//>>built
require({cache:{"url:builder/plugins/app-list/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-cf" data-dojo-attach-point\x3d"createFromHere" data-dojo-attach-event\x3d"onclick:_onCreateFromHereClick,onmouseover:_onCreateFromHereMouseover,onmouseout:_onCreateFromHereMouseout"\x3e${nls.createFromHere}\x3c/div--\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" style\x3d"border-top-left-radius:5px;border-top-right-radius:5px;"data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item itme-remove" style\x3d"" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n\r\n  \x3c!--div class\x3d"item itme-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppOperMenu.html dojo/on dojo/query dojo/dom dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/serviceUtils jimu/dijit/LoadingShelter dijit/form/TextBox dijit/form/SimpleTextarea jimu/dijit/QRCode builder/PluginManager".split(" "),function(m,a,n,p,q,r,s,t,u,e,h,v,k,l,w,x,y,z){return m([n,p],{templateString:q,baseClass:"app-menu",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",
appListWidget:void 0,loadingDiv:null,_downloadUrl:null,postCreate:function(){this.inherited(arguments);this.height=a.getMarginBox(this.domNode).h;this.hide();this._downloadUrl="/webappbuilder/rest/apps/"+this.app.id+"/download";a.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(r(this.downloadLinkNode,"click",e.hitch(this,function(){this.hide()})))},refresh:function(){var d=t.byId("list-section"),b=a.position(this.posNode),f=a.position(d),c=b.y-f.y,d=a.getStyle(d,"height"),f=f.y+d,
d=this.height,b=b.y+d;a.setStyle(this.upTriangle,"display","block");a.setStyle(this.downTriangle,"display","none");b+30>f&&(c=c-d-66,a.setStyle(this.upTriangle,"display","none"),a.setStyle(this.downTriangle,"top",this.height-2+"px"),a.setStyle(this.downTriangle,"display","block"));a.setStyle(this.domNode,isRTL?{top:c+52+"px",left:"2px"}:{top:c+52+"px",right:"2px"})},show:function(){this.refresh();a.setStyle(this.domNode,"display","block");this.isShow=!0},hide:function(){a.setStyle(this.domNode,"display",
"none");this.isShow=!1},_onMenuClick:function(a){a.stopPropagation()},_onCreateFromHereClick:function(){},_onCreateFromHereMouseover:function(){a.addClass(this.createFromHere,"item-mouseover")},_onCreateFromHereMouseout:function(){a.removeClass(this.createFromHere,"item-mouseover")},_onRemoveClick:function(){var a=new h({content:this.nls.confirmDeleteApp,titleLabel:this.nls.deleteAppTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){var b=new l({hidden:!0});
b.placeAt(this.appListWidget.domNode);b.show(this.nls.deleting);a.close();k.removeApp(this.app.id).then(e.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),a.apps!=={}&&this.appListWidget.refresh(a.apps)):console.error(this.nls.deleteFalse);b.destroy()}),function(){console.error(this.nls.deleteError);b.destroy()})})},{label:this.nls.cancel,onClick:e.hitch(this,function(){a.close()})}]})},_onRemoveMouseover:function(){a.addClass(this.remove,"item-mouseover")},
_onRemoveMouseout:function(){a.removeClass(this.remove,"item-mouseover")},_onDuplicateClick:function(){var a=new l({hidden:!0});a.placeAt(this.appListWidget.domNode);a.show(this.nls.duplicating);k.duplicateApp({name:this.app.name,description:this.app.description,is3D:this.app.is3D,createFromId:this.app.id,appType:this.app.appType,appPath:z.getInstance().getStemappInfo("HTML").appPath}).then(e.hitch(this,function(b){a.destroy();b.success?(console.log("Duplicated app successfully, app id\x3d"+this.app.id),
b.apps!=={}&&this.appListWidget.refresh(b.apps)):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError)});this.hide()},_onDuplicateMouseover:function(){a.addClass(this.duplicate,"item-mouseover")},_onDuplicateMouseout:function(){a.removeClass(this.duplicate,"item-mouseover")},_onEditClick:function(){var d=a.create("div",{"class":"edit-app-info-content"}),b;b=a.create("div",{"class":"app-name"},d);var f=(new w({value:this.app.name,maxlength:250,required:!0,placeholder:this.nls.appName,
"class":"name-text-box"})).placeAt(b);b=a.create("div",{"class":"app-description"},d);var c=(new x({value:this.app.description,rows:5,trim:!0,maxlength:250,required:!0,placeholder:this.nls.appDesc,"class":"desc-text-area"})).placeAt(b),g=new h({content:d,container:"main-page",titleLabel:this.nls.editAppInfo,width:"700",autoHeight:!0,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){var a=e.hitch(this,this._onEditPageOk,f.getValue(),c.getValue(),g);this.app.name!==f.getValue()||this.app.description!==
c.getValue()?a():g.close()})},{label:this.nls.cancel,onClick:function(){g.close()}}]}),d=s(".line",g.domNode)[0];a.destroy(d)},_onEditPageOk:function(a,b,f){var c=e.clone(this.app);c.name=a;c.description=b;this.appListWidget.updateApp(c).then(e.hitch(this,function(c){!0===c.success?(this.app.name=a,this.app.description=b,console.log(this.nls.editAppTrue+this.app.id),this.app.lastUpdated=c.lastUpdated,this.app.modified=c.modified,this.appListWidget.refresh(this.apps),f.close()):(console.error(this.nls.editAppFalse),
new v({message:c.message}))}),function(a){console.error(this.nls.error+a)})},_onEditMouseover:function(){a.addClass(this.editAppInfo,"item-mouseover")},_onEditMouseout:function(){a.removeClass(this.editAppInfo,"item-mouseover")},_onDownloadClick:function(){},_onDownloadMouseover:function(){a.addClass(this.download,"item-mouseover")},_onDownloadMouseout:function(){a.removeClass(this.download,"item-mouseover")},_onAgolTemplateClick:function(){var a=this.appListWidget.pluginsMeta["popup-actions.popup-agoltemplate"];
a&&this.appListWidget.pluginManager.loadPlugin(a).then(e.hitch(this,function(a){a.onClickBeforeConfigPage(this.app)}))},_onAgolTemplateMouseover:function(){a.addClass(this.agolTemplate,"item-mouseover")},_onAgolTemplateMouseout:function(){a.removeClass(this.agolTemplate,"item-mouseover")},_onQRCodeClick:function(){new h({content:new y({text:"http://"+window.location.host+path+"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,
key:u.ESCAPE}]})}})});