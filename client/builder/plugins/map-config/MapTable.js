//>>built
require({cache:{"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"filteredMapsSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),function(t,u,v,w,x,y,f,z,c,C,e,q,r,s,A,D,B){return t([u,v,w,y],{templateString:x,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,
originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=B},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=A.getStandardPortalUrl(this.portalUrl));this.own(q(this.allMapsTableDiv,"scroll",f.hitch(this,this._onAllMapsSectionScroll)));this.own(q(this.filteredMapsTableDiv,"scroll",f.hitch(this,this._onFilteredMapsSectionScroll)));this.showAllMapsSection();this.searchAllMaps()},show:function(){c.setStyle(this.domNode,
"display","block")},hide:function(){c.setStyle(this.domNode,"display","none")},searchAllMaps:function(b){this.showAllMapsSection();b&&(this.query=f.mixin({},b),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),s.getPortal(this.portalUrl).queryItems(this.query).then(f.hitch(this,function(a){this.domNode&&(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),f.hitch(this,function(a){console.error(a);
this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(b){this.showFilterMapsSection();b&&(this.filteredQuery=f.mixin({},b),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),s.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(f.hitch(this,function(a){this.domNode&&(this.filteredMapsShelter.hide(),this.filteredQuery.start=a.nextStart,this._createMapItems(a,this.filteredMapsTbody),
0===this._getWebMapCount(this.filteredMapsTbody)&&(c.setStyle(this.filteredMapsTableDiv,"display","none"),c.setStyle(this.searchNoneTipSection,"display","block")))}),f.hitch(this,function(a){console.error(a);this.domNode&&(this.filteredMapsShelter.hide(),0===this._getWebMapCount(this.filteredMapsTbody)&&(c.setStyle(this.filteredMapsTableDiv,"display","none"),c.setStyle(this.searchNoneTipSection,"display","block")))})))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},
clearAllMapsSection:function(){c.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){c.empty(this.filteredMapsTbody)},showAllMapsSection:function(){c.setStyle(this.allMapsSection,"display","block");c.setStyle(this.filteredMapsSection,"display","none")},showFilterMapsSection:function(){c.setStyle(this.allMapsSection,"display","none");c.setStyle(this.filteredMapsSection,"display","block");c.setStyle(this.filteredMapsTableDiv,"display","block");c.setStyle(this.searchNoneTipSection,"display",
"none")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(b){return r.isScrollToBottom(b)},_createMapItems:function(b,a){var g=z.filter(b.results,f.hitch(this,function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==g.length){var m={},d,h=e("td.empty",a),k;if(0<h.length){var n=Math.min(g.length,
h.length),l=g.splice(0,n);for(k=0;k<n;k++){var p=h[k];d=this._createMapItem(l[k]);m[d.item.id]=d;c.place(d,p);c.removeClass(p,"empty")}}if(0!==g.length){h=Math.ceil(g.length/5);for(k=0;k<h;k++){d=c.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");c.place(d,a);n=e("td",d);for(l=0;l<n.length;l++)p=n[l],(d=g[5*k+l])?(d=this._createMapItem(d),m[d.item.id]=d,c.place(d,p)):c.addClass(p,"empty")}if(!this.getSelectedMapItem()&&
(this.appConfig&&this.appConfig.map.itemId)&&(d=m[this.appConfig.itemId]))g=e(".map-item-bg",d),c.addClass(g,"selected")}}},_getWebMapCount:function(b){return e(".map-item-div",b).length},_createMapItem:function(b){var a=c.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
g=e(".map-item-bg",a)[0],m=e(".map-item-thumbnail",a)[0],d=e(".map-item-title",a)[0],h=e(".map-item-detail-icon",a)[0];e(".none-thumbnail-tip",a);h.href=b.detailsPageUrl;h.title=this.nls.viewItemDetails||"";a.item=b;h=b.thumbnailUrl||r.getDefaultWebMapThumbnail();c.setStyle(m,"backgroundImage","url("+h+")");this.own(q(g,"click",f.hitch(this,this._onMapItemBgClick)));d.innerHTML=b.title;d.title=b.title;return a},unselect:function(){e(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(b){b=
b.target||b.srcElement;var a=null;c.hasClass(b,"map-item-thumbnail")?a=b.parentNode:c.hasClass(b,"none-thumbnail-tip")&&(a=b.parentNode.parentNode);a&&c.hasClass(a,"map-item-bg")&&(this.unselect(),c.addClass(a,"selected"),this.emit("select",{mapTable:this,selectedNode:a}))},getSelectedMapItem:function(){var b=null,a=e(".map-item-bg.selected",this.domNode);0<a.length&&(b=a[0].parentNode.item);return b}})});