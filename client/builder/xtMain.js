//>>built
require({cache:{"builder/SetPortalUrl":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/topic dojox/validate/regexp dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SetPortalUrl.html dojo/Evented dojo/request dojo/Deferred dojo/keys dojo/cookie dojo/store/Memory jimu/dijit/LoadingIndicator jimu/portalUrlUtils ./tokenUtils esri/request esri/arcgis/OAuthInfo esri/IdentityManager dijit/form/TextBox dijit/form/ValidationTextBox jimu/dijit/URLComboBox".split(" "),
function(d,h,b,k,f,r,m,e,w,u,s,g,v,t,n,x,l,p,y,z,A){return h([u,r,m,e],{baseClass:"jimu-set-portal-url",templateString:w,label:"setportalurl",defaultExpires:20160,invalidInput:!0,_portalUrlInputStatus:"uncheck",_validPortalUrls:null,_UrlEnterKeyDown:!1,_continueClick:!1,_oauthCheckError:null,currentDef:null,signinInfo:null,currentPortalUrl:null,postMixInProperties:function(){this.nls=window.builderNls},postCreate:function(){this.inherited(arguments);this.signinInfos=[];this._validPortalUrls=[];this.loading||
(this.loading=new x);this.loading.placeAt(this.domNode);this.loading.show();this.loadingUrl=b.create("div",{"class":"loadingUrl"},this.portalUrlInput.domNode);this.invalidUrl=b.create("div",{"class":"invalidUrl"},this.portalUrlInput.domNode);this.validUrl=b.create("div",{"class":"validUrl"},this.portalUrlInput.domNode);this.signinInfo={portalUrl:"",supportsOAuth:!1,appId:null};b.addClass(this.portalUrlInput.domNode,"portalUrlInput");this._getFAQHelpLink().then(d.hitch(this,function(a){b.setStyle(this.faqNode,
"display","inline-block");b.setAttr(this.faqNode,"href",a)}));this._getSigninInfos().then(d.hitch(this,function(a){var c=new n({data:a});this.signinInfos=a;this.portalUrlInput.set("store",c);this.portalUrlInput.set("searchAttr","portalUrl");this.currentPortalUrl?this.portalUrlInput.set("value",this.currentPortalUrl):a[0]&&a[0].portalUrl&&this.portalUrlInput.set("value",a[0].portalUrl)}),d.hitch(this,function(a){console.error(a)})).always(d.hitch(this,function(){this.loading.hide()}))},_writeWabCurrentPortalUrlToCookie:function(a){t("wab_portalurl",
a,{path:"/webappbuilder"});t("wab_portalurl",a,{path:"/webappviewer"});t("wab_portalurl_persistent",a,{path:"/",expires:365})},_getFAQHelpLink:function(){var a=new g;window.isXT?s("/webappbuilder/help/exists",{handleAs:"json"}).then(d.hitch(this,function(c){!c||!c.exists?a.resolve("#"):s("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(d.hitch(this,function(c){var b="#";c&&(c.m&&c.m["120000962"])&&(b="/webappbuilder/help/"+c.m["120000962"]);a.resolve(b)}),d.hitch(this,function(c){console.warn(c);
a.resolve("#")}))}),function(c){console.log(c);a.resolve("#")}):a.resolve("#");return a},_getSigninInfos:function(){var a=new g;s("/webappbuilder/rest/signininfo/getsignininfos",{handleAs:"json"}).then(d.hitch(this,function(c){c.success?a.resolve(c.infos):a.resolve([])}),d.hitch(this,function(c){a.reject(c)}));return a},setPortalUrl:function(a,c){this._oauthCheckError={portalUrl:a,error:c};this.currentPortalUrl=a;this.portalUrlInput.set("value",a)},_isValidAppIdInPortalUrl:function(a){return!this._oauthCheckError?
!0:l.isSamePortalUrl(a,this._oauthCheckError.portalUrl)&&("invalid_client_id"===this._oauthCheckError.error||"invalid_redirect_uri"===this._oauthCheckError.error)?!1:!0},_onPortalUrlKeyDown:function(a){(a.keyCode?a.keyCode:a.which)===v.ENTER?(this._UrlEnterKeyDown=!0,this.portalUrlInput.onBlur()):(this._continueClick=this._UrlEnterKeyDown=!1,this._portalUrlInputStatus="uncheck",this._hideAllStatus(),b.setStyle(this.appIdDiv,"display","none"),this.appIdInput.set("value",""),this._cancelValidating())},
_cancelValidating:function(){this.currentDef&&!this.currentDef.isCanceled()&&(this._portalUrlInputStatus="uncheck",this.currentDef.cancel(),b.setStyle(this.invalidUrl,"display","none"),b.setStyle(this.errorRemind,"display","none"))},_onPortalUrlBlur:function(){this._switchPortalUrlInputStatus()},_switchPortalUrlInputStatus:function(){if("checking"!==this._portalUrlInputStatus){b.setStyle(this.appIdDiv,"display","none");var a=this.portalUrlInput.get("value");0>a.toLowerCase().indexOf("http://")&&0>
a.toLowerCase().indexOf("https://")&&(a=l.setHttpProtocol(a));a=l.getStandardPortalUrl(a);if(this._isValidPortalUrl(a)){var c=this._getSigninInfo(a);c.portalUrl=a;this._showValidStatus();(this.signinInfo=c)&&(c.isWebTier||!c.supportsOAuth)?this._UrlEnterKeyDown&&this._onContinue():c&&c.appId?(this.appIdInput.set("value",c.appId),this._UrlEnterKeyDown&&this._onContinue()):(b.setStyle(this.appIdDiv,"display","block"),this._UrlEnterKeyDown=!1,this.appIdInput.set("value",""))}else this.appIdInput.set("value",
""),this._UrlEnterKeyDown=!1,this._cancelValidating(),this._validatePortal()}},_isValidPortalUrl:function(a){for(var c=0,b=this._validPortalUrls.length;c<b;c++)if(l.isSamePortalUrl(a,this._validPortalUrls[c]))return!0;return!1},_onPortalUrlChange:function(){this._switchPortalUrlInputStatus()},_onAppIdInputKeyDown:function(a){if((a.keyCode?a.keyCode:a.which)===v.ENTER)this.signinInfo.appId=this.appIdInput.get("value"),this.continueBtn.focus(),this.continueBtn.click(),a.stopPropagation()},_onAppIdInputChange:function(){var a=
this.signinInfo.appId,c=this.appIdInput.get("value");this.signinInfo.appId=c;this.signinInfo.supportsOAuth&&!this.signinInfo.appId?b.addClass(this.continueBtn,"Cont-btn-disable"):(b.removeClass(this.continueBtn,"Cont-btn-disable"),a!==c&&(b.removeClass(this.appIdInput.domNode,"errorStatus"),b.setStyle(this.appIdErrorNode,"display","none")))},_updateSigninInfo:function(a){var c=new g;s("/webappbuilder/rest/signininfo/setsignininfo",{handleAs:"json",data:a,method:"POST"}).then(d.hitch(this,function(b){b.success&&
this._writeWabCurrentPortalUrlToCookie(a.portalUrl);c.resolve(b)}),d.hitch(this,function(a){c.reject(a)}));return c},_allowNamedorLocal:function(a){var c="^"+f.url({allowNamed:!1,allLocal:!1});return RegExp(c,"g").test(a)},_validatePortalExist:function(a){var c=new g;a=l.getPortalSelfInfoUrl(a);a=l.setHttpsProtocol(a);this.currentDef=y({url:a,content:{f:"json"},handleAs:"json",timeout:6E4},{useProxy:!0});this.currentDef.then(d.hitch(this,function(){c.resolve(!0)}),d.hitch(this,function(a){a=a.status||
a.xhr||a.xhr.status;401===a||403===a?c.resolve(!0):c.resolve(!1)}));return c},_validatePortal:function(){this.portalUrlInput.get("value")?b.setStyle(this.remind,"display","none"):b.setStyle(this.remind,"display","block");var a=this.portalUrlInput.get("value");a&&(this.portalUrlInput.validator(this.portalUrlInput.get("value"))&&(a=this.portalUrlInput.get("value")),0>a.toLowerCase().indexOf("http://")&&0>a.toLowerCase().indexOf("https://")&&(a=l.setHttpProtocol(a)),/www.arcgis.com/gi.test(a)||!this._allowNamedorLocal(a)?
this._showInvalidStatus():(this._showValidatingStatus(),a=l.getStandardPortalUrl(a),b.addClass(this.continueBtn,"Cont-btn-disable"),this._validatePortalExist(a).then(d.hitch(this,function(c){c?this._postProcessPortal(a):(this._showInvalidStatus(),b.setStyle(this.appIdDiv,"display","none"))}))))},_getPortalSelf:function(a){var c={url:a+"/sharing/rest/portals/self",content:{f:"json"},handleAs:"json",timeout:15E3,callbackParamName:"callback",preventCache:!0};if(a=p.getPortalCredential(a))a.token&&(c.content.token=
a.token),a.ssl&&(c.url=l.setHttpsProtocol(c.url));return y(c)},_postProcessPortal:function(a){this.currentDef=p.isWebTierPortal(a);this.currentDef.then(d.hitch(this,function(c){var e=p.getPortalCredential(a);e&&(e.ssl&&(a=l.setHttpsProtocol(a)),k.publish("userSignIn",e));this.currentDef=e=this._getPortalSelf(a);this.signinInfo={portalUrl:a};e.then(d.hitch(this,function(e){this.portalSelfInfo=e;if(!e.isPortal&&!e.urlKey)this._showInvalidStatus(),console.error("invalid name");else{var d=this._getSigninInfo(a);
d||this.signinInfos.push(this.signinInfo);this._isValidPortalUrl(a)||this._validPortalUrls.push(a);this.signinInfo.supportsOAuth=e.supportsOAuth;if(c)this.signinInfo.isWebTier=!0,this._showValidStatus(),b.removeClass(this.continueBtn,"Cont-btn-disable");else if(this.signinInfo.appId=d?d.appId:"",this.signinInfo.supportsOAuth?this.signinInfo.appId?(this._isValidAppIdInPortalUrl(a)||(b.setStyle(this.appIdDiv,"display","block"),b.addClass(this.appIdInput.domNode,"errorStatus"),b.setStyle(this.appIdErrorNode,
"display","block")),this.appIdInput.set("value",this.signinInfo.appId)):b.setStyle(this.appIdDiv,"display","block"):b.setStyle(this.appIdDiv,"display","none"),this._showValidStatus(),b.removeClass(this.continueBtn,"Cont-btn-disable"),e=b.getStyle(this.appIdDiv,"display"),this.signinInfo.supportsOAuth&&"none"!==e)b.addClass(this.continueBtn,"Cont-btn-disable"),this.appIdInput.focus();else if(this._UrlEnterKeyDown||this._continueClick)this._onContinue(),this._UrlEnterKeyDown=this._continueClick=!1}}),
d.hitch(this,function(a){this._showInvalidStatus();console.error(a)}))}),d.hitch(this,function(a){this._showInvalidStatus();console.error(a)}))},_getSigninInfo:function(a){for(var c=0;c<this.signinInfos.length;c++)if(l.isSamePortalUrl(this.signinInfos[c].portalUrl,a))return this.signinInfos[c];return null},_hideAllStatus:function(){b.setStyle(this.loadingUrl,"display","none");b.setStyle(this.validUrl,"display","none");b.setStyle(this.invalidUrl,"display","none");b.setStyle(this.errorRemind,"display",
"none")},_showValidStatus:function(){b.removeClass(this.portalUrlInput.domNode,"errorStatus");b.setStyle(this.loadingUrl,"display","none");b.setStyle(this.validUrl,"display","block");b.setStyle(this.invalidUrl,"display","none");b.setStyle(this.errorRemind,"display","none");this.invalidInput=!1;this._portalUrlInputStatus="checked"},_showValidatingStatus:function(){b.removeClass(this.portalUrlInput.domNode,"errorStatus");b.setStyle(this.loadingUrl,"display","block");b.setStyle(this.validUrl,"display",
"none");b.setStyle(this.invalidUrl,"display","none");b.setStyle(this.errorRemind,"display","none");this.invalidInput=!0;this._portalUrlInputStatus="checking"},_showInvalidStatus:function(){b.addClass(this.portalUrlInput.domNode,"errorStatus");b.setStyle(this.portalUrlInput.domNode,"data-dojo-props","missingMessage:'IPUT URL'");b.setStyle(this.loadingUrl,"display","none");b.setStyle(this.validUrl,"display","none");b.setStyle(this.invalidUrl,"display","block");b.setStyle(this.errorRemind,"display",
"block");var a=this.portalUrlInput.get("value");/www.arcgis.com/gi.test(a)||!this._allowNamedorLocal(a)?this.errorRemind.innerHTML=this.nls.errOrg:this.errorRemind.innerHTML=this.nls.errPrefix+a+"\x3cbr\x3e"+this.nls.errRemind;this.invalidInput=!0;this._portalUrlInputStatus="checked"},_onContinue:function(){this.invalidInput||(this.signinInfo.isWebTier?k.publish("switchToMainPage",this.signinInfo):this.signinInfo.supportsOAuth?this.signinInfo.appId?this._updateSigninInfo(this.signinInfo).then(d.hitch(this,
function(a){a.success&&this._oauthSignIn(this.signinInfo.portalUrl,this.signinInfo.appId)})):this.appIdInput.focus():(this._continueClick=this._UrlEnterKeyDown=!1,k.publish("switchToSignin",d.clone(this.signinInfo))))},_oauthSignIn:function(a,c){p.signOutAll();a=l.getStandardPortalUrl(a);var b=new z({appId:c,portalUrl:a,expiration:this.defaultExpires,authNamespace:"/",popup:!1});A.registerOAuthInfos([b]);b=l.getSharingUrl(a);A.getCredential(b)}})})},"jimu/dijit/URLComboBox":function(){define(["dojo/_base/declare",
"dojo/_base/html","dijit/form/ComboBox","dojox/validate/regexp"],function(d,h,b,k){return d([b],{required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allLocal:!1,declaredClass:"jimu.dijit.URLComboBox",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.urlInput;this.invalidMessage=this.nls.invalidUrl},postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-url-combobox")},validator:function(b){var d="^"+k.url({allowNamed:this.allowNamed,
allLocal:this.allLocal}),d=RegExp(d,"g").test(b);return this.rest?(b=/\/rest\/services/gi.test(b),d&&b):d}})})},"builder/PortalSignIn":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic dojo/_base/html dojo/request/registry dojo/keys dojo/Deferred dojo/promise/all dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/PortalSignIn.html esri/request jimu/portalUrlUtils jimu/dijit/CheckBox jimu/dijit/Message ./tokenUtils".split(" "),function(d,
h,b,k,f,r,m,e,w,u,s,g,v,t,n,x,l,p){return d([u,s,g],{templateString:v,nls:null,defaultExpires:20160,label:"signin",postMixInProperties:function(){this.inherited(arguments);this.nls=window.builderNls},postCreate:function(){this.inherited(arguments);this._hideAppIdTip();this._bindEvents()},_hideAppIdTip:function(){f.setStyle(this.appIdTipSection,"display","none")},_bindEvents:function(){this.remember=new x({label:this.nls.remember,checked:!1},this.remember);this.own(b(this.password,"blur",h.hitch(this,
this.changeSigninStatus)));this.own(b(this.domNode,"keydown",h.hitch(this,function(b){(b.keyCode?b.keyCode:b.which)===m.ENTER&&this._onSigninClick()})))},_generateTokenSignIn:function(b){var d=new e,g=p.xtGetCredentialFromCookie(b);if(g)return d.resolve(g),d;p.removeWabAuthCookie();b=n.getStandardPortalUrl(b);var a=n.setHttpsProtocol(b),g="/proxy.js?"+a+"/sharing/generateToken";this.shelter.show(this.nls.signingIn+"...");r(g,{handleAs:"json",method:"POST",data:{request:"getToken",username:f.getAttr(this.username,
"value"),password:f.getAttr(this.password,"value"),referer:window.location.host,expiration:this.remember.checked?this.defaultExpires:120,f:"json"},headers:{"X-Requested-With":null}}).then(h.hitch(this,function(c){if(c&&c.token){this._clearUserPassword();var e="/proxy.js?"+n.getCommunitySelfUrl(a),g=this._getPortalSelf(c.token),e=r(e,{handleAs:"json",method:"POST",data:{token:c.token,f:"json"},headers:{"X-Requested-With":null}});w([g,e]).then(h.hitch(this,function(a){this.shelter.hide();var e=a[0];
a=a[1];if(a.orgId){var g=n.getProtocol(b)+":";!e.isPortal&&e.urlKey&&(this.signinInfo.portalUrl=g+"//"+e.urlKey.toLowerCase()+"."+e.customBaseUrl);a.username&&(e={server:n.getStandardPortalUrl(this.signinInfo.portalUrl),token:c.token,userId:a.username,expires:c.expires,referer:window.location.host,scope:"portal",isAdmin:"org_admin"===a.role},a=p.saveAndRegisterCookieToCredential(e),k.publish("userSignIn",a),d.resolve(e))}else new l({message:this.nls.namedUserTip,container:document.body})}),h.hitch(this,
function(a){console.error(a);this._loginStatus(!0);d.reject(a)}))}else this.shelter.hide(),this._loginStatus(!0),d.reject()}),h.hitch(this,function(a){this.shelter.hide();console.error(a);this._loginStatus(!0);d.reject(a)}));return d},setSigninInfo:function(b){this.signinInfo=b;f.setStyle(this.domNode,"display","block");var e=n.getStandardPortalUrl(b.portalUrl);this.forgot.href=e+"/home/troubleshoot.html";p.xtGetCredentialFromCookie(b.portalUrl)&&this._onSigninClick()},_getPortalSelf:function(b){var e=
{url:n.getPortalSelfInfoUrl(this.signinInfo.portalUrl),content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0};b&&(e.content.token=b);return t(e)},_onSigninClick:function(){this._generateTokenSignIn(this.signinInfo.portalUrl).then(h.hitch(this,function(){k.publish("switchToMainPage",this.signinInfo)}),h.hitch(this,function(b){console.error(b)}))},_onBackClick:function(){k.publish("switchToSetPortalUrl")},_loginStatus:function(b){b?(this.username.focus(),f.setStyle(this.errorNode,
"display","block")):f.setStyle(this.errorNode,"display","none")},_clearUserPassword:function(){this.username.value="";this.password.value=""},changeSigninStatus:function(){this.password.value?f.removeClass(this.signin,"signin-btn-disable"):f.hasClass(this.signin,"signin-btn-disable")||f.addClass(this.signin,"signin-btn-disable")}})})},"dojo/request/registry":function(){define(["require","../_base/array","./default!platform","./util"],function(d,h,b,k){function f(e,d){for(var f=m.slice(0),h=0,g;g=
f[h++];)if(g(e,d))return g.request.call(null,e,d);return b.apply(null,arguments)}function r(b,d){var f;d?(f=b.test?function(d){return b.test(d)}:b.apply&&b.call?function(){return b.apply(null,arguments)}:function(d){return d===b},f.request=d):(f=function(){return!0},f.request=b);return f}var m=[];f.register=function(b,d,f){var k=r(b,d);m[f?"unshift":"push"](k);return{remove:function(){var b;~(b=h.indexOf(m,k))&&m.splice(b,1)}}};f.load=function(e,h,k,m){e?d([e],function(d){b=d;k(f)}):k(f)};k.addCommonMethods(f);
return f})},"url:builder/templates/SetPortalUrl.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"portalContent"\x3e\r\n    \x3cp class \x3d "specify-text-url"\x3e${nls.tip}\x3c/p\x3e \r\n\r\n    \x3cdiv class\x3d"portalUrlDiv" id\x3d"portalUrlDiv"\x3e\r\n      \x3cinput class\x3d"portalUrlInput" data-dojo-attach-point\x3d"portalUrlInput" name\x3d"portalUrl" type\x3d"text"\r\n      data-dojo-type\x3d"jimu/dijit/URLComboBox" data-dojo-attach-event\x3d"KeyDown: _onPortalUrlKeyDown,Change:_onPortalUrlChange,Blur:_onPortalUrlBlur"\r\n      data-dojo-props\x3d"rest:false,missingMessage:\'Please input portalUrl.\', invalidMessage: \'Invalid Portal URL\', allowNamed:true, allowLocal:true" /\x3e\r\n      \x3cdiv class\x3d"Remind" data-dojo-attach-point\x3d"remind" \x3e \r\n        \x3ctable\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd\x3e${nls.example}:\x3c/td\x3e\x3ctd\x3ehttp://myportal.company.com/arcgis\x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd\x3e\x3c/td\x3e\x3ctd\x3ehttp://orgname.maps.arcgis.com\x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"errorRemind" data-dojo-attach-point\x3d"errorRemind"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"appIdDiv" data-dojo-attach-point\x3d"appIdDiv"\x3e\r\n      \x3cp\x3e\r\n        \x3cspan\x3e\r\n          ${nls.appIdTip}\r\n        \x3c/span\x3e\r\n        \x3cspan\x3e(\x3c/span\x3e\r\n        \x3ca href\x3d"http://developers.arcgis.com/web-appbuilder/guide/getstarted.htm#ESRI_SECTION1_7BEAC94A35A945A58073127C1BE7359A" target\x3d"_blank"\x3e?\x3c/a\x3e\r\n        \x3cspan\x3e)\x3c/span\x3e\r\n      \x3c/p\x3e\r\n      \x3cinput type\x3d"text" class\x3d"appIdInput" data-dojo-attach-point\x3d"appIdInput" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Change: _onAppIdInputChange,KeyDown: _onAppIdInputKeyDown"\r\n      data-dojo-props\x3d\'required:true,placeHolder:"${nls.appIdPlaceHolder}"\'/\x3e\r\n      \x3clabel class\x3d"appIdError jimu-float-leading" data-dojo-attach-point\x3d"appIdErrorNode"\x3e${nls.appIdError}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"ContinueBtn jimu-float-trailing" data-dojo-attach-point\x3d"continueBtn" data-dojo-attach-event\x3d"click:_onContinue"\x3e\r\n      ${nls.continueBtn}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"trouble-shooting"\x3e\r\n      \x3ca data-dojo-attach-point\x3d"faqNode" target\x3d"_blank"\x3e${nls.faq}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/templates/PortalSignIn.html":'\x3cdiv class\x3d"jimu-portal-signin"\x3e\r\n  \x3clabel data-dojo-attach-point\x3d"errorNode" class\x3d"error-message"\x3e${nls.errorMessage}\x3c/label\x3e\r\n  \x3cdiv class\x3d"signin-content" data-dojo-attach-point\x3d"signinContentNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"appIdTipSection" class\x3d"appid-tip-section" style\x3d"display:none;"\x3e\r\n      \x3cdiv\x3e${nls.appIdTip1}\x3c/div\x3e\r\n      \x3cdiv style\x3d"margin-top:20px;"\x3e\r\n        \x3cspan\x3e${nls.appIdTip2}\x3c/span\x3e\r\n        \x3ca class\x3dhelp-link target\x3d_blank href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.here}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"form"\x3e\r\n      \x3clabel\x3e${nls.username}\x3c/label\x3e\r\n      \x3cinput type\x3d"text" tabindex\x3d"1" data-dojo-attach-point\x3d"username" /\x3e\r\n      \x3clabel\x3e${nls.password}\x3c/label\x3e\r\n      \x3ca data-dojo-attach-point\x3d"forgot" style\x3d"margin-left:10px;" target\x3d"_blank" href\x3d"#"\x3e${nls.forgot}\x3c/a\x3e\r\n      \x3cinput type\x3d"password" tabindex\x3d"2" data-dojo-attach-point\x3d"password" /\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"remember"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"operations"\x3e\r\n      \x3cdiv class\x3d"btn signin-btn jimu-float-trailing" data-dojo-attach-point\x3d"signin" tabindex\x3d"3" data-dojo-attach-event\x3d"onclick:_onSigninClick" \x3e${nls.con}\x3c/div\x3e\r\n      \x3cdiv class\x3d"btn jimu-trailing-margin2 jimu-float-trailing" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBackClick"\x3e${nls.back}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/parser dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/cookie dojo/request/xhr dojo/topic dijit/registry builder/tokenUtils jimu jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/dijit/ViewStack jimu/dijit/LoadingShelter ./SetPortalUrl ./PortalSignIn ./utils esri/config esri/urlUtils esri/request esri/IdentityManager".split(" "),function(d,h,b,k,f,r,m,e,w,u,s,g,v,t,n,x,l,p,y,z,A,a,c){function B(a){h.setStyle("pre-main-page","display","block");h.setStyle("main-page","display",
"none");null===q&&(q=new n({viewType:"dijit",views:[new l({},"portal-url-div"),new p({},"signin-div")]},"pre-main-page"),q.switchView("setportalurl"))}var q=null;e.subscribe("switchToSetPortalUrl",function(){B();q.switchView("setportalurl")});e.subscribe("switchToSignin",function(a){B();var b=window.location.href.replace("action\x3dsetportalurl","action\x3dsignin");g.changeLocation(b);q.switchView("signin");q.getViewByLabel("signin").setSigninInfo(a)});c._oAuthDfd=null;(function(){z.defaults.io.proxyUrl=
"/proxy.js";var a=r("wab_portalurl_persistent");m("/webappbuilder/rest/signininfo/getsignininfo",{query:{portalUrl:a},handleAs:"json"}).then(function(b){if(b.success)if(b=b.info){var c;c=window.originalHash.replace("#","");c=g.hashToObject(c);if(c.access_token){var d=y.removeActionFromUrl(window.location.href);g.changeLocation(d);c=u.registerAuth2Hash(c);e.publish("userSignIn",c);e.publish("switchToMainPage",b)}else c.error&&c.error_description?(d="unknown_error","invalid_request"===c.error?"Invalid client_id"===
c.error_description?d="invalid_client_id":"Invalid redirect_uri"===c.error_description&&(d="invalid_redirect_uri"):d="access_denied"===c.error?"access_denied":"unknown_error",e.publish("switchToSetPortalUrl"),q.getViewByLabel("setportalurl").setPortalUrl(b.portalUrl,d)):"setportalurl"===queryObject.action?(e.publish("switchToSetPortalUrl"),q.getViewByLabel("setportalurl").setPortalUrl(b.portalUrl)):"signin"===queryObject.action?b.supportsOAuth||b.isWebTier?(e.publish("switchToSetPortalUrl"),q.getViewByLabel("setportalurl").setPortalUrl(b.portalUrl)):
e.publish("switchToSignin",b):b.isWebTier?(e.publish("switchToSetPortalUrl"),q.getViewByLabel("setportalurl").setPortalUrl(b.portalUrl)):e.publish("switchToMainPage",b)}else e.publish("switchToSetPortalUrl"),q.getViewByLabel("setportalurl").setPortalUrl(a);else console.log("Unknow error")})})()});