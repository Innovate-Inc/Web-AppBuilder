//>>built
require({cache:{"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(q,e,a){var f=q.some;return function(k){var n,r;k instanceof Array?r=k:k&&"object"===typeof k&&(n=k);var t,b=[];if(n){r=[];for(var g in n)Object.hasOwnProperty.call(n,g)&&(b.push(g),r.push(n[g]));t={}}else r&&(t=[]);if(!r||!r.length)return(new e).resolve(t);var d=new e;d.promise.always(function(){t=b=null});var h=r.length;f(r,function(g,m){n||b.push(m);a(g,function(a){d.isFulfilled()||(t[b[m]]=
a,0===--h&&d.resolve(t))},d.reject);return d.isFulfilled()});return d.promise}})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(q,e){q.cookie=function(a,f,k){var n=document.cookie,r;if(1==arguments.length)r=(r=n.match(RegExp("(?:^|; )"+e.escapeString(a)+"\x3d([^;]*)")))?decodeURIComponent(r[1]):void 0;else{k=k||{};n=k.expires;if("number"==typeof n){var t=new Date;t.setTime(t.getTime()+864E5*n);n=k.expires=t}n&&n.toUTCString&&(k.expires=n.toUTCString());f=encodeURIComponent(f);
var n=a+"\x3d"+f,b;for(b in k)n+="; "+b,t=k[b],!0!==t&&(n+="\x3d"+t);document.cookie=n}return r};q.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return q.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(q,e){var a={};e.setObject("dojo.regexp",
a);a.escapeString=function(a,e){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return e&&-1!=e.indexOf(a)?a:"\\"+a})};a.buildGroupRE=function(e,k,n){if(!(e instanceof Array))return k(e);for(var r=[],t=0;t<e.length;t++)r.push(k(e[t]));return a.group(r.join("|"),n)};a.group=function(a,e){return"("+(e?"?:":"")+a+")"};return a})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale esri/arcgis/utils esri/SpatialReference esri/geometry/Extent esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters jimu/portalUrlUtils esri/urlUtils esri/request ./shared/utils".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z){function D(c,a){var b=c.match(/url\([^)]+\)/gi),d,l;if(null===b||""===a)return c;for(d=0;d<b.length;d++)if(l=b[d].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),4<=l.length){var p=l[2];a.endWith("/")||(a+="/");c=c.replace(l[1]+p+l[3],l[1]+a+p+l[3])}return c}function E(c,a){var b=Array.isArray(a),d=b&&[]||{};b?(c=c||[],d=d.concat(c),a.forEach(function(a,b){"undefined"===typeof c[b]?d[b]=a:"object"===typeof a?d[b]=E(c[b],a):-1===c.indexOf(a)&&d.push(a)})):
(c&&"object"===typeof c&&Object.keys(c).forEach(function(a){d[a]=c[a]}),Object.keys(a).forEach(function(b){d[b]="object"!==typeof a[b]||!a[b]?a[b]:c[b]?E(c[b],a[b]):a[b]}));return d}function A(c){var a,b={};a=c.indexOf("/");c.substring(0,a);c=c.substring(0,c.lastIndexOf("/")+1);b.folderUrl=require(C.getRequireConfig()).toUrl(c);b.amdFolder=c;return b}function G(c){c.panels.forEach(function(c){c.uri="panels/"+c.name+"/Panel.js"});c.styles.forEach(function(c){c.uri="styles/"+c.name+"/style.css"});c.layouts.forEach(function(c){c.uri=
"layouts/"+c.name+"/config.json";c.icon="layouts/"+c.name+"/icon.png";c.RTLIcon="layouts/"+c.name+"/icon_rtl.png"})}var C={},H={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};q.mixin(C,z);var I=[];require.on("error",function(c){e.forEach(I,function(a){c.info[0]&&-1<c.info[0].indexOf(a.resKey)&&a.def.reject(c);for(var b in c.info)-1<b.indexOf(a.resKey)&&a.def.reject(c)})});C.checkError=function(c,a){I.push({resKey:c,def:a})};C.replacePlaceHolder=function(c,
a){var b=JSON.stringify(c),d=b.match(/\$\{(\w)+\}/g),l;if(null===d)return c;for(l=0;l<d.length;l++){var p=d[l].match(/(\w)+/g)[0];a[p]&&(b=b.replace(d[l],a[p]))}return JSON.parse(b)};C.changeUnit=function(c){var a=Math.abs(c),b;c=Math.floor(a);b=Math.floor(60*(a-c));a=(60*(60*(a-c)-b)).toFixed(2);return c+"\u00b0"+(10>b?"0"+b:b)+"'"+(10>a?"0"+a:a)+'"'};C.formatTime=function(c){var a=c/1E3;c=Math.floor(a/60);a=Number(a-60*c).toFixed(1);return(10>c?"0"+c:c)+":"+(10>a?"0"+a:a)};C.parseTime=function(c){var a=
/(\d{2,})\:(\d{2})\.(\d{1})/;if(!a.test(c))return console.log("wrong time format."),-1;c=c.match(a);return 1E3*(60*parseInt(c[1],10)+parseInt(c[2],10)+parseInt(c[3],10)/10)};C.preloadImg=function(c,a){var b=[],b="string"===typeof c?[c]:c;e.forEach(b,function(c){(new Image).src=a?a+c:c})};C.getPositionStyle=function(c){var a={};if(!c)return a;c=q.clone(c);if(window.isRTL)if("undefined"!==typeof c.left&&"undefined"!==typeof c.right){var b=c.left;c.left=c.right;c.right=b}else"undefined"!==typeof c.left?
(c.right=c.left,delete c.left):"undefined"!==typeof c.right&&(c.left=c.right,delete c.right);for(var b="left top right bottom width height".split(" "),d=0;d<b.length;d++){var l=b[d];a[l]="number"===typeof c[l]?c[l]+"px":"undefined"!==typeof c[l]?c[l]:"auto"}return a};C.isEqual=function(c,a){function b(c,a){var p;if(isNaN(c)&&isNaN(a)&&"number"===typeof c&&"number"===typeof a||c===a)return!0;if("function"===typeof c&&"function"===typeof a||c instanceof Date&&a instanceof Date||c instanceof RegExp&&
a instanceof RegExp||c instanceof String&&a instanceof String||c instanceof Number&&a instanceof Number)return c.toString()===a.toString();if(-1<d.indexOf(c)||-1<l.indexOf(a))return!1;if(null!==a){for(p in a)if(a.hasOwnProperty(p)!==c.hasOwnProperty(p)||typeof a[p]!==typeof c[p])return!1;for(p in c){if(a.hasOwnProperty(p)!==c.hasOwnProperty(p)||typeof a[p]!==typeof c[p])return!1;switch(typeof c[p]){case "object":case "function":d.push(c);l.push(a);if(!b(c[p],a[p]))return!1;d.pop();l.pop();break;default:if(c[p]!==
a[p])return!1}}}return!0}var d,l;d=[];l=[];return!b(c,a)?!1:!0};C.file={supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return f("safari")&&6>f("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var c=null;if(document.all)try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(a){c=null}else navigator.plugins&&0<navigator.plugins.length&&(c=navigator.plugins["Shockwave Flash"]);
return!!c},containSeparator:function(c){return 0<=c.indexOf("/")?!0:0<=c.indexOf("\\")?!0:!1},getNameFromPath:function(c){var a="",a=0<=c.indexOf("/")?"/":"\\";c=c.split(a);return 0<c.length?c[c.length-1]:null},getFolderFromPath:function(c){return c.substr(0,c.length-C.file.getNameFromPath(c).length)},readFile:function(c,a,b,d){if(this.supportHTML5()){var l=c.target.files[0];l&&(l.type.match(a)?l.size>=b?d({errCode:"exceed"}):(c=new FileReader,c.onload=function(c){d(null,l.name,c.target.result)},
c.readAsDataURL(l)):d({errCode:"invalidType"}))}else if(this.supportFileAPI()){var p=window.FileAPI.getFiles(c);p[0].type.match(a)?p[0].size>=b?d({errCode:"exceed"}):window.FileAPI.readAsDataURL(p[0],function(c){c&&c.result?d(null,p[0].name,c.result):d({errCode:"readError"})}):d({errCode:"invalidType"})}}};C.processWidgetSetting=function(c){if(!c.uri)return c;q.mixin(c,A(c.uri));c.icon||(c.icon=c.amdFolder+"images/icon.png");c.thumbnail||(c.thumbnail=c.amdFolder+"images/thumbnail.png");return c};
C.getRequireConfig=function(){if(jimuConfig){var c=[];jimuConfig.widgetsPackage&&(c=c.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(c=c.concat(jimuConfig.themesPackage));jimuConfig.configsPackage&&(c=c.concat(jimuConfig.configsPackage));return{packages:c}}return{}};C.getTypeByGeometryType=function(c){var a=null,b="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),d=["esriGeometryRing","esriGeometryPolygon",
"esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(c)?a="point":0<=b.indexOf(c)?a="polyline":0<=d.indexOf(c)&&(a="polygon");return a};C.getSymbolTypeByGeometryType=function(c){var a=null;c=C.getTypeByGeometryType(c);"point"===c?a="marker":"polyline"===c?a="line":"polygon"===c&&(a="fill");return a};C.getServices=function(){return H};C.getArcGISDefaultGeometryService=function(){return new w(H.geometryService)};C.restoreToDefaultWebMapExtent=function(a,d,g){var h=new b;
if(!(a&&"esri.Map"===a.declaredClass))return setTimeout(function(){h.reject("Invalid map.")},0),h;d=d&&d.itemInfo;if(!d)return setTimeout(function(){h.reject("Invalid itemInfo")},0),h;d=d.item&&d.item.extent;if(!d)return setTimeout(function(){h.reject("Invalid itemInfo.item.extent")}),h;var s=new p({wkid:4326}),s=new c(d[0][0],d[0][1],d[1][0],d[1][1],s);if(4326===parseInt(a.spatialReference.wkid,10))return a.setExtent(s);if(a.spatialReference.isWebMercator())return s=l.geographicToWebMercator(s),
a.setExtent(s);d=new v;d.geometries=[s];d.outSR=a.spatialReference;s=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;s&&"esri.tasks.GeometryService"===s.declaredClass||(g&&"string"===typeof g&&q.trim(g)?(g=q.trim(g),s=new w(g)):s=C.getArcGISDefaultGeometryService());s.project(d).then(function(c){if(c=c&&c[0])return a.setExtent(c);h.reject("Invalid projected geometry.");return h},function(c){console.error(c);h.reject(c);return h});return h};C.getAncestorWindow=function(){for(var c=
window;c&&c.parent&&c!==c.parent;)c=c.parent;return c};C.getAncestorDom=function(c,b,d){if(c&&1===c.nodeType&&b&&"function"===typeof b){var l=100,p=document.body;d&&("number"===typeof d?(d=parseInt(d,10),0<d&&(l=d)):1===d.nodeType&&(p=d));for(d=0;c.parentNode&&d<l&&a.isDescendant(c.parentNode,p);){if(b(c.parentNode))return c.parentNode;c=c.parentNode;d++}}return null};C.bindClickAndDblclickEvents=function(c,a,b,d){var l=null;if(c&&1===c.nodeType&&a&&"function"===typeof a&&b&&"function"===typeof b){var p=
200;d&&"number"===typeof d&&(d=parseInt(d,10),0<d&&(p=d));var h=0,l=g(c,"click",function(c){h++;1===h?setTimeout(function(){1===h&&(h=0,a(c))},p):2===h&&(h=0,b(c))})}return l};C.isScrollToBottom=function(c){var b=a.getContentBox(c);return 0===c.scrollHeight-(c.scrollTop+b.h)};C.getAllItemTypes=function(){var c=[],c=c.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service",
"Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In","Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return c=c.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer",
"Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};C.getItemQueryStringByTypes=function(c){var a="",b=C.getAllItemTypes();if(c&&0<c.length&&0<c.length){var d="";e.forEach(c,function(a,b){d+=' type:"'+a+'" ';b!==c.length-1&&(d+=" OR ")});a=" ( "+d+" ) ";b=c.concat(b);b=e.filter(b,function(a){return e.every(c,
function(c){return 0>c.toLowerCase().indexOf(a.toLowerCase())})});e.forEach(b,function(c){a+=' -type:"'+c+'" '})}return a};C.getItemQueryStringByTypeKeywords=function(c){var a="";c&&0<c.length&&(a=' typekeywords:"'+c.join(",")+'" ');return a};C.isNotEmptyString=function(c,a){var b=c&&"string"===typeof c;return b?a?b&&q.trim(c):!0:!1};C.isObject=function(c){return c&&"object"===typeof c};C.createWebMap=function(c,a,b,d){c=x.getStandardPortalUrl(c);c=x.getBaseItemUrl(c);s.arcgisUrl=c;return s.createMap(a,
b,d)};C.getRandomString=function(){var c=Math.random().toString();return c=c.slice(2,c.length)};C._getDomainsByServerName=function(c){var a=c.split("."),b=a.length;return e.map(a,q.hitch(this,function(c,d){var l=a.slice(d,b),p="",h=l.length-1;e.forEach(l,q.hitch(this,function(c,a){p+=c;a!==h&&(p+=".")}));return p}))};C.removeCookie=function(c,a){var b=this._getDomainsByServerName(window.location.hostname);e.forEach(b,q.hitch(this,function(b){h(c,null,{expires:-1,path:a});h(c,null,{expires:-1,path:a,
domain:b});h(c,null,{expires:-1,path:a,domain:"."+b})}))};C.isLocaleChanged=function(c,a){return!c.startWith(a)};C.hashToObject=function(c){c=c.replace("#","");c=n.queryToObject(c);for(var a in c)if(c.hasOwnProperty(a))try{c[a]=d.parse(c[a])}catch(b){}return c};C.reCreateObject=function(c){function a(c){var d=[];c.forEach(function(c){Array.isArray(c)?d.push(a(c)):"object"===typeof c?d.push(b(c)):d.push(c)});return d}function b(c){var d={},l;for(l in c)c.hasOwnProperty(l)&&(null===c[l]?d[l]=null:Array.isArray(c[l])?
d[l]=a(c[l]):d[l]="object"===typeof c[l]?b(c[l]):c[l]);return d}return Array.isArray(c)?a(c):b(c)};C.setVerticalCenter=function(c){setTimeout(function(){var b=r(".jimu-vcenter-text",c),d,l;e.forEach(b,function(c){d=a.getContentBox(c).h;a.setStyle(c,{lineHeight:d+"px"})},this);b=r(".jimu-vcenter",c);e.forEach(b,function(c){d=a.getContentBox(c).h;l=a.getContentBox(r(c).parent()[0]).h;a.setStyle(c,{marginTop:(l-d)/2+"px"})},this)},10)};C.merge=E;C.loadStyleLink=function(c,d,l){var p=new b,h,s=require(C.getRequireConfig()).toUrl(d);
if(require.cache["url:"+s]){h=require.cache["url:"+s];var m=s.split("/").pop(),s=s.substr(0,s.length-m.length);h=D(h,s);c=l?a.create("style",{id:c,type:"text/css"},a.byId(l),"before"):a.create("style",{id:c,type:"text/css"},document.getElementsByTagName("head")[0]);c.styleSheet&&!c.sheet?c.styleSheet.cssText=h:c.appendChild(a.toDom(h));p.resolve("load");return p}h=l?a.create("link",{id:c,rel:"stylesheet",type:"text/css",href:s},a.byId(l),"before"):a.create("link",{id:c,rel:"stylesheet",type:"text/css",
href:s},document.getElementsByTagName("head")[0]);g(h,"load",function(){p.resolve("load")});var u=setInterval(function(){var c;if(e.some(document.styleSheets,function(a){if(a.href&&a.href.substr(a.href.indexOf(d),a.href.length)===d)return c=a,!0}))try{!p.isFulfilled()&&(c.cssRules&&c.cssRules.length||c.rules&&c.rules.length)&&p.resolve("load"),clearInterval(u)}catch(a){}},50);return p};C.changeLocation=function(c){window.history.pushState&&window.history.pushState({path:c},"",c)};C.urlToObject=function(c){var a=
null;-1===c.indexOf("#")?(a=y.urlToObject(c),a.hash=null):(c=c.split("#"),a=y.urlToObject(c[0]),a.hash=c[1]?-1<c[1].indexOf("\x3d")?n.queryToObject(c[1]):c[1]:null);return a};C.setConfigByTemplate=function(c,a,b){a=function(c){var a=[];c.split("_").forEach(function(c){var b=!1,d;"--"===c.slice(c.length-2)&&(b=!0,c=c.slice(0,c.length-2));d=c.search(/\[[0-9]+\]/);-1===d&&(d=c.length);a.push({key:c.slice(0,d),index:Number(c.slice(d+1,-1)),deleteFlag:b})});return a}(a);for(var d=1;d<a.length-1;d++)if(c=
q.isArray(c[a[d].key])?c[a[d].key][a[d].index]:c[a[d].key],!c)return;a[a.length-1].deleteFlag?!0===b&&(q.isArray(c[a[a.length-1].key])?delete c[a[a.length-1].key][a[a.length-1].index]:delete c[a[a.length-1].key]):q.isArray(c[a[a.length-1].key])?c[a[a.length-1].key][a[a.length-1].index]=b:c[a[a.length-1].key]=b};C.setConfigByTemplateWithId=function(c,a,b){function d(b){var l;l=a;var p=-1;b=l.search(RegExp(b));0<=b&&(l=l.slice(b,l.length),l=l.indexOf("]"),p=b+l+1);l=p;p=a.slice(b,l);return-1!==b?(b=
a.slice(b+p.indexOf("[")+1,l-1),l=a.slice(l+1),(b=c.getConfigElementById(b))?{object:b,key:"section_"+l,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var l=c,p=a;if(!(0<=a.search("widgets\\[.+\\]_config"))){var h=d("groups\\[.+\\]");"deleted"!==h.state&&("isSection"===h.state&&(l=h.object,p=h.key),h=d("widgets\\[.+\\]"),"delete"!==h.state&&("isSection"===h.state&&(l=h.object,p=h.key),C.setConfigByTemplate(l,p,b)))}};C.addManifestProperies=function(c){c.icon=c.url+"images/icon.png";
"theme"===c.category?G(c):("undefined"!==typeof c["2D"]&&(c.support2D=c["2D"]),"undefined"!==typeof c["3D"]&&(c.support3D=c["3D"]),"undefined"===typeof c["2D"]&&"undefined"===typeof c["3D"]&&(c.support2D=!0),delete c["2D"],delete c["3D"],"undefined"===typeof c.properties&&(c.properties={}),z.processWidgetProperties(c))};C.getUniqueValues=function(c,a){var l=new b,p=c.replace(/\/*$/g,"")+"/generateRenderer",h=d.stringify({type:"uniqueValueDef",uniqueValueFields:[a]});B({url:p,content:{classificationDef:h,
f:"json"},handleAs:"json",callbackParamName:"callback"}).then(q.hitch(this,function(c){var a=[];(c=c&&c.uniqueValueInfos)&&0<c.length&&(a=e.map(c,q.hitch(this,function(c){return c.value})));l.resolve(a)}),q.hitch(this,function(c){l.reject(c)}));return l};C.combineRadioCheckBoxWithLabel=function(c,b){var d=!1;if(c&&1===c.nodeType&&"input"===c.tagName.toLowerCase()){var l=c.getAttribute("type")||"",l=l.toLowerCase();if("radio"===l||"checkbox"===l)d=!0}l=!1;b&&(1===b.nodeType&&"label"===b.tagName.toLowerCase())&&
(l=!0);d&&l&&(d=c.getAttribute("id"),d||(d="input_"+C.getRandomString(),c.setAttribute("id",d)),b.setAttribute("for",d),a.setStyle(b,"cursor","pointer"))};C.processManifestLabel=function(c,a){c.label=c.i18nLabels&&(c.i18nLabels[a]||c.i18nLabels.defaultLabel)||c.label||c.name;c.layouts&&e.forEach(c.layouts,function(b){var d="i18nLabels_layout_"+b.name;b.label=c[d]&&(c[d][a]||c[d].defaultLabel)||b.label||b.name});c.styles&&e.forEach(c.styles,function(b){var d="i18nLabels_style_"+b.name;b.label=c[d]&&
(c[d][a]||c[d].defaultLabel)||b.label||b.name})};C.addManifest2WidgetJson=function(c,a){q.mixin(c,a.properties);c.name=a.name;c.label||(c.label=a.label);c.manifest=a};C.addI18NLabel=function(c){var a=new b;if(c.i18nLabels)return a.resolve(c),a;c.i18nLabels={};if(c.properties&&!1===c.properties.hasLocale)return a.resolve(c),a;var d="widget"===c.category?"_widgetLabel":"_themeLabel";require(C.getRequireConfig(),["dojo/i18n!"+c.amdFolder+"/nls/strings"],function(b){c.i18nLabels[dojoConfig.locale]=b[d];
"theme"===c.category&&(c.layouts&&c.layouts.forEach(function(a){c["i18nLabels_layout_"+a.name]={};c["i18nLabels_layout_"+a.name][dojoConfig.locale]=b["_layout_"+a.name]}),c.styles&&c.styles.forEach(function(a){c["i18nLabels_style_"+a.name]={};c["i18nLabels_style_"+a.name][dojoConfig.locale]=b["_style_"+a.name]}));a.resolve(c)});return a};C.localizeNumber=function(c,a){var b=(c.toString().split(".")[1]||"").length,d="",d=0<b?"#,###,###,##0.0"+Array.prototype.join.call({length:b},"0"):"#,###,###,##0",
b={locale:k.locale,pattern:d};q.mixin(b,a||{});try{return u.format(c,b)}catch(l){return console.error(l),c.toLocaleString()}};C.parseNumber=function(c,a){var b={locale:k.locale};q.mixin(b,a||{});try{return u.parse(c,b)}catch(d){return console.error(d),c}};C.localizeDate=function(c,a){var b={locale:k.locale,fullYear:!0};q.mixin(b,a||{});try{return m.format(c,b)}catch(d){return console.error(d),"date"===b.selector?c.toLocaleDateString():"time"===b.selector?c.toLocaleTimeString():c.toLocaleString()}};
C.addRelativePathInCss=D;C.url={isAbsolute:function(c){return!c?!1:c.startWith("http")||c.startWith("/")},removeQueryParamFromUrl:function(c,a){var b=y.urlToObject(c);b.query&&delete b.query[a];var d=b.path,l;for(l in b.query)d=d===b.path?d+"?"+l+"\x3d"+b.query[l]:d+"\x26"+l+"\x3d"+b.query[l];return d},addQueryParamToUrl:function(c,a,b){c=y.urlToObject(c);c.query||(c.query={});c.query[a]=b;a=c.path;for(var d in c.query)a=a===c.path?a+"?"+d+"\x3d"+c.query[d]:a+"\x26"+d+"\x3d"+c.query[d];return a}};
C.processUrlInWidgetConfig=function(c,a){if(c)return c.startWith("data:")||c.startWith("http")||c.startWith("/")?c:c.startWith("${appPath}")?c.replace("${appPath}",window.appInfo.appPath):a+c};C.processUrlInAppConfig=function(c){if(c)return c.startWith("data:")||c.startWith("http")||c.startWith("/")?c:window.appInfo.appPath+c};C.getLocationUrlWithoutHashAndQueryParams=function(){var c=window.location,a=c.protocol+"//"+c.host+c.pathname,c=y.urlToObject(c.href);c.query&&c.query.apiurl&&(a=C.url.addQueryParamToUrl(a,
"apiurl",c.query.apiurl));return a};C.getDefaultWebMapThumbnail=function(){return require.toUrl("jimu/images/webmap.png")};return C})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(q,e,a){var f=q.NodeList;e.extend(f,{_buildArrayFromCallback:function(a){for(var e=[],f=0;f<this.length;f++){var t=a.call(this[f],this[f],e);t&&(e=e.concat(t))}return e},_getUniqueAsNodeList:function(e){for(var f=[],r=0,t;t=e[r];r++)1==t.nodeType&&-1==a.indexOf(f,t)&&f.push(t);
return this._wrap(f,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(a,e){var f=this._getUniqueAsNodeList(a),f=e?q._filterResult(f,e):f;return f._stash(this)},_getRelatedUniqueNodes:function(a,e){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(e),a)},children:function(a){return this._getRelatedUniqueNodes(a,function(a,f){return e._toArray(a.childNodes)})},closest:function(a,e){return this._getRelatedUniqueNodes(null,function(f,t){do if(q._filterResult([f],a,e).length)return f;
while(f!=e&&(f=f.parentNode)&&1==f.nodeType);return null})},parent:function(a){return this._getRelatedUniqueNodes(a,function(a,e){return a.parentNode})},parents:function(a){return this._getRelatedUniqueNodes(a,function(a,e){for(var f=[];a.parentNode;)a=a.parentNode,f.push(a);return f})},siblings:function(a){return this._getRelatedUniqueNodes(a,function(a,e){for(var f=[],b=a.parentNode&&a.parentNode.childNodes,g=0;g<b.length;g++)b[g]!=a&&f.push(b[g]);return f})},next:function(a){return this._getRelatedUniqueNodes(a,
function(a,e){for(var f=a.nextSibling;f&&1!=f.nodeType;)f=f.nextSibling;return f})},nextAll:function(a){return this._getRelatedUniqueNodes(a,function(a,e){for(var f=[],b=a;b=b.nextSibling;)1==b.nodeType&&f.push(b);return f})},prev:function(a){return this._getRelatedUniqueNodes(a,function(a,e){for(var f=a.previousSibling;f&&1!=f.nodeType;)f=f.previousSibling;return f})},prevAll:function(a){return this._getRelatedUniqueNodes(a,function(a,e){for(var f=[],b=a;b=b.previousSibling;)1==b.nodeType&&f.push(b);
return f})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(a,e){return 0!=e%2})},odd:function(){return this.filter(function(a,e){return 0==e%2})}});return f})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(q,e,a,f,k){var n={};q.setObject("dojo.number",
n);n.format=function(a,b){b=q.mixin({},b||{});var g=e.normalizeLocale(b.locale),g=e.getLocalization("dojo.cldr","number",g);b.customs=g;g=b.pattern||g[(b.type||"decimal")+"Format"];return isNaN(a)||Infinity==Math.abs(a)?null:n._applyPattern(a,g,b)};n._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;n._applyPattern=function(a,b,g){g=g||{};var d=g.customs.group,h=g.customs.decimal;b=b.split(";");var u=b[0];b=b[0>a?1:0]||"-"+u;if(-1!=b.indexOf("%"))a*=100;else if(-1!=b.indexOf("\u2030"))a*=1E3;else if(-1!=b.indexOf("\u00a4"))d=
g.customs.currencyGroup||d,h=g.customs.currencyDecimal||h,b=b.replace(/\u00a4{1,3}/,function(a){return g[["symbol","currency","displayName"][a.length-1]]||g.currency||""});else if(-1!=b.indexOf("E"))throw Error("exponential notation not supported");var m=n._numberPatternRE,u=u.match(m);if(!u)throw Error("unable to find a number expression in pattern: "+b);!1===g.fractional&&(g.places=0);return b.replace(m,n._formatAbsolute(a,u[0],{decimal:h,group:d,places:g.places,round:g.round}))};n.round=function(a,
b,g){g=10/(g||10);return(g*+a).toFixed(b)/g};if(0==(0.9).toFixed()){var r=n.round;n.round=function(a,b,g){var d=Math.pow(10,-b||0),h=Math.abs(a);if(!a||h>=d)d=0;else if(h/=d,0.5>h||0.95<=h)d=0;return r(a,b,g)+(0<a?d:-d)}}n._formatAbsolute=function(a,b,g){g=g||{};!0===g.places&&(g.places=0);Infinity===g.places&&(g.places=6);b=b.split(".");var d="string"==typeof g.places&&g.places.indexOf(","),h=g.places;d?h=g.places.substring(d+1):0<=h||(h=(b[1]||[]).length);0>g.round||(a=n.round(a,h,g.round));a=String(Math.abs(a)).split(".");
var u=a[1]||"";b[1]||g.places?(d&&(g.places=g.places.substring(0,d)),d=void 0!==g.places?g.places:b[1]&&b[1].lastIndexOf("0")+1,d>u.length&&(a[1]=f.pad(u,d,"0",!0)),h<u.length&&(a[1]=u.substr(0,h))):a[1]&&a.pop();h=b[0].replace(",","");d=h.indexOf("0");-1!=d&&(d=h.length-d,d>a[0].length&&(a[0]=f.pad(a[0],d)),-1==h.indexOf("#")&&(a[0]=a[0].substr(a[0].length-d)));var h=b[0].lastIndexOf(","),m,s;-1!=h&&(m=b[0].length-h-1,b=b[0].substr(0,h),h=b.lastIndexOf(","),-1!=h&&(s=b.length-h-1));b=[];for(h=a[0];h;)d=
h.length-m,b.push(0<d?h.substr(d):h),h=0<d?h.slice(0,d):"",s&&(m=s,delete s);a[0]=b.reverse().join(g.group||",");return a.join(g.decimal||".")};n.regexp=function(a){return n._parseInfo(a).regexp};n._parseInfo=function(a){a=a||{};var b=e.normalizeLocale(a.locale),b=e.getLocalization("dojo.cldr","number",b),g=a.pattern||b[(a.type||"decimal")+"Format"],d=b.group,h=b.decimal,u=1;if(-1!=g.indexOf("%"))u/=100;else if(-1!=g.indexOf("\u2030"))u/=1E3;else{var m=-1!=g.indexOf("\u00a4");m&&(d=b.currencyGroup||
d,h=b.currencyDecimal||h)}b=g.split(";");1==b.length&&b.push("-"+b[0]);b=k.buildGroupRE(b,function(b){b="(?:"+k.escapeString(b,".")+")";return b.replace(n._numberPatternRE,function(b){var c={signed:!1,separator:a.strict?d:[d,""],fractional:a.fractional,decimal:h,exponent:!1};b=b.split(".");var l=a.places;1==b.length&&1!=u&&(b[1]="###");1==b.length||0===l?c.fractional=!1:(void 0===l&&(l=a.pattern?b[1].lastIndexOf("0")+1:Infinity),l&&void 0==a.fractional&&(c.fractional=!0),!a.places&&l<b[1].length&&
(l+=","+b[1].length),c.places=l);b=b[0].split(",");1<b.length&&(c.groupSize=b.pop().length,1<b.length&&(c.groupSize2=b.pop().length));return"("+n._realNumberRegexp(c)+")"})},!0);m&&(b=b.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(b,d,c,l){b=k.escapeString(a[["symbol","currency","displayName"][c.length-1]]||a.currency||"");d=d?"[\\s\\xa0]":"";l=l?"[\\s\\xa0]":"";return!a.strict?(d&&(d+="*"),l&&(l+="*"),"(?:"+d+b+l+")?"):d+b+l}));return{regexp:b.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:d,
decimal:h,factor:u}};n.parse=function(a,b){var g=n._parseInfo(b),d=RegExp("^"+g.regexp+"$").exec(a);if(!d)return NaN;var h=d[1];if(!d[1]){if(!d[2])return NaN;h=d[2];g.factor*=-1}h=h.replace(RegExp("["+g.group+"\\s\\xa0]","g"),"").replace(g.decimal,".");return h*g.factor};n._realNumberRegexp=function(a){a=a||{};"places"in a||(a.places=Infinity);"string"!=typeof a.decimal&&(a.decimal=".");if(!("fractional"in a)||/^0/.test(a.places))a.fractional=[!0,!1];"exponent"in a||(a.exponent=[!0,!1]);"eSigned"in
a||(a.eSigned=[!0,!1]);var b=n._integerRegexp(a),g=k.buildGroupRE(a.fractional,function(b){var d="";b&&0!==a.places&&(d="\\"+a.decimal,d=Infinity==a.places?"(?:"+d+"\\d+)?":d+("\\d{"+a.places+"}"));return d},!0),d=k.buildGroupRE(a.exponent,function(b){return b?"([eE]"+n._integerRegexp({signed:a.eSigned})+")":""}),b=b+g;g&&(b="(?:(?:"+b+")|(?:"+g+"))");return b+d};n._integerRegexp=function(a){a=a||{};"signed"in a||(a.signed=[!0,!1]);"separator"in a?"groupSize"in a||(a.groupSize=3):a.separator="";var b=
k.buildGroupRE(a.signed,function(a){return a?"[-+]":""},!0),g=k.buildGroupRE(a.separator,function(b){if(!b)return"(?:\\d+)";b=k.escapeString(b);" "==b?b="\\s":"\u00a0"==b&&(b="\\s\\xa0");var h=a.groupSize,g=a.groupSize2;return g?(b="(?:0|[1-9]\\d{0,"+(g-1)+"}(?:["+b+"]\\d{"+g+"})*["+b+"]\\d{"+h+"})",0<h-g?"(?:"+b+"|(?:0|[1-9]\\d{0,"+(h-1)+"}))":b):"(?:0|[1-9]\\d{0,"+(h-1)+"}(?:["+b+"]\\d{"+h+"})*)"},!0);return b+g};return n})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),
function(q,e,a,f,k,n,r,t,b){a.add("dojo-preload-i18n-Api",1);r=q.i18n={};var g=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,d=function(c,a,b,d){var l=[b+d];a=a.split("-");for(var p="",h=0;h<a.length;h++)if(p+=(p?"-":"")+a[h],!c||c[p])l.push(b+p+"/"+d),l.specificity=p;return l},h={},u=function(c,a,b){b=b?b.toLowerCase():q.locale;c=c.replace(/\./g,"/");a=a.replace(/\./g,"/");return/root/i.test(b)?c+"/nls/"+a:c+"/nls/"+b+"/"+a},m=q.getL10nName=function(c,a,d){return b.id+"!"+u(c,a,d)},s=function(c,a,b,
l,p,g){c([a],function(s){var m=n.clone(s.root||s.ROOT),u=d(!s._v1x&&s,p,b,l);c(u,function(){for(var c=1;c<u.length;c++)m=n.mixin(n.clone(m),arguments[c]);h[a+"/"+p]=m;m.$locale=u.specificity;g()})})},p=function(c){var a=k.extraLocale||[],a=n.isArray(a)?a:[a];a.push(c);return a},c=function(c,b,d){if(a("dojo-preload-i18n-Api")){var l=c.split("*"),m="preload"==l[1];m&&(h[c]||(h[c]=1,y(l[2],t.parse(l[3]),1,b)),d(1));if(!(l=m))v&&x.push([c,b,d]),l=v;if(l)return}c=g.exec(c);var u=c[1]+"/",w=c[5]||c[4],
e=u+w,l=(c=c[5]&&c[4])||q.locale||"",k=e+"/"+l;c=c?[l]:p(l);var r=c.length,z=function(){--r||d(n.delegate(h[k]))};f.forEach(c,function(c){var d=e+"/"+c;a("dojo-preload-i18n-Api")&&B(d);h[d]?z():s(b,e,u,w,c,z)})};if(a("dojo-unit-tests"))var l=r.unitTests=[];a("dojo-preload-i18n-Api");var w=r.normalizeLocale=function(c){c=c?c.toLowerCase():q.locale;return"root"==c?"ROOT":c},v=0,x=[],y=r._preloadLocalizations=function(a,b,d,l){function p(c,a){l([c],a)}function g(c,a){for(var b=c.split("-");b.length;){if(a(b.join("-")))return;
b.pop()}a("ROOT")}function s(){for(--v;!v&&x.length;)c.apply(null,x.shift())}function m(c){c=w(c);g(c,function(d){if(0<=f.indexOf(b,d)){var m=a.replace(/\./g,"/")+"_"+d;v++;p(m,function(a){for(var b in a){var p=a[b],m=b.match(/(.+)\/([^\/]+)$/),u;if(m){u=m[2];m=m[1]+"/";p._localized=p._localized||{};var w;if("ROOT"===d){var y=w=p._localized;delete p._localized;y.root=p;h[e.toAbsMid(b)]=y}else w=p._localized,h[e.toAbsMid(m+u+"/"+d)]=p;d!==c&&function(a,b,d,p){var m=[],u=[];g(c,function(c){p[c]&&(m.push(e.toAbsMid(a+
c+"/"+b)),u.push(e.toAbsMid(a+b+"/"+c)))});m.length?(v++,l(m,function(){for(var l=0;l<m.length;l++)d=n.mixin(n.clone(d),arguments[l]),h[u[l]]=d;h[e.toAbsMid(a+b+"/"+c)]=n.clone(d);s()})):h[e.toAbsMid(a+b+"/"+c)]=d}(m,u,p,w)}}s()});return!0}return!1})}l=l||e;m();f.forEach(q.config.extraLocale,m)},B=function(){},z={},D=new Function("__bundle","__checkForLegacyModules","__mid","__amdValue","var define \x3d function(mid, factory){define.called \x3d 1; __amdValue.result \x3d factory || mid;},\t   require \x3d function(){define.called \x3d 1;};try{define.called \x3d 0;eval(__bundle);if(define.called\x3d\x3d1)return __amdValue;if((__checkForLegacyModules \x3d __checkForLegacyModules(__mid)))return __checkForLegacyModules;}catch(e){}try{return eval('('+__bundle+')');}catch(e){return e;}"),
B=function(c){for(var a,b=c.split("/"),d=q.global[b[0]],l=1;d&&l<b.length-1;d=d[b[l++]]);d&&((a=d[b[l]])||(a=d[b[l].replace(/-/g,"_")]),a&&(h[c]=a));return a};r.getLocalization=function(a,b,d){var l;a=u(a,b,d);c(a,e,function(c){l=c});return l};a("dojo-unit-tests")&&l.push(function(c){c.register("tests.i18n.unit",function(c){var a;a=D("{prop:1}",B,"nonsense",z);c.is({prop:1},a);c.is(void 0,a[1]);a=D("({prop:1})",B,"nonsense",z);c.is({prop:1},a);c.is(void 0,a[1]);a=D("{'prop-x':1}",B,"nonsense",z);
c.is({"prop-x":1},a);c.is(void 0,a[1]);a=D("({'prop-x':1})",B,"nonsense",z);c.is({"prop-x":1},a);c.is(void 0,a[1]);a=D("define({'prop-x':1})",B,"nonsense",z);c.is(z,a);c.is({"prop-x":1},z.result);a=D("define('some/module', {'prop-x':1})",B,"nonsense",z);c.is(z,a);c.is({"prop-x":1},z.result);a=D("this is total nonsense and should throw an error",B,"nonsense",z);c.is(a instanceof Error,!0)})});return n.mixin(r,{dynamic:!0,normalize:function(c,a){return/^\./.test(c)?a(c):c},load:c,cache:h,getL10nName:m})})},
"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(q,e){var a=/[&<>'"\/]/g,f={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},k={};e.setObject("dojo.string",k);k.escape=function(e){return!e?"":e.replace(a,function(a){return f[a]})};k.rep=function(a,e){if(0>=e||!a)return"";for(var f=[];;){e&1&&f.push(a);if(!(e>>=1))break;a+=a}return f.join("")};k.pad=function(a,e,f,b){f||(f="0");a=String(a);e=k.rep(f,Math.ceil((e-a.length)/
f.length));return b?a+e:e+a};k.substitute=function(a,f,k,b){b=b||q.global;k=k?e.hitch(b,k):function(a){return a};return a.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(a,d,h){a=e.getObject(d,!1,f);h&&(a=e.getObject(h,!1,b).call(b,a,d));return k(a,d).toString()})};k.trim=String.prototype.trim?e.trim:function(a){a=a.replace(/^\s+/,"");for(var e=a.length-1;0<=e;e--)if(/\S/.test(a.charAt(e))){a=a.substring(0,e+1);break}return a};return k})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),
function(q,e,a,f,k,n,r,t,b){function g(a,b,c,d){return d.replace(/([a-z])\1*/ig,function(h){var g,m,e=h.charAt(0);h=h.length;var k=["abbr","wide","narrow"];switch(e){case "G":g=b[4>h?"eraAbbr":"eraNames"][0>a.getFullYear()?0:1];break;case "y":g=a.getFullYear();switch(h){case 1:break;case 2:if(!c.fullYear){g=String(g);g=g.substr(g.length-2);break}default:m=!0}break;case "Q":case "q":g=Math.ceil((a.getMonth()+1)/3);m=!0;break;case "M":case "L":g=a.getMonth();3>h?(g+=1,m=!0):(e=["months","L"==e?"standAlone":
"format",k[h-3]].join("-"),g=b[e][g]);break;case "w":g=u._getWeekOfYear(a,0);m=!0;break;case "d":g=a.getDate();m=!0;break;case "D":g=u._getDayOfYear(a);m=!0;break;case "e":case "c":if(g=a.getDay(),2>h){g=(g-f.getFirstDayOfWeek(c.locale)+8)%7;break}case "E":g=a.getDay();3>h?(g+=1,m=!0):(e=["days","c"==e?"standAlone":"format",k[h-3]].join("-"),g=b[e][g]);break;case "a":e=12>a.getHours()?"am":"pm";g=c[e]||b["dayPeriods-format-wide-"+e];break;case "h":case "H":case "K":case "k":m=a.getHours();switch(e){case "h":g=
m%12||12;break;case "H":g=m;break;case "K":g=m%12;break;case "k":g=m||24}m=!0;break;case "m":g=a.getMinutes();m=!0;break;case "s":g=a.getSeconds();m=!0;break;case "S":g=Math.round(a.getMilliseconds()*Math.pow(10,h-3));m=!0;break;case "v":case "z":if(g=u._getZone(a,!0,c))break;h=4;case "Z":e=u._getZone(a,!1,c);e=[0>=e?"+":"-",r.pad(Math.floor(Math.abs(e)/60),2),r.pad(Math.abs(e)%60,2)];4==h&&(e.splice(0,0,"GMT"),e.splice(3,0,":"));g=e.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+
d);}m&&(g=r.pad(g,h));return g})}function d(a,b,c,d){var h=function(c){return c};b=b||h;c=c||h;d=d||h;var g=a.match(/(''|[^'])+/g),m="'"==a.charAt(0);e.forEach(g,function(a,d){a?(g[d]=(m?c:b)(a.replace(/''/g,"'")),m=!m):g[d]=""});return d(g.join(""))}function h(a,b,c,d){d=n.escapeString(d);c.strict||(d=d.replace(" a"," ?a"));return d.replace(/([a-z])\1*/ig,function(d){var l;l=d.charAt(0);var h=d.length,g="",m="";c.strict?(1<h&&(g="0{"+(h-1)+"}"),2<h&&(m="0{"+(h-2)+"}")):(g="0?",m="0{0,2}");switch(l){case "y":l=
"\\d{2,4}";break;case "M":case "L":l=2<h?"\\S+?":"1[0-2]|"+g+"[1-9]";break;case "D":l="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+g+"[1-9][0-9]|"+m+"[1-9]";break;case "d":l="3[01]|[12]\\d|"+g+"[1-9]";break;case "w":l="[1-4][0-9]|5[0-3]|"+g+"[1-9]";break;case "E":case "e":case "c":l=".+?";break;case "h":l="1[0-2]|"+g+"[1-9]";break;case "k":l="1[01]|"+g+"\\d";break;case "H":l="1\\d|2[0-3]|"+g+"\\d";break;case "K":l="1\\d|2[0-4]|"+g+"[1-9]";break;case "m":case "s":l="[0-5]\\d";break;case "S":l="\\d{"+h+"}";
break;case "a":h=c.am||b["dayPeriods-format-wide-am"];g=c.pm||b["dayPeriods-format-wide-pm"];l=h+"|"+g;c.strict||(h!=h.toLowerCase()&&(l+="|"+h.toLowerCase()),g!=g.toLowerCase()&&(l+="|"+g.toLowerCase()),-1!=l.indexOf(".")&&(l+="|"+l.replace(/\./g,"")));l=l.replace(/\./g,"\\.");break;default:l=".*"}a&&a.push(d);return"("+l+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var u={};q.setObject(b.id.replace(/\//g,"."),u);u._getZone=function(b,d,c){return d?a.getTimezoneName(b):b.getTimezoneOffset()};u.format=
function(a,b){b=b||{};var c=k.normalizeLocale(b.locale),l=b.formatLength||"short",c=u._getGregorianBundle(c),h=[],m=q.hitch(this,g,a,c,b);if("year"==b.selector)return d(c["dateFormatItem-yyyy"]||"yyyy",m);var e;"date"!=b.selector&&(e=b.timePattern||c["timeFormat-"+l])&&h.push(d(e,m));"time"!=b.selector&&(e=b.datePattern||c["dateFormat-"+l])&&h.push(d(e,m));return 1==h.length?h[0]:c["dateTimeFormat-"+l].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(c,a){return h[a]})};u.regexp=function(a){return u._parseInfo(a).regexp};
u._parseInfo=function(a){a=a||{};var b=k.normalizeLocale(a.locale),b=u._getGregorianBundle(b),c=a.formatLength||"short",l=a.datePattern||b["dateFormat-"+c],g=a.timePattern||b["timeFormat-"+c],c="date"==a.selector?l:"time"==a.selector?g:b["dateTimeFormat-"+c].replace(/\{(\d+)\}/g,function(c,a){return[g,l][a]}),m=[];return{regexp:d(c,q.hitch(this,h,m,b,a)),tokens:m,bundle:b}};u.parse=function(b,d){var c=/[\u200E\u200F\u202A\u202E]/g,l=u._parseInfo(d),h=l.tokens,g=l.bundle,c=RegExp("^"+l.regexp.replace(c,
"")+"$",l.strict?"":"i").exec(b&&b.replace(c,""));if(!c)return null;var m=["abbr","wide","narrow"],f=[1970,0,1,0,0,0,0],k="",c=e.every(c,function(c,a){if(!a)return!0;var b=h[a-1],l=b.length,b=b.charAt(0);switch(b){case "y":if(2!=l&&d.strict)f[0]=c;else if(100>c)c=Number(c),b=""+(new Date).getFullYear(),l=100*b.substring(0,2),b=Math.min(Number(b.substring(2,4))+20,99),f[0]=c<b?l+c:l-100+c;else{if(d.strict)return!1;f[0]=c}break;case "M":case "L":if(2<l){if(l=g["months-"+("L"==b?"standAlone":"format")+
"-"+m[l-3]].concat(),d.strict||(c=c.replace(".","").toLowerCase(),l=e.map(l,function(c){return c.replace(".","").toLowerCase()})),c=e.indexOf(l,c),-1==c)return!1}else c--;f[1]=c;break;case "E":case "e":case "c":l=g["days-"+("c"==b?"standAlone":"format")+"-"+m[l-3]].concat();d.strict||(c=c.toLowerCase(),l=e.map(l,function(c){return c.toLowerCase()}));c=e.indexOf(l,c);if(-1==c)return!1;break;case "D":f[1]=0;case "d":f[2]=c;break;case "a":l=d.am||g["dayPeriods-format-wide-am"];b=d.pm||g["dayPeriods-format-wide-pm"];
if(!d.strict){var s=/\./g;c=c.replace(s,"").toLowerCase();l=l.replace(s,"").toLowerCase();b=b.replace(s,"").toLowerCase()}if(d.strict&&c!=l&&c!=b)return!1;k=c==b?"p":c==l?"a":"";break;case "K":24==c&&(c=0);case "h":case "H":case "k":if(23<c)return!1;f[3]=c;break;case "m":f[4]=c;break;case "s":f[5]=c;break;case "S":f[6]=c}return!0}),l=+f[3];"p"===k&&12>l?f[3]=l+12:"a"===k&&12==l&&(f[3]=0);l=new Date(f[0],f[1],f[2],f[3],f[4],f[5],f[6]);d.strict&&l.setFullYear(f[0]);var n=h.join(""),r=-1!=n.indexOf("d"),
n=-1!=n.indexOf("M");if(!c||n&&l.getMonth()>f[1]||r&&l.getDate()>f[2])return null;if(n&&l.getMonth()<f[1]||r&&l.getDate()<f[2])l=a.add(l,"hour",1);return l};var m=[];u.addCustomFormats=function(a,b){m.push({pkg:a,name:b})};u._getGregorianBundle=function(a){var b={};e.forEach(m,function(c){c=k.getLocalization(c.pkg,c.name,a);b=q.mixin(b,c)},this);return b};u.addCustomFormats(b.id.replace(/\/date\/locale$/,".cldr"),"gregorian");u.getNames=function(a,b,c,d){var h;d=u._getGregorianBundle(d);a=[a,c,b];
"standAlone"==c&&(c=a.join("-"),h=d[c],1==h[0]&&(h=void 0));a[1]="format";return(h||d[a.join("-")]).concat()};u.isWeekend=function(a,b){var c=f.getWeekend(b),d=(a||new Date).getDay();c.end<c.start&&(c.end+=7,d<c.start&&(d+=7));return d>=c.start&&d<=c.end};u._getDayOfYear=function(b){return a.difference(new Date(b.getFullYear(),0,1,b.getHours()),b)+1};u._getWeekOfYear=function(a,b){1==arguments.length&&(b=0);var c=(new Date(a.getFullYear(),0,1)).getDay(),d=Math.floor((u._getDayOfYear(a)+(c-b+7)%7-
1)/7);c==b&&d++;return d};return u})},"dojo/date":function(){define(["./has","./_base/lang"],function(q,e){var a={getDaysInMonth:function(e){var k=e.getMonth();return 1==k&&a.isLeapYear(e)?29:[31,28,31,30,31,30,31,31,30,31,30,31][k]},isLeapYear:function(a){a=a.getFullYear();return!(a%400)||!(a%4)&&!!(a%100)},getTimezoneName:function(a){var e=a.toString(),n="",r=e.indexOf("(");if(-1<r)n=e.substring(++r,e.indexOf(")"));else if(r=/([A-Z\/]+) \d{4}$/,e=e.match(r))n=e[1];else if(e=a.toLocaleString(),r=
/ ([A-Z\/]+)$/,e=e.match(r))n=e[1];return"AM"==n||"PM"==n?"":n},compare:function(a,e,n){a=new Date(+a);e=new Date(+(e||new Date));"date"==n?(a.setHours(0,0,0,0),e.setHours(0,0,0,0)):"time"==n&&(a.setFullYear(0,0,0),e.setFullYear(0,0,0));return a>e?1:a<e?-1:0},add:function(a,e,n){var r=new Date(+a),t=!1,b="Date";switch(e){case "day":break;case "weekday":var g;(e=n%5)?g=parseInt(n/5):(e=0<n?5:-5,g=0<n?(n-5)/5:(n+5)/5);var d=a.getDay(),h=0;6==d&&0<n?h=1:0==d&&0>n&&(h=-1);d+=e;if(0==d||6==d)h=0<n?2:-2;
n=7*g+e+h;break;case "year":b="FullYear";t=!0;break;case "week":n*=7;break;case "quarter":n*=3;case "month":t=!0;b="Month";break;default:b="UTC"+e.charAt(0).toUpperCase()+e.substring(1)+"s"}if(b)r["set"+b](r["get"+b]()+n);t&&r.getDate()<a.getDate()&&r.setDate(0);return r},difference:function(e,k,n){k=k||new Date;n=n||"day";var r=k.getFullYear()-e.getFullYear(),t=1;switch(n){case "quarter":e=e.getMonth();k=k.getMonth();e=Math.floor(e/3)+1;k=Math.floor(k/3)+1;t=k+4*r-e;break;case "weekday":r=Math.round(a.difference(e,
k,"day"));n=parseInt(a.difference(e,k,"week"));t=r%7;if(0==t)r=5*n;else{var b=0,g=e.getDay();k=k.getDay();n=parseInt(r/7);t=r%7;e=new Date(e);e.setDate(e.getDate()+7*n);e=e.getDay();if(0<r)switch(!0){case 6==g:b=-1;break;case 0==g:b=0;break;case 6==k:b=-1;break;case 0==k:b=-2;break;case 5<e+t:b=-2}else if(0>r)switch(!0){case 6==g:b=0;break;case 0==g:b=1;break;case 6==k:b=2;break;case 0==k:b=1;break;case 0>e+t:b=2}r=r+b-2*n}t=r;break;case "year":t=r;break;case "month":t=k.getMonth()-e.getMonth()+12*
r;break;case "week":t=parseInt(a.difference(e,k,"day")/7);break;case "day":t/=24;case "hour":t/=60;case "minute":t/=60;case "second":t/=1E3;case "millisecond":t*=k.getTime()-e.getTime()}return Math.round(t)}};e.mixin(e.getObject("dojo.date",!0),a);return a})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(q,e){var a={};q.setObject("dojo.cldr.supplemental",a);a.getFirstDayOfWeek=function(e){e={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,
qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[a._region(e)];return void 0===e?1:e};a._region=function(a){a=e.normalizeLocale(a);a=a.split("-");var k=a[1];k?4==k.length&&(k=a[2]):k={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",
as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",
ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",
sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",
bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",
guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",
luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",
sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",
yav:"cm",zza:"tr"}[a[0]];return k};a.getWeekend=function(e){var k=a._region(e);e={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[k];k={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[k];void 0===e&&(e=6);void 0===k&&(k=0);return{start:e,end:k}};return a})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct ../kernel ../config ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z,D,E,A,G,C){function H(c){return m({url:ca.arcgisUrl+"/"+c.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function I(c,a){var b={f:"json"};a&&(b.token=a);return m({url:c,content:b,callbackParamName:"callback"},{disableIdentityLookup:!0})}function L(c){c.itemProperties.layerDefinition&&(c.layerDefinition?(c.layerDefinition.drawingInfo||(c.layerDefinition.drawingInfo=c.itemProperties.layerDefinition.drawingInfo),
u.isDefined(c.layerDefinition.definitionExpression)||(c.layerDefinition.definitionExpression=c.itemProperties.layerDefinition.definitionExpression),u.isDefined(c.layerDefinition.minScale)||(c.layerDefinition.minScale=c.itemProperties.layerDefinition.minScale),u.isDefined(c.layerDefinition.maxScale)||(c.layerDefinition.maxScale=c.itemProperties.layerDefinition.maxScale)):c.layerDefinition=c.itemProperties.layerDefinition);c.itemProperties.popupInfo&&(!c.popupInfo&&!c.disablePopup)&&(c.popupInfo=c.itemProperties.popupInfo);
u.isDefined(c.itemProperties.showLabels)&&!u.isDefined(c.showLabels)&&(c.showLabels=c.itemProperties.showLabels);u.isDefined(c.itemProperties.showLegend)&&!u.isDefined(c.showLegend)&&(c.showLegend=c.itemProperties.showLegend);u.isDefined(c.itemProperties.refreshInterval)&&!u.isDefined(c.refreshInterval)&&(c.refreshInterval=c.itemProperties.refreshInterval)}function J(c){L(c);c.itemProperties.layerDefinition&&c.layerDefinition&&(!u.isDefined(c.layerDefinition.maximumTrackPoints)&&u.isDefined(c.itemProperties.layerDefinition.maximumTrackPoints)&&
(c.layerDefinition.maximumTrackPoints=c.itemProperties.layerDefinition.maximumTrackPoints),!c.layerDefinition.definitionGeometry&&c.itemProperties.layerDefinition.definitionGeometry&&(c.layerDefinition.definitionGeometry=c.itemProperties.layerDefinition.definitionGeometry));c.itemProperties.purgeOptions&&!c.purgeOptions&&(c.purgeOptions=c.itemProperties.purgeOptions)}function F(c,d){var l=new k,h=c.itemData,g=[],p=[];a.forEach(h.operationalLayers,function(c){if(c.itemId&&!c.type){var a=c.url.toLowerCase();
-1<a.indexOf("/featureserver")||-1<a.indexOf("/mapserver/")?(p.push(c),g.push(H(c))):-1<a.indexOf("/mapserver")&&-1===a.indexOf("/mapserver/")&&(!c.layers||!u.isDefined(c.minScale)&&!u.isDefined(c.maxScale))?(p.push(c),g.push(H(c))):-1<a.indexOf("/imageserver")&&!u.isDefined(c.minScale)&&!u.isDefined(c.maxScale)?(p.push(c),g.push(H(c))):-1<a.indexOf("/streamserver")&&(p.push(c),g.push(H(c)))}});h.baseMap&&h.baseMap.baseMapLayers&&a.forEach(h.baseMap.baseMapLayers,function(c){c.itemId&&(p.push(c),
g.push(H(c)))});if(0<g.length){var m={};(new b(g)).addCallback(function(b){a.forEach(p,function(c,d){var l=b[d][1];if(l&&!(l instanceof Error)&&(m[c.itemId]=l,!c.type)){var h=c.url.toLowerCase();if((-1<h.indexOf("/featureserver")||-1<h.indexOf("/mapserver/"))&&l.layers)a.forEach(l.layers,function(a){if(h.match("/featureserver/"+a.id+"$")=="/featureserver/"+a.id||h.match("/mapserver/"+a.id+"$")=="/mapserver/"+a.id)c.itemProperties=a,L(c)});else if(-1<h.indexOf("/streamserver"))c.itemProperties=l,J(c);
else if(-1<h.indexOf("/mapserver"))l.layers&&!c.layers&&(c.layers=l.layers),u.isDefined(l.minScale)&&!u.isDefined(c.minScale)&&(c.minScale=l.minScale),u.isDefined(l.maxScale)&&!u.isDefined(c.maxScale)&&(c.maxScale=l.maxScale),u.isDefined(l.refreshInterval)&&!u.isDefined(c.refreshInterval)&&(c.refreshInterval=l.refreshInterval),l.visibleLayers&&!c.visibleLayers&&(c.visibleLayers=l.visibleLayers);else if(-1<h.indexOf("/imageserver")&&(u.isDefined(l.minScale)&&!u.isDefined(c.minScale)&&(c.minScale=l.minScale),
u.isDefined(l.maxScale)&&!u.isDefined(c.maxScale)&&(c.maxScale=l.maxScale),u.isDefined(l.refreshInterval)&&!u.isDefined(c.refreshInterval)&&(c.refreshInterval=l.refreshInterval),l.popupInfo&&(!c.popupInfo&&!c.disablePopup)&&(c.popupInfo=l.popupInfo),l.renderingRule&&!c.renderingRule&&(c.renderingRule=l.renderingRule,l.renderingRule.functionName&&(c.renderingRule.rasterFunction=l.renderingRule.functionName)),l.bandIds&&!c.bandIds&&(c.bandIds=l.bandIds),l.mosaicRule&&!c.mosaicRule&&(c.mosaicRule=l.mosaicRule),
l.format&&!c.format&&(c.format=l.format),u.isDefined(l.compressionQuality)&&!u.isDefined(c.compressionQuality)&&(c.compressionQuality=l.compressionQuality),l.layerDefinition&&l.layerDefinition.definitionExpression&&(!u.isDefined(c.layerDefinition)||!u.isDefined(c.layerDefinition.definitionExpression))))c.layerDefinition=c.layerDefinition||{},c.layerDefinition.definitionExpression=l.layerDefinition.definitionExpression}});c.relatedItemsData=m;l.callback(c)})}else l.callback(c);return l}function N(a,
b){var l=new k,h=a.itemData,g=h.baseMap.baseMapLayers[0];if("BingMapsAerial"===g.type||"BingMapsRoad"===g.type||"BingMapsHybrid"===g.type)if(g.portalUrl&&d.id)delete b.bingMapsKey,d.id.checkSignInStatus(c.urlToObject(ca.arcgisUrl).path).then(e.hitch(null,function(c,a,b,d,l){I(g.portalUrl,l.token).then(e.hitch(null,M,c,a,b,d),e.hitch(null,K,c,a,b,d))},a,b,h,l),e.hitch(null,function(c,a,b,d,l){I(g.portalUrl).then(e.hitch(null,M,c,a,b,d),e.hitch(null,K,c,a,b,d))},a,b,h,l));else if(b.bingMapsKey){var p=
new fa({bingMapsKey:b.bingMapsKey,mapStyle:fa.MAP_STYLE_AERIAL});f.connect(p,"onLoad",e.hitch(this,function(){l.callback([a,b])}));f.connect(p,"onError",function(c){delete b.bingMapsKey;a.itemData=P(h);g=a.itemData.baseMap.baseMapLayers[0];g.errors=[];g.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});l.callback([a,b])})}else a.itemData=P(h),g=a.itemData.baseMap.baseMapLayers[0],g.errors=[],g.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),
l.callback([a,b]);else l.callback([a,b]);return l}function M(c,a,b,d,l){l.bingKey?(a.bingMapsKey=l.bingKey,l=new fa({bingMapsKey:a.bingMapsKey,mapStyle:fa.MAP_STYLE_AERIAL}),f.connect(l,"onLoad",e.hitch(this,function(){d.callback([c,a])})),f.connect(l,"onError",function(l){delete a.bingMapsKey;c.itemData=P(b);l=c.itemData.baseMap.baseMapLayers[0];l.errors=[];l.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});d.callback([c,
a])})):K(c,a,b,d)}function K(c,a,b,d){delete a.bingMapsKey;c.itemData=P(b);b=c.itemData.baseMap.baseMapLayers[0];b.errors=[];b.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});d.callback([c,a])}function P(c){c.baseMap="BingMapsAerial"===c.baseMap.baseMapLayers[0].type?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:
"BingMapsRoad"===c.baseMap.baseMapLayers[0].type?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};
return c}function Q(c,b,d,l){var h=c.dynamicLayerInfos||c.layerInfos,g=b.layers;if(g&&h)if(l.usePopupManager){var p;a.forEach(h,function(c){var a=c.id;if(!c.subLayerIds)for(c=0;c<g.length;c++){var b=g[c];if(b.id===a&&b.popupInfo){p||(p={});p[a]={infoTemplate:new d(b.popupInfo),layerUrl:b.layerUrl};break}}});p&&c.setInfoTemplates(p)}else{var m=[],s=[],e=[],w=[],v=[],f=[];a.forEach(h,function(b){var d=b.id;if(!b.subLayerIds&&-1!==a.indexOf(c.visibleLayers,d))for(b=0;b<g.length;b++){var l=g[b];if(l.id===
d){s.push(d);m.push(l.popupInfo);e.push(l.layerUrl||"");l.layerDefinition&&l.layerDefinition.definitionExpression?w.push(l.layerDefinition.definitionExpression):w.push("");v.push(u.isDefined(l.minScale)?l.minScale:null);f.push(u.isDefined(l.maxScale)?l.maxScale:null);break}}});m.length&&(c.__popups=m,c.__popupIds=s,c.__popupUrls=e,c.__popupWhereClauses=w,c.__popupMinScales=v,c.__popupMaxScales=f,c.__resourceInfo=b.resourceInfo)}}function R(c){if(!c)return!1;var a=(new r(ca.arcgisUrl)).authority;return-1!==
c.indexOf(".arcgis.com/")||-1!==c.indexOf(a)}function ba(c){return!c?!1:-1!==c.indexOf("/services.arcgisonline.com/")||-1!==c.indexOf("/server.arcgisonline.com/")}function S(c){if("https:"===location.protocol&&(R(c)||ba(c)))c=c.replace("http:","https:");return c}function U(c,b,d){var l=[],h;c.displayLevels||(l=a.map(c.resourceInfo.tileInfo.lods,function(c){return c.level}));c.exclusionAreas&&(h=e.clone(c.exclusionAreas),h=a.map(h,function(c){c.geometry=new w(c.geometry);return c}));l=new A(S(c.url),
{resourceInfo:c.resourceInfo,opacity:c.opacity,visible:c.visibility,displayLevels:c.displayLevels||l,id:c.id,minScale:c.minScale,maxScale:c.maxScale,refreshInterval:c.refreshInterval,exclusionAreas:h});d.ignorePopups||Q(l,c,b,d);return l}function O(c,a){if(!c||!a||0===a.length)return[];var b=","+a+",",d=[],l,h=",";for(l=0;l<c.length;l++)if(null!==c[l].subLayerIds){if(-1===b.indexOf(","+c[l].id+",")||-1<h.indexOf(","+c[l].id+","))h+=c[l].subLayerIds.toString()+","}else-1<b.indexOf(","+c[l].id+",")&&
-1===h.indexOf(","+c[l].id+",")&&d.push(c[l].id);return d}function W(c,b,d){var l=new La;l.format="png24";c.resourceInfo&&(c.resourceInfo.supportedImageFormatTypes&&-1<c.resourceInfo.supportedImageFormatTypes.indexOf("PNG32"))&&(l.format="png32");var l=new Ma(S(c.url),{resourceInfo:c.resourceInfo,opacity:c.opacity,visible:c.visibility,id:c.id,imageParameters:l,minScale:c.minScale,maxScale:c.maxScale,refreshInterval:c.refreshInterval}),h=c.visibleLayers;if(!c.visibleLayers){var g="";a.forEach(l.layerInfos,
function(c){c.defaultVisibility&&(g+=(0<g.length?",":"")+c.id)});h=g}if(c.layers&&0<c.layers.length){var p=[],m=[],s,u=[],w,v;a.forEach(c.layers,function(b){b.layerDefinition&&b.layerDefinition.definitionExpression&&(p[b.id]=b.layerDefinition.definitionExpression);if(b.layerDefinition&&b.layerDefinition.source){s=null;v=b.layerDefinition.source;if("mapLayer"===v.type){var d=a.filter(c.resourceInfo.layers,function(c){return c.id===v.mapLayerId});d.length&&(s=e.mixin(d[0],b))}else s=e.mixin({},b);s&&
(s.source=v,delete s.popupInfo,s=new Na(s),c.visibleLayers&&(d="string"==typeof c.visibleLayers?c.visibleLayers.split(","):c.visibleLayers,-1<a.indexOf(d,b.id)?s.defaultVisibility=!0:s.defaultVisibility=!1),m.push(s))}b.layerDefinition&&(b.layerDefinition.source&&b.layerDefinition.drawingInfo)&&(w=new Oa(b.layerDefinition.drawingInfo),u[b.id]=w)},this);0<p.length&&l.setLayerDefinitions(p);0<m.length?(l.setDynamicLayerInfos(m,!0),0<u.length&&l.setLayerDrawingOptions(u,!0)):(h=O(l.layerInfos,h),l.setVisibleLayers(h))}else h=
O(l.layerInfos,h),l.setVisibleLayers(h);d.ignorePopups||Q(l,c,b,d);return l}function aa(c,a,b){var d=new Pa;d.bandIds=c.bandIds;null!=c.format&&(d.format=c.format,null!=c.compressionQuality&&(d.compressionQuality=c.compressionQuality));if(c.renderingRule&&c.renderingRule.rasterFunction){var l=new Qa(c.renderingRule);d.renderingRule=l}c.mosaicRule&&(l=new Ra(c.mosaicRule),d.mosaicRule=l);u.isDefined(c.noData)&&(d.noData=c.noData);u.isDefined(c.noDataInterpretation)&&(d.noDataInterpretation=c.noDataInterpretation);
u.isDefined(c.interpolation)&&(d.interpolation=c.interpolation);l=c.layerType?"ArcGISImageServiceVectorLayer"===c.layerType:!1;u.isDefined(c.layerType)||(l=c.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===c.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===c.resourceInfo.serviceDataType));d={resourceInfo:c.resourceInfo,opacity:c.opacity,visible:c.visibility,id:c.id,imageServiceParameters:d,minScale:c.minScale,maxScale:c.maxScale,refreshInterval:c.refreshInterval};
d=l?new Sa(S(c.url),d):new Ta(S(c.url),d);c.layerDefinition&&c.layerDefinition.definitionExpression&&d.setDefinitionExpression(c.layerDefinition.definitionExpression,!0);!b.ignorePopups&&c.popupInfo&&d.setInfoTemplate(new a(c.popupInfo));return d}function V(c,b,d){var l=[102113,102100,3857],h=d||new s(b[0].layerObject.fullExtent.spatialReference),g=new s(c.resourceInfo.fullExtent.spatialReference);return h.wkt==g.wkt&&(h.wkid==g.wkid||u.isDefined(h.latestWkid)&&h.latestWkid==g.wkid||u.isDefined(g.latestWkid)&&
h.wkid==g.latestWkid||u.isDefined(h.latestWkid)&&h.latestWkid==g.latestWkid)||h.wkid&&g.wkid&&a.some(l,function(c){return c===g.wkid})&&a.some(l,function(c){return c===h.wkid})?!0:!1}function Y(c,b){if(!b[0].layerObject.tileInfo)return!1;var d=[];a.forEach(b,function(c){c.baseMapLayer&&c.layerObject.tileInfo&&(d=d.concat(a.map(c.layerObject.tileInfo.lods,function(c){return c.scale})))});return a.some(c.resourceInfo.tileInfo.lods,function(c){return a.some(d,function(a){return a===c.scale})})}function Z(b,
l,h,g,p){var m,v=h._clazz;if("OpenStreetMap"===b.type)m=new Ua({id:b.id,opacity:b.opacity,visible:null!==b.visibility&&void 0!==b.visibility?b.visibility:!0});else if("WMS"===b.type){var k=[],r=[];a.forEach(b.layers,function(c){r.push(new Va({name:c.name,title:c.title,legendURL:c.legendURL}));k.push(c.name)},this);b.visibleLayers&&(k=b.visibleLayers);g={extent:new w(b.extent[0][0],b.extent[0][1],b.extent[1][0],b.extent[1][1],new s({wkid:4326})),layerInfos:r,version:b.version,maxWidth:b.maxWidth,maxHeight:b.maxHeight,
getMapURL:b.mapUrl,spatialReferences:b.spatialReferences,title:b.title,copyright:b.copyright,minScale:b.minScale||0,maxScale:b.maxScale||0,format:b.format};m=new Wa(b.url,{id:b.id,visibleLayers:k,format:"png",transparent:b.baseMapLayer?!1:!0,opacity:b.opacity,visible:null!==b.visibility?b.visibility:!0,resourceInfo:g,refreshInterval:b.refreshInterval});m.spatialReference.wkid=g.spatialReferences[0]}else if("KML"===b.type){h=b.url;if(d.id&&(v=d.id.findCredential(c.urlToObject(ca.arcgisUrl).path))){var A=
ca.arcgisUrl.substring(ca.arcgisUrl.indexOf("//")+2,ca.arcgisUrl.indexOf("/",ca.arcgisUrl.indexOf("//")+3)),z=A.split("."),z=z[z.length-2]+"."+z[z.length-1];l=h.indexOf(z);-1<l&&(h="https://"+A+h.substring(l+z.length),h+="?token\x3d"+v.token)}m=new Xa(h,{id:b.id,visible:null!==b.visibility?b.visibility:!0,outSR:g,refreshInterval:b.refreshInterval});f.connect(m,"onLoad",function(){(b.opacity||0===b.opacity)&&m.setOpacity(b.opacity);u.isDefined(b.minScale)&&u.isDefined(b.maxScale)&&m.setScaleRange(b.minScale,
b.maxScale);b.visibleFolders&&a.forEach(m.folders,function(c){-1<a.indexOf(b.visibleFolders,c.id)?m.setFolderVisibility(c,!0):m.setFolderVisibility(c,!1)},this)})}else"WebTiledLayer"===b.type?(m=new Ya(b.templateUrl,{id:b.id,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,copyright:b.copyright,fullExtent:b.fullExtent&&new w(b.fullExtent),initialExtent:b.fullExtent&&new w(b.fullExtent),subDomains:b.subDomains,tileInfo:b.tileInfo?new Za(b.tileInfo):null,refreshInterval:b.refreshInterval}),
f.connect(m,"onLoad",function(){(u.isDefined(b.minScale)||u.isDefined(b.maxScale))&&m.setScaleRange(b.minScale,b.maxScale)})):"GeoRSS"===b.type?(m=new $a(b.url,{id:b.id,opacity:b.opacity,outSpatialReference:g,refreshInterval:b.refreshInterval}),f.connect(m,"onLoad",function(){!1===b.visibility&&m.hide();u.isDefined(b.minScale)&&u.isDefined(b.maxScale)&&m.setScaleRange(b.minScale,b.maxScale);var c=m.getFeatureLayers();a.forEach(c,function(a){b.pointSymbol&&"esriGeometryPoint"===a.geometryType?(a.renderer.symbol=
x.fromJson(b.pointSymbol),1===c.length&&(m.pointSymbol=x.fromJson(b.pointSymbol))):b.lineSymbol&&"esriGeometryPolyline"===a.geometryType?(a.renderer.symbol=x.fromJson(b.lineSymbol),1===c.length&&(m.polylineSymbol=x.fromJson(b.lineSymbol))):b.polygonSymbol&&"esriGeometryPolygon"===a.geometryType&&(a.renderer.symbol=x.fromJson(b.polygonSymbol),1===c.length&&(m.polygonSymbol=x.fromJson(b.polygonSymbol)))})})):"CSV"==b.type&&b.url?(g={layerDefinition:b.layerDefinition,columnDelimiter:b.columnDelimiter,
id:b.id?b.id:null,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,refreshInterval:b.refreshInterval},b.locationInfo&&(g.latitudeFieldName=b.locationInfo.latitudeFieldName,g.longitudeFieldName=b.locationInfo.longitudeFieldName),h.ignorePopups||(g.infoTemplate=new B(b.popupInfo?b.popupInfo:ab.generateDefaultPopupInfo(b))),m=new bb(b.url,g)):b.layerDefinition&&!b.url?(g=n.fromJson(n.toJson(b)),delete g.id,delete g.opacity,delete g.visibility,m=new G(g,{id:b.id,opacity:b.opacity,visible:b.visibility,
outFields:["*"],autoGeneralize:!0}),!h.ignorePopups&&g.popupInfo&&m.setInfoTemplate(new v(g.popupInfo)),ea(m)):"BingMapsAerial"===b.type||"BingMapsRoad"===b.type||"BingMapsHybrid"===b.type?h.bingMapsKey?(g=fa.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===b.type?g=fa.MAP_STYLE_AERIAL:"BingMapsRoad"===b.type&&(g=fa.MAP_STYLE_ROAD),m=new fa({bingMapsKey:h.bingMapsKey,mapStyle:g,opacity:b.opacity,id:b.id}),f.connect(m,"onError",e.hitch(this,function(c){c.errors=c.errors||[];c.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+
c.type+"]"})},b))):(b.errors=b.errors||[],b.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+b.type+"]"})):b.resourceInfo&&b.resourceInfo.mapName?m=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||V(b,l,g)&&Y(b,p))?U(b,v,h):W(b,v,h):b.resourceInfo&&b.resourceInfo.pixelSizeX?m=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||V(b,l,g)&&Y(b,p))?U(b,v,h):aa(b,v,h):b.resourceInfo&&"Feature Layer"===b.resourceInfo.type?
(b.capabilities&&(b.resourceInfo.capabilities=b.capabilities),m=new G(S(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,mode:R(b.url)?G.MODE_AUTO:u.isDefined(b.mode)?b.mode:G.MODE_ONDEMAND,editable:!1===h.editable?!1:void 0,outFields:["*"],autoGeneralize:!0,refreshInterval:b.refreshInterval}),!h.ignorePopups&&b.popupInfo&&m.setInfoTemplate(new v(b.popupInfo)),b.layerDefinition&&(b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&(g=y.fromJson(b.layerDefinition.drawingInfo.renderer),
g.isMaxInclusive=!0,m.setRenderer(g)),b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.labelingInfo&&(g=a.map(b.layerDefinition.drawingInfo.labelingInfo,function(c){return new cb(c)}),m.setLabelingInfo(g)),b.layerDefinition.definitionExpression&&m.setDefinitionExpression(b.layerDefinition.definitionExpression),u.isDefined(b.layerDefinition.minScale)&&m.setMinScale(b.layerDefinition.minScale),u.isDefined(b.layerDefinition.maxScale)&&m.setMaxScale(b.layerDefinition.maxScale)),ea(m)):b.resourceInfo&&
b.resourceInfo.streamUrls&&(g={resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id},b.layerDefinition&&(z=b.layerDefinition.drawingInfo,b.layerDefinition.definitionGeometry&&(A=A||{},A.geometry=b.layerDefinition.definitionGeometry),u.isDefined(b.layerDefinition.definitionExpression)&&(A=A||{},A.where=b.layerDefinition.definitionExpression),u.isDefined(b.layerDefinition.maximumTrackPoints)&&(g.maximumTrackPoints=b.layerDefinition.maximumTrackPoints)),A&&(g.filter=A),b.purgeOptions&&
(g.purgeOptions=b.purgeOptions),m=new db(S(b.url),g),z&&z.renderer&&(g=z.renderer,m.setRenderer(y.fromJson(g))),!h.ignorePopups&&b.popupInfo&&m.setInfoTemplate(new v(b.popupInfo)),b.layerDefinition&&(u.isDefined(b.layerDefinition.minScale)&&m.setMinScale(b.layerDefinition.minScale),u.isDefined(b.layerDefinition.maxScale)&&m.setMaxScale(b.layerDefinition.maxScale)),t.once(m,"error",function(c){b.errors.push({message:"Error loading stream layer. Check websocket url"})}));m&&(m.arcgisProps={title:b.title},
b.baseMapLayer&&(m._basemapGalleryLayerType=b.isReference?"reference":"basemap"));return m}function X(c,b,d,l){a.forEach(c,function(a,h){if(a.url&&!a.type){if(0===h||c[0].layerObject)a.layerObject=Z(a,c,b,d,l)}else a.layerObject=Z(a,c,b,d,l)});var h=a.filter(c,function(c){return!c.isReference}),g=a.filter(c,function(c){return!!c.isReference});return c=h.concat(g)}function $(c){var a=null;c=c[0];c.url&&!c.type?c.resourceInfo.spatialReference&&(a=new s,c.resourceInfo.spatialReference.wkid&&(a.wkid=
c.resourceInfo.spatialReference.wkid),c.resourceInfo.spatialReference.wkt&&(a.wkt=c.resourceInfo.spatialReference.wkt)):-1<c.type.indexOf("BingMaps")||"OpenStreetMap"==c.type?a=new s({wkid:102100}):"WMS"==c.type&&(a=new s({wkid:c.spatialReferences[0]}));return a}function T(c,b,d,l,h,g,p){a.forEach(b,function(a,b){a.url&&!a.type&&(a.resourceInfo=c[a.deferredsPos][1],delete a.deferredsPos)});g=g||$(b);b=X(b,d,g,p);h.callback(b);return h}function ea(c){!window.CanvasRenderingContext2D&&(c.renderer&&
"esri.renderer.HeatmapRenderer"===c.renderer.declaredClass)&&c.setRenderer(y.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:0.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function ga(c,a){var b=S(c);return m({url:b,content:{f:"json"},callbackParamName:"callback",error:function(c,d){c.message=c.message?c.message+(" [url:"+b+"]"):"[url:"+b+"]";a.push(c);h.defaults.io.errorHandler(c,d)}})}
function da(c){var a=ca.arcgisUrl+"/"+c.itemId+"/data";return m({url:a,content:{f:"json"},callbackParamName:"callback",error:function(b,d){b.message=b.message?b.message+(" [url:"+a+"]"):"[url:"+a+"]";c.errors=c.errors||[];c.errors.push(b);h.defaults.io.errorHandler(b,d)}})}function ha(c,b,d){var l=new k;if((!d.featureCollection||!d.featureCollection.layers)&&!d.layers)return console.log("Invalid Feature Collection item data [item id: "+c.itemId+"]: ",d),c.errors=c.errors||[],c.errors.push({message:"Invalid Feature Collection item data. [item id: "+
c.itemId+"]"}),l.errback(),l;d.layers&&(d.featureCollection={layers:d.layers},delete d.layers,u.isDefined(d.showLegend)&&(d.featureCollection.showLegend=d.showLegend,delete d.showLegend));ja(c,d.featureCollection,b).then(function(b){d.featureCollection=b;c.featureCollection&&c.featureCollection.layers?a.forEach(d.featureCollection.layers,function(a,b){var d=c.featureCollection.layers[b];if(!d.poupInfo&&!d.layerDefinition)d.popupInfo=a.popupInfo,d.layerDefinition=a.layerDefinition;else if(d.layerDefinition){if(u.isDefined(d.layerDefinition.minScale)&&
u.isDefined(d.layerDefinition.maxScale)&&(d.layerDefinition.minScale!==a.layerDefinition.minScale||d.layerDefinition.maxScale!==a.layerDefinition.maxScale))delete a.layerDefinition.minscale,delete a.layerDefinition.maxScale;d.layerDefinition.drawingInfo&&n.toJson(d.layerDefinition.drawingInfo)!==n.toJson(a.layerDefinition.drawingInfo)&&delete a.layerDefinition.drawingInfo;d.layerDefinition.showLegend!==a.layerDefinition.showLegend&&delete a.layerDefinition.showLegend;d.layerDefinition=e.mixin(d.layerDefinition,
a.layerDefinition)}else d.layerDefinition=a.layerDefinition;d.featureSet=a.featureSet;d.nextObjectId=a.nextObjectId}):(c.featureCollection=c.featureCollection||{},c.featureCollection=e.mixin(c.featureCollection,d.featureCollection));l.callback(c)});return l}function ja(c,d,l){var h=new k;q(["./csv"],function(g){var p=[];a.forEach(d.layers,function(c){c.featureSet&&(c.featureSet.features&&c.featureSet.features.length&&c.featureSet.features[0].geometry&&c.featureSet.features[0].geometry.spatialReference)&&
(c.deferredsPos=p.length,p.push(g.projectFeatureCollection(c,l,c.featureSet.features[0].geometry.spatialReference)))});(new b(p)).addCallback(function(){a.forEach(d.layers,function(a){u.isDefined(a.deferredsPos)&&(p[a.deferredsPos].results&&p[a.deferredsPos].results.length?a=p[a.deferredsPos].results[0]:(console.log("Errors projecting feature collection. ["+c.title+" - "+a.layerDefinition.name+"]"),a.errors=a.errors||[],a.errors.push({message:"Errors projecting feature collection. ["+c.title+" - "+
a.layerDefinition.name+"]"})),delete a.deferredsPos)});h.callback(d)})});return h}function ka(c,d,l,h){var g=new k,p=new k,m=[],s;a.forEach(c.operationalLayers,function(c){c.itemId&&"Feature Collection"==c.type&&m.push(da(c).then(e.hitch(null,ha,c,l)))});0===m.length?ma(c,d,l,h,p):(s=new b(m),s.addCallback(function(a){ma(c,d,l,h,p)}));p.then(function(c){m=[];a.forEach(c,function(c){c=c.layerObject;if(c instanceof G&&!c.loaded&&!c.loadError){var a=new k;t.once(c,"load, error",function(){a.callback(c)});
m.push(a)}});if(m.length){var d=new k;s=new b(m);s.addCallback(function(){d.callback(c)});return d.promise}return c}).then(function(c){var b=[];a.forEach(c,function(c){if(c.layerObject instanceof G){var a=c.layerObject;a.loaded&&(a.labelingInfo&&(c.showLabels||a._collection))&&b.push(a)}});b.length?q(["../layers/LabelLayer"],function(d){var l=new d;a.forEach(b,function(c){l.addFeatureLayer(c)});c.push({layerObject:l});g.callback(c)}):g.callback(c)});return g}function ma(c,d,l,h,g){var p=[],m=[],s=
[];a.forEach(c.operationalLayers,function(c,b){c.featureCollection?a.forEach(c.featureCollection.layers,function(d,l){var h=!0;c.visibleLayers&&-1==a.indexOf(c.visibleLayers,l)&&(h=!1);d.visibility=c.visibility&&h;d.opacity=c.opacity;d.id=(c.id||"operational"+b)+"_"+l;s.push(d)},this):s.push(c)});a.forEach(c.baseMap.baseMapLayers,function(c,a){c.baseMapLayer=!0;c.id=c.id||"base"+a;p.push(c)});a.forEach(s,function(c,a){c.id=c.id||"operational"+a;p.push(c)});a.forEach(p,function(c){c.url&&!c.type&&
(c.deferredsPos=m.length,c.errors=c.errors||[],m.push(ga(c.url,c.errors)))});0===m.length?(l=l||$(p),p=X(p,d,l,h),g.callback(p)):(new b(m)).addCallback(function(c){T(c,p,d,m,g,l,h)});return g}function la(c,b,d,l){var h=c.minScale,g=c.maxScale;if(10.1>=d.version&&b)for(c=b.length-1;0<=c;c--){if(b[c].id==l)if(0==h&&0<b[c].minScale?h=b[c].minScale:0<h&&0==b[c].minScale?h=d.minScale:0<h&&0<b[c].minScale&&(h=Math.min(h,b[c].minScale)),g=Math.max(d.maxScale||0,b[c].maxScale||0),d.setScaleRange(h,g),-1<
b[c].parentLayerId)l=b[c].parentLayerId;else break}else 10.1<d.version&&(a.forEach(c.layerInfos,function(c){c.id==l&&(0==h&&0<c.minScale?h=c.minScale:0<h&&0==c.minScale||0<h&&0<c.minScale&&(h=Math.min(h,c.minScale)),g=Math.max(g||0,c.maxScale||0))}),d.setScaleRange(h,g))}function na(c,b,d,l){var h=c.url,g=c.__popupIds,p=c.__popupUrls,m=c.__popupWhereClauses,s=c.__popupMinScales,w=c.__popupMaxScales,v=c.__resourceInfo,y=[];a.forEach(c.__popups,function(l,e){if(l){var x,k=[];a.forEach(l.fieldInfos,
function(c){"shape"!==c.fieldName.toLowerCase()&&k.push(c.fieldName)});if(c.dynamicLayerInfos&&0<c.dynamicLayerInfos.length){var n=a.filter(c.dynamicLayerInfos,function(c){return g[e]==c.id})[0].source;x=new G(h+"/dynamicLayer",{id:c.id+"_"+g[e],source:n,outFields:k,mode:G.MODE_SELECTION,infoTemplate:l&&new d(l),drawMode:!1,visible:c.visible,autoGeneralize:!0});var r=function(a,d){0<m[a].length&&d.setDefinitionExpression(m[a]);if(!u.isDefined(s[a])&&!u.isDefined(w[a]))la(c,b||v.layers,d,g[a]);else if(u.isDefined(c.minScale)||
u.isDefined(c.maxScale)){var l=c.minScale,h=c.maxScale;0==l&&0<s[a]?l=s[a]:0<l&&0==s[a]||0<l&&0<s[a]&&(l=Math.min(l,s[a]));h=Math.max(h||0,w[a]||0);d.setScaleRange(l,h)}else d.setScaleRange(s[a],w[a])};x.loaded?r(e,x):f.connect(x,"onLoad",function(c){r(e,x)})}else{var t=null,B=h+"/"+g[e];if(p[e].length)B=p[e];else if(b)for(n=0;n<b.length;n++)if(b[n].id===g[e]){t=b[n];break}x=new G(S(B),{id:c.id+"_"+g[e],outFields:k,mode:G.MODE_SELECTION,infoTemplate:l&&new d(l),drawMode:!1,visible:c.visible,resourceInfo:t,
autoGeneralize:!0});x.loaded?(0<m[e].length&&x.setDefinitionExpression(m[e]),la(c,b||v.layers,x,g[e])):f.connect(x,"onLoad",function(a){0<m[e].length&&x.setDefinitionExpression(m[e]);la(c,b||v.layers,a,g[e])})}y.push(x)}});0<y.length&&(f.connect(c,"onVisibilityChange",e.hitch(this,function(c,b){a.forEach(c,function(c){b?c.show():c.hide()})},y)),f.connect(l,"onLayerRemove",e.hitch(this,function(c,b,d){c.id===d.id&&a.forEach(b,function(c){l.removeLayer(c)})},c,y)));delete c.__popups;delete c.__popupIds;
delete c.__popupUrls;delete c.__popupWhereClauses;delete c.__popupMinScales;delete c.__popupMaxScales;delete c.__resourceInfo;return y}function eb(c){return m({url:S(c.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function fb(c,d,l){var h=[];a.forEach(c,function(c){var a=c.__popups;a&&(1<a.length&&10<=c.version)&&(c.__deferredsPos=h.length,h.push(eb(c)))});var g=[];0<h.length?(new b(h)).addCallback(function(b){a.forEach(c,function(c){c.__popups&&0<c.__popups.length&&
(c.__deferredsPos||0===c.__deferredsPos?(g=g.concat(na(c,b[c.__deferredsPos][1].layers,l,d)),delete c.__deferredsPos):g=g.concat(na(c,null,l,d)))});d.addLayers(g)}):(a.forEach(c,function(c){c.__popups&&0<c.__popups.length&&(g=g.concat(na(c,null,l,d)))}),d.addLayers(g))}function gb(c){a.forEach(c,function(c){var b=c.layer;b.toJson&&(c=b.toJson(),c.featureSet&&(b.name&&-1<b.name.indexOf("Text"))&&a.forEach(c.featureSet.features,function(c,a){if(c.attributes.TEXT){var d=b.graphics[a];d.symbol.setText(c.attributes.TEXT);
c.symbol.horizontalAlignment&&(d.symbol.align=c.symbol.horizontalAlignment);d.setSymbol(d.symbol);d.setAttributes(c.attributes)}},this))})}function hb(c){var b=6;a.forEach(c,function(c){if(c=c.renderer)"esri.renderer.SimpleRenderer"===c.declaredClass?((c=c.symbol)&&c.xoffset&&(b=Math.max(b,Math.abs(c.xoffset))),c&&c.yoffset&&(b=Math.max(b,Math.abs(c.yoffset)))):("esri.renderer.UniqueValueRenderer"===c.declaredClass||"esri.renderer.ClassBreaksRenderer"===c.declaredClass)&&a.forEach(c.infos,function(c){(c=
c.symbol)&&c.xoffset&&(b=Math.max(b,Math.abs(c.xoffset)));c&&c.yoffset&&(b=Math.max(b,Math.abs(c.yoffset)))})});return b}function Ea(c){var b=this,d=b.infoWindow,h=c.graphic;if(b.loaded){d.hide();d.clearFeatures();var g=[];a.forEach(b.graphicsLayerIds,function(c){if((c=b.getLayer(c))&&c instanceof G&&c.loaded&&c.visible)c.clearSelection(),c.infoTemplate&&!c.suspended&&g.push(c)});a.forEach(b.layerIds,function(c){(c=b.getLayer(c))&&(-1!==c.declaredClass.indexOf("ArcGISImageServiceLayer")&&c.loaded&&
c.visible&&c.infoTemplate)&&g.push(c)});h=h&&h.getInfoTemplate()?h:null;if(g.length||h){var p=hb(g),m=c.screenPoint,s=b.toMap(new l(m.x-p,m.y+p)),p=b.toMap(new l(m.x+p,m.y-p)),s=new w(s.x,s.y,p.x,p.y,b.spatialReference),u=new D;u.geometry=s;u.timeExtent=b.timeExtent;var e=!0,s=a.map(g,function(a){var b;-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?(u.geometry=c.mapPoint,e=!1,b=a.queryVisibleRasters(u,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),b.addCallback(function(){return a.getVisibleRasters()})):
(b=a.selectFeatures(u),b.addCallback(function(){return a.getSelectedFeatures()}));return b});h&&(p=new k,p.callback([h]),s.splice(0,0,p));if(!a.some(s,function(c){return-1===c.fired})){var v=h?1:0;a.forEach(g,function(c){v=-1!==c.declaredClass.indexOf("ArcGISImageServiceLayer")?v+c.getVisibleRasters().length:v+c.getSelectedFeatures().length});if(!v)return}d.setFeatures(s);d.show(c.mapPoint,{closestFirst:e})}}}function mb(c,a){var b=a.mapOptions||{},d;b.infoWindow||(d=new z({visibleWhenEmpty:!1},g.create("div")),
b.infoWindow=d);!u.isDefined(b.showInfoWindowOnClick)&&!a.usePopupManager&&(b.showInfoWindowOnClick=!1);b=new p(c,b);f.connect(b,"onLayersAddResult",gb);return b}function ia(c,b,d,l,h,g){var p,m,s,u;l.map?(p=l.map,m=l.clickEventHandle,s=l.clickEventListener,u=l.errors):(p=mb(l,h),!h.ignorePopups&&(!h.disableClickBehavior&&!h.usePopupManager)&&(m=f.connect(p,"onClick",Ea),s=Ea));p.addLayers(c);!h.ignorePopups&&!h.usePopupManager&&fb(c,p,h._clazz);var e=u||[];a.forEach(b,function(c){c.errors&&(e=e.concat(c.errors))},
this);p.loaded?g.callback({map:p,itemInfo:d,errors:e,clickEventHandle:m,clickEventListener:s}):f.connect(p,"onLoad",function(){g.callback({map:p,itemInfo:d,errors:e,clickEventHandle:m,clickEventListener:s})})}function oa(c,b,d,l,h){var g=[];a.forEach(h,function(c){e.isArray(c.layerObject)?a.forEach(c.layerObject,function(c){g.push(c)}):g.push(c.layerObject)});if("BingMapsAerial"===h[0].type||"BingMapsRoad"===h[0].type||"BingMapsHybrid"===h[0].type)var p=setInterval(function(){if(h[0].layerObject&&
h[0].layerObject.loaded)clearInterval(p),ib(c,b,d,l,h,g);else if(h[0].errors){clearInterval(p);var a="";h[0].errors&&h[0].errors.length&&(a=" ("+h[0].errors[0].message+")");l.errback(Error(C.arcgis.utils.baseLayerError+a))}},10);else if(!g[0]&&h[0].baseMapLayer){var m="";h[0].errors&&h[0].errors.length&&(m=" ("+h[0].errors[0].message+")");l.errback(Error(C.arcgis.utils.baseLayerError+m))}else ib(c,b,d,l,h,g)}function ib(c,b,d,l,g,p){try{var m=d.mapOptions||{};d.mapOptions=m;var e=c.item;p=a.filter(p,
u.isDefined);if(e)if(e.extent&&e.extent.length)if(m.extent)ia(p,g,c,b,d,l);else{var f=new w(e.extent[0][0],e.extent[0][1],e.extent[1][0],e.extent[1][1],new s({wkid:4326})),y=p[0].spatialReference;4326===y.wkid?(m.extent=f,ia(p,g,c,b,d,l)):102100===y.wkid||102113===y.wkid||3857===y.wkid?(f.xmin=Math.max(f.xmin,-180),f.xmax=Math.min(f.xmax,180),f.ymin=Math.max(f.ymin,-89.99),f.ymax=Math.min(f.ymax,89.99),m.extent=v.geographicToWebMercator(f),ia(p,g,c,b,d,l)):d.geometryServiceURL||h.defaults.geometryService?
(d.geometryServiceURL?new E(d.geometryServiceURL):h.defaults.geometryService).project([f],y,function(a){a=a[0];m.extent=m.extent||a;ia(p,g,c,b,d,l)},function(){ia(p,g,c,b,d,l)}):l.errback(Error(C.arcgis.utils.geometryServiceError))}else ia(p,g,c,b,d,l);else ia(p,g,c,b,d,l)}catch(x){l.errback(x)}}function jb(c){var b=[];c=c.baseMap.baseMapLayers.concat(c.operationalLayers);a.forEach(c,function(c){var d={};if(c.featureCollection&&"CSV"!==c.type)!0===c.featureCollection.showLegend&&a.forEach(c.featureCollection.layers,
function(a){!1!==a.showLegend&&(d={layer:a.layerObject,title:c.title,defaultSymbol:a.renderer&&a.renderer.defaultSymbol&&a.renderer.defaultLabel?!0:!1},1<c.featureCollection.layers.length&&(d.title+=" - "+a.layerDefinition.name),b.push(d))});else if(c.baseMapLayer&&!0===c.showLegend&&c.layerObject||!c.baseMapLayer&&!1!==c.showLegend&&c.layerObject){var l=c.layerObject.renderer,h=c.layerObject.declaredClass,l=!l||l&&l.defaultSymbol&&l.defaultLabel?!0:!1;if(10.1>c.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===
h||"esri.layers.ArcGISTiledMapServiceLayer"===h)||"esri.layers.ArcGISImageServiceLayer"===h)l=!0;d={layer:c.layerObject,title:c.title,defaultSymbol:l};c.layers&&(h=a.map(a.filter(c.layers,function(c){return!1===c.showLegend}),function(c){return c.id}),h.length&&(d.hideLayers=h));b.push(d)}});return b}function nb(c,b){function d(c,b){a.forEach(c,function(c,a){switch(c){case pa:Ma=b[a];break;case qa:Ta=b[a];break;case ra:Sa=b[a];break;case Fa:ab=b[a];break;case sa:bb=b[a];break;case Ga:Na=b[a];break;
case ta:$a=b[a];break;case Ha:La=b[a];break;case ua:Pa=b[a];break;case va:Xa=b[a];break;case wa:cb=b[a];break;case Ia:Oa=b[a];break;case xa:Ra=b[a];break;case ya:Ua=b[a];break;case za:Qa=b[a];break;case Aa:db=b[a];break;case Ja:Za=b[a];break;case Ba:fa=b[a];break;case Ca:Ya=b[a];break;case Da:Wa=b[a];break;case Ka:Va=b[a]}})}var l=new k,h=c.itemData,g=[];h.baseMap&&h.baseMap.baseMapLayers&&(g=g.concat(h.baseMap.baseMapLayers));h.operationalLayers&&(g=g.concat(h.operationalLayers));for(var h=a.map(g,
function(c){return c&&c.layerType}),p=[],m=[],g=!1,s=0;s<h.length;s++){switch(h[s]){case "ArcGISFeatureLayer":-1===a.indexOf(p,wa)&&p.push(wa);break;case "ArcGISImageServiceLayer":-1===a.indexOf(p,qa)&&(p.push(qa),m.push(ua),m.push(xa),m.push(za));break;case "ArcGISImageServiceVectorLayer":-1===a.indexOf(p,ra)&&(p.push(ra),m.push(ua),m.push(xa),m.push(za));break;case "ArcGISMapServiceLayer":-1===a.indexOf(p,pa)&&(p.push(pa),m.push(Ga),m.push(Ha),m.push(Ia));break;case "ArcGISStreamLayer":-1===a.indexOf(p,
Aa)&&p.push(Aa);break;case "ArcGISTiledImageServiceLayer":case "ArcGISTiledMapServiceLayer":break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===a.indexOf(p,Ba)&&p.push(Ba);break;case "CSV":-1===a.indexOf(p,sa)&&(p.push(sa),m.push(Fa));break;case "GeoRSS":-1===a.indexOf(p,ta)&&p.push(ta);break;case "KML":-1===a.indexOf(p,va)&&p.push(va);break;case "OpenStreetMap":-1===a.indexOf(p,ya)&&p.push(ya);break;case "WebTiledLayer":-1===a.indexOf(p,Ca)&&(p.push(Ca),m.push(Ja));break;case "WMS":-1===
a.indexOf(p,Da)&&(p.push(Da),m.push(Ka));break;default:g=!0}if(g)break}g&&(p=ob,m=pb);p.length?q(p,function(){d(p,arguments);m.length?q(m,function(){d(m,arguments);l.resolve()}):l.resolve()}):l.resolve();return l}function kb(c,b,d,l){nb(l,b).then(function(){N(l,b).then(function(b){var l=b[0],h=b[1];if(!l.itemData.operationalLayers||0===l.itemData.operationalLayers.length)F(l,h).addCallback(function(a){ka(a.itemData,h).addCallback(e.hitch(null,oa,a,c,h,d))});else{var g=new k,p=l.itemData.baseMap.baseMapLayers.slice(),
m=a.filter(l.itemData.baseMap.baseMapLayers,function(c){return!c.isReference});b={item:l.item,itemData:{baseMap:{baseMapLayers:m}}};l.itemData.baseMap.baseMapLayers=a.filter(l.itemData.baseMap.baseMapLayers,function(c){return c.isReference});F(b,h).addCallback(function(a){ka(a.itemData,h).addCallback(e.hitch(null,oa,a,c,h,g))});g.then(function(c){F(l,h).addCallback(function(a){ka(a.itemData,h,c.map.spatialReference,m).addCallback(function(b){a.itemData.baseMap.baseMapLayers=p;oa(a,c,h,d,b)})})},e.hitch(d,
d.errback))}})})}function lb(c){ca._arcgisUrl&&0<ca._arcgisUrl.length&&(ca.arcgisUrl=ca._arcgisUrl);var a=ca.arcgisUrl+"/"+c,b={},d=new k;m({url:a,content:{f:"json"},callbackParamName:"callback",load:function(c){b.item=c;m({url:a+"/data",content:{f:"json"},callbackParamName:"callback",load:function(c){b.itemData=c;d.callback(b)},error:function(c){d.errback(c)}})},error:function(c){d.errback(c)}});return d}var ca,Ma,Ta,Sa,ab,bb,Na,$a,La,Pa,Xa,cb,Oa,Ra,Ua,Qa,db,Za,fa,Ya,Wa,Va,pa="../layers/ArcGISDynamicMapServiceLayer",
qa="../layers/ArcGISImageServiceLayer",ra="../layers/ArcGISImageServiceVectorLayer",Fa="./csv",sa="../layers/CSVLayer",Ga="../layers/DynamicLayerInfo",ta="../layers/GeoRSSLayer",Ha="../layers/ImageParameters",ua="../layers/ImageServiceParameters",va="../layers/KMLLayer",wa="../layers/LabelClass",Ia="../layers/LayerDrawingOptions",xa="../layers/MosaicRule",ya="../layers/OpenStreetMapLayer",za="../layers/RasterFunction",Aa="../layers/StreamLayer",Ja="../layers/TileInfo",Ba="../virtualearth/VETiledLayer",
Ca="../layers/WebTiledLayer",Da="../layers/WMSLayer",Ka="../layers/WMSLayerInfo",ob=[pa,qa,ra,sa,ta,va,wa,ya,Aa,Ba,Ca,Da],pb=[Fa,Ga,Ha,ua,Ia,xa,za,Ja,Ka];ca={arcgisUrl:location.protocol+"//www.arcgis.com/sharing/rest/content/items",getItem:lb,createMap:function(c,a,b){var d=new k;b=b||{};var l=b.infoTemplateClass;b._clazz=l&&(e.isObject(l)?l:e.getObject(l))||B;e.isString(c)?lb(c).addCallback(e.hitch(null,kb,a,b,d)).addErrback(e.hitch(d,d.errback)):kb(a,b,d,c);return d},getLegendLayers:function(c){return c&&
c.itemInfo&&c.itemInfo.itemData?jb(c.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:F,_getItemData:H,_getBingKey:I,_portalUrlResponse:M,_portalUrlFailure:K,_processFSItemProperties:L,_processSSItemProperties:J,_getLayers:ka,_preBuildLayerObjects:T,_buildLayerObjects:X,_preCreateMap:oa,_getMapSR:$,_createMap:ia,_addSelectionLayers:fb,_createSelectionFeatureLayers:na,_getServiceInfo:ga,_getFeatureCollectionItem:da,_mergeFeatureCollectionItem:ha,_projectFeatureCollection:ja,_getLayersInfo:eb,_initLayer:Z,
_loadAsCached:U,_loadAsDynamic:W,_processPopups:Q,_onLayersAddResult:gb,_sameSpatialReferenceAsBasemap:V,_sameTilingSchemeAsBasemap:Y,_showPopup:Ea,_calculateClickTolerance:hb,_getVisibleFeatureLayers:O,_updateLayerScaleInfo:la,_checkUrl:S,_isHostedService:R,_isAgolService:ba,_getLegendLayers:jb};e.setObject("arcgis.utils",ca,d);return ca})},"dojo/_base/url":function(){define(["./kernel"],function(q){var e=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,a=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,
f=function(){for(var k=arguments,n=[k[0]],r=1;r<k.length;r++)if(k[r]){var t=new f(k[r]+""),n=new f(n[0]+"");if(""==t.path&&!t.scheme&&!t.authority&&!t.query)null!=t.fragment&&(n.fragment=t.fragment),t=n;else if(!t.scheme&&(t.scheme=n.scheme,!t.authority&&(t.authority=n.authority,"/"!=t.path.charAt(0)))){for(var n=(n.path.substring(0,n.path.lastIndexOf("/")+1)+t.path).split("/"),b=0;b<n.length;b++)"."==n[b]?b==n.length-1?n[b]="":(n.splice(b,1),b--):0<b&&(!(1==b&&""==n[0])&&".."==n[b]&&".."!=n[b-1])&&
(b==n.length-1?(n.splice(b,1),n[b-1]=""):(n.splice(b-1,2),b-=2));t.path=n.join("/")}n=[];t.scheme&&n.push(t.scheme,":");t.authority&&n.push("//",t.authority);n.push(t.path);t.query&&n.push("?",t.query);t.fragment&&n.push("#",t.fragment)}this.uri=n.join("");k=this.uri.match(e);this.scheme=k[2]||(k[1]?"":null);this.authority=k[4]||(k[3]?"":null);this.path=k[5];this.query=k[7]||(k[6]?"":null);this.fragment=k[9]||(k[8]?"":null);null!=this.authority&&(k=this.authority.match(a),this.user=k[3]||null,this.password=
k[4]||null,this.host=k[6]||k[7],this.port=k[9]||null)};f.prototype.toString=function(){return this.uri};return q._Url=f})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(q,e,a){q.DeferredList=function(f,k,n,r,t){var b=[];e.call(this);var g=this;0===f.length&&!k&&this.resolve([0,[]]);var d=0;a.forEach(f,function(a,u){function m(a,h){b[u]=[a,h];d++;d===f.length&&g.resolve(b)}a.then(function(a){k?g.resolve([u,a]):m(!0,a)},function(a){n?g.reject(a):
m(!1,a);if(r)return null;throw a;})})};q.DeferredList.prototype=new e;q.DeferredList.prototype.gatherResults=function(e){e=new q.DeferredList(e,!1,!0,!1);e.addCallback(function(e){var f=[];a.forEach(e,function(a){f.push(a[1])});return f});return e};return q.DeferredList})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(q,e,a){q=window.location;a=q.pathname;a={version:"3.13",_appBaseUrl:q.protocol+"//"+q.host+a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-
1]))};e.noGlobals||(window.esri=a);(a.dijit=a.dijit||{})._arcgisUrl=("file:"===q.protocol?"http:":q.protocol)+"//www.arcgis.com/sharing/rest";return a})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(q,e,a,f){a={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,
style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:window.Worker&&!1,io:{errorHandler:function(a,f){e.publish("esri.Error",[a])},proxyUrl:null,alwaysUseProxy:!1,useCors:!0,corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com static.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com".split(" "),
corsDetection:window.cordova?!1:!0,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5}}};q.noGlobals||(window.esriConfig=a);return a})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(q,e,a,f,k,n,r,t,b){function g(a){return void 0!==a&&null!==a}function d(a,b,c){var d=c.match(/([^\(]+)(\([^\)]+\))?/i),
h=f.trim(d[1]);c=b[a];var d=e.fromJson((d[2]?f.trim(d[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})")),m=d.utcOffset;if(-1===q.indexOf(u,h))h=f.getObject(h),f.isFunction(h)&&(c=h(c,a,b,d));else if("number"===typeof c||"string"===typeof c&&c&&!isNaN(Number(c)))switch(c=Number(c),h){case "NumberFormat":return r.format(c,d);case "DateString":a=new Date(c);if(d.local||d.systemLocale)return d.systemLocale?a.toLocaleDateString()+(d.hideTime?"":" "+a.toLocaleTimeString()):a.toDateString()+(d.hideTime?
"":" "+a.toTimeString());a=a.toUTCString();d.hideTime&&(a=a.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return a;case "DateFormat":return a=new Date(c),g(m)&&(a=k.add(a,"minute",a.getTimezoneOffset()-m)),t.format(a,d)}return g(c)?c:""}function h(a,b){var c;if(b)for(c in a)a.hasOwnProperty(c)&&(void 0===a[c]?delete a[c]:a[c]instanceof Object&&h(a[c],!0));else for(c in a)a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];return a}var u=["NumberFormat","DateString","DateFormat"],m=/<\/?[^>]+>/g;return{valueOf:function(a,
b){for(var c in a)if(a[c]==b)return c;return null},stripTags:function(a){if(a){var b=typeof a;if("string"===b)a=a.replace(m,"");else if("object"===b)for(var c in a)(b=a[c])&&"string"===typeof b&&(b=b.replace(m,"")),a[c]=b}return a},substitute:function(a,b,c){var l,h,m;g(c)&&(f.isObject(c)?(l=c.first,h=c.dateFormat,m=c.numberFormat):l=c);if(!b||"${*}"===b){b=[];for(var u in a){c=a[u];if(h&&-1!==q.indexOf(h.properties||"",u))c=d(u,a,h.formatter||"DateString");else if(m&&-1!==q.indexOf(m.properties||
"",u))c=d(u,a,m.formatter||"NumberFormat");b.push(u+" \x3d "+(g(c)?c:"")+"\x3cbr/\x3e");if(l)break}return b.join("")}return f.replace(b,f.hitch({obj:a},function(c,a){var b=a.split(":");return 1<b.length?(a=b[0],b.shift(),d(a,this.obj,b.join(":"))):h&&-1!==q.indexOf(h.properties||"",a)?d(a,this.obj,h.formatter||"DateString"):m&&-1!==q.indexOf(m.properties||"",a)?d(a,this.obj,m.formatter||"NumberFormat"):g(this.obj[a])?this.obj[a]:""}),/\$\{([^\}]+)\}/g)},filter:function(b,d,c){d=[f.isString(b)?b.split(""):
b,c||a.global,f.isString(d)?new Function("item","index","array",d):d];c={};var l;b=d[0];for(l in b)d[2].call(d[l],b[l],l,b)&&(c[l]=b[l]);return c},isDefined:g,fixJson:h}})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/io/script dojo/io/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c){function l(c){c=
new n(c);return(c.host+(c.port?":"+c.port:"")).toLowerCase()}function w(c,u,w,v){var y=!1,x=!1,n;s.isDefined(u)&&(k.isObject(u)?(y=!!u.useProxy,x=!!u.usePost,n=u.crossOrigin):y=!!u);c=k.mixin({},c);c._ssl&&(c.url=c.url.replace(/^http:/i,"https:"));u=c.content;var D=c.url,q=w&&c.form,M=z;n=s.isDefined(n)?n:M.useCors;c.load=function(c){var b;c&&(c.error?(b=k.mixin(Error(),c.error),b.log=a.isDebug):"error"===c.status&&(b=k.mixin(Error(),c),b.log=a.isDebug),b&&!s.isDefined(b.httpCode)&&(b.httpCode=b.code));
return b||c};c.error=function(c,b){b&&b.xhr&&b.xhr.abort();c instanceof Error||(c=k.mixin(Error(),c));c.log=a.isDebug;M.errorHandler(c,b);return c};c._token&&(c.content=c.content||{},c.content.token=c._token);var K=0,P;u&&D&&(P=d.objectToQuery(u),K=P.length+D.length+1,m("esri-url-encodes-apostrophe")&&(K=P.replace(/'/g,"%27").length+D.length+1));c.timeout=s.isDefined(c.timeout)?c.timeout:M.timeout;c.handleAs=c.handleAs||"json";try{var Q,R,ba=n&&p.canUseXhr(c.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(c.url),
S=p.hasSameOrigin(c.url,window.location.href)||ba,U=x||w||K>M.postLength?!0:!1,O=!S&&-1!==c.handleAs.indexOf("json")&&c.callbackParamName&&!w?!0:!1,W=p.getProxyRule(c.url)||M.alwaysUseProxy||y||(!O||U)&&!S?!0:!1;w&&(!m("esri-file-upload")&&!W&&ba)&&(W=!0);if(W)if(Q=p.getProxyUrl(D,n),R=Q.path,Q._xo&&(ba=!0),!U&&R.length+1+K>M.postLength&&(U=!0),c.url=R+"?"+D,U)c.content=k.mixin(Q.query||{},u);else{var aa=d.objectToQuery(k.mixin(Q.query||{},u));aa&&(c.url+="?"+aa);c.content=null}if(O&&!U)return!s.isDefined(c.isAsync)&&
4>m("ff")&&(c.isAsync=!0),t.get(B?B(c):c);var V=c.headers;if(ba&&(!V||!V.hasOwnProperty("X-Requested-With")))V=c.headers=V||{},V["X-Requested-With"]=null;if(w){var Y=c.callbackParamName||"callback.html",Z=c.callbackElementName||"textarea",X,$,T,ea,ga=q.elements?q.elements.length:0,da;if(u=c.content)for(X in u)if(T=u[X],s.isDefined(T)){$=null;for(ea=0;ea<ga;ea++)if(da=q.elements[ea],da.name===X){$=da;break}$?$.value=T:v?q.append(X,T):q.appendChild(g.create("input",{type:"hidden",name:X,value:T}))}if(m("esri-file-upload"))e.forEach(q.elements,
function(c){c.name===Y&&q.removeChild(c)}),c.contentType=!1,c.postData=v?q:new FormData(q),delete c.form;else{q.enctype="multipart/form-data";9>m("ie")&&(q.encoding="multipart/form-data");q.method="post";e.some(q.elements,function(c){return c.name===Y})||q.appendChild(g.create("input",{type:"hidden",name:Y,value:Z}));if(-1!==D.toLowerCase().indexOf("addattachment")||-1!==D.toLowerCase().indexOf("updateattachment"))c.url=D+(-1===D.indexOf("?")?"?":"\x26")+Y+"\x3d"+Z,W&&(c.url=R+"?"+c.url);delete c.content}}if(ba&&
!c.hasOwnProperty("withCredentials"))if(v=W?R:D,-1!==e.indexOf(z.webTierAuthServers,l(v)))c.withCredentials=!0;else if(h.id){var ha=h.id.findServerInfo(v);ha&&ha.webTierAuth&&(c.withCredentials=!0)}c=B?B(c):c;if(U){if(w&&!m("esri-file-upload"))return b.send(c);!W&&m("safari")&&(c.url+=(-1===c.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+E++);return r.post(c)}return r.get(c)}catch(ja){return w=new f,w.errback(c.error(ja)),w}}function v(c){var a=z.corsStatus,b=p.canUseXhr(c,!0);-1<b&&
z.corsEnabledServers.splice(b,1);a[l(c)]=1;return b}function x(c){var a=z.corsStatus;if(z.corsDetection&&z.useCors)try{var b=l(c);m("esri-cors")&&(c&&-1!==c.toLowerCase().indexOf("/rest/services")&&!p.hasSameOrigin(c,window.location.href)&&!p.canUseXhr(c)&&!a[b])&&(a[b]=-1,r.get({url:c.substring(0,c.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null}}).then(function(d){d?(a[b]=2,p.canUseXhr(c)||z.corsEnabledServers.push(b)):a[b]=
1},function(c){a[b]=1}))}catch(d){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}}function y(b,d){function g(c){c._pendingDfd=w(b,d,K,M);if(!c._pendingDfd){c.ioArgs=c._pendingDfd&&c._pendingDfd.ioArgs;var l=Error("Deferred object is missing");l.log=a.isDebug;b._usrDfd=null;c.errback(l);c._pendingDfd=null;return c}c._pendingDfd.addCallback(function(a){c.ioArgs=c._pendingDfd&&c._pendingDfd.ioArgs;b._usrDfd=null;c.callback(a);c._pendingDfd=null}).addErrback(function(a){var l,
g,p;a&&(l=a.code,g=a.subcode,p=(p=a.messageCode)&&p.toUpperCase());if(a&&403==l&&(4==g||a.message&&-1<a.message.toLowerCase().indexOf("ssl")&&-1===a.message.toLowerCase().indexOf("permission"))){if(!b._ssl){b._ssl=b._sslFromServer=!0;b._usrDfd=c;y(b,d);return}}else if(a&&415==a.status){if(v(b.url),!b._err415){b._err415=1;b._usrDfd=c;y(b,d);return}}else if(h.id&&-1!==e.indexOf(h.id._errorCodes,l)&&!h.id._isPublic(b.url)&&!k&&(403!=l||-1===e.indexOf(D,p)&&(!s.isDefined(g)||2==g))){c._pendingDfd=h.id.getCredential(b.url,
{token:b._token,error:a});c._pendingDfd.addCallback(function(a){b._token=a.token;b._usrDfd=c;b._credential=a;b._ssl=b._sslFromServer||a.ssl;y(b,d)}).addErrback(function(a){b._usrDfd=null;c.errback(a);c._pendingDfd=null});return}c.ioArgs=c._pendingDfd&&c._pendingDfd.ioArgs;b._usrDfd=null;c.errback(a);c._pendingDfd=null})}b.url=p.fixUrl(b.url);"file:"!==window.location.protocol&&(b.url=p.getAbsoluteUrl(b.url));d=d||{};var u,n=b.form,k=d.disableIdentityLookup,t=d._preLookup,B=!1;if(m("esri-workers")&&
!1!==z.useWorkers)if(!0===d.useWorkers||!0===z.useWorkers)B=!0;else if(d.workerOptions){var E=d.workerOptions;if(E.callback||E.worker&&E.worker.worker instanceof Worker)B=!0}var M=n&&n.append,K=n&&(n.elements?e.some(n.elements,function(c){return"file"===c.type}):M),P=-1!==b.url.toLowerCase().indexOf("token\x3d")||b.content&&b.content.token||K&&e.some(n.elements,function(c){return"token"===c.name})?1:0;x(b.url);if(b._usrDfd)u=b._usrDfd;else{u=new f(c._dfdCanceller);u.addCallback(function(c){/\/sharing\/rest\/accounts\/self/i.test(b.url)&&
(!P&&!b._token&&c.user&&c.user.username)&&z.webTierAuthServers.push(l(b.url));if(c=b._credential){var a=h.id.findServerInfo(c.server);if(a=a&&a.owningSystemUrl)a=a.replace(/\/?$/,"/sharing"),(c=h.id.findCredential(a,c.userId))&&-1===h.id._getIdenticalSvcIdx(a,c)&&c.resources.splice(0,0,a)}});u.addBoth(function(c){delete b._credential;if(c&&(!m("ie")||!c.nodeType))c._ssl=b._ssl});var Q=b.load,R=b.error;Q&&u.addCallback(function(c){var a=u._pendingDfd,a=a&&a.ioArgs;return Q.call(a&&a.args,c,a)});R&&
u.addErrback(function(c){var a=u._pendingDfd,a=a&&a.ioArgs;return R.call(a&&a.args,c,a)})}if(h.id&&!P&&!b._token&&!h.id._isPublic(b.url)&&(!k||t))if(n=h.id.findCredential(b.url))b._token=n.token,b._ssl=n.ssl;B?d.workerOptions&&d.workerOptions.worker?(r=d.workerOptions.worker,g(u)):q(["./workers/RequestClient"],function(c){if(d.workerOptions){var a=d.workerOptions;r=c.getClient(a.callback,a.cbFunction)}else r=c.getClient();g(u)}):g(u);return u}var B,z=u.defaults.io,D=["COM_0056","COM_0057"],E=0;y._request=
w;y._disableCors=v;y._detectCors=x;y.setRequestPreCallback=function(c){B=c};return y})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),function(q,e,a,f,k,n,r,t,b,g){e.deprecated("dojo/io/script","Use dojo/request/script.","2.0");var d={get:function(a){var u,m=this._makeScriptDeferred(a,function(a){u&&u.cancel()}),s=m.ioArgs;n._ioAddQueryToUrl(s);n._ioNotifyStart(m);
u=b.get(s.url,{timeout:a.timeout,jsonp:s.jsonp,checkString:a.checkString,ioArgs:s,frameDoc:a.frameDoc,canAttach:function(a){s.requestId=a.id;s.scriptId=a.scriptId;s.canDelete=a.canDelete;return d._canAttach(s)}},!0);g.around(u,"isValid",function(a){return function(c){d._validCheck(m);return a.call(this,c)}});u.then(function(){m.resolve(m)}).otherwise(function(a){m.ioArgs.error=a;m.reject(a)});return m},attach:b._attach,remove:b._remove,_makeScriptDeferred:function(a,g){var m=n._ioSetArgs(a,g||this._deferredCancel,
this._deferredOk,this._deferredError),s=m.ioArgs;s.id=e._scopeName+"IoScript"+(a.callbackSuffix||this._counter++);s.canDelete=!1;s.jsonp=a.callbackParamName||a.jsonp;s.jsonp&&(s.query=s.query||"",0<s.query.length&&(s.query+="\x26"),s.query+=s.jsonp+"\x3d"+(a.frameDoc?"parent.":"")+e._scopeName+".io.script.jsonp_"+s.id+"._jsonpCallback",s.frameDoc=a.frameDoc,s.canDelete=!0,m._jsonpCallback=this._jsonpCallback,this["jsonp_"+s.id]=m);m.addBoth(function(a){s.canDelete&&(a instanceof Error?d["jsonp_"+
s.id]._jsonpCallback=function(){delete d["jsonp_"+s.id];if(s.requestId)e.global[b._callbacksProperty][s.requestId]()}:d._addDeadScript(s))});return m},_deferredCancel:function(a){a.canceled=!0},_deferredOk:function(a){a=a.ioArgs;return a.json||a.scriptLoaded||a},_deferredError:function(a,b){console.log("dojo.io.script error",a);return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){d._deadScripts.push({id:a.id,frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(a){if((a=d._deadScripts)&&
0<a.length){for(var b=0;b<a.length;b++)d.remove(a[b].id,a[b].frameDoc),delete d["jsonp_"+a[b].id],a[b].frameDoc=null;d._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;return a.json||a.scriptLoaded&&!a.args.checkString?!0:(a=a.args.checkString)&&eval("typeof("+a+") !\x3d 'undefined'")},_resHandle:function(a){d._ioCheck(a)?a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},_jsonpCallback:function(a){this.ioArgs.json=a;if(this.ioArgs.requestId)e.global[b._callbacksProperty][this.ioArgs.requestId](a)}};
a.setObject("dojo.io.script",d);return d})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(q,e,a,f,k,n,r,t,b,g,d){function h(a,b){a.canDelete&&c._remove(a.id,b.options.frameDoc,!0)}function u(a){B&&B.length&&(k.forEach(B,function(a){c._remove(a.id,a.frameDoc);a.frameDoc=null}),B=[]);return a.options.jsonp?!a.data:!0}function m(c){return!!this.scriptLoaded}function s(c){return(c=
c.options.checkString)&&eval("typeof("+c+') !\x3d\x3d "undefined"')}function p(c,a){if(this.canDelete){var b=this.response.options;B.push({id:this.id,frameDoc:b.ioArgs?b.ioArgs.frameDoc:b.frameDoc});b.ioArgs&&(b.ioArgs.frameDoc=null);b.frameDoc=null}a?this.reject(a):this.resolve(c)}function c(b,d,g){var f=a.parseArgs(b,a.deepCopy({},d));b=f.url;d=f.options;var k=a.deferred(f,h,u,d.jsonp?null:d.checkString?s:m,p);n.mixin(k,{id:l+w++,canDelete:!1});d.jsonp&&(RegExp("[?\x26]"+d.jsonp+"\x3d").test(b)||
(b+=(~b.indexOf("?")?"\x26":"?")+d.jsonp+"\x3d"+(d.frameDoc?"parent.":"")+l+"_callbacks."+k.id),k.canDelete=!0,y[k.id]=function(c){f.data=c;k.handleResponse(f)});a.notify&&a.notify.emit("send",f,k.promise.cancel);if(!d.canAttach||d.canAttach(k)){var t=c._attach(k.id,b,d.frameDoc);if(!d.jsonp&&!d.checkString)var B=r(t,v,function(c){if("load"===c.type||x.test(t.readyState))B.remove(),k.scriptLoaded=c})}e(k);return g?k:k.promise}g.add("script-readystatechange",function(c,a){return"undefined"!==typeof a.createElement("script").onreadystatechange&&
("undefined"===typeof c.opera||"[object Opera]"!==c.opera.toString())});var l=q.id.replace(/[\/\.\-]/g,"_"),w=0,v=g("script-readystatechange")?"readystatechange":"load",x=/complete|loaded/,y=f.global[l+"_callbacks"]={},B=[];c.get=c;c._attach=function(c,a,b){b=b||d.doc;var l=b.createElement("script");l.type="text/javascript";l.src=a;l.id=c;l.async=!0;l.charset="utf-8";return b.getElementsByTagName("head")[0].appendChild(l)};c._remove=function(c,a,d){b.destroy(t.byId(c,a));y[c]&&(d?y[c]=function(){delete y[c]}:
delete y[c])};c._callbacksProperty=l+"_callbacks";return c})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u){a.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");n=u._iframeName;n=n.substring(0,n.lastIndexOf("_"));var m=f.delegate(u,{create:function(){return m._frame=u.create.apply(u,arguments)},
get:null,post:null,send:function(b){var d,c=k._ioSetArgs(b,function(c){d&&d.cancel()},function(c){var b=null;c=c.ioArgs;try{var l=c.handleAs;"xml"===l||"html"===l?b=d.response.data:(b=d.response.text,"json"===l?b=e.fromJson(b):"javascript"===l&&(b=a.eval(b)))}catch(g){b=g}return b},function(c,a){a.ioArgs._hasError=!0;return c}),l=c.ioArgs,g="GET",m=t.byId(b.form);b.method&&("POST"===b.method.toUpperCase()&&m)&&(g="POST");b={method:g,handleAs:"json"===b.handleAs||"javascript"===b.handleAs?"text":b.handleAs,
form:b.form,query:m?null:b.content,data:m?b.content:null,timeout:b.timeout,ioArgs:l};b.method&&(b.method=b.method.toUpperCase());if(q.ioPublish&&a.publish&&!1!==l.args.ioPublish)var f=h.after(u,"_notifyStart",function(a){a.options.ioArgs===l&&(f.remove(),k._ioNotifyStart(c))},!0);d=u(l.url,b,!0);l._callNext=d._callNext;d.then(function(){c.resolve(c)}).otherwise(function(a){c.ioArgs.error=a;c.reject(a)});return c},_iframeOnload:r.global[n+"_onload"]});f.setObject("dojo.io.iframe",m);return m})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h){function u(c){return!this.isFulfilled()}function m(c){return!!this._finished}function s(a,b){if(!b)try{var d=a.options,l=c.doc(c._frame),g=d.handleAs;if("html"!==g){if("xml"===g)if("html"===l.documentElement.tagName.toLowerCase()){t("a",l.documentElement).orphan();var h=l.documentElement.innerText,h=h.replace(/>\s+</g,"\x3e\x3c");a.text=n.trim(h)}else a.data=l;else a.text=l.getElementsByTagName("textarea")[0].value;k(a)}else a.data=l}catch(p){b=p}b?this.reject(b):
this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}function p(c){this._callNext()}function c(b,d,l){var g=f.parseArgs(b,f.deepCreate(v,d),!0);b=g.url;d=g.options;if("GET"!==d.method&&"POST"!==d.method)throw Error(d.method+" not supported by dojo/request/iframe");c._frame||(c._frame=c.create(c._iframeName,w+"();"));b=f.deferred(g,null,u,m,s,p);b._callNext=function(){this._calledNext||(this._calledNext=!0,c._currentDfd=null,c._fireNextRequest())};b._legacy=
l;c._dfdQueue.push(b);c._fireNextRequest();a(b);return l?b:b.promise}var l=q.id.replace(/[\/\.\-]/g,"_"),w=l+"_onload";h.global[w]||(h.global[w]=function(){var a=c._currentDfd;if(a){var b=g.byId(a.response.options.form)||a._tmpForm;if(b){for(var l=a._contentToClean,h=0;h<l.length;h++)for(var p=l[h],m=0;m<b.childNodes.length;m++){var s=b.childNodes[m];if(s.name===p){d.destroy(s);break}}a._originalAction&&b.setAttribute("action",a._originalAction);a._originalMethod&&(b.setAttribute("method",a._originalMethod),
b.method=a._originalMethod);a._originalTarget&&(b.setAttribute("target",a._originalTarget),b.target=a._originalTarget)}a._tmpForm&&(d.destroy(a._tmpForm),delete a._tmpForm);a._finished=!0}else c._fireNextRequest()});var v={method:"POST"};c.create=function(c,a,l){if(h.global[c])return h.global[c];if(h.global.frames[c])return h.global.frames[c];l||(b("config-useXDomain")&&!b("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),
l=b("config-dojoBlankHtmlUrl")||e.toUrl("dojo/resources/blank.html"));a=d.place('\x3ciframe id\x3d"'+c+'" name\x3d"'+c+'" src\x3d"'+l+'" onload\x3d"'+a+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',h.body());return h.global[c]=a};c.doc=function(c){if(c.contentDocument)return c.contentDocument;var a=c.name;if(a){var b=h.doc.getElementsByTagName("iframe");if(c.document&&b[a].contentWindow&&b[a].contentWindow.document)return b[a].contentWindow.document;
if(h.doc.frames[a]&&h.doc.frames[a].document)return h.doc.frames[a].document}return null};c.setSrc=function(c,a,b){c=h.global.frames[c.name];c.contentWindow&&(c=c.contentWindow);try{b?c.location.replace(a):c.location=a}catch(d){console.log("dojo/request/iframe.setSrc: ",d)}};c._iframeName=l+"_IoIframe";c._notifyStart=function(){};c._dfdQueue=[];c._currentDfd=null;c._fireNextRequest=function(){var a;try{if(!c._currentDfd&&c._dfdQueue.length){do a=c._currentDfd=c._dfdQueue.shift();while(a&&(a.canceled||
a.isCanceled&&a.isCanceled())&&c._dfdQueue.length);if(!a||a.canceled||a.isCanceled&&a.isCanceled())c._currentDfd=null;else{var b=a.response,p=b.options,m=a._contentToClean=[],s=g.byId(p.form),u=f.notify,e=p.data||null,w;!a._legacy&&"POST"===p.method&&!s?s=a._tmpForm=d.create("form",{name:l+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},h.body()):"GET"===p.method&&(s&&-1<b.url.indexOf("?"))&&(w=b.url.slice(b.url.indexOf("?")+1),e=n.mixin(r.queryToObject(w),e));if(s){if(!a._legacy){var v=
s;do v=v.parentNode;while(v&&v!==h.doc.documentElement);v||(s.style.position="absolute",s.style.left="-1000px",s.style.top="-1000px",h.body().appendChild(s));s.name||(s.name=l+"_form")}if(e){var v=function(c,a){d.create("input",{type:"hidden",name:c,value:a},s);m.push(c)},k;for(k in e){var t=e[k];if(n.isArray(t)&&1<t.length)for(w=0;w<t.length;w++)v(k,t[w]);else s[k]?s[k].value=t:v(k,t)}}var q=s.getAttributeNode("action"),J=s.getAttributeNode("method"),F=s.getAttributeNode("target");b.url&&(a._originalAction=
q?q.value:null,q?q.value=b.url:s.setAttribute("action",b.url));if(a._legacy){if(!J||!J.value)J?J.value=p.method:s.setAttribute("method",p.method)}else a._originalMethod=J?J.value:null,J?J.value=p.method:s.setAttribute("method",p.method);a._originalTarget=F?F.value:null;F?F.value=c._iframeName:s.setAttribute("target",c._iframeName);s.target=c._iframeName;u&&u.emit("send",b,a.promise.cancel);c._notifyStart(b);s.submit()}else p="",b.options.data&&(p=b.options.data,"string"!==typeof p&&(p=r.objectToQuery(p))),
v=b.url+(-1<b.url.indexOf("?")?"\x26":"?")+p,u&&u.emit("send",b,a.promise.cancel),c._notifyStart(b),c.setSrc(c._frame,v,!0)}}}catch(N){a.reject(N)}};f.addCommonMethods(c,["GET","POST"]);return c})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(q,e){var a=q("ff"),f=q("ie"),k=void 0===f&&7<=q("trident"),n=q("webkit"),r=q("opera"),t=q("chrome"),b=q("safari"),g=navigator.userAgent,d;(d=g.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&q.add("esri-iphone",parseFloat(d[2].replace("_",
".")));(d=g.match(/Android\s+(\d+\.\d+)/i))&&q.add("esri-android",parseFloat(d[1]));(d=g.match(/Fennec\/(\d+\.\d+)/i))&&q.add("esri-fennec",parseFloat(d[1]));0<=g.indexOf("BlackBerry")&&0<=g.indexOf("WebKit")&&q.add("esri-blackberry",1);q.add("esri-touch",q("esri-iphone")||q("esri-android")||q("esri-blackberry")||6<=q("esri-fennec")||(a||n)&&document.createTouch?!0:!1);q.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled);e._getDOMAccessor=function(b){var d="";a?d="Moz":n?d="Webkit":
f?d="ms":r&&(d="O");return d+b.charAt(0).toUpperCase()+b.substr(1)};q.add("esri-phonegap",!!window.cordova);q.add("esri-cors",q("esri-phonegap")||"XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest);q.add("esri-file-upload",window.FormData&&window.FileList?!0:!1);q.add("esri-workers",window.Worker?!0:!1);q.add("esri-transforms",k||9<=f||3.5<=a||4<=t||3.1<=b||10.5<=r||3.2<=q("esri-iphone")||2.1<=q("esri-android"));q.add("esri-transitions",k||10<=f||4<=a||4<=t||3.1<=b||10.5<=r||3.2<=q("esri-iphone")||
2.1<=q("esri-android"));q.add("esri-transforms3d",k||10<=a||12<=t||4<=b||3.2<=q("esri-iphone")||3<=q("esri-android"));q.add("esri-url-encodes-apostrophe",function(){var a=window.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>q("esri-android")&&(q.add("esri-transforms",!1,!1,!0),q.add("esri-transitions",!1,!1,!0),q.add("esri-transforms3d",!1,!1,!0));e._css=function(d){var g=q("esri-transforms3d");if(void 0!==d&&null!==d)g=d;else if(g&&(t||b&&!q("esri-iphone")))g=!1;var m=
g?"translate3d(":"translate(",s=g?t?",-1px)":",0px)":")",p=g?"scale3d(":"scale(",c=g?",1)":")",l=g?"rotate3d(0,0,1,":"rotate(",e=g?"matrix3d(":"matrix(",v=g?",0,0,":",",k=g?",0,0,0,0,1,0,":",",y=g?",0,1)":")";return{names:{transition:n&&"-webkit-transition"||a&&"MozTransition"||r&&"OTransition"||f&&"msTransition"||"transition",transform:n&&"-webkit-transform"||a&&"MozTransform"||r&&"OTransform"||f&&"msTransform"||"transform",transformName:n&&"-webkit-transform"||a&&"-moz-transform"||r&&"-o-transform"||
f&&"-ms-transform"||"transform",origin:n&&"-webkit-transform-origin"||a&&"MozTransformOrigin"||r&&"OTransformOrigin"||f&&"msTransformOrigin"||"transformOrigin",endEvent:n&&"webkitTransitionEnd"||a&&"transitionend"||r&&"oTransitionEnd"||f&&"MSTransitionEnd"||"transitionend"},translate:function(c,a){return m+c+"px,"+a+"px"+s},scale:function(a){return p+a+","+a+c},rotate:function(c){return l+c+"deg)"},matrix:function(c){return e+c.xx+","+c.xy+v+c.yx+","+c.yy+k+c.dx.toFixed(10)+(a?"px,":",")+c.dy.toFixed(10)+
(a?"px":"")+y},getScaleFromMatrix:function(c){if(!c)return 1;c=c.toLowerCase();var a=-1<c.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(c.substring(a.length,c.indexOf(",")))}}};return q})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(q,e,a,f,k,n,r,t){var b={},g=n.defaults.io,d=window.location.protocol;"file:"===d&&(d="http:");b.urlToObject=function(b){var d={},g=new a(b),
s=b.indexOf("?");null===g.query?d={path:b,query:null}:(d.path=b.substring(0,s),d.query=f.queryToObject(g.query));g.fragment&&(d.hash=g.fragment,null===g.query&&(d.path=d.path.substring(0,d.path.length-(g.fragment.length+1))));return d};b.getProxyUrl=function(a,d){var m=q.isString(a)?0===q.trim(a).toLowerCase().indexOf("https:"):a,s=g.proxyUrl,p,c,l=t.io.proxyNotSet;if(q.isString(a)&&(c=b.getProxyRule(a)))s=c.proxyUrl;if(!s)throw console.log(l),Error(l);m&&(!1!==d&&0!==window.location.href.toLowerCase().indexOf("https:"))&&
(m=s,0!==m.toLowerCase().indexOf("http")&&(m=b.getAbsoluteUrl(m)),m=m.replace(/^http:/i,"https:"),b.canUseXhr(m)&&(s=m,p=1));s=b.urlToObject(s);s._xo=p;return s};b.addProxy=function(a){var d=b.getProxyRule(a),m;d?m=b.urlToObject(d.proxyUrl):g.alwaysUseProxy&&(m=b.getProxyUrl());m&&(d=b.urlToObject(a),a=m.path+"?"+d.path,(m=f.objectToQuery(q.mixin(m.query||{},d.query)))&&(a+="?"+m));return a};b.addProxyRule=function(a){var d=a.urlPrefix=b.urlToObject(a.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,
"").toLowerCase(),m=g.proxyRules,s,p=m.length,c,l=p;for(s=0;s<p;s++)if(c=m[s].urlPrefix,0===d.indexOf(c)){if(d.length===c)return-1;l=s;break}else 0===c.indexOf(d)&&(l=s+1);m.splice(l,0,a);return l};b.getProxyRule=function(a){var d=g.proxyRules,m=d.length,s=b.urlToObject(a).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),p;for(a=0;a<m;a++)if(0===s.indexOf(d[a].urlPrefix)){p=d[a];break}return p};b.hasSameOrigin=function(b,d,g){b=b.toLowerCase();d=d.toLowerCase();var s=window.location.href.toLowerCase();
b=0===b.indexOf("http")?new a(b):s=new a(s);d=0===d.indexOf("http")?new a(d):q.isString(s)?new a(s):s;return(g||b.scheme===d.scheme)&&b.host===d.host&&b.port===d.port};b.canUseXhr=function(a,d){var m=r("esri-phonegap")?!0:!1,s=b.hasSameOrigin,p=g.corsEnabledServers,c,l=-1;!m&&(r("esri-cors")&&p&&p.length)&&(m=e.some(p,function(b,d){c=0!==q.trim(b).toLowerCase().indexOf("http");return s(a,c?"http://"+b:b)||c&&s(a,"https://"+b)?(l=d,!0):!1}));return d?l:m};b.getAbsoluteUrl=function(a){return q.isString(a)&&
!/^https?:\/\//i.test(a)?0===a.indexOf("//")?d+a:0===a.indexOf("/")?d+"//"+window.location.host+a:k._appBaseUrl+a:a};b.fixUrl=function(a){/^\/\//i.test(a)&&(a=d+a);return a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")};return b})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(q,e,a){return{_dfdCanceller:function(a){a.canceled=!0;var e=a._pendingDfd;-1===a.fired&&(e&&-1===e.fired)&&e.cancel();a._pendingDfd=null},_fixDfd:function(a){var e=a.then;a.then=
function(a,f,t){if(a){var b=a;a=function(a){return a&&a._argsArray?b.apply(null,a):b(a)}}return e.call(this,a,f,t)};return a},_resDfd:function(a,e,n){var r=e.length;1===r?n?a.errback(e[0]):a.callback(e[0]):1<r?(e._argsArray=!0,a.callback(e)):a.callback()}}})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(q,e,a,f,k,n){f=[-2.0037508342788905E7,2.0037508342788905E7];k=[-2.0037508342787E7,2.0037508342787E7];
return q(null,{declaredClass:"esri.SpatialReference",constructor:function(e){e&&(a.isObject(e)?a.mixin(this,e):a.isString(e)?this.wkt=e:this.wkid=e)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:f,origin:k,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:f,origin:k,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:f,origin:k,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:f,origin:k,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==e.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==e.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(a){var e=!1;a&&(e=this.isWebMercator()&&4326===a.wkid||a.isWebMercator()&&4326===this.wkid);return e},isWebMercator:function(){return this._isWebMercator()},equals:function(a){var e=!1;a&&(this===a&&
(e=!0),this.wkid||a.wkid?e=this.wkid===a.wkid||this.isWebMercator()&&a.isWebMercator()||this.wkid===a.latestWkid||a.wkid===this.latestWkid:this.wkt&&a.wkt&&(e=this.wkt.toUpperCase()===a.wkt.toUpperCase()));return e},toJson:function(){var a=null,e=n.isDefined;e(this.wkid)?a={wkid:this.wkid}:e(this.wkt)&&(a={wkt:this.wkt});a&&e(this.latestWkid)&&(a.latestWkid=this.latestWkid);return a}})})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x){var y={up:"panUp",right:"panRight",down:"panDown",left:"panLeft"},B={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},z=f.connect,D=f.disconnect,E=h.create,A=m.set,G=k.hitch,C=u.getMarginBox,H=e.deprecated,I=k.mixin,L=0;return a(v,{declaredClass:"esri.Map",constructor:function(c,a){I(this,{_slider:null,_navDiv:null,_mapParams:I({attributionWidth:0.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",
sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},a||{})});I(this,{isDoubleClickZoom:!1,isShiftDoubleClickZoom:!1,isClickRecenter:!1,isScrollWheelZoom:!1,isPan:!1,isRubberBandZoom:!1,isKeyboardNavigation:!1,isPanArrows:!1,isZoomSlider:!1});k.isFunction(p._css)&&(p._css=p._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);var d=l("esri-transforms")&&l("esri-transitions");this.navigationMode=this._mapParams.navigationMode||d&&"css-transforms"||
"classic";"css-transforms"===this.navigationMode&&!d&&(this.navigationMode="classic");this.fadeOnZoom=w.isDefined(this._mapParams.fadeOnZoom)?this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode;"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1);this.setMapCursor("default");this.smartNavigation=a&&a.smartNavigation;if(!w.isDefined(this.smartNavigation)&&l("mac")&&!l("esri-touch")&&!l("esri-pointer")&&!(3.5>=l("ff"))){var g=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);
g&&(w.isDefined(g[1])&&w.isDefined(g[3]))&&(d=parseInt(g[1],10),g=parseInt(g[3],10),this.smartNavigation=10<d||10===d&&6<=g)}this.showAttribution=w.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=z(this,"onLoad",this,"_onLoadInitNavsHandler");var h=E("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(d=k.getObject("esri.dijit.Attribution",!1))this._initAttribution(d,h);else{var m=
L++,s=this;this._rids&&this._rids.push(m);q(["./dijit/Attribution"],function(c){var a=s._rids?n.indexOf(s._rids,m):-1;-1!==a&&(s._rids.splice(a,1),s._initAttribution(c,h))})}this._mapParams.logo&&(d={},6===l("ie")&&(d.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+q.toUrl("./images/map/logo-med.png")+"')"),this._ogol=E("div",{style:d},h),this._setLogoSize(),this._onMapResizeLogo_connect=z(this,"onResize",this,"_setLogoSize"),l("esri-touch")||
(this._ogol_connect=z(this._ogol,"onclick",this,"_openLogoLink")));this.navigationManager=new x(this);a&&a.basemap&&(this._onLoadFix=!0,this.setBasemap(a.basemap),this._onLoadFix=!1);if(this.autoResize=this._mapParams.autoResize)d=this._getEnclosingResizableWidget(this.container)||window,g=G(this,this.resize),this._rszSignal=t.pausable(d,"resize",g),this._oriSignal=t.pausable(window,"orientationchange",g),b.after(d,"resize",g,!0)},_getEnclosingResizableWidget:function(c){var a=s.getEnclosingWidget(c);
return!a?a:a.resize?a:this._getEnclosingResizableWidget(c.parentNode)},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(d.remove(this._ogol,"logo-med"),d.add(this._ogol,"logo-sm")):(d.remove(this._ogol,"logo-sm"),d.add(this._ogol,"logo-med")))},_initAttribution:function(c,a){var b=E("span",{"class":"esriAttribution"},a,"first");A(b,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(z(b,"onclick",function(){d.contains(this,
"esriAttributionOpen")?d.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&d.add(this,"esriAttributionOpen")}));this.attribution=new c({map:this},b)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var c=this._slider;c&&(c.destroy&&!c._destroyed)&&c.destroy();var c=this._navDiv,a=this.attribution;c&&h.destroy(c);a&&a.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);n.forEach(this._connects,D);
this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(c){var a=this.getLevel();return!this.__tileInfo||!(a===this.getMinZoom()&&0>c||a===this.getMaxZoom()&&0<c)},_onLoadInitNavsHandler:function(){this.enableMapNavigation();this._createNav();if("small"===this._mapParams.sliderStyle||!this._createSlider)this._createSimpleSlider();
else if(this._mapParams.slider){var c=-1!==this._getSliderClass(!0).indexOf("Horizontal"),c=[c?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",c?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",c?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];if(n.some(c,function(c){return!k.getObject(c,!1)})){var c=n.map(c,function(c){return c.replace(/\./g,"/")}),a=L++,b=this;this._rids&&this._rids.push(a);q(c,function(){var c=b._rids?n.indexOf(b._rids,a):-1;-1!==c&&(b._rids.splice(c,
1),b._createSlider.apply(b,arguments))})}else c=n.map(c,function(c){return k.getObject(c,!1)}),this._createSlider.apply(this,c)}D(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var c,a,b,l=d.add,g=this.id;this._navDiv=E("div",{id:g+"_navdiv"},this.root);l(this._navDiv,"navDiv");var h=this.width/2,p=this.height/2,m;for(b in y)a=y[b],c=E("div",{id:g+"_pan_"+b},this._navDiv),l(c,"fixedPan "+a),"up"===b||"down"===b?(m=parseInt(C(c).w,10)/2,A(c,{left:h-m+"px",zIndex:30})):
(m=parseInt(C(c).h,10)/2,A(c,{top:p-m+"px",zIndex:30})),this._connects.push(z(c,"onclick",G(this,this[a])));this._onMapResizeNavHandler_connect=z(this,"onResize",this,"_onMapResizeNavHandler");for(b in B)a=B[b],c=E("div",{id:g+"_pan_"+b,style:{zIndex:30}},this._navDiv),l(c,"fixedPan "+a),this._connects.push(z(c,"onclick",G(this,this[a])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(c,a,b){c=this.id;a/=2;b/=2;var d=g.byId,l,h,p;for(l in y)h=d(c+"_pan_"+l),"up"===l||"down"===l?(p=parseInt(C(h).w,
10)/2,A(h,"left",a-p+"px")):(p=parseInt(C(h).h,10)/2,A(h,"top",b-p+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var c=this._slider=E("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),a=l("esri-touch")&&!l("ff")?"touchstart":l("esri-pointer")?navigator.msPointerEnabled?"MSPointerDown":"pointerdown":"onclick",b=E("div",{"class":"esriSimpleSliderIncrementButton"},c),h=E("div",{"class":"esriSimpleSliderDecrementButton"},c);this._incButton=b;this._decButton=
h;this._simpleSliderZoomHandler(null,null,null,this.getLevel());b.innerHTML="\x3cspan\x3e+\x3c/span\x3e";h.innerHTML="\x3cspan\x3e\x26ndash;\x3c/span\x3e";8>l("ie")&&d.add(h,"dj_ie67Fix");this._connects.push(z(b,a,this,this._simpleSliderChangeHandler));this._connects.push(z(h,a,this,this._simpleSliderChangeHandler));"touchstart"==a&&(this._connects.push(z(b,"onclick",this,this._simpleSliderChangeHandler)),this._connects.push(z(h,"onclick",this,this._simpleSliderChangeHandler)));(-1<this.getMaxZoom()||
-1<this.getMinZoom())&&this._connects.push(z(this,"onZoomEnd",this,this._simpleSliderZoomHandler));10>l("ie")&&g.setSelectable(c,!1);this.root.appendChild(c);this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(c){r.stop(c);c=-1!==c.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:c?1:-1})},_simpleSliderZoomHandler:function(c,a,b,l){var g;c=this._incButton;a=this._decButton;-1<l&&l===this.getMaxZoom()?g=c:-1<l&&l===this.getMinZoom()&&(g=a);g?(d.add(g,"esriSimpleSliderDisabledButton"),
d.remove(g===c?a:c,"esriSimpleSliderDisabledButton")):(d.remove(c,"esriSimpleSliderDisabledButton"),d.remove(a,"esriSimpleSliderDisabledButton"))},_getSliderClass:function(c){c=c?"Large":"Simple";var a=this._mapParams.sliderOrientation,b=this._mapParams.sliderPosition||"",a=a&&"horizontal"===a.toLowerCase()?"esri"+c+"SliderHorizontal":"esri"+c+"SliderVertical";if(b)switch(b.toLowerCase()){case "top-left":b="esri"+c+"SliderTL";break;case "top-right":b="esri"+c+"SliderTR";break;case "bottom-left":b=
"esri"+c+"SliderBL";break;case "bottom-right":b="esri"+c+"SliderBR"}return"esri"+c+"Slider "+a+" "+b},_createSlider:function(a,b,d){if(this._mapParams.slider){var g=E("div",{id:this.id+"_zoom_slider"},this.root),h=c.defaults.map,p=this._getSliderClass(!0),m=-1!==p.indexOf("Horizontal"),s=this.getNumLevels();if(0<s){var u,e,w=this._mapParams.sliderLabels,v=!!w;if(h=!1!==w){var f=m?"bottomDecoration":"rightDecoration";if(!w){w=[];for(m=0;m<s;m++)w[m]=""}n.forEach([{"class":"esriLargeSliderTicks",container:f,
count:s,dijitClass:b},{"class":v&&"esriLargeSliderLabels",container:f,count:s,labels:w,dijitClass:d}],function(c){var a=E("div"),d=c.dijitClass;delete c.dijitClass;g.appendChild(a);d===b?u=new d(c,a):e=new d(c,a)})}a=this._slider=new a({id:g.id,"class":p,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),discreteValues:s,value:this.getLevel(),clickSelect:!0,intermediateChanges:!0,style:"z-index:30;"},g);a.startup();h&&(u.startup(),e.startup());this._slider_connect=z(a,"onChange",this,"_onSliderChangeHandler");
this._connects.push(z(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(z(a._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{a=this._slider=new a({id:g.id,"class":p,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:h.sliderChangeImmediate,style:"height:50px; z-index:30;"},g);d=a.domNode.firstChild.childNodes;for(m=1;3>=m;m++)A(d[m],"visibility","hidden");a.startup();this._slider_connect=z(a,"onChange",this,"_onDynSliderChangeHandler");
this._connects.push(z(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}d=a.decrementButton;a.incrementButton.style.outline="none";d.style.outline="none";a.sliderHandle.style.outline="none";a._onKeyPress=function(){};if(a=a._movable){var y=a.onMouseDown;a.onMouseDown=function(c){9>l("ie")&&1!==c.button||y.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){D(this._slider_connect);D(this._slidermovestop_connect);this._slider_connect=z(this._slider,"onChange",
this,"_onSliderChangeDragHandler");this._slidermovestop_connect=z(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(c){this._extentUtil({targetLevel:c})},_onSliderMoveEndHandler:function(){D(this._slider_connect);D(this._slidermovestop_connect)},_onSliderChangeHandler:function(c){this.setLevel(c)},_updateSliderValue:function(c,a){D(this._slider_connect);var b=this._slider,d=b._onChangeActive;b._onChangeActive=!1;b.set("value",c);b._onChangeActive=
d;this._slider_connect=z(b,"onChange",this,a)},_onExtentChangeSliderHandler:function(c,a,b,d){D(this._slidermovestop_connect);this._updateSliderValue(d.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(c){this._extentUtil({numLevels:0<c?1:-1})},_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(a){window.open(c.defaults.map.logoLink,"_blank");r.stop(a)},enableMapNavigation:function(){this.navigationManager.enableNavigation()},
disableMapNavigation:function(){this.navigationManager.disableNavigation()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.navigationManager.enableDoubleClickZoom(),this.isDoubleClickZoom=!0)},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&(this.navigationManager.disableDoubleClickZoom(),this.isDoubleClickZoom=!1)},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(H(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",
null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(H(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!1)},enableClickRecenter:function(){this.isClickRecenter||(this.navigationManager.enableClickRecenter(),this.isClickRecenter=
!0)},disableClickRecenter:function(){this.isClickRecenter&&(this.navigationManager.disableClickRecenter(),this.isClickRecenter=!1)},enablePan:function(){this.isPan||(this.navigationManager.enablePan(),this.isPan=!0)},disablePan:function(){this.isPan&&(this.navigationManager.disablePan(),this.isPan=!1)},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.navigationManager.enableRubberBandZoom(),this.isRubberBandZoom=!0)},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.navigationManager.disableRubberBandZoom(),
this.isRubberBandZoom=!1)},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.navigationManager.enableKeyboardNavigation(),this.isKeyboardNavigation=!0)},disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.navigationManager.disableKeyboardNavigation(),this.isKeyboardNavigation=!1)},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&
(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display="none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&(A(this._slider.domNode||this._slider,"visibility","visible"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(A(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=
!1)}})})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(q,e,a){var f={},k={},n={length:0,add:function(a){if(k[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");k[a.id]=a;this.length++},remove:function(a){k[a]&&(delete k[a],this.length--)},byId:function(a){return"string"==typeof a?k[a]:a},byNode:function(a){return k[a.getAttribute("widgetId")]},toArray:function(){var a=[],e;for(e in k)a.push(k[e]);
return a},getUniqueId:function(e){var n;do n=e+"_"+(e in f?++f[e]:f[e]=0);while(k[n]);return"dijit"==a._scopeName?n:a._scopeName+"_"+n},findWidgets:function(a,e){function b(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType){var h=a.getAttribute("widgetId");h?(h=k[h])&&g.push(h):a!==e&&b(a)}}var g=[];b(a);return g},_destroyAll:function(){a._curFocus=null;a._prevFocus=null;a._activeStack=[];q.forEach(n.findWidgets(e.body()),function(a){a._destroyed||(a.destroyRecursive?a.destroyRecursive():a.destroy&&
a.destroy())})},getEnclosingWidget:function(a){for(;a;){var e=1==a.nodeType&&a.getAttribute("widgetId");if(e)return k[e];a=a.parentNode}return null},_hash:k};return a.registry=n})},"dijit/main":function(){define(["dojo/_base/kernel"],function(q){return q.dijit})},"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./PluginTarget ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z,D,E,A,G,C,H,I,L,J,F,N,M,K,P,Q,R,ba,S,U){function O(c,a){var b=c.lods;b.sort(function(c,a){return c.scale>a.scale?-1:c.scale<a.scale?1:0});var d=[],b=t.filter(b,function(c){if(-1===T(d,c.scale))return d.push(c.scale),!0}),l=a.lods=[],g;t.forEach(b,function(c,a){g=l[a]=new Q(c);g.level=a});a.tileInfo=new P(ea(c,{lods:l}))}var W,aa=N.toMapPoint,V=N.toScreenPoint,Y=k.connect,Z=k.disconnect,X=r.hitch,$=p.set,T=t.indexOf,ea=r.mixin,ga=0,da=x.defaults.map,
ha=da.layerNamePrefix,ja=da.graphicsLayerNamePrefix,ka=RegExp("^"+ha+"(\\d+)$"),ma=RegExp("^"+ja+"(\\d+)$"),la=function(){};return f([z,G],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(c,a){var b=this;this.registerConnectEvents();ea(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var p=this.container=d.byId(c),e=this.id=h.get(p,"id")||l.getUniqueId(this.declaredClass);u.add(p,"map");var w=s.getContentBox(p),v=u.add,f=m.create;this.position=new H(0,0);this._reposition();var y=this.width=w.w||da.width,n=this.height=w.h||da.height;
0===w.w&&$(p,"width",y+"px");0===w.h&&$(p,"height",n+"px");var k=this.root=f("div",{id:e+"_root",style:{width:y+"px",height:n+"px",direction:"ltr"}});v(k,"container");w=this.__container=f("div",{id:e+"_container"},k);$(w,"position","absolute");v(w,"container");p.appendChild(k);p=this._params=ea({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},a||{});this.wrapAround180=
p.wrapAround180;this.optimizePanAnimation=p.optimizePanAnimation;B.isDefined(p.resizeDelay)&&(this.resizeDelay=p.resizeDelay);p.lods&&(O({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:p.lods},p),this.__tileInfo=p.tileInfo);this.extent=p.extent;this._extentUtil({mapCenter:p.center,targetLevel:p.zoom,targetScale:p.scale});this.__visibleRect=new L(0,0,y,n);this.__visibleDelta=new L(0,0,y,n);e=this._layersDiv=f("div",{id:e+"_layers"});
v(e,"layersDiv");w.appendChild(e);this._zoomAnimDiv=f("div",{style:{position:"absolute"}});p.infoWindow?this.infoWindow=p.infoWindow:(v=this.infoWindow=new U(p.popupOptions,f("div")),v.startup(),v._ootb=!0,$(v.domNode,"zIndex",40));p.showLabels&&(q(["./layers/LabelLayer"],function(c){W=c;b._createLabelLayer()}),this.on("load",function(){b._createLabelLayer()}));this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:p.showInfoWindowOnClick});this._zoomStartHandler=X(this,this._zoomStartHandler);
this._zoomingHandler=X(this,this._zoomingHandler);this._zoomEndHandler=X(this,this._zoomEndHandler);this._panningHandler=X(this,this._panningHandler);this._panEndHandler=X(this,this._panEndHandler);this._endTranslate=X(this,this._endTranslate);g.addOnWindowUnload(this,this.destroy)},_getAbsMid:function(c){return q.toAbsMid?q.toAbsMid(c):e.id.replace(/\/[^\/]*$/ig,"/")+c},_cleanUp:function(){var c=this.infoWindow;c&&(c._ootb&&c.destroy?c.destroy():c.unsetMap(this),delete this.infoWindow);Z(this._tsTimeExtentChange_connect);
this.removePlugin("./plugins/popupManager");m.destroy(this.root);this.root=null},_addLayer:function(c,a,b){if(c.id){var d=c.id.match(c instanceof K?ma:ka);d&&d[1]&&(d=Number(d[1]),ga<=d&&(ga=d+1))}var l=c.id||(c instanceof K?ja:ha)+ga++;c.id=l;this._layers[l]=c;var g,h;if(a===this.layerIds||a===this.graphicsLayerIds)g=this._layerSize,this._layerSize++;c._isRefLayer="top"===b;b=!B.isDefined(b)||0>b||b>a.length||"top"===b?a.length:b;0===g&&(this._firstLayerId=l);if(!c._isRefLayer)for(;(h=this.getLayer(a[b-
1]))&&h._isRefLayer;)b--;a.splice(b,0,l);var p=X(this,this._addLayerHandler),m=this;b=this._connects;d=function(){c.loaded?m._onLoadFix?(m._onLoadFix=!1,setTimeout(function(){p(c)},0)):p(c):(m["_"+l+"_addtoken_load"]=Y(c,"onLoad",m,"_addLayerHandler"),m["_"+l+"_addtoken_err"]=Y(c,"onError",m,function(b){p(c,b,a)}))};this.loaded||0===g||c.loaded&&-1===T(this.graphicsLayerIds,l)?d():b.push(Y(this,"onLoad",d));return c},_addLayerHandler:function(c,a,b){var d=this.id,l=c.id,g=T(c instanceof K?this.graphicsLayerIds:
this.layerIds,l),h=g,p=!1,m=this._params;Z(this["_"+l+"_addtoken_load"]);Z(this["_"+l+"_addtoken_err"]);if(a)delete this._layers[l],-1!==g&&(b.splice(g,1),this.onLayerAddResult(c,a));else{-1===g&&(g=T(this._internalLayerIds,l),h=20+g,p=!0);if(l===this._firstLayerId){a=c.spatialReference;if((b=this.extent&&this.extent.spatialReference)&&!b.equals(a)&&(c.tileInfo||!c.url))b=null;b=this.spatialReference=b||a;this.wrapAround180=this.wrapAround180&&b&&b._isWrappable()?!0:!1;c.tileInfo&&(this.__tileInfo?
(a=this.__tileInfo.lods,this.__tileInfo=ea({},c.tileInfo),this.__tileInfo.lods=a):(O(ea({},c.tileInfo),m),this.__tileInfo=m.tileInfo));if(this.wrapAround180){a=this.__tileInfo;b=b._getInfo();if(!a||Math.abs(b.origin[0]-a.origin.x)>b.dx)this.wrapAround180=!1;this.wrapAround180&&a&&A._addFrameInfo(a,b)}m.units=c.units;if((a=this.__tileInfo&&this.__tileInfo.lods)&&a.length){b=m.minScale;var g=m.maxScale,s=-1,u=-1,e=!1,w=!1,v;for(v=0;v<a.length;v++)0<b&&(!e&&b>=a[v].scale)&&(s=a[v].level,e=!0),0<g&&(!w&&
g>=a[v].scale)&&(u=0<v?a[v-1].level:-1,w=!0);-1===m.minZoom&&(m.minZoom=0===b?a[0].level:s);-1===m.maxZoom&&(m.maxZoom=0===g?a[a.length-1].level:u);for(v=0;v<a.length;v++)m.minZoom===a[v].level&&(m.minScale=a[v].scale),m.maxZoom===a[v].level&&(m.maxScale=a[v].scale)}else m.minZoom=m.maxZoom=m.zoom=-1}c instanceof K?(this._gc||(this._gc=new K._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=d+"_gc"),h=c._setMap(this,this._gc._surface),h.id=d+"_"+l,this._layerDivs[l]=h,this._reorderLayers(this.graphicsLayerIds)):
(h=c._setMap(this,this._layersDiv,h,this.__LOD),h.id=d+"_"+l,this._layerDivs[l]=h,this._reorderLayers(this.layerIds),!p&&-1!==c.declaredClass.indexOf("VETiledLayer")&&this._onBingLayerAdd(c));l===this._firstLayerId&&(this.graphics=new K({id:d+"_graphics",displayOnPan:m.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20));if(c===this.graphics){b=this._layers[this._firstLayerId];d=m.zoom;h=m.scale;a=m.center;b=b.initialExtent||b.fullExtent;this._firstLayerId=null;this.extent&&
(this.extent=this._convertGeometry(this,this.extent));!this.extent&&b&&(a&&(a=this._convertGeometry(b,a)),a&&(b=b.centerAt(a)));if(a=this.extent||b&&new I(b.toJson()))-1<d?a=this.__getExtentForLevel(d,null,a).extent:0<h&&(a=F.getExtentForScale(this,h,a));if(!a){console.log("Map: "+this.invalidExtent);return}d=this._fixExtent(a,m.fitExtent);this.extent=d.extent;this.__LOD=d.lod;this.__setExtent(this.extent,null,null,m.fitExtent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);
this.onLoad(this)}p||(this.onLayerAdd(c),this.onLayerAddResult(c));Z(this[l+"_addLayerHandler_connect"])}},_convertGeometry:function(c,a){var b=c&&c.spatialReference,d=a&&a.spatialReference;b&&(d&&!b.equals(d))&&(b._canProject(d)?b.isWebMercator()?a=M.geographicToWebMercator(a):4326===b.wkid&&(a=M.webMercatorToGeographic(a,!0)):(console.log("Map: "+B.substitute({geometry:d.wkid||d.wkt,map:b.wkid||b.wkt},this.invalidGeometry)),a=null));return a},_reorderLayers:function(a){var b=this.onLayerReorder,
d=m.place,l=this._layerDivs,g=this._layers,h=this._gc?this._gc._surface.getEventSource():null;if(a===this.graphicsLayerIds)t.forEach(a,function(c,a){var p=l[c];p&&(d(p.getEventSource(),h,a),b(g[c],a))});else{var p=this.graphics,s=p?p.id:null,u=this._layersDiv,e;t.forEach(a,function(c,a){e=l[c];c!==s&&e&&(d(e,u,a),b(g[c],a))});this._mapImageLyr&&this._placeMapImageLyr();h&&(h=9>c("ie")?h.parentNode:h,d(h,h.parentNode,a.length))}this.onLayersReordered([].concat(a))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,
this._zoomAnimDiv.anchor)},_zoomingHandler:function(c){var a=parseFloat(c.left),b=parseFloat(c.top);c=new I(a,b-parseFloat(c.height),a+parseFloat(c.width),b,this.spatialReference);a=this.extent.getWidth()/c.getWidth();this.__zoom(c,a,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var c=this._zoomAnimDiv,a=c.extent,b=this.extent.getWidth()/a.getWidth(),d=c.anchor,l=c.newLod,g=c.levelChange;c.extent=c.anchor=c.levelChange=c.startingExtent=c.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(a,
b,d,l,g)},_panningHandler:function(c){if(isNaN(parseFloat(c.left))||isNaN(parseFloat(c.top))){var a=Math.round,b=this._panAnim.node;c.left=-1*(this._delta.x-a(this.width/2))+"px";c.top=-1*(this._delta.y-a(this.height/2))+"px";p.set(b,"left",c.left);p.set(b,"top",c.top)}c=new H(parseFloat(c.left),parseFloat(c.top));a=this.toMap(c);this.onPan(this.extent.offset(this.extent.xmin-a.x,this.extent.ymax-a.y),c)},_panEndHandler:function(c){this.__panning=!1;var a=Math.round;c=new H(-a(parseFloat(c.style.left)),
-a(parseFloat(c.style.top)));var a=c.x,b=c.y,d=this.__visibleRect,l=this.__visibleDelta;d.x+=-a;d.y+=-b;l.x+=-a;l.y+=-b;$(this._zoomAnimDiv,{left:"0px",top:"0px"});var d=this.extent,l=this._ratioW,g=this._ratioH,d=new I(d.xmin+a/l,d.ymin-b/g,d.xmax+a/l,d.ymax-b/g,this.spatialReference);c.setX(-c.x);c.setY(-c.y);this._delta=this._panAnim=null;this._updateExtent(d);this.onPanEnd(d,c);this._fireExtChg([d,c,!1,this.__LOD])},_fixExtent:function(c,a){for(var b=this._reshapeExtent(c),d=1.25;!0===a&&(b.extent.getWidth()<
c.getWidth()||b.extent.getHeight()<c.getHeight())&&0<b.lod.level&&3>=d;)b=this._reshapeExtent(c.expand(d)),d+=0.25;return b},_getFrameWidth:function(){var c=-1,a=this.spatialReference._getInfo();this.__LOD?(a=this.__LOD._frameInfo)&&(c=a[3]):a&&(c=Math.round(2*a.valid[1]/(this.extent.getWidth()/this.width)));return c},_fixAspectRatio:function(c){var a=c.getWidth(),b=c.getHeight(),d=a/b,l=this.width/this.height,g=0,h=0;this.width>this.height?a>b?l>d?g=b*l-a:h=a/l-b:g=b*l-a:this.width<this.height?a<
b?l>d?g=b*l-a:h=a/l-b:h=a/l-b:a<b?g=b-a:a>b&&(h=a/l-b);g&&(c.xmin-=g/2,c.xmax+=g/2);h&&(c.ymin-=h/2,c.ymax+=h/2);return c},_reshapeExtent:function(c){c=this._fixAspectRatio(c);return this._getAdjustedExtent(c)},_getAdjustedExtent:function(c){if(this.__tileInfo)return A.getCandidateTileInfo(this,this.__tileInfo,c);var a=F.getScale(this,c),b=this.getMinScale(),d=this.getMaxScale(),l=!d||a>=d;b&&!(a<=b)?c=F.getExtentForScale(this,b,c):l||(c=F.getExtentForScale(this,d,c));return{extent:c}},_onBingLayerAdd:function(c){this["__"+
c.id+"_vis_connect"]=k.connect(c,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(c.visible)},_onBingLayerRemove:function(c){k.disconnect(this["__"+c.id+"_vis_connect"]);delete this["__"+c.id+"_vis_connect"];var a=t.some(this.layerIds,function(a){return(c=this._layers[a])&&c.visible&&-1!==c.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(a)},_toggleBingLogo:function(a){a&&!this._bingLogo?(a={left:this._mapParams&&this._mapParams.nav?"25px":""},6===c("ie")&&(a.filter=
"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+q.toUrl("./images/map/bing-logo-lg.png")+"')"),a=this._bingLogo=m.create("div",{style:a},this.root),u.add(a,"bingLogo-lg")):!a&&this._bingLogo&&(m.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(c,a){var b=this._zoomAnim,d=this._panAnim;if(b&&b._active)b.stop(),b._fire("onEnd",[b.node]);else if(d&&d._active){d.stop();this._panAnim=null;var d=d.curve.getValue(d._getStep()),b=
Math.round(parseFloat(d.left)),d=Math.round(parseFloat(d.top)),l=this.navigationManager._dragOrigin;this.__pan(b,d);l&&(l.x-=b,l.y-=d);return}this.__panning=!0;this.onPanStart(this.extent,new H(c,a))},__pan:function(c,a){var b=this.extent,d=this._ratioW,l=this._ratioH;this.onPan(new I(b.xmin-c/d,b.ymin+a/l,b.xmax-c/d,b.ymax+a/l,this.spatialReference),new H(c,a))},__panEnd:function(c,a){var b=this.__visibleRect,d=this.__visibleDelta;b.x+=c;b.y+=a;d.x+=c;d.y+=a;var b=new H(c,a),d=this.extent,l=this._ratioW,
g=this._ratioH,d=new I(d.xmin-c/l,d.ymin+a/g,d.xmax-c/l,d.ymax+a/g,this.spatialReference);this.__panning=!1;this._updateExtent(d);this.onPanEnd(d,b);this._fireExtChg([d,b,!1,this.__LOD])},__zoomStart:function(c,a){this.__zooming=!0;this.onZoomStart(c,1,a,this.__LOD?this.__LOD.level:null)},__zoom:function(c,a,b){this.onZoom(c,a,b)},__zoomEnd:function(c,a,b,d,l){$(this._layersDiv,{left:"0px",top:"0px"});this._delta=new H(0,0);this.__visibleRect.x=this.__visibleRect.y=0;c=new I(c);this.__LOD=d;this._ratioW=
this.width/c.getWidth();this._ratioH=this.height/c.getHeight();var g=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(c,l);this.onZoomEnd(c,a,b,d?d.level:null);this._fireExtChg([c,g,l,d])},_extentUtil:function(c,a,b,d,l){var g=new n,h,p,m,s,u,e,w,v,f,y,k=this.width,x=this.height,t,z,A;c&&(h=c.numLevels,p=c.targetLevel,t=B.isDefined(p),m=c.factor,s=c.mapAnchor,u=c.screenAnchor,e=c.mapCenter,z=c.levelOrFactor,w=c.targetScale,v=B.isDefined(w)&&0<w);a&&(f=a.dx,y=a.dy,e=a.mapCenter);r.isArray(e)&&
(e=new C(e));var D=this._panAnim;a=(c=this._stopAnim())?c.divExtent:this.extent;var q=this.__tileInfo,G=this._params;if(!this.loaded){if(b)a&&(b=this._convertGeometry(a,b)),b&&(this.extent=b,G.zoom=G.scale=-1,G.center=null);else if(e||t||v){if(e)if(a){if(e=this._convertGeometry(a,e))this.extent=a.centerAt(e),G.center=null}else G.center=e;t&&-1<p?(G.zoom=p,G.scale=-1):v&&(G.scale=w,G.zoom=-1)}g.resolve();return g}if(e&&(e=this._convertGeometry(this,e),!e)||s&&(s=this._convertGeometry(this,s),!s)||
b&&(b=this._convertGeometry(this,b),!b))return g.reject(),g;D&&(s&&u)&&(s=aa(this.extent,k,x,u));c&&(s&&u)&&(s=aa(c.divExtent,k,x,u));t&&(q?(h=this.getMinZoom(),t=this.getMaxZoom(),p<h?p=h:p>t&&(p=t),h=p-(c?c.level:this.getLevel())):(h=0<p?-1:1,A=z?p:null));if(!b)if(B.isDefined(h))q?(k=c?c.level:this.getLevel(),x=this.__getExtentForLevel(k+h,e,a).extent):(x=(c?c.end:this.extent).expand(A||(0<h?0.5*h:2*-h)),A&&e&&(x=x.centerAt(e))),x&&(e?b=x:(k=s||a.getCenter(),f=a.ymax-(x.getHeight()-a.getHeight())*
(k.y-a.ymax)/a.getHeight(),k=a.xmin-(x.getWidth()-a.getWidth())*(k.x-a.xmin)/a.getWidth(),b=new I(k,f-x.getHeight(),k+x.getWidth(),f,this.spatialReference)));else if(v)b=F.getExtentForScale(this,w,a);else if(B.isDefined(m))b=a.expand(m);else if(f||y)c?(b=c.end,s=b.getCenter(),A=V(b,k,x,s),A.x+=f,A.y+=y,A=aa(b,k,x,A),b=b.offset(A.x-s.x,A.y-s.y)):(f=new H(k/2+f,x/2+y),y=aa(a,k,x,f),x=a.getWidth(),f=a.getHeight(),k=y.x-x/2,y=y.y-f/2,b=new I(k,y,k+x,y+f,this.spatialReference));b||(e?(a=c?c.end:a,x=a.getWidth(),
f=a.getHeight(),k=e.x-x/2,y=e.y-f/2,b=new I(k,y,k+x,y+f,this.spatialReference)):c&&(b=c.end));b?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,la),this._extentDfd.reject()),this._extentDfd=g,this.__setExtent(b,null,u,d,c,l)):g.reject();return g},__setExtent:function(c,a,b,d,l,g){try{if(this._firstLayerId)this.extent=c;else{var h=!0,p=this.spatialReference,m=l?l.divExtent:this.extent,s=this._fixExtent(c,d||!1);c=s.extent;var e=c.getWidth(),u=c.getHeight(),w=Math.round;if(m)var v=
w(1E6*m.getWidth()),f=w(1E6*e),y=w(1E6*m.getHeight()),k=w(1E6*u),h=v!==f||y!==k;var n,x,t=l&&l.rect,r=l&&l.divExtent;if(da.zoomDuration&&h&&m){r=r||new I(m);t=t||{left:m.xmin,top:m.ymax,width:m.getWidth(),height:m.getHeight()};x={left:c.xmin,top:c.ymax,width:e,height:u};var B=new C(c.xmin,c.ymax,p),z=new C(c.xmin,c.ymin,p),A=new C(this.extent.xmin,this.extent.ymax,p),q=new C(this.extent.xmin,this.extent.ymin,p);n=J.getLineIntersection(A,B,q,z,p);!n&&!l&&(h=!1)}this._ratioW=this.width/e;this._ratioH=
this.height/u;var G=this._zoomAnimDiv;if(h)$(this._layersDiv,{left:"0px",top:"0px"}),a=new H(0,0),this.__visibleRect.x=this.__visibleRect.y=0,t&&x?(this._delta=a,G.id="_zAD",G.startingExtent=r,G.extent=c,G.levelChange=h,G.newLod=s.lod,G.anchor=b?b:!n&&l?l.anchor:V(this.extent,this.width,this.height,n),this._zoomAnim=D.resize({node:G,start:t,end:x,duration:da.zoomDuration,rate:da.zoomRate,beforeBegin:!l?this._zoomStartHandler:null,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),
this._fireOnScale(this.extent.getWidth()/c.getWidth(),G.anchor)):(this._updateExtent(c,h),this._fireExtChg([this.extent,a,h,this.__LOD=s.lod]));else if(!this.__panning)if(!1===this.loaded||g)this._updateExtent(c,h),this._fireExtChg([this.extent,a,h,this.__LOD=s.lod]);else{this.__panning=!0;t=(new L(0,0,this.width,this.height,this.spatialReference)).getCenter();t.x=w(t.x);t.y=w(t.y);var E=this._delta=this.toScreen(c.getCenter()),F=Math.abs(t.x-E.x),ea=Math.abs(t.y-E.y);this.optimizePanAnimation&&(F>
2*this.width||ea>2*this.height)?(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,this._delta=null,this._updateExtent(c,!1),this.onPanEnd(this.extent,new H(0,0)),this._fireExtChg([this.extent,new H(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new H(0,0)),this._panAnim=D.slideTo({node:G,left:t.x-E.x,top:t.y-E.y,duration:da.panDuration,rate:da.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),
this._panAnim.play())}}}catch(N){console.log(N.stack),console.error(N)}},_fireOnScale:function(c,a,b){if("css-transforms"===this.navigationMode){var d=this.__visibleDelta;this.onScale(w.scaleAt(c,{x:-1*(this.width/2-(a.x-d.x)),y:-1*(this.height/2-(a.y-d.y))}),b)}},_stopAnim:function(){var c=this._zoomAnim,a=this._panAnim;if(c&&c._active){c.stop();var a=c.curve.getValue(c._getStep()),b=parseFloat(a.left),d=parseFloat(a.top),c=c.node;return{anchor:c.anchor,start:c.startingExtent,end:c.extent,level:c.newLod&&
c.newLod.level,rect:a,divExtent:new I(b,d-parseFloat(a.height),b+parseFloat(a.width),d,this.spatialReference)}}a&&a._active&&(a.stop(),a._fire("onEnd",[a.node]))},__getExtentForLevel:function(c,a,b){var d=this.__tileInfo,d=d&&d.lods;c=B.isDefined(c)?c:0;b=b||this.extent;a=a||b&&b.getCenter();if(d){if(a){b=this.getMinZoom();var l=this.getMaxZoom();c>l&&(c=l);c<b&&(c=b);c=d[c];d=this.width*c.resolution/2;b=this.height*c.resolution/2;return{extent:new I(a.x-d,a.y-b,a.x+d,a.y+b,a.spatialReference),lod:c}}}else if(b)return{extent:b.expand(!c||
1>c?1:c).centerAt(a)};console.log("Map: "+this.invalidExtent)},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var c=--this._jobs;c?0>c&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(c,a){this[c]&&this[c].apply(this,a)},_updateExtent:function(c,a){this.extent=c;a&&this._setClipRect();var b=this.spatialReference;b&&(b.isWebMercator()?this.geographicExtent=M.webMercatorToGeographic(this._getAvailExtent(),
!0):4326===b.wkid&&(this.geographicExtent=new I(this._getAvailExtent().toJson())))},_fireExtChg:function(c){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",c);if(c=this._extentDfd)delete this._extentDfd,c.resolve()},attr:function(c,a){var b=this.container;b&&(null==a?b.removeAttribute(c):b.setAttribute(c,a));return this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect()},onBeforeUnload:function(){},
onUnload:function(){},onExtentChange:function(c,a,b){},onTimeExtentChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},
onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),this.removeAllLayers(),this._cleanUp(),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(c){$(this.__container,"cursor",this.cursor=c)},setMapCursor:function(c){this.setCursor(this._cursor=c)},resetMapCursor:function(){this.setCursor(this._cursor)},setInfoWindow:function(c){var a=this.infoWindow;a&&a.unsetMap(this);this.infoWindow=c;this.loaded&&c&&c.setMap(this)},setInfoWindowOnClick:function(c){this._params.showInfoWindowOnClick=
c;this.popupManager&&this.popupManager.set("enabled",c)},getInfoWindowAnchor:function(c){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(c)||"upperright"},toScreen:function(c,a){return V(this.extent,this.width,this.height,c,a)},toMap:function(c){return aa(this.extent,this.width,this.height,c)},addLayer:function(c,a){c&&!this.getLayer(c.id)&&this._addLayer(c,c instanceof K?this.graphicsLayerIds:this.layerIds,a);return c},addLayers:function(c){var a=[],b=c.length,d,l,
g=c.length;d=k.connect(this,"onLayerAddResult",function(l,g){-1!==t.indexOf(c,l)&&(b--,a.push({layer:l,success:!g,error:g}),b||(k.disconnect(d),this.onLayersAddResult(a)))});for(l=0;l<g;l++)this.addLayer(c[l]);return this},removeLayer:function(c,a){var b=c.id,d=c instanceof K?this.graphicsLayerIds:this.layerIds,l=T(d,b);0<=l&&(d.splice(l,1),c instanceof K?(Z(this["_gl_"+c.id+"_click_connect"]),c.loaded&&c._unsetMap(this,this._gc._surface)):c.loaded&&(c._unsetMap(this,this._layersDiv),-1!==c.declaredClass.indexOf("VETiledLayer")&&
this._onBingLayerRemove(c)),delete this._layers[b],delete this._layerDivs[b],a||this._reorderLayers(d),this.onLayerRemove(c))},removeAllLayers:function(){var c=this.layerIds,a;for(a=c.length-1;0<=a;a--)this.removeLayer(this._layers[c[a]],1);c=this.graphicsLayerIds;for(a=c.length-1;0<=a;a--)this.removeLayer(this._layers[c[a]],1);this.onLayersRemoved()},reorderLayer:function(c,b){r.isString(c)&&(a.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",
null,"v2.0"),c=this.getLayer(c));var d=c.id,l,g=c instanceof K?this.graphicsLayerIds:this.layerIds;0>b?b=0:b>=g.length&&(b=g.length-1);l=T(g,d);-1===l||l===b||(g.splice(l,1),g.splice(b,0,d),this._reorderLayers(g))},getLayer:function(c){return this._layers[c]},setExtent:function(c,a){c=new I(c.toJson());var b=c.getWidth(),d=c.getHeight();return 0===b&&0===d?this.centerAt(new C({x:c.xmin,y:c.ymin,spatialReference:c.spatialReference&&c.spatialReference.toJson()})):this._extentUtil(null,null,c,a)},centerAt:function(c){return this._extentUtil(null,
{mapCenter:c})},centerAndZoom:function(c,a){return this._extentUtil({targetLevel:a,mapCenter:c,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:F.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*F.getUnitValueForSR(this.spatialReference)},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},
setScale:function(c){return this._extentUtil({targetScale:c})},getLayersVisibleAtScale:function(c){var a=[];(c=c||this.getScale())&&t.forEach(this.layerIds.concat(this.graphicsLayerIds),function(b){b=this.getLayer(b);b.isVisibleAtScale(c)&&a.push(b)},this);return a},getNumLevels:function(){var c=this.getMinZoom(),a=this.getMaxZoom();return c===a&&0>c?0:a-c+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(c){if(-1<c)return this._extentUtil({targetLevel:c})},getZoom:function(){return this.getLevel()},
setZoom:function(c){return this.setLevel(c)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(c){var a;r.isObject(c)?(a=c,c=a.title):a=y&&y[c];if(a){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var b=[],d=[],l=0;t.forEach(a.baseMapLayers||a.layers,function(a){var g,h={id:a.id,displayLevels:a.displayLevels,opacity:B.isDefined(a.opacity)?a.opacity:null,visible:B.isDefined(a.visibility)?a.visibility:
null};if(a.type)switch(a.type){case "OpenStreetMap":g=new S(h);break;default:console.log("Map.setBasemap: "+B.substitute({basemapName:c,type:a.type},this.unknownLayerType))}else{g=a.url;if("https:"===window.location.protocol&&(-1!==g.search(/^http\:\/\/server\.arcgisonline\.com/i)||-1!==g.search(/^http\:\/\/services\.arcgisonline\.com/i)||-1!==g.search(/^http\:\/\/.+\.arcgis\.com/i)))g=g.replace(/http:/i,"https:");g=new R(g,h)}g&&(b.push(g),d.push(a),a.isReference||l++)},this);if(!b.length||!l)console.log("Map.setBasemap: "+
B.substitute({basemapName:c},this.invalidBasemap));else{var g={basemapName:c,infos:d,layers:b};if(this.loaded){var h=this,p=new n(E._dfdCanceller),m=function(c){p._pendingLayers--;c=t.indexOf(g.layers,this);if(-1<c&&(c=p._layerEvents[c]))k.disconnect(c[0]),k.disconnect(c[1]);0>=p._pendingLayers&&(delete p._layerEvents,delete h._basemapDfd,0>p.fired&&p.callback(g))};this._basemapDfd=p;p._pendingLayers=0;p._layerEvents={};t.forEach(b,function(c,a){c&&(p._pendingLayers++,c.loaded?m(c):p._layerEvents[a]=
[k.connect(c,"onLoad",c,m),k.connect(c,"onError",c,m)])});p.addCallback(X(this,this._basemapLoaded))}else this._basemapLoaded(g)}}else{a=[];for(var s in y)a.push(s);console.log("Map.setBasemap: "+B.substitute({basemapName:c,list:a.join(",")},this.unknownBasemap))}},_basemapLoaded:function(c){var a=c.layers,b=c.infos,d=0,l=!0,g;this.loaded&&(t.forEach(a,function(c,a){c.loaded&&(b[a].isReference||d++)}),l=d);l&&(this.basemapLayerIds&&(g={basemapName:this._basemap,infos:y&&y[this._basemap]&&y[this._basemap].baseMapLayers},
g.basemapName||(t.forEach(this.basemapLayerIds,function(c){if(this.getLayer(c)instanceof S)return g.basemapName="osm",g.infos=y&&y.osm&&y.osm.baseMapLayers,!1},this),g.basemapName||(g=null))),this._removeBasemap(),this._basemap=c.basemapName,this.basemapLayerIds=this._addBasemap(a,b),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",{current:c,previous:g}))},_addBasemap:function(c,a){var b=[],d=[],l=0;t.forEach(c,function(c,g){a[g].isReference?b.push(c):(this.addLayer(c,l++),
d.push(c.id))},this);b.length&&t.forEach(b,function(c){this.addLayer(c,"top");d.push(c.id)},this);return d},_removeBasemap:function(){var c=this.basemapLayerIds,a;c&&c.length&&t.forEach(c,function(c){(a=this.getLayer(c))&&this.removeLayer(a)},this)},getBasemap:function(){return this._basemap||""},translate:function(c,a){c=c||0;a=a||0;if(!this._txTimer){this._tx=this._ty=0;var b=this.toScreen(this.extent.getCenter());this.__panStart(b.x,b.y)}this._tx+=c;this._ty+=a;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);
this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var c=this._tx,a=this._ty;this._tx=this._ty=0;this.__panEnd(c,a)},setTimeExtent:function(c){c=(this.timeExtent=c)?new c.constructor(c.toJson()):null;this.onTimeExtentChange(c)},setTimeSlider:function(c){this.timeSlider&&(Z(this._tsTimeExtentChange_connect),this.timeSlider=this._tsTimeExtentChange_connect=null);c&&(this.timeSlider=c,this.setTimeExtent(c.getCurrentTimeExtent()),
this._tsTimeExtentChange_connect=Y(c,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(c){if(this.visible!==c){this.visible=c;c||(this._display=this.container.style.display);this.container.style.display=c?this._display:"none";if(this.autoResize){var a=c?"resume":"pause";this._rszSignal[a]();this._oriSignal[a]()}c&&this.resize()}return this},resize:function(c){var a=this,b=function(){clearTimeout(a._resizeT);a.reposition();a._resize()};clearTimeout(a._resizeT);!0===c?b():a._resizeT=
setTimeout(b,a.resizeDelay)},_resize:function(){var c=this.width,a=this.height,b=s.getContentBox(this.container);if(!(c===b.w&&a===b.h)){var d=this._zoomAnim||this._panAnim;d&&(d.stop(),d._fire("onEnd",[d.node]));$(this.root,{width:(this.width=b.w)+"px",height:(this.height=b.h)+"px"});b=this.width;d=this.height;this.attribution&&this.attribution.domNode&&p.set(this.attribution.domNode,"maxWidth",Math.floor(b*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,
b,d);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,b,d);var l=new L(this.extent),c=(new L(l.x,l.y,l.width*(b/c),l.height*(d/a),this.spatialReference)).getExtent();this.onResize(c,b,d);this._extentUtil(null,null,c,null,!0)}},reposition:function(){this._reposition();this.onReposition(this.position.x,this.position.y)},_reposition:function(){var c=s.position(this.container,!0),a=s.getPadBorderExtents(this.container);this.position.update(c.x+a.l,c.y+a.t)},_setClipRect:function(){delete this._clip;
var a=7>=c("ie")||void 0===c("ie")&&7<=c("trident")?"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var b=this.width,d=this.height,l=this._getFrameWidth(),g=b-l;0<g&&(a=g/2,a="rect(0px,"+(a+l)+"px,"+d+"px,"+a+"px)",d=this.extent.getWidth(),b=d*(l/b),this._clip=[(d-b)/2,b])}$(this.__container,"clip",a)},_getAvailExtent:function(){var c=this.extent,a=this._clip;if(a){if(!c._clip){var b=new L(c);b.width=a[1];b.x+=a[0];c._clip=b.getExtent()}return c._clip}return c},_fixedPan:function(c,a){return this._extentUtil(null,
{dx:c,dy:a})},panUp:function(){return this._fixedPan(0,-0.75*this.height)},panUpperRight:function(){return this._fixedPan(0.75*this.width,-0.75*this.height)},panRight:function(){return this._fixedPan(0.75*this.width,0)},panLowerRight:function(){return this._fixedPan(0.75*this.width,0.75*this.height)},panDown:function(){return this._fixedPan(0,0.75*this.height)},panLowerLeft:function(){return this._fixedPan(-0.75*this.width,0.75*this.height)},panLeft:function(){return this._fixedPan(-0.75*this.width,
0)},panUpperLeft:function(){return this._fixedPan(-0.75*this.width,-0.75*this.height)},enableSnapping:function(c){c=c||{};if("esri.SnappingManager"===c.declaredClass)this.snappingManager=c;else{var a=ga++,b=this;this._rids&&this._rids.push(a);q(["./SnappingManager"],function(d){var l=b._rids?t.indexOf(b._rids,a):-1;-1!==l&&(b._rids.splice(l,1),b.snappingManager=new d(r.mixin({map:b},c)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();
this.snappingManager=null},_createLabelLayer:function(){function c(){a._labels.removeAllFeatureLayers();t.forEach(a.graphicsLayerIds,function(c){c=a.getLayer(c);"function"===typeof c.applyEdits&&a._labels.addFeatureLayer(c)})}var a=this;!this._labels&&(W&&this.loaded)&&(this._labels=new W({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),c(),this.on("layers-reordered",c))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new ba,this._mapImageLyr._setMap(this,
this._layersDiv),this._placeMapImageLyr());return this._mapImageLyr},_placeMapImageLyr:function(){for(var c=this.layerIds,a=this._layerDivs,b=!1,d,l,g=c.length-1;0<=g;g--)if(d=c[g],l=this.getLayer(d),d=a[d],l&&d&&!l._isReference){m.place(this._mapImageLyr._div,d,"after");b=!0;break}b||m.place(this._mapImageLyr._div,this._layersDiv,"first")}})})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(q,e){var a=q.matrix={},f={};a._degToRad=function(a){return f[a]||(f[a]=Math.PI*
a/180)};a._radToDeg=function(a){return 180*(a/Math.PI)};a.Matrix2D=function(f){if(f)if("number"==typeof f)this.xx=this.yy=f;else if(f instanceof Array){if(0<f.length){for(var n=a.normalize(f[0]),r=1;r<f.length;++r){var t=n,b=a.normalize(f[r]),n=new a.Matrix2D;n.xx=t.xx*b.xx+t.xy*b.yx;n.xy=t.xx*b.xy+t.xy*b.yy;n.yx=t.yx*b.xx+t.yy*b.yx;n.yy=t.yx*b.xy+t.yy*b.yy;n.dx=t.xx*b.dx+t.xy*b.dy+t.dx;n.dy=t.yx*b.dx+t.yy*b.dy+t.dy}e.mixin(this,n)}}else e.mixin(this,f)};e.extend(a.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,
dy:0});e.mixin(a,{identity:new a.Matrix2D,flipX:new a.Matrix2D({xx:-1}),flipY:new a.Matrix2D({yy:-1}),flipXY:new a.Matrix2D({xx:-1,yy:-1}),translate:function(e,f){return 1<arguments.length?new a.Matrix2D({dx:e,dy:f}):new a.Matrix2D({dx:e.x,dy:e.y})},scale:function(e,f){return 1<arguments.length?new a.Matrix2D({xx:e,yy:f}):"number"==typeof e?new a.Matrix2D({xx:e,yy:e}):new a.Matrix2D({xx:e.x,yy:e.y})},rotate:function(e){var f=Math.cos(e);e=Math.sin(e);return new a.Matrix2D({xx:f,xy:-e,yx:e,yy:f})},
rotateg:function(e){return a.rotate(a._degToRad(e))},skewX:function(e){return new a.Matrix2D({xy:Math.tan(e)})},skewXg:function(e){return a.skewX(a._degToRad(e))},skewY:function(e){return new a.Matrix2D({yx:Math.tan(e)})},skewYg:function(e){return a.skewY(a._degToRad(e))},reflect:function(e,f){1==arguments.length&&(f=e.y,e=e.x);var r=e*e,t=f*f,b=r+t,g=2*e*f/b;return new a.Matrix2D({xx:2*r/b-1,xy:g,yx:g,yy:2*t/b-1})},project:function(e,f){1==arguments.length&&(f=e.y,e=e.x);var r=e*e,t=f*f,b=r+t,g=
e*f/b;return new a.Matrix2D({xx:r/b,xy:g,yx:g,yy:t/b})},normalize:function(e){return e instanceof a.Matrix2D?e:new a.Matrix2D(e)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(e){var f=new a.Matrix2D,r;for(r in e)"number"==typeof e[r]&&("number"==typeof f[r]&&f[r]!=e[r])&&(f[r]=e[r]);return f},invert:function(e){e=a.normalize(e);var f=e.xx*e.yy-e.xy*e.yx;return e=new a.Matrix2D({xx:e.yy/f,xy:-e.xy/f,yx:-e.yx/f,yy:e.xx/f,dx:(e.xy*e.dy-e.yy*e.dx)/
f,dy:(e.yx*e.dx-e.xx*e.dy)/f})},_multiplyPoint:function(a,e,f){return{x:a.xx*e+a.xy*f+a.dx,y:a.yx*e+a.yy*f+a.dy}},multiplyPoint:function(e,f,r){e=a.normalize(e);return"number"==typeof f&&"number"==typeof r?a._multiplyPoint(e,f,r):a._multiplyPoint(e,f.x,f.y)},multiplyRectangle:function(e,f){var r=a.normalize(e);f=f||{x:0,y:0,width:0,height:0};if(a.isIdentity(r))return{x:f.x,y:f.y,width:f.width,height:f.height};var t=a.multiplyPoint(r,f.x,f.y),b=a.multiplyPoint(r,f.x,f.y+f.height),g=a.multiplyPoint(r,
f.x+f.width,f.y),d=a.multiplyPoint(r,f.x+f.width,f.y+f.height),r=Math.min(t.x,b.x,g.x,d.x),h=Math.min(t.y,b.y,g.y,d.y),u=Math.max(t.x,b.x,g.x,d.x),t=Math.max(t.y,b.y,g.y,d.y);return{x:r,y:h,width:u-r,height:t-h}},multiply:function(e){for(var f=a.normalize(e),r=1;r<arguments.length;++r){var t=f,b=a.normalize(arguments[r]),f=new a.Matrix2D;f.xx=t.xx*b.xx+t.xy*b.yx;f.xy=t.xx*b.xy+t.xy*b.yy;f.yx=t.yx*b.xx+t.yy*b.yx;f.yy=t.yx*b.xy+t.yy*b.yy;f.dx=t.xx*b.dx+t.xy*b.dy+t.dx;f.dy=t.yx*b.dx+t.yy*b.dy+t.dy}return f},
_sandwich:function(e,f,r){return a.multiply(a.translate(f,r),e,a.translate(-f,-r))},scaleAt:function(e,f,r,t){switch(arguments.length){case 4:return a._sandwich(a.scale(e,f),r,t);case 3:return"number"==typeof r?a._sandwich(a.scale(e),f,r):a._sandwich(a.scale(e,f),r.x,r.y)}return a._sandwich(a.scale(e),f.x,f.y)},rotateAt:function(e,f,r){return 2<arguments.length?a._sandwich(a.rotate(e),f,r):a._sandwich(a.rotate(e),f.x,f.y)},rotategAt:function(e,f,r){return 2<arguments.length?a._sandwich(a.rotateg(e),
f,r):a._sandwich(a.rotateg(e),f.x,f.y)},skewXAt:function(e,f,r){return 2<arguments.length?a._sandwich(a.skewX(e),f,r):a._sandwich(a.skewX(e),f.x,f.y)},skewXgAt:function(e,f,r){return 2<arguments.length?a._sandwich(a.skewXg(e),f,r):a._sandwich(a.skewXg(e),f.x,f.y)},skewYAt:function(e,f,r){return 2<arguments.length?a._sandwich(a.skewY(e),f,r):a._sandwich(a.skewY(e),f.x,f.y)},skewYgAt:function(e,f,r){return 2<arguments.length?a._sandwich(a.skewYg(e),f,r):a._sandwich(a.skewYg(e),f.x,f.y)}});q.Matrix2D=
a.Matrix2D;return a})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(q,e,a,f,k,n,r,t,b){var g=e.getObject("dojox.gfx",!0),d=g._base={};g._hasClass=function(a,c){var b=a.getAttribute("className");return b&&0<=(" "+b+" ").indexOf(" "+c+" ")};g._addClass=function(a,c){var b=a.getAttribute("className")||"";if(!b||0>(" "+b+" ").indexOf(" "+c+" "))a.setAttribute("className",
b+(b?" ":"")+c)};g._removeClass=function(a,c){var b=a.getAttribute("className");b&&a.setAttribute("className",b.replace(RegExp("(^|\\s+)"+c+"(\\s+|$)"),"$1$2"))};d._getFontMeasurements=function(){var a={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,b;f("ie")&&(b=k.doc.documentElement.style.fontSize||"",b||(k.doc.documentElement.style.fontSize="100%"));var d=t.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",
height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},k.body());for(c in a)d.style.fontSize=c,a[c]=16*Math.round(12*d.offsetHeight/16)/12/1E3;f("ie")&&(k.doc.documentElement.style.fontSize=b);k.body().removeChild(d);return a};var h=null;d._getCachedFontMeasurements=function(a){if(a||!h)h=d._getFontMeasurements();return h};var u=null,m={};d._getTextBox=function(a,c,d){var g,h,s=arguments.length,e;u||(u=t.create("div",{style:{position:"absolute",top:"-10000px",
left:"0",visibility:"hidden"}},k.body()));g=u;g.className="";h=g.style;h.borderWidth="0";h.margin="0";h.padding="0";h.outline="0";if(1<s&&c)for(e in c)e in m||(h[e]=c[e]);2<s&&d&&(g.className=d);g.innerHTML=a;g.getBoundingClientRect?(h=g.getBoundingClientRect(),h={l:h.left,t:h.top,w:h.width||h.right-h.left,h:h.height||h.bottom-h.top}):h=b.getMarginBox(g);g.innerHTML="";return h};d._computeTextLocation=function(a,c,b,d){var g={};switch(a.align){case "end":g.x=a.x-c;break;case "middle":g.x=a.x-c/2;
break;default:g.x=a.x}g.y=a.y-b*(d?0.75:1);return g};d._computeTextBoundingBox=function(a){if(!g._base._isRendered(a))return{x:0,y:0,width:0,height:0};var c;c=a.getShape();var b=a.getFont()||g.defaultFont;a=a.getTextWidth();b=g.normalizedLength(b.size);c=d._computeTextLocation(c,a,b,!0);return{x:c.x,y:c.y,width:a,height:b}};d._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var s=0;d._getUniqueId=function(){var a;do a=q._scopeName+"xUnique"+ ++s;while(r.byId(a));
return a};d._fixMsTouchAction=function(a){a=a.rawNode;"undefined"!=typeof a.style.msTouchAction&&(a.style.msTouchAction="none")};e.mixin(g,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",
x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",
x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(c){var b=a[c];if(b)return new b;b=a[c]=new Function;b.prototype=g["default"+c];return new b}}(),normalizeColor:function(b){return b instanceof a?b:new a(b)},normalizeParameters:function(a,c){var b;if(c){var d={};for(b in a)b in c&&!(b in d)&&(a[b]=c[b])}return a},makeParameters:function(a,c){var b=null;if(!c)return e.delegate(a);
var d={};for(b in a)b in d||(d[b]=e.clone(b in c?c[b]:a[b]));return d},formatNumber:function(a,c){var b=a.toString();if(0<=b.indexOf("e"))b=a.toFixed(4);else{var d=b.indexOf(".");0<=d&&5<b.length-d&&(b=a.toFixed(4))}return 0>a?b:c?" "+b:b},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var c=g.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){c.style=a[0];c.variant=a[1];c.weight=a[2];var b=a[3].indexOf("/");c.size=0>b?
a[3]:a[3].substring(0,b);var d=4;0>b&&("/"==a[4]?d=6:"/"==a[4].charAt(0)&&(d=5));d<a.length&&(c.family=a.slice(d).join(" "))}return c},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return g._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*g.px_in_pt()},px2pt:function(a){return a/g.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var c=g.px_in_pt(),b=parseFloat(a);switch(a.slice(-2)){case "px":return b;case "pt":return b*c;case "in":return 72*
b*c;case "pc":return 12*b*c;case "mm":return b*g.mm_in_pt*c;case "cm":return b*g.cm_in_pt*c}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,c){return a&&c&&a===c},switchTo:function(a){var c="string"==typeof a?g[a]:a;c&&(n.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){g[a]=
c[a]}),"string"==typeof a?g.renderer=a:n.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(c){return g.renderer=g[c]&&g[c].Surface===g.Surface?c:null}))}});return g})},"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(q,e,a,f){q=q.toUrl(".");return{streets:{title:f.basemaps.streets,thumbnailUrl:q+"/images/basemap/streets.jpg",itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},
satellite:{title:f.basemaps.satellite,thumbnailUrl:q+"/images/basemap/satellite.jpg",itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},hybrid:{title:f.basemaps.hybrid,thumbnailUrl:q+"/images/basemap/hybrid.jpg",itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",
isReference:!0}]},terrain:{title:f.basemaps.terrain,thumbnailUrl:q+"/images/basemap/terrain.jpg",itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:f.basemaps.topo,thumbnailUrl:q+"/images/basemap/topo.jpg",itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},
gray:{title:f.basemaps.gray,thumbnailUrl:q+"/images/basemap/gray.jpg",itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:f.basemaps["dark-gray"],thumbnailUrl:q+"/images/basemap/dark-gray.jpg",itemId:"da65bacab5bd4defb576f839b6b28098",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:f.basemaps.oceans,thumbnailUrl:q+"/images/basemap/oceans.jpg",itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",isReference:!0}]},"national-geographic":{title:f.basemaps["national-geographic"],
thumbnailUrl:q+"/images/basemap/national-geographic.jpg",itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},osm:{title:f.basemaps.osm,thumbnailUrl:q+"/images/basemap/osm.jpg",itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(q,e,a,f,k,
n){return q([f],{declaredClass:"esri.Evented",registerConnectEvents:function(){var a=this.constructor,f=this.constructor._meta.parents,b=[{}],g={},d,h,u=function(a,b){e.isArray(a)||(a=[a]);for(var d=0;d<a.length;d++){var c=a[d];c._meta&&c._meta.parents&&u(c._meta.parents,b);c.prototype._eventMap&&b.push(e.mixin({},c.prototype._eventMap))}return b};if(!a._onMap){u(f,b);b.push(this._eventMap);f=e.mixin.apply(this,b);for(d in this)/^on\w/.test(d)&&e.isFunction(this[d])&&(b=this._hyphenLower(d).toLowerCase(),
f[b]||(g[b]={method:d}));for(h in f)d=this._onCamelCase(h),g[h]={method:d,argKeys:f[h]};a._onMap=g;return a._onMap}},on:function(f,t){if(-1<f.indexOf(",")){for(var b=f.split(/\s*,\s*/),g=b.length,d=[];g--;)d.push(this.on(b[g],t));d.remove=function(){for(var a=0;a<d.length;a++)d[a].remove()};return d}var b=this.constructor._onMap||this.registerConnectEvents(),g="string"==typeof f&&f.toLowerCase(),h=this._onCamelCase(g),u=b&&b[g];return(h=u&&u.method||this[h]&&e.isFunction(this[h])&&h)?u&&e.isArray(u.argKeys)?
(b=this._onArr2Obj(t,b[g].argKeys),a.after(this,h,b,!0)):a.after(this,h,function(a){a=a||{};a.target||(a.target=this);t.call(this,a)},!0):this.inherited(arguments)},emit:function(a,f){var b,g,d,h,u=a.toLowerCase();h=this._onCamelCase(a);var m=this.constructor._onMap||this.registerConnectEvents();h=(d=m&&m[u]&&m[u].method||e.isFunction(this[h])&&h)&&this[d];d&&(m&&m[u])&&this._onObj2Arr(function(){g=Array.prototype.slice.call(arguments)},m[u].argKeys)(f);f=f||{};f.target||(f.target=this);h&&(b=g&&
g.length?g:[f],b=h.apply(this,b));this.inherited(arguments,[a,f]);return b},_onObj2Arr:function(a,e){if(e){var b=this;return function(g){var d,h=[],u=e.length;for(d=0;d<u;d++)h[d]=g[e[d]];a.apply(b,h)}}return a},_onArr2Obj:function(a,e){if(e){var b=this;return function(){var g,d={},h=arguments.length;for(g=0;g<h;g++)d[e[g]]=arguments[g];d.target||(d.target=b);a.call(b,d)}}return a},_hyphenLower:function(a){return a.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})},
_onCamelCase:function(a){return"on"+a.substr(0,1).toUpperCase()+a.substr(1).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})}})})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),function(q,e,a,f,k,n,r,t,b){return{animateRange:function(b){var d=b.range;return new e.Animation(a.mixin({curve:new e._Line(d.start,d.end)},b))},resize:function(b){var d=b.node=f.byId(b.node),h=b.start,
u=b.end;h||(h=k.getMarginBox(d),d=k.getPadBorderExtents(d),h=b.start={left:h.l+d.l,top:h.t+d.t,width:h.w-d.w,height:h.h-d.h});u||(u=b.anchor?b.anchor:{x:h.left,y:h.top},d=b.size,u=b.end={left:h.left-(d.width-h.width)*(u.x-h.left)/h.width,top:h.top-(d.height-h.height)*(u.y-h.top)/h.height,width:d.width,height:d.height});return e.animateProperty(a.mixin({properties:{left:{start:h.left,end:u.left},top:{start:h.top,end:u.top},width:{start:h.width,end:u.width},height:{start:h.height,end:u.height}}},b))},
slideTo:function(b){var d=b.node=f.byId(b.node),h=n.getComputedStyle,u=null,m=null,s=function(){return function(){var a="absolute"==d.style.position?"absolute":"relative";u="absolute"==a?d.offsetTop:parseInt(h(d).top)||0;m="absolute"==a?d.offsetLeft:parseInt(h(d).left)||0;"absolute"!=a&&"relative"!=a&&(a=k.position(d,!0),u=a.y,m=a.x,d.style.position="absolute",d.style.top=u+"px",d.style.left=m+"px")}}();s();b=e.animateProperty(a.mixin({properties:{top:{start:u,end:b.top||0},left:{start:m,end:b.left||
0}}},b));q.connect(b,"beforeBegin",b,s);return b},flash:function(b){b=a.mixin({end:"#f00",duration:500,count:1},b);b.duration/=2*b.count;var d=f.byId(b.node),h=b.start;h||(h=n.getComputedStyle(d).backgroundColor);var u=b.end,m=[],s=b.count,d={node:d,duration:b.duration};for(b=0;b<s;b++)m.push(e.animateProperty(a.mixin({properties:{backgroundColor:{start:h,end:u}}},d))),m.push(e.animateProperty(a.mixin({properties:{backgroundColor:{start:u,end:h}}},d)));return r.chain(m)}}})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d){a.isAsync||g(0,function(){d(["./fx/Toggler"])});a=a.fx={};g={_fire:function(a,b){this[a]&&this[a].apply(this,b||[]);return this}};var h=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;f.forEach(this._animations,function(a){this.duration+=a.duration;a.delay&&(this.duration+=a.delay)},this)};h.prototype=new e;q.extend(h,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();
this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=k.after(this._current,"onAnimate",q.hitch(this,"_onAnimate"),!0),this._onEndCtx=k.after(this._current,"onEnd",q.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,b){this._current||(this._current=this._animations[this._index=0]);if(!b&&"playing"==this._current.status())return this;var d=k.after(this._current,
"beforeBegin",q.hitch(this,function(){this._fire("beforeBegin")}),!0),c=k.after(this._current,"onBegin",q.hitch(this,function(c){this._fire("onBegin",arguments)}),!0),l=k.after(this._current,"onPlay",q.hitch(this,function(a){this._fire("onPlay",arguments);d.remove();c.remove();l.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=k.after(this._current,"onAnimate",q.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=k.after(this._current,
"onEnd",q.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=k.after(this._current,"onPause",q.hitch(this,function(b){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,b){this.pause();var d=this.duration*a;this._current=null;f.some(this._animations,function(c,a){if(d<=c.duration)return this._current=c,this._index=a,!0;d-=c.duration;return!1},this);this._current&&this._current.gotoPercent(d/
this._current.duration);b&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var b=k.after(this._current,"onStop",q.hitch(this,function(a){this._fire("onStop",arguments);b.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&
this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});q.extend(h,g);a.chain=function(a){return new h(a)};var u=function(a){this._animations=a||[];this._connects=[];this.duration=this._finished=0;f.forEach(a,function(a){var c=a.duration;a.delay&&(c+=a.delay);this.duration<c&&(this.duration=c);this._connects.push(k.after(a,"onEnd",q.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new n.Animation({curve:[0,1],duration:this.duration});var b=this;f.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),
function(a){b._connects.push(k.after(b._pseudoAnimation,a,function(){b._fire(a,arguments)},!0))})};q.extend(u,{_doAction:function(a,b){f.forEach(this._animations,function(d){d[a].apply(d,b)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,b){var d=this._pseudoAnimation;d[a].apply(d,b)},play:function(a,b){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",
arguments);this._call("pause",arguments);return this},gotoPercent:function(a,b){var d=this.duration*a;f.forEach(this._animations,function(c){c.gotoPercent(c.duration<d?1:d/c.duration,b)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();f.forEach(this._connects,function(a){a.remove()})}});q.extend(u,g);a.combine=function(a){return new u(a)};
a.wipeIn=function(a){var b=a.node=r.byId(a.node),d=b.style,c;a=n.animateProperty(q.mixin({properties:{height:{start:function(){c=d.overflow;d.overflow="hidden";if("hidden"==d.visibility||"none"==d.display)return d.height="1px",d.display="",d.visibility="",1;var a=t.get(b,"height");return Math.max(a,1)},end:function(){return b.scrollHeight}}}},a));var l=function(){d.height="auto";d.overflow=c};k.after(a,"onStop",l,!0);k.after(a,"onEnd",l,!0);return a};a.wipeOut=function(a){var b=(a.node=r.byId(a.node)).style,
d;a=n.animateProperty(q.mixin({properties:{height:{end:1}}},a));k.after(a,"beforeBegin",function(){d=b.overflow;b.overflow="hidden";b.display=""},!0);var c=function(){b.overflow=d;b.height="auto";b.display="none"};k.after(a,"onStop",c,!0);k.after(a,"onEnd",c,!0);return a};a.slideTo=function(a){var d=null,g=null,c=function(c){return function(){var a=t.getComputedStyle(c),h=a.position;d="absolute"==h?c.offsetTop:parseInt(a.top)||0;g="absolute"==h?c.offsetLeft:parseInt(a.left)||0;"absolute"!=h&&"relative"!=
h&&(a=b.position(c,!0),d=a.y,g=a.x,c.style.position="absolute",c.style.top=d+"px",c.style.left=g+"px")}}(a.node=r.byId(a.node));c();a=n.animateProperty(q.mixin({properties:{top:a.top||0,left:a.left||0}},a));k.after(a,"beforeBegin",c,!0);return a};return a})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(q,e,a,f,k){return{_addFrameInfo:function(a,e){var f,b,g=2*e.origin[1],d=e.origin[0],h=a.origin.x,u=a.width,m;q.forEach(a.lods,
function(a){f=Math.round(g/a.resolution);b=Math.ceil(f/u);m=Math.floor((d-h)/(u*a.resolution));a._frameInfo||(a._frameInfo=[b,m,m+b-1,f])})},getContainingTileCoords:function(a,e,f){var b=a.origin;f=f.resolution;return{row:Math.floor((b.y-e.y)/(a.height*f)),col:Math.floor((e.x-b.x)/(a.width*f))}},getCandidateTileInfo:function(a,e,t){var b;b=a.width;for(var g=a.height,d=t.xmax-t.xmin,h=t.ymax-t.ymin,u=a.__tileInfo===e,m=u?a.getMinZoom():-1,u=u?a.getMaxZoom():-1,s=-1,p=e.lods,c=Math.abs,l,w,v,u=-1<u?
u:p.length-1,m=-1<m?m:0;m<=u;m++)if(w=p[m])if(v=d>h?c(h-g*w.resolution):c(d-b*w.resolution),0>s||v<=s)l=w,s=v;else break;b=l;l=b.resolution;g=(t.xmin+t.xmax)/2;d=(t.ymin+t.ymax)/2;h=a.width/2*l;l*=a.height/2;g=new k(g-h,d-l,g+h,d+l,t.spatialReference);t=new f(g.xmin,g.ymax,t.spatialReference);u=b.resolution;h=e.width;d=e.height;e=e.origin;a=a.__visibleDelta;l=Math.floor;p=h*u;c=d*u;u=l((e.y-t.y)/c);s=l((t.x-e.x)/p);m=e.y-u*c;e=l(Math.abs((t.x-(e.x+s*p))*h/p))+a.x;a=l(Math.abs((t.y-m)*d/c))+a.y;return{tile:{point:t,
coords:{row:u,col:s},offsets:{x:e,y:a}},lod:b,extent:g}},getTileExtent:function(a,e,f,b){var g=a.origin;e=a.lods[e].resolution;var d=a.width,h=a.height;return new k(b*e*d+g.x,g.y-(f+1)*e*h,(b+1)*e*d+g.x,g.y-f*e*h,a.spatialReference)}}})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry".split(" "),function(q,e,a,f,k,n,r){function t(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);var c=b*u;return[a*u*g,g/2*Math.log((1+
Math.sin(c))/(1-Math.sin(c)))]}function b(a,b,c){a=a/g*h;if(c)return b=d/2-2*Math.atan(Math.exp(-1*b/g)),[a,b*h];c=a-360*Math.floor((a+180)/360);b=d/2-2*Math.atan(Math.exp(-1*b/g));return[c,b*h]}var g=6378137,d=3.141592653589793,h=57.29577951308232,u=0.017453292519943,m={type:"point",x:0,y:0};q=q(r,{declaredClass:"esri.geometry.Point",constructor:function(a,b,c){e.mixin(this,m);e.isArray(a)?(this.x=a[0],this.y=a[1],this.spatialReference=b):e.isObject(a)?(e.mixin(this,a),k.isDefined(this.latitude)&&
(this.y=this.latitude),k.isDefined(this.longitude)&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=new n(this.spatialReference))):(this.x=a,this.y=b,this.spatialReference=c);this.verifySR()},offset:function(a,b){return new this.constructor(this.x+a,this.y+b,this.spatialReference)},setX:function(a){this.x=a;this.clearCache();return this},setY:function(a){this.y=a;this.clearCache();return this},setLongitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setX(t(a,
this.y)[0]):4326===b.wkid&&this.setX(a));return this},setLatitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setY(t(this.x,a)[1]):4326===b.wkid&&this.setY(a));return this},getLongitude:function(){var a=this.spatialReference,d;a&&(a._isWebMercator()?d=b(this.x,this.y)[0]:4326===a.wkid&&(d=this.x));return d},getLatitude:function(){var a=this.spatialReference,d;a&&(a._isWebMercator()?d=b(this.x,this.y)[1]:4326===a.wkid&&(d=this.y));return d},update:function(a,b){this.x=a;this.y=
b;this.clearCache();return this},normalize:function(){var a=this.x,b=this.spatialReference;if(b){var c=b._getInfo();if(c){var d=c.valid[0],g=c.valid[1],c=2*g;a>g?(d=Math.ceil(Math.abs(a-g)/c),a-=d*c):a<d&&(d=Math.ceil(Math.abs(a-d)/c),a+=d*c)}}return new this.constructor(a,this.y,b)},toJson:function(){var a={x:this.x,y:this.y},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});q.lngLatToXY=t;q.xyToLngLat=b;q.defaultProps=m;return q})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(q,e,a,f,k){return q(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(a){this.spatialReference=a;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new k(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(a){return this.cache&&this.cache[a]},setCacheValue:function(a,e){this.cache||
(this.cache={});this.cache[a]=e}})})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils".split(" "),function(q,e,a,f,k,n,r,t,b,g,d){var h={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},u=q(t,{declaredClass:"esri.geometry.Extent",constructor:function(b,d,g,c,l){a.mixin(this,h);a.isObject(b)?(a.mixin(this,b),this.spatialReference&&(this.spatialReference=new r(this.spatialReference))):
this.update(b,d,g,c,l);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new b((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),d=a.x-b.x;a=a.y-b.y;return new u(this.xmin+d,this.ymin+a,this.xmax+d,this.ymax+a,this.spatialReference)},update:function(a,b,d,c,l){this.xmin=a;this.ymin=b;this.xmax=d;this.ymax=c;this.spatialReference=
l;this.clearCache();return this},offset:function(a,b){return new u(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;a=this.getWidth()*b;b*=this.getHeight();return new u(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;var b=a.type,d=this.spatialReference,c=a.spatialReference;d&&(c&&!d.equals(c)&&d._canProject(c))&&(a=d.isWebMercator()?g.geographicToWebMercator(a):g.webMercatorToGeographic(a,
!0));switch(b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var b=this._normalize(!1,!0);a.isArray(b)||(b=[b]);return b},shiftCentralMeridian:function(){return this._normalize(!0)},_intersectsMultipoint:function(a){var b=a.points.length,d;for(d=0;d<b;d++)if(this.contains(a.getPoint(d)))return!0;
return!1},_intersectsExtent:function(a){var b,d,c,l,g=!1;this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?g=!0:c=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?g=!0:c=Math.min(this.xmax,a.xmax)-b);this.ymin<=a.ymin?(d=a.ymin,this.ymax<d?g=!0:l=Math.min(this.ymax,a.ymax)-d):(d=this.ymin,a.ymax<d?g=!0:l=Math.min(this.ymax,a.ymax)-d);return g?null:new u(b,d,b+c,d+l,this.spatialReference)},_intersectsPolygon:function(a){var d=[this.xmin,this.ymax],g=[this.xmax,this.ymax],c=[this.xmin,this.ymin],l=[this.xmax,
this.ymin],h=[d,g,c,l],d=[[c,d],[d,g],[g,l],[l,c]],c=a.rings,l=c.length,e,u=new b(0,0,this.spatialReference);e=h.length;for(g=0;g<e;g++)if(u.update(h[g][0],h[g][1]),a.contains(u))return!0;u.setSpatialReference(a.spatialReference);for(var f,t,g=0;g<l;g++)if(h=c[g],e=h.length){f=h[0];u.update(f[0],f[1]);if(this.contains(u))return!0;for(a=1;a<e;a++){t=h[a];u.update(t[0],t[1]);if(this.contains(u)||this._intersectsLine([f,t],d))return!0;f=t}}return!1},_intersectsPolyline:function(a){var d=[[[this.xmin,
this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],g,c=a.paths,l=c.length,h,e,u,f,t=new b(0,0,a.spatialReference);for(a=0;a<l;a++)if(h=c[a],e=h.length){u=h[0];t.update(u[0],u[1]);if(this.contains(t))return!0;for(g=1;g<e;g++){f=h[g];t.update(f[0],f[1]);if(this.contains(t)||this._intersectsLine([u,f],d))return!0;u=f}}return!1},_intersectsLine:function(a,b){var g=d._getLineIntersection2,
c,l=b.length;for(c=0;c<l;c++)if(g(a,b[c]))return!0;return!1},contains:function(a){if(!a)return!1;var d=a.type;if("point"===d){var g=this.spatialReference,c=a.spatialReference,d=a.x;a=a.y;g&&(c&&!g.equals(c)&&g._canProject(c))&&(a=g.isWebMercator()?b.lngLatToXY(d,a):b.xyToLngLat(d,a,!0),d=a[0],a=a[1]);return d>=this.xmin&&d<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===d?this._containsExtent(a):!1},_containsExtent:function(a){var d=a.xmin,g=a.ymin,c=a.xmax,l=a.ymax,h=a.spatialReference;a=
new b(d,g,h);d=new b(d,l,h);l=new b(c,l,h);g=new b(c,g,h);return this.contains(a)&&this.contains(d)&&this.contains(l)&&this.contains(g)?!0:!1},union:function(a){return new u(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new u(this.xmin,this.ymin,this.xmax,this.ymax,a&&new r(a.toJson()))},_shiftCM:function(a){var b=this.getCacheValue("_shifted");if(!b){var b=
new u(this.toJson()),d=b.spatialReference;if(a=a||d._getInfo()){var c=this._getCM(a);if(c){var l=d._isWebMercator()?g.webMercatorToGeographic(c):c;b.xmin-=c.x;b.xmax-=c.x;d._isWebMercator()||(l.x=this._normalizeX(l.x,a).x);b.setSpatialReference(new r(n.substitute({Central_Meridian:l.x},4326===d.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b,d=a.valid[0];a=a.valid[1];var c=this.xmin,l=this.xmax;if(!(c>=d&&c<=a)||!(l>=d&&l<=a))b=this.getCenter();
return b},_normalize:function(a,b,d){var c=new u(this.toJson()),l=c.spatialReference;if(l&&(d=d||l._getInfo())){var g=e.map(this._getParts(d),function(c){return c.extent});return 2<g.length?a?this._shiftCM(d):c.update(d.valid[0],c.ymin,d.valid[1],c.ymax,l):2===g.length?a?this._shiftCM(d):b?g:{rings:e.map(g,function(c){return[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]}),spatialReference:l}:g[0]||c}return c},_getParts:function(a){var b=this.getCacheValue("_parts");
if(!b){var b=[],d=this.xmin,c=this.xmax,l=this.ymin,g=this.ymax,h=this.spatialReference,e=this.getWidth(),f=d,t=c,k=0,n=0,r,A;a=a||h._getInfo();r=a.valid[0];A=a.valid[1];n=this._normalizeX(d,a);d=n.x;k=n.frameId;n=this._normalizeX(c,a);c=n.x;n=n.frameId;a=d===c&&0<e;if(e>2*A){e=new u(f<t?d:c,l,A,g,h);d=new u(r,l,f<t?c:d,g,h);A=new u(0,l,A,g,h);l=new u(r,l,0,g,h);h=[];r=[];e.contains(A)&&h.push(k);e.contains(l)&&r.push(k);d.contains(A)&&h.push(n);d.contains(l)&&r.push(n);for(g=k+1;g<n;g++)h.push(g),
r.push(g);b.push({extent:e,frameIds:[k]},{extent:d,frameIds:[n]},{extent:A,frameIds:h},{extent:l,frameIds:r})}else d>c||a?b.push({extent:new u(d,l,A,g,h),frameIds:[k]},{extent:new u(r,l,c,g,h),frameIds:[n]}):b.push({extent:new u(d,l,c,g,h),frameIds:[k]});this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var d=0,c=b.valid[0],l=b.valid[1],g=2*l;a>l?(d=Math.ceil(Math.abs(a-l)/g),a-=d*g):a<c&&(d=Math.ceil(Math.abs(a-c)/g),a+=d*g,d=-d);return{x:a,frameId:d}},toJson:function(){var a={xmin:this.xmin,
ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});u.defaultProps=h;return u})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(q,e,a,f,k,n){function r(a,g,d,h){if("point"===a.type){var e=g(a.x,a.y,h);return new a.constructor(e[0],e[1],new k(d))}if("extent"===a.type){var e=g(a.xmin,a.ymin,h),m=g(a.xmax,a.ymax,h);return new a.constructor(e[0],
e[1],m[0],m[1],new k(d))}if("polyline"===a.type||"polygon"===a.type){var e="polyline"===a.type,s=[],p;q.forEach(e?a.paths:a.rings,function(c){s.push(p=[]);q.forEach(c,function(c){p.push(g(c[0],c[1],h))})});return e?new a.constructor({paths:s,spatialReference:d}):new a.constructor({rings:s,spatialReference:d})}if("multipoint"===a.type){var c=[];q.forEach(a.points,function(a){c.push(g(a[0],a[1],h))});return new a.constructor({points:c,spatialReference:d})}}function t(a,g){var d=a&&(null!=a.wkid?a:a.spatialReference),
h=g&&(null!=g.wkid?g:g.spatialReference);return!d||!h?!1:h.equals(d)?!0:h._canProject(d)}return{canProject:t,project:function(a,g){var d=a&&a.spatialReference,h=g&&(null!=g.wkid?g:g.spatialReference);d&&h?d.equals(h)?a=new a.constructor(a.toJson()):t(d,h)?h.isWebMercator()?a=r(a,n.lngLatToXY,{wkid:102100}):4326===h.wkid&&(a=r(a,n.xyToLngLat,{wkid:4326})):a=null:a=null;return a},lngLatToXY:n.lngLatToXY,xyToLngLat:n.xyToLngLat,geographicToWebMercator:function(a){return r(a,n.lngLatToXY,{wkid:102100})},
webMercatorToGeographic:function(a,g){return r(a,n.xyToLngLat,{wkid:4326},g)}}})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(q,e,a,f){function k(a,b,g){return a instanceof f?new f(a.x+g*(b.x-a.x),a.y+g*(b.y-a.y)):[a[0]+g*(b[0]-a[0]),a[1]+g*(b[1]-a[1])]}function n(a,b){return 1E-8>Math.abs(a-b)}function r(a,b,g,d){var h,e=n(a[0],b[0])?1E10:(a[1]-b[1])/(a[0]-b[0]),m=n(g[0],d[0])?1E10:(g[1]-d[1])/(g[0]-d[0]),s=a[1]-e*a[0],p=g[1]-m*g[0];if(n(e,
m)){if(n(s,p)){if(n(a[0],b[0]))if(Math.min(a[1],b[1])<Math.max(g[1],d[1])||Math.max(a[1],b[1])>Math.min(g[1],d[1]))a=(a[1]+b[1]+g[1]+d[1]-Math.min(a[1],b[1],g[1],d[1])-Math.max(a[1],b[1],g[1],d[1]))/2,h=(a-s)/e;else return null;else if(Math.min(a[0],b[0])<Math.max(g[0],d[0])||Math.max(a[0],b[0])>Math.min(g[0],d[0]))h=(a[0]+b[0]+g[0]+d[0]-Math.min(a[0],b[0],g[0],d[0])-Math.max(a[0],b[0],g[0],d[0]))/2,a=e*h+s;else return null;return[h,a]}return null}n(e,1E10)?(h=a[0],a=m*h+p):n(m,1E10)?(h=g[0],a=e*
h+s):(h=-(s-p)/(e-m),a=a[1]===b[1]?a[1]:g[1]===d[1]?g[1]:e*h+s);return[h,a]}return{getLength:function(a,b){var g=b.x-a.x,d=b.y-a.y;return Math.sqrt(g*g+d*d)},_getLength:function(a,b){var g=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(g*g+d*d)},getPointOnLine:k,getMidpoint:function(a,b){return k(a,b,0.5)},_equals:n,_getLineIntersection:r,getLineIntersection:function(a,b,g,d,h){(a=r([a.x,a.y],[b.x,b.y],[g.x,g.y],[d.x,d.y]))&&(a=new f(a[0],a[1],h));return a},_getLineIntersection2:function(a,b){var g=a[0],
d=a[1],h=b[0],e=b[1],m=g[0],g=g[1],s=d[0],d=d[1],p=h[0],c=h[1],h=e[0]-p,p=m-p,l=s-m,e=e[1]-c,c=g-c,f=d-g,v=e*l-h*f;if(0===v)return!1;h=(h*c-e*p)/v;p=(l*c-f*p)/v;return 0<=h&&1>=h&&0<=p&&1>=p?[m+h*(s-m),g+h*(d-g)]:!1},_pointLineDistance:function(a,b){var g=b[0],d=b[1],h=g[0],e=g[1],g=a[0],m=a[1],s=d[0]-h,p=d[1]-e,c=g-h,l=m-e,d=Math.sqrt,f=Math.pow,v=d(f(s,2)+f(p,2)),c=(c*s+l*p)/(v*v),e=e+c*p;return d(f(g-(h+c*s),2)+f(m-e,2))}}})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),
function(q,e,a,f,k,n){function r(){e.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}r.prototype={addPlugin:function(a,b){var g=this,d=this._plugins,h=new k;try{q([a],function(e){a in d?h.resolve({id:d[a].declaredId||a.replace(/\//g,".")}):(d[a]=e,n(e.add(g,b),function(){var b={id:e.declaredId||a.replace(/\//g,".")};g.emit("plugin-add",b);h.resolve(b)},function(a){h.reject(a)}))})}catch(e){h.reject(e)}return h.promise},removePlugin:function(a){if(a in this._plugins){var b=
this._plugins[a];b.remove(this);delete this._plugins[a];this.emit("plugin-remove",{id:b.declaredId||a.replace(/\//g,".")})}},_pluginsHandler:function(){var e=this;a.some(arguments,function(a){if(a&&a.plugins&&a.plugins instanceof Array){a=a.plugins;var g,d,h;for(h=0;h<a.length;h++)g=a[h],d=g instanceof Object?g.id:g,e.addPlugin(d,g.options);return!0}})}};return r})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],function(q,e,
a,f,k){return q(k,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../SpatialReference ./Geometry ./Point ./Extent".split(" "),function(q,e,a,f,k,n,r,t,b){var g=q(r,{declaredClass:"esri.geometry.Rect",constructor:function(a,b,g,m,s){e.mixin(this,f.defaultRect);e.isObject(a)&&"extent"===a.type&&(b=a.ymax,g=a.getWidth(),m=a.getHeight(),s=a.spatialReference,a=a.xmin);e.isObject(a)?
(e.mixin(this,a),this.spatialReference&&(this.spatialReference=new n(this.spatialReference))):(this.x=a,this.y=b,this.width=g,this.height=m,this.spatialReference=s);this.verifySR()},getCenter:function(){return new t(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(a,b){return new g(this.x+a,this.y+b,this.width,this.height,this.spatialReference)},intersects:function(a){return a.x+a.width<=this.x||a.y+a.height<=this.y||a.y>=this.y+this.height||a.x>=this.x+this.width?
!1:!0},getExtent:function(){return new b(parseFloat(this.x),parseFloat(this.y)-parseFloat(this.height),parseFloat(this.x)+parseFloat(this.width),parseFloat(this.y),this.spatialReference)},update:function(a,b,g,e,s){this.x=a;this.y=b;this.width=g;this.height=e;this.spatialReference=s;this.clearCache();return this}});return g})},"esri/geometry/scaleUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../config ../lang ../WKIDUnitConversion".split(" "),function(q,e,a,f,k,n){var r=20015077/180,
t=f.defaults,b={getUnitValueForSR:function(a){return this.getUnitValue(a)||r},getUnitValue:function(a){var b,h,e;a&&("object"===typeof a?(b=a.wkid,h=a.wkt):"number"===typeof a?b=a:"string"===typeof a&&(h=a));b?e=n.values[n[b]]:h&&-1!==h.search(/^PROJCS/i)&&(a=/UNIT\[([^\]]+)\]\]$/i.exec(h))&&a[1]&&(e=parseFloat(a[1].split(",")[1]));return e},getScale:function(a,d,h){var e,m,s;1<arguments.length&&k.isDefined(d)&&!d.declaredClass?(e=a,m=d,d=null,s=b.getUnitValue(h)):(e=d||a.extent,m=a.width,s=b.getUnitValue(e&&
e.spatialReference));return e&&m?39.37*(e.getWidth()/m*(s||r))*t.screenDPI:0},getExtentForScale:function(a,d,h){h=h||a.extent;var e;e=b.getUnitValue(a.spatialReference);return h.expand(d*a.width/(39.37*(e||r)*t.screenDPI)/h.getWidth())}};return b})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(q,e){var a,f={values:[1,0.3048,0.3048006096012192,0.3047972654,0.9143917962,0.201166195164,0.9143984146160287,0.3047994715386762,20.11676512155263,20.11678249437587,0.9143985307444408,
0.91439523,0.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,
3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,
3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,
3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,
5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6210:0,6211:0,6316:0,6391:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,
22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,
30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,
102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,
103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,
103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,
103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(a=2E3;2046>a;a++)f[a]=0;for(a=2056;2066>a;a++)f[a]=0;for(a=2067;2136>a;a++)f[a]=0;for(a=2137;2155>a;a++)f[a]=
0;for(a=2161;2171>a;a++)f[a]=0;for(a=2172;2194>a;a++)f[a]=0;for(a=2195;2199>a;a++)f[a]=0;for(a=2200;2204>a;a++)f[a]=0;for(a=2205;2218>a;a++)f[a]=0;for(a=2222;2225>a;a++)f[a]=1;for(a=2225;2251>a;a++)f[a]=2;for(a=2251;2254>a;a++)f[a]=1;for(a=2257;2265>a;a++)f[a]=2;for(a=2274;2280>a;a++)f[a]=2;for(a=2280;2283>a;a++)f[a]=1;for(a=2283;2290>a;a++)f[a]=2;for(a=2290;2293>a;a++)f[a]=0;for(a=2308;2314>a;a++)f[a]=0;for(a=2315;2463>a;a++)f[a]=0;for(a=2523;2867>a;a++)f[a]=0;for(a=2867;2870>a;a++)f[a]=1;for(a=
2870;2889>a;a++)f[a]=2;for(a=2891;2896>a;a++)f[a]=2;for(a=2896;2899>a;a++)f[a]=1;for(a=2902;2909>a;a++)f[a]=2;for(a=2915;2921>a;a++)f[a]=2;for(a=2921;2924>a;a++)f[a]=1;for(a=2924;2931>a;a++)f[a]=2;for(a=2931;2963>a;a++)f[a]=0;for(a=2964;2969>a;a++)f[a]=2;for(a=2969;2974>a;a++)f[a]=0;for(a=2975;2992>a;a++)f[a]=0;for(a=2995;3052>a;a++)f[a]=0;for(a=3054;3080>a;a++)f[a]=0;for(a=3081;3089>a;a++)f[a]=0;for(a=3092;3102>a;a++)f[a]=0;for(a=3106;3139>a;a++)f[a]=0;for(a=3146;3152>a;a++)f[a]=0;for(a=3153;3167>
a;a++)f[a]=0;for(a=3168;3173>a;a++)f[a]=0;for(a=3174;3204>a;a++)f[a]=0;for(a=3294;3359>a;a++)f[a]=0;for(a=3367;3404>a;a++)f[a]=0;for(a=3408;3417>a;a++)f[a]=0;for(a=3417;3439>a;a++)f[a]=2;for(a=3441;3447>a;a++)f[a]=2;for(a=3447;3451>a;a++)f[a]=0;for(a=3451;3460>a;a++)f[a]=2;for(a=3460;3479>a;a++)f[a]=0;for(a=3554;3560>a;a++)f[a]=0;for(a=3560;3571>a;a++)f[a]=2;for(a=3571;3582>a;a++)f[a]=0;for(a=3594;3598>a;a++)f[a]=0;for(a=3601;3605>a;a++)f[a]=0;for(a=3637;3640>a;a++)f[a]=0;for(a=3665;3668>a;a++)f[a]=
0;for(a=3693;3696>a;a++)f[a]=0;for(a=3701;3728>a;a++)f[a]=0;for(a=3728;3740>a;a++)f[a]=2;for(a=3740;3752>a;a++)f[a]=0;for(a=3753;3761>a;a++)f[a]=2;for(a=3761;3774>a;a++)f[a]=0;for(a=3775;3778>a;a++)f[a]=0;for(a=3779;3782>a;a++)f[a]=0;for(a=3783;3786>a;a++)f[a]=0;for(a=3788;3792>a;a++)f[a]=0;for(a=3797;3803>a;a++)f[a]=0;for(a=3814;3817>a;a++)f[a]=0;for(a=3825;3830>a;a++)f[a]=0;for(a=3832;3842>a;a++)f[a]=0;for(a=3844;3853>a;a++)f[a]=0;for(a=3873;3886>a;a++)f[a]=0;for(a=3890;3894>a;a++)f[a]=0;for(a=
3907;3913>a;a++)f[a]=0;for(a=3942;3951>a;a++)f[a]=0;for(a=3968;3971>a;a++)f[a]=0;for(a=3973;3977>a;a++)f[a]=0;for(a=3986;3990>a;a++)f[a]=0;for(a=3994;3998>a;a++)f[a]=0;for(a=4048;4052>a;a++)f[a]=0;for(a=4056;4064>a;a++)f[a]=0;for(a=4093;4097>a;a++)f[a]=0;for(a=4399;4414>a;a++)f[a]=2;for(a=4418;4434>a;a++)f[a]=2;for(a=4455;4458>a;a++)f[a]=2;for(a=4484;4490>a;a++)f[a]=0;for(a=4491;4555>a;a++)f[a]=0;for(a=4568;4590>a;a++)f[a]=0;for(a=4652;4657>a;a++)f[a]=0;for(a=4766;4801>a;a++)f[a]=0;for(a=5014;5017>
a;a++)f[a]=0;for(a=5069;5073>a;a++)f[a]=0;for(a=5105;5131>a;a++)f[a]=0;for(a=5173;5189>a;a++)f[a]=0;for(a=5253;5260>a;a++)f[a]=0;for(a=5269;5276>a;a++)f[a]=0;for(a=5292;5312>a;a++)f[a]=0;for(a=5329;5332>a;a++)f[a]=0;for(a=5343;5350>a;a++)f[a]=0;for(a=5355;5358>a;a++)f[a]=0;for(a=5387;5390>a;a++)f[a]=0;for(a=5459;5464>a;a++)f[a]=0;for(a=5479;5483>a;a++)f[a]=0;for(a=5518;5521>a;a++)f[a]=0;for(a=5530;5540>a;a++)f[a]=0;for(a=5550;5553>a;a++)f[a]=0;for(a=5562;5584>a;a++)f[a]=0;for(a=5623;5626>a;a++)f[a]=
2;for(a=5631;5640>a;a++)f[a]=0;for(a=5649;5654>a;a++)f[a]=0;for(a=5663;5681>a;a++)f[a]=0;for(a=5682;5686>a;a++)f[a]=0;for(a=5875;5878>a;a++)f[a]=0;for(a=5921;5941>a;a++)f[a]=0;for(a=6050;6126>a;a++)f[a]=0;for(a=6244;6276>a;a++)f[a]=0;for(a=6328;6349>a;a++)f[a]=0;for(a=6350;6355>a;a++)f[a]=0;for(a=20002;20033>a;a++)f[a]=0;for(a=20062;20093>a;a++)f[a]=0;for(a=20135;20139>a;a++)f[a]=0;for(a=20248;20259>a;a++)f[a]=0;for(a=20348;20359>a;a++)f[a]=0;for(a=20436;20441>a;a++)f[a]=0;for(a=20822;20825>a;a++)f[a]=
0;for(a=20934;20937>a;a++)f[a]=0;for(a=21035;21038>a;a++)f[a]=0;for(a=21095;21098>a;a++)f[a]=0;for(a=21148;21151>a;a++)f[a]=0;for(a=21413;21424>a;a++)f[a]=0;for(a=21473;21484>a;a++)f[a]=0;for(a=21780;21783>a;a++)f[a]=0;for(a=21891;21895>a;a++)f[a]=0;for(a=21896;21900>a;a++)f[a]=0;for(a=22171;22178>a;a++)f[a]=0;for(a=22181;22188>a;a++)f[a]=0;for(a=22191;22198>a;a++)f[a]=0;for(a=22234;22237>a;a++)f[a]=0;for(a=22521;22526>a;a++)f[a]=0;for(a=22991;22995>a;a++)f[a]=0;for(a=23028;23039>a;a++)f[a]=0;for(a=
23830;23854>a;a++)f[a]=0;for(a=23866;23873>a;a++)f[a]=0;for(a=23877;23885>a;a++)f[a]=0;for(a=23886;23895>a;a++)f[a]=0;for(a=23946;23949>a;a++)f[a]=0;for(a=24311;24314>a;a++)f[a]=0;for(a=24342;24348>a;a++)f[a]=0;for(a=24370;24375>a;a++)f[a]=10;for(a=24375;24382>a;a++)f[a]=0;for(a=24718;24722>a;a++)f[a]=0;for(a=24817;24822>a;a++)f[a]=0;for(a=24877;24883>a;a++)f[a]=0;for(a=24891;24894>a;a++)f[a]=0;for(a=25391;25396>a;a++)f[a]=0;for(a=25828;25839>a;a++)f[a]=0;for(a=26191;26196>a;a++)f[a]=0;for(a=26391;26394>
a;a++)f[a]=0;for(a=26701;26723>a;a++)f[a]=0;for(a=26729;26800>a;a++)f[a]=2;for(a=26801;26804>a;a++)f[a]=2;for(a=26811;26814>a;a++)f[a]=2;for(a=26847;26871>a;a++)f[a]=2;for(a=26891;26900>a;a++)f[a]=0;for(a=26901;26924>a;a++)f[a]=0;for(a=26929;26947>a;a++)f[a]=0;for(a=26948;26999>a;a++)f[a]=0;for(a=27037;27041>a;a++)f[a]=0;for(a=27205;27233>a;a++)f[a]=0;for(a=27258;27261>a;a++)f[a]=0;for(a=27391;27399>a;a++)f[a]=0;for(a=27561;27565>a;a++)f[a]=0;for(a=27571;27575>a;a++)f[a]=0;for(a=27581;27585>a;a++)f[a]=
0;for(a=27591;27595>a;a++)f[a]=0;for(a=28191;28194>a;a++)f[a]=0;for(a=28348;28359>a;a++)f[a]=0;for(a=28402;28433>a;a++)f[a]=0;for(a=28462;28493>a;a++)f[a]=0;for(a=29118;29123>a;a++)f[a]=0;for(a=29168;29173>a;a++)f[a]=0;for(a=29177;29186>a;a++)f[a]=0;for(a=29187;29196>a;a++)f[a]=0;for(a=29900;29904>a;a++)f[a]=0;for(a=30161;30180>a;a++)f[a]=0;for(a=30491;30495>a;a++)f[a]=0;for(a=30729;30733>a;a++)f[a]=0;for(a=31251;31260>a;a++)f[a]=0;for(a=31265;31269>a;a++)f[a]=0;for(a=31275;31280>a;a++)f[a]=0;for(a=
31281;31298>a;a++)f[a]=0;for(a=31461;31470>a;a++)f[a]=0;for(a=31491;31496>a;a++)f[a]=0;for(a=31917;31923>a;a++)f[a]=0;for(a=31965;32001>a;a++)f[a]=0;for(a=32001;32004>a;a++)f[a]=2;for(a=32005;32032>a;a++)f[a]=2;for(a=32033;32061>a;a++)f[a]=2;for(a=32064;32068>a;a++)f[a]=2;for(a=32074;32078>a;a++)f[a]=2;for(a=32081;32087>a;a++)f[a]=0;for(a=32107;32131>a;a++)f[a]=0;for(a=32133;32159>a;a++)f[a]=0;for(a=32164;32168>a;a++)f[a]=2;for(a=32180;32200>a;a++)f[a]=0;for(a=32201;32261>a;a++)f[a]=0;for(a=32301;32361>
a;a++)f[a]=0;for(a=32601;32663>a;a++)f[a]=0;for(a=32664;32668>a;a++)f[a]=2;for(a=32701;32762>a;a++)f[a]=0;for(a=53001;53005>a;a++)f[a]=0;for(a=53008;53020>a;a++)f[a]=0;for(a=53021;53033>a;a++)f[a]=0;for(a=53042;53047>a;a++)f[a]=0;for(a=54001;54005>a;a++)f[a]=0;for(a=54008;54020>a;a++)f[a]=0;for(a=54021;54033>a;a++)f[a]=0;for(a=54042;54047>a;a++)f[a]=0;for(a=54048;54054>a;a++)f[a]=0;for(a=102001;102041>a;a++)f[a]=0;for(a=102042;102064>a;a++)f[a]=0;for(a=102065;102068>a;a++)f[a]=0;for(a=102070;102118>
a;a++)f[a]=0;for(a=102122;102217>a;a++)f[a]=0;for(a=102221;102378>a;a++)f[a]=0;for(a=102382;102389>a;a++)f[a]=0;for(a=102389;102399>a;a++)f[a]=2;for(a=102401;102445>a;a++)f[a]=0;for(a=102445;102448>a;a++)f[a]=2;for(a=102450;102453>a;a++)f[a]=0;for(a=102461;102469>a;a++)f[a]=2;for(a=102469;102497>a;a++)f[a]=0;for(a=102500;102520>a;a++)f[a]=1;for(a=102520;102525>a;a++)f[a]=0;for(a=102525;102530>a;a++)f[a]=2;for(a=102530;102550>a;a++)f[a]=0;for(a=102570;102589>a;a++)f[a]=0;for(a=102590;102599>a;a++)f[a]=
0;for(a=102601;102604>a;a++)f[a]=0;for(a=102605;102629>a;a++)f[a]=0;for(a=102629;102647>a;a++)f[a]=2;for(a=102648;102701>a;a++)f[a]=2;for(a=102701;102704>a;a++)f[a]=0;for(a=102707;102731>a;a++)f[a]=2;for(a=102733;102759>a;a++)f[a]=2;for(a=102767;102799>a;a++)f[a]=0;for(a=102962;102970>a;a++)f[a]=0;for(a=102971;102974>a;a++)f[a]=0;for(a=102975;102990>a;a++)f[a]=0;for(a=102990;102993>a;a++)f[a]=1;for(a=102997;103003>a;a++)f[a]=0;for(a=103003;103009>a;a++)f[a]=2;for(a=103009;103012>a;a++)f[a]=0;for(a=
103012;103015>a;a++)f[a]=2;for(a=103019;103022>a;a++)f[a]=0;for(a=103022;103025>a;a++)f[a]=2;for(a=103029;103032>a;a++)f[a]=0;for(a=103032;103035>a;a++)f[a]=2;for(a=103065;103069>a;a++)f[a]=0;for(a=103074;103077>a;a++)f[a]=0;for(a=103077;103080>a;a++)f[a]=1;for(a=103080;103083>a;a++)f[a]=0;for(a=103083;103086>a;a++)f[a]=2;for(a=103090;103094>a;a++)f[a]=0;for(a=103097;103100>a;a++)f[a]=0;for(a=103100;103103>a;a++)f[a]=2;for(a=103107;103110>a;a++)f[a]=0;for(a=103110;103113>a;a++)f[a]=2;for(a=103113;103117>
a;a++)f[a]=0;for(a=103117;103121>a;a++)f[a]=2;for(a=103153;103158>a;a++)f[a]=0;for(a=103158;103163>a;a++)f[a]=2;for(a=103163;103166>a;a++)f[a]=0;for(a=103166;103169>a;a++)f[a]=1;for(a=103169;103172>a;a++)f[a]=2;for(a=103186;103189>a;a++)f[a]=0;for(a=103189;103192>a;a++)f[a]=2;for(a=103192;103196>a;a++)f[a]=0;for(a=103196;103200>a;a++)f[a]=2;for(a=103200;103225>a;a++)f[a]=0;for(a=103225;103228>a;a++)f[a]=1;for(a=103232;103238>a;a++)f[a]=0;for(a=103238;103244>a;a++)f[a]=2;for(a=103244;103247>a;a++)f[a]=
0;for(a=103247;103250>a;a++)f[a]=2;for(a=103254;103257>a;a++)f[a]=0;for(a=103257;103260>a;a++)f[a]=2;for(a=103264;103267>a;a++)f[a]=0;for(a=103267;103270>a;a++)f[a]=2;for(a=103300;103376>a;a++)f[a]=0;for(a=103381;103384>a;a++)f[a]=0;for(a=103384;103387>a;a++)f[a]=1;for(a=103387;103390>a;a++)f[a]=0;for(a=103390;103393>a;a++)f[a]=2;for(a=103397;103400>a;a++)f[a]=0;for(a=103400;103472>a;a++)f[a]=2;for(a=103476;103479>a;a++)f[a]=0;for(a=103479;103482>a;a++)f[a]=2;for(a=103486;103489>a;a++)f[a]=0;for(a=
103489;103492>a;a++)f[a]=2;for(a=103492;103496>a;a++)f[a]=0;for(a=103496;103500>a;a++)f[a]=2;for(a=103528;103544>a;a++)f[a]=0;for(a=103544;103549>a;a++)f[a]=2;for(a=103549;103552>a;a++)f[a]=0;for(a=103552;103555>a;a++)f[a]=1;for(a=103555;103558>a;a++)f[a]=2;for(a=103558;103561>a;a++)f[a]=0;for(a=103571;103574>a;a++)f[a]=0;for(a=103574;103577>a;a++)f[a]=2;for(a=103577;103581>a;a++)f[a]=0;for(a=103581;103584>a;a++)f[a]=2;for(a=103600;103695>a;a++)f[a]=0;for(a=103700;103794>a;a++)f[a]=2;for(a=103794;103872>
a;a++)f[a]=0;for(a=103900;103972>a;a++)f[a]=2;return f})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(q,e,a,f,k,n,r,t,b,g){var d=function(){return 9>a("ie")?function(a,b,d,g,p,c,l,e,f){var x=[],y=Math.round,k,n=l.length,t,r,A,q,C,H;for(k=0;k<n;k++)if(t=l[k],q=e?e(t[0][0],t[0][1],f):t[0],1<(A=t.length)){C=y((q[0]-a)*d+p);H=y((b-q[1])*g+c);q=e?e(t[1][0],t[1][1],
f):t[1];r=y((q[0]-a)*d+p);q=y((b-q[1])*g+c);x.push("M",C+","+H,"L",r+","+q);for(r=2;r<A;r++)q=e?e(t[r][0],t[r][1],f):t[r],C=y((q[0]-a)*d+p),H=y((b-q[1])*g+c),x.push(C+","+H)}else C=y((q[0]-a)*d+p),H=y((b-q[1])*g+c),x.push("M",C+","+H);return x}:function(a,b,d,g,p,c,l,e,f){var x=[],y,k,n,t,r,A,q=Math.round;y=0;for(n=l?l.length:0;y<n;y++){r=l[y];x.push("M");k=0;for(t=r?r.length:0;k<t;k++)A=e?e(r[k][0],r[k][1],f):r[k],x.push(q((A[0]-a)*d+p)+","+q((b-A[1])*g+c))}return x}}();return{toScreenPoint:function(a,
b,d,g,p){var c=a.spatialReference,l=g.spatialReference,e=g.x;g=g.y;c&&(l&&!c.equals(l)&&c._canProject(l))&&(c=c.isWebMercator()?k.lngLatToXY(e,g):k.xyToLngLat(e,g,!0),e=c[0],g=c[1]);e=(e-a.xmin)*(b/a.getWidth());g=(a.ymax-g)*(d/a.getHeight());p||(e=Math.round(e),g=Math.round(g));return new n(e,g)},toScreenGeometry:function(a,d,e,s){var p=a.xmin,c=a.ymax,l=d/a.getWidth(),f=e/a.getHeight(),v=q.forEach,x=Math.round;if(s instanceof k)return new k(x((s.x-p)*l),x((c-s.y)*f));if(s instanceof b){a=new b;
var y=a.points;v(s.points,function(a,b){y[b]=[x((a[0]-p)*l),x((c-a[1])*f)]});return a}if(s instanceof g)return new g(x((s.xmin-p)*l),x((c-s.ymin)*f),x((s.xmax-p)*l),x((c-s.ymax)*l));if(s instanceof r){a=new r;var n=a.paths,z;v(s.paths,function(a,b){z=n[b]=[];v(a,function(a,b){z[b]=[x((a[0]-p)*l),x((c-a[1])*f)]})});return a}if(s instanceof t){a=new t;var D=a.rings,E;v(s.rings,function(a,b){E=D[b]=[];v(a,function(a,b){E[b]=[x((a[0]-p)*l),x((c-a[1])*f)]})});return a}},_toScreenPath:function(a,b,g,e,
p,c){var l=e instanceof r,f=a.spatialReference,v=e.spatialReference,x,y;f&&(v&&!f.equals(v)&&f._canProject(v))&&(f.isWebMercator()?x=k.lngLatToXY:(x=k.xyToLngLat,y=!0));return d(a.xmin,a.ymax,b/a.getWidth(),g/a.getHeight(),p,c,l?e.paths:e.rings,x,y)},toMapPoint:function(a,b,d,g){return new k(a.xmin+g.x/(b/a.getWidth()),a.ymax-g.y/(d/a.getHeight()),a.spatialReference)},toMapGeometry:function(a,d,e,s){var p=a.xmin,c=a.ymax,l=a.spatialReference,f=d/a.getWidth(),v=e/a.getHeight(),x=q.forEach;if(s instanceof
k)return new k(p+s.x/f,c-s.y/v,l);if(s instanceof b){a=new b(l);var y=a.points;x(s.points,function(a,b){y[b]=[p+a[0]/f,c-a[1]/v]});return a}if(s instanceof g)return new g(p+s.xmin/f,c-s.ymin/v,p+s.xmax/f,c-s.ymax/v,l);if(s instanceof r){a=new r(l);var n=a.paths,z;x(s.paths,function(a,b){z=n[b]=[];x(a,function(a,b){z[b]=[p+a[0]/f,c-a[1]/v]})});return a}if(s instanceof t){a=new t(l);var D=a.rings,E;x(s.rings,function(a,b){E=D[b]=[];x(a,function(a,b){E[b]=[p+a[0]/f,c-a[1]/v]})});return a}}}})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent".split(" "),
function(q,e,a,f,k,n,r,t,b,g){var d={type:"polyline",paths:null};q=q(t,{declaredClass:"esri.geometry.Polyline",constructor:function(b){a.mixin(this,d);this.paths=[];this._path=0;b&&(a.isArray(b)?this.paths=a.isArray(b[0][0])?b:[b]:b.paths?a.mixin(this,b):this.spatialReference=b,this.spatialReference&&(this.spatialReference=new r(this.spatialReference)));this.verifySR()},addPath:function(b){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];a.isArray(b[0])?e.forEach(b,this._addPointArr,
this):e.forEach(b,this._addPoint,this);return this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,b){this.clearCache();this._path=b;this.paths[this._path]||(this.paths[this._path]=[]);e.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==b&&void 0!==a&&(0>b||b>=this.paths[a].length)?!1:!0},getPoint:function(a,d){if(this._validateInputs(a,
d))return new b(this.paths[a][d],this.spatialReference)},setPoint:function(a,b,d){if(this._validateInputs(a,b))return this.clearCache(),this.paths[a][b]=[d.x,d.y],this},insertPoint:function(a,b,d){if(this._validateInputs(a)&&n.isDefined(b)&&0<=b&&b<=this.paths[a].length)return this.clearCache(),this.paths[a].splice(b,0,[d.x,d.y]),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var d,g=a.length,e=this.spatialReference;for(d=0;d<g;d++)a[d]=
new b(a[d],e);return a}},removePoint:function(a,d){if(this._validateInputs(a,d))return this.clearCache(),new b(this.paths[a].splice(d,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new g(a),a._partwise=b,a;a=this.paths;var d=a.length;if(d&&a[0].length){var e,p,c,l,f,v,x,y,k=l=a[0][0][0],n=f=a[0][0][1],t=Math.min,r=Math.max,A=this.spatialReference,b=[],q,C,H,I;for(v=0;v<d;v++){e=a[v];q=C=e[0]&&e[0][0];H=I=
e[0]&&e[0][1];y=e.length;for(x=0;x<y;x++)p=e[x],c=p[0],p=p[1],k=t(k,c),n=t(n,p),l=r(l,c),f=r(f,p),q=t(q,c),H=t(H,p),C=r(C,c),I=r(I,p);b.push(new g({xmin:q,ymin:H,xmax:C,ymax:I,spatialReference:A?A.toJson():null}))}a={xmin:k,ymin:n,xmax:l,ymax:f,spatialReference:A?A.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new g(a);a._partwise=b;return a}},toJson:function(){var b={paths:a.clone(this.paths)},d=this.spatialReference;d&&(b.spatialReference=
d.toJson());return b}});q.defaultProps=d;return q})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils".split(" "),function(q,e,a,f,k,n,r,t,b,g,d){var h={type:"polygon",rings:null},u=q(t,{declaredClass:"esri.geometry.Polygon",constructor:function(b){a.mixin(this,h);this.rings=[];this._ring=0;b&&(a.isArray(b)?this.rings=a.isArray(b[0][0])?b:[b]:b.rings?a.mixin(this,b):
this.spatialReference=b,this.spatialReference&&(this.spatialReference=new r(this.spatialReference)));this.verifySR()},addRing:function(b){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];a.isArray(b[0])?e.forEach(b,this._addPointArr,this):e.forEach(b,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,b){this.clearCache();this._ring=b;this.rings[this._ring]||
(this.rings[this._ring]=[]);e.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==b&&void 0!==a&&(0>b||b>=this.rings[a].length)?!1:!0},getPoint:function(a,d){if(this._validateInputs(a,d))return new b(this.rings[a][d],this.spatialReference)},setPoint:function(a,b,d){if(this._validateInputs(a,b))return this.clearCache(),this.rings[a][b]=[d.x,d.y],this},insertPoint:function(a,b,d){if(this._validateInputs(a)&&n.isDefined(b)&&0<=
b&&b<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(b,0,[d.x,d.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var d,g=a.length,c=this.spatialReference;for(d=0;d<g;d++)a[d]=new b(a[d],c);return a}},removePoint:function(a,d){if(this._validateInputs(a,d))return this.clearCache(),new b(this.rings[a].splice(d,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");
if(a)return a=new g(a),a._partwise=b,a;a=this.rings;var d=a.length;if(d&&a[0].length){var c,l,h,e,u,f,k,n,t=e=a[0][0][0],r=u=a[0][0][1],A=Math.min,q=Math.max,C=this.spatialReference,b=[],H,I,L,J;for(f=0;f<d;f++){c=a[f];H=I=c[0]&&c[0][0];L=J=c[0]&&c[0][1];n=c.length;for(k=0;k<n;k++)l=c[k],h=l[0],l=l[1],t=A(t,h),r=A(r,l),e=q(e,h),u=q(u,l),H=A(H,h),L=A(L,l),I=q(I,h),J=q(J,l);b.push(new g({xmin:H,ymin:L,xmax:I,ymax:J,spatialReference:C?C.toJson():null}))}a={xmin:t,ymin:r,xmax:e,ymax:u,spatialReference:C?
C.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new g(a);a._partwise=b;return a}},contains:function(a){var d=this.rings,g,c=!1,l,h,e,u,f,k,n=d.length;g=this.spatialReference;l=a.spatialReference;var t=a.x;a=a.y;g&&(l&&!g.equals(l)&&g._canProject(l))&&(a=g.isWebMercator()?b.lngLatToXY(t,a):b.xyToLngLat(t,a,!0),t=a[0],a=a[1]);for(k=0;k<n;k++){g=d[k];e=g.length;for(f=u=0;f<e;f++)if(u++,u===e&&(u=0),l=g[f],h=g[u],(l[1]<a&&h[1]>=a||h[1]<a&&l[1]>=
a)&&l[0]+(a-l[1])/(h[1]-l[1])*(h[0]-l[0])<t)c=!c}return c},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var a=this.rings,d,g,c,l=[],h,u;e.forEach(a,function(a){d=g=c=0;e.forEach(a,function(b,l){l<a.length-1&&(h=a[l+1],u=b[0]*h[1]-h[0]*b[1],d+=(b[0]+h[0])*u,g+=(b[1]+h[1])*u,c+=u)});0<c&&(c*=-1);c&&l.push([d,g,c/2])});l.sort(function(a,c){return a[2]-c[2]});d=g=void 0;if(l[0])a=6*l[0][2],d=l[0][0]/a,g=l[0][1]/a;else if(a=a[0]&&a[0].length?this._getLineCentroid(a[0]):
null)d=a.x,g=a.y;a=isNaN(d)||isNaN(g)?null:new b(d,g,this.spatialReference);this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(a){var b,g=0,c=0,l=0,h,e,u={x:0,y:0},f={x:0,y:0},k,n=a.length,t;for(k=0;k<n-1;k++)h=a[k],e=a[k+1],h&&e&&(u.x=h[0],u.y=h[1],f.x=e[0],f.y=e[1],b=d.getLength(u,f),0<b&&(g+=b,h=d.getMidpoint(h,e),c+=b*h[0],l+=b*h[1]));0<g?t={x:c/g,y:l/g}:a[0]&&(t={x:a[0][0],y:a[0][1]});return t},isClockwise:function(b){var d=0,g,c=b.length,l=a.isArray(b[0])?function(a,c){return a[0]*
c[1]-c[0]*a[1]}:function(a,c){return a.x*c.y-c.x*a.y};for(g=0;g<c;g++)d+=l(b[g],b[(g+1)%c]);return 0>=d/2},isSelfIntersecting:function(a){a=a||this;var b,g,c,l,h,e,u,f=a.rings.length,k;for(c=0;c<f;c++){for(b=0;b<a.rings[c].length-1;b++){h=[[a.rings[c][b][0],a.rings[c][b][1]],[a.rings[c][b+1][0],a.rings[c][b+1][1]]];for(g=c+1;g<f;g++)for(l=0;l<a.rings[g].length-1;l++)if(e=[[a.rings[g][l][0],a.rings[g][l][1]],[a.rings[g][l+1][0],a.rings[g][l+1][1]]],(u=d._getLineIntersection2(h,e))&&!(u[0]===h[0][0]&&
u[1]===h[0][1]||u[0]===e[0][0]&&u[1]===e[0][1]||u[0]===h[1][0]&&u[1]===h[1][1]||u[0]===e[1][0]&&u[1]===e[1][1]))return!0}l=a.rings[c].length;if(!(4>=l))for(b=0;b<l-3;b++){k=l-1;0===b&&(k=l-2);h=[[a.rings[c][b][0],a.rings[c][b][1]],[a.rings[c][b+1][0],a.rings[c][b+1][1]]];for(g=b+2;g<k;g++)if(e=[[a.rings[c][g][0],a.rings[c][g][1]],[a.rings[c][g+1][0],a.rings[c][g+1][1]]],(u=d._getLineIntersection2(h,e))&&!(u[0]===h[0][0]&&u[1]===h[0][1]||u[0]===e[0][0]&&u[1]===e[0][1]||u[0]===h[1][0]&&u[1]===h[1][1]||
u[0]===e[1][0]&&u[1]===e[1][1]))return!0}}return!1},toJson:function(){var b={rings:a.clone(this.rings)},d=this.spatialReference;d&&(b.spatialReference=d.toJson());return b}});u.defaultProps=h;u.createEllipse=function(a){var b=a.center.x,d=a.center.y,c=a.longAxis,l=a.shortAxis,g=a.numberOfPoints,h=a.map,e,f,k;a=[];var n=2*Math.PI/g;for(f=0;f<g;f++)e=Math.cos(f*n),k=Math.sin(f*n),e=h.toMap({x:c*e+b,y:l*k+d}),a.push(e);a.push(a[0]);b=new u(h.spatialReference);b.addRing(a);return b};u.createCircle=function(a){return u.createEllipse({center:a.center,
longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})};u.fromExtent=function(a){var b=a.normalize();a=a.spatialReference;return new u({rings:e.map(b,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?a.toJson():null})};return u})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent".split(" "),function(q,e,a,f,k,n,r,
t){var b={type:"multipoint",points:null};q=q(n,{declaredClass:"esri.geometry.Multipoint",constructor:function(a){e.mixin(this,b);this.points=[];a&&(a.points?e.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=new k(this.spatialReference)));this.verifySR()},addPoint:function(a){this.clearCache();e.isArray(a)?this.points.push(a):this.points.push([a.x,a.y]);return this},removePoint:function(a){if(this._validateInputs(a))return this.clearCache(),new r(this.points.splice(a,
1)[0],this.spatialReference)},getExtent:function(){var a=this.getCacheValue("_extent");if(a)return new t(a);var a=this.points,b=a.length;if(b){var h=a[0],e,m,f=e=h[0],p=m=h[1],c=Math.min,l=Math.max,w=this.spatialReference,v,k;for(k=0;k<b;k++)h=a[k],v=h[0],h=h[1],f=c(f,v),p=c(p,h),e=l(e,v),m=l(m,h);a={xmin:f,ymin:p,xmax:e,ymax:m,spatialReference:w?w.toJson():null};this.setCacheValue("_extent",a);return new t(a)}},_validateInputs:function(a){return null===a||0>a||a>=this.points.length?!1:!0},getPoint:function(a){if(this._validateInputs(a))return a=
this.points[a],new r(a[0],a[1],this.spatialReference)},setPoint:function(a,b){if(this._validateInputs(a))return this.clearCache(),this.points[a]=[b.x,b.y],this},toJson:function(){var a={points:e.clone(this.points)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});q.defaultProps=b;return q})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/dom-style dojox/gfx dojox/gfx/matrix ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B){var z,D=-1!==t.renderer.toLowerCase().indexOf("svg"),E=-1!==t.renderer.toLowerCase().indexOf("canvas"),A=9>u("ie"),G=u("esri-touch");p=q(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(a,c){var b,d=this._connects=[];this._map=a;E?(b=n.create("div",{style:"overflow: visible; position: absolute;"},c),this._surface={getEventSource:function(){return b}},d.push(e.connect(b,"onmousedown",this,this._canvasDownHandler)),d.push(e.connect(b,
"onmouseup",this,this._canvasUpHandler)),d.push(e.connect(b,"onclick",this,this._canvasClickHandler)),z.prototype._canvas=!0):(b=(this._surface=t.createSurface(c,a.width,a.height)).getEventSource(),r.set(b=A?b.parentNode:b,{overflow:"visible",position:"absolute"}));d.push(e.connect(a,"onResize",this,"_onResizeHandler"));return b},_onResizeHandler:function(a,c,b){a=this._surface.getEventSource();var d=this._map,l;A&&r.set(a=a.parentNode,{width:c+"px",height:b+"px",clip:"rect(0px "+c+"px "+b+"px 0px)"});
k.set(a,"width",c);k.set(a,"height",b);this._surface.declaredClass||f.forEach(a.childNodes,function(a){k.set(a,"width",c);k.set(a,"height",b)});d.loaded&&(d.graphics.suspended||(d.graphics._resized=!0),f.forEach(d.graphicsLayerIds,function(a){l=d.getLayer(a);l.suspended||(l._resized=!0)}))},_cleanUp:function(){f.forEach(this._connects,e.disconnect,e);this._map=this._surface=null},_processEvent:function(a){var c=this._map;a.screenPoint=new w(a.pageX-c.position.x,a.pageY-c.position.y);a.mapPoint=c.toMap(a.screenPoint)},
_canvasDownHandler:function(a){this._processEvent(a);this._downPt=a.screenPoint.x+","+a.screenPoint.y},_canvasUpHandler:function(a){this._processEvent(a);this._upPt=a.screenPoint.x+","+a.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(a,c,b,d){if(!a.visible||!c)return!1;var l=c.getTransformedBoundingBox(),g;return l?(g=new v(l[0].x,l[0].y,l[2].x,l[2].y),delete g.spatialReference,G?g.intersects(b):g.contains(d)):f.some(c.children||[],function(a){l=a.getTransformedBoundingBox();g=new v(l[0].x,
l[0].y,l[2].x,l[2].y);delete g.spatialReference;return G?g.intersects(b):g.contains(d)})},_canvasClickHandler:function(a){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(a);var c=this._map,b=f.map(c.graphicsLayerIds,function(a){return c.getLayer(a)});b.push(c.graphics);b.reverse();var b=f.filter(b,function(a){return a.loaded&&a._mouseEvents&&!a.suspended&&(!h.isDefined(a.opacity)||0<a.opacity)}),d=a.screenPoint,l=this._tolerance,g=d.x-l,e=d.y+l,p=d.x+l,l=d.y-l,m=new v(g,
l,p,e),g=c.toMap(new w(g,e)),p=c.toMap(new w(p,l)),e=g.spatialReference._getInfo(),u=new v(v.prototype._normalizeX(g.x,e).x,g.y,v.prototype._normalizeX(p.x,e).x,p.y,g.spatialReference),s;delete m.spatialReference;f.some(b,function(a){a=f.filter(a.graphics,function(a){return this._isPrimaryMatch(a,a.getDojoShape(),m,d)||!(!a._bgShape||!this._isPrimaryMatch(a,a._bgShape,m,d))},this);a.reverse();if(0<a.length){var c;f.some(a,function(a){return a.geometry&&u.intersects(a.geometry)?(c=a,!0):!1});if(c)return s=
c,!0}return!1},this);if(s&&(b=s.getLayer()))a.graphic=s,b.onClick(a)}}});z=q(g,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:E?"canvas-2d":t.renderer,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},constructor:function(c,b){if(c&&(a.isString(c)||a.isObject(c)&&(c.layerDefinition||c.query)))c=b;this._params=a.mixin({displayOnPan:!0,drawMode:!0,styling:!0},c||{});var d=this._params.dataAttributes;"string"===typeof d&&(d=
[d]);this.styling=D?this._params.styling:!0;this.dataAttributes=d;this.infoTemplate=c&&c.infoTemplate;this.graphics=[];this._draw=a.hitch(this,this._draw);this._refresh=a.hitch(this,this._refresh);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(a){this._params.drawMode=a},renderer:null,_setMap:function(c,b){this.inherited(arguments);this._map=c;this._wrap=c.wrapAround180;this._srInfo=c.spatialReference._getInfo();this._canvas?(b=
t.createSurface(b.getEventSource(),c.width,c.height),r.set(b.rawNode,"position","absolute"),this._div=b.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=a.hitch(this,this._canvasRender)):this._div=b.createGroup();this._bgGroup=this._div.createGroup();this._div.getEventSource().id=this.id+"_layer";var d=this.opacity;h.isDefined(d)&&1>d&&this.setOpacity(d,!0);return this._div},_unsetMap:function(a,c){f.forEach(this.graphics,function(a){a._shape=null});this._canvas?
(c=this._div.getParent(),c._parent={},n.destroy(c.rawNode),c.destroy()):(this._div.clear(),c.remove(this._div),n.destroy(this._div.getEventSource()));this._map=this._div=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onZoomStartHandler:function(){s.hide(this._div.getEventSource())},_onExtentChangeHandler:function(a,c,d,l){clearTimeout(this._wakeTimer);this._wakeTimer=null;d?(a=this._map.__visibleRect,c=this._div,this._evalSDRenderer(),
this._refresh(!0),c.setTransform(b.translate({x:a.x,y:a.y})),this._renderProto&&c.surface.pendingRender?this._dirty=!0:this.suspended||s.show(c.getEventSource())):this._resized&&(this._refresh(!1),this._resized=!1);if(0<this.graphics.length)this.onUpdate()},_canvasRender:function(){var a=this._div;this._dirty&&(delete this._dirty,this.suspended||s.show(a.getEventSource()));return this._renderProto.apply(a,arguments)},_refresh:function(a){var c=this.graphics,b=c.length,d,l=this._draw;for(d=0;d<b;d++)l(c[d],
a)},refresh:function(){this._refresh(!0)},redraw:function(){this._refresh(!0)},_onPanHandler:function(a,c){this._panDx=c.x;this._panDy=c.y;var d=this._map.__visibleRect;this._div.setTransform(b.translate({x:d.x+c.x,y:d.y+c.y}))},_onPanEndUpdateHandler:function(a,c){if(!this._params._child&&(c.x!==this._panDx||c.y!==this._panDy)){var d=this._map.__visibleRect;this._div.setTransform(b.translate({x:d.x,y:d.y}))}this._refresh(!1);if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){s.hide(this._div.getEventSource())},
_onPanEndHandler:function(){var a=this._map.__visibleRect,c=this._div;c.setTransform(b.translate({x:a.x,y:a.y}));this._refresh(!1);this._renderProto&&c.surface.pendingRender?this._dirty=!0:s.show(c.getEventSource());if(this.graphics.length)this.onUpdate()},onSuspend:function(){this.inherited(arguments);s.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(c){this.inherited(arguments);c.firstOccurrence&&this._evalSDRenderer();
this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var a=this._map,c=e.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=c(a,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=c(a,"onPanStart",this,"_onPanStartHandler"),
this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=c(a,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=e.disconnect;a(this._onExtentChangeHandler_connect);a(this._onZoomStartHandler_connect);a(this._onPanHandler_connect);a(this._onPanStartHandler_connect);a(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=
this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=null},_updateExtent:function(a){var c=a.geometry;if(c){if(!(a._extent=c.getExtent())){var b,d;if("esri.geometry.Point"===c.declaredClass)b=c.x,d=c.y;else if("esri.geometry.Multipoint"===c.declaredClass)b=c.points[0][0],d=c.points[0][1];else{a._extent=null;return}a._extent=new v(b,d,b,d,c.spatialReference)}}else a._extent=null},_intersects:function(a,c,b){var d=a.spatialReference,
l=c.spatialReference,g=d&&l&&!d.equals(l)&&d._canProject(l)&&4326===l.wkid;if(this._wrap&&!b){b=[];var d=a._getFrameWidth(),h=this._srInfo,e=a._clip?a._getAvailExtent():a.extent,p,m,u,s,v=[];p=c._partwise;g&&(e=a.geographicExtent,h=l._getInfo());a=e._getParts(h);if(p&&p.length){c=[];l=0;for(g=p.length;l<g;l++)c=c.concat(p[l]._getParts(h))}else c=c._getParts(h);l=0;for(g=c.length;l<g;l++){u=c[l];h=0;for(e=a.length;h<e;h++)if(s=a[h],s.extent.intersects(u.extent)){p=0;for(m=u.frameIds.length;p<m;p++)b.push((s.frameIds[0]-
u.frameIds[p])*d)}}l=0;for(g=b.length;l<g;l++)p=b[l],f.indexOf(b,p)===l&&v.push(p);return v.length?v:null}return(g?a.geographicExtent:a.extent).intersects(c)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(a,c){if(this._params.drawMode&&this._map&&!this.suspended)try{var b=a._extent,d,l,g=!D||this.styling,h=D&&this.dataAttributes,e=a.getDojoShape(),p;if(a.visible&&b&&(d=this._intersects(this._map,b,a.geometry._originOnly))&&(l=
g?this._getSymbol(a):this._defaultMarker)){if(!a._offsets||a._offsets.join(",")!==d.join(",")?a._offsets=d:p=!0,!e||c||!p){var m=a.geometry.type,b={graphic:a},u=a._bgShape,f=g&&!a.symbol?this._getRenderer(a):null,s=f&&f.backgroundFillSymbol;if("point"===m)this._isInvalidShape(l,e)&&this._removeShape(a),a._shape=this._drawPoint(this._div,a.geometry,l,a.getDojoShape(),d,f,a),g&&this._symbolizePoint(a.getDojoShape(),l,f,a);else if("multipoint"===m)this._drawMarkers(a,l,d,f),g&&this._symbolizeMarkers(a,
l,f);else{var v,m=l,w,y;g&&(m=(v="simplemarkersymbol"===l.type||"picturemarkersymbol"===l.type||"textsymbol"===l.type?l:null)?s:l);m&&m===s&&(w=this._bgGroup);u&&!w&&this._removeBgShape(a);m&&(!w&&this._isInvalidShape(m,a._shape)&&this._removeShape(a,!1),y=this._drawShape(a,d,w||this._div,w?u:a.getDojoShape()),g&&this._symbolizeShape(y,m,!s&&f,a),a[w?"_bgShape":"_shape"]=y);if(v){this._isInvalidShape(v,a._shape)&&this._removeShape(a,!1);var k=a.geometry.getCentroid();(y=k&&this._drawPoint(this._div,
k,v,a._shape,d,f,a))&&this._symbolizePoint(y,v,f,a);a._shape=y}}E||(a._bgShape&&this._initNode(a,a._bgShape,a._bgShape!==u,b,h),a._shape&&this._initNode(a,a._shape,a._shape!==e,b,h));b.node=a.getNode();this.onGraphicDraw(b)}}else e&&this._removeShape(a)}catch(n){this._errorHandler(n,a)}},_initNode:function(a,c,b,d,l){if(c=c&&c.getNode())c.e_graphic=a,this._addDataAttrs(a,l,c),b&&(d.node=c,this.onGraphicNodeAdd(d))},_removeShape:function(a,c){var b=a.getDojoShape(),d=b&&b.getNode();b&&(b.removeShape(),
b.destroy());a._shape=a._offsets=null;!1!==c&&this._removeBgShape(a);if(d&&(d.e_graphic=null,!E))this.onGraphicNodeRemove({graphic:a,node:d})},_removeBgShape:function(a){var c=a._bgShape,b=c&&c.getNode();c&&(c.removeShape(),c.destroy(),a._bgShape=null);if(b&&(b.e_graphic=null,!E))this.onGraphicNodeRemove({graphic:a,node:b})},_addDataAttrs:function(a,c,b){var d=a.attributes,l,g=c?c.length:0,h=this._getRenderer(a);if(b&&d){for(l=0;l<g;l++)(b=c[l])&&a.attr("data-"+b,d[b]);!this.styling&&h&&(h.getBreakIndex?
(c=h.getBreakIndex(a),a.attr("data-class-break",-1!==c?c:null)):h.getUniqueValueInfo&&(c=h.getUniqueValueInfo(a),a.attr("data-unique-value",c?c.value:null)))}},_drawShape:function(a,c,b,d){a=a.geometry;var l=a.type,g=this._map,h=g.extent,e=g.width,p=g.height,g=g.__visibleRect,m=[],u,f;u="extent"===l;if("rect"===l||u)m={x:0,y:0,spatialReference:a.spatialReference},m.x=u?a.xmin:a.x,m.y=u?a.ymax:a.y,l=y.toScreenPoint(h,e,p,m),m.x=u?a.xmax:a.x+a.width,m.y=u?a.ymin:a.y+a.height,a=y.toScreenPoint(h,e,p,
m),c={x:l.x-g.x+c[0],y:l.y-g.y,width:Math.abs(a.x-l.x),height:Math.abs(a.y-l.y)},0===c.width&&(c.width=1),0===c.height&&(c.height=1),d=this._drawRect(b,d,c);else if("polyline"===l||"polygon"===l){u=0;for(f=c.length;u<f;u++)m=m.concat(y._toScreenPath(h,e,p,a,-g.x+c[u],-g.y));d=this._drawPath(b,d,m);this._rendererLimits&&("polyline"===l?this._clipPolyline(d,a):this._clipPolygon(d,a))}return d},_drawRect:function(a,c,b){return c?c.setShape(b):a.createRect(b)},_drawImage:function(a,c,b){return c?c.setShape(b):
a.createImage(b)},_drawCircle:function(a,c,b){return c?c.setShape(b):a.createCircle(b)},_drawPath:function(){return A?function(a,c,b,d){b=d?b:b.join(" ");if(c)return c.setShape(b);c=a.createObject(d?t.Path:t.EsriPath,b);a._overrideSize(c.getEventSource());return c}:function(a,c,b,d){b=d?b:b.join(" ");return c?c.setShape(b):a.createPath(b)}}(),_drawText:function(a,c,b){return c?c.setShape(b):a.createText(b)},_evalSDRenderer:function(a){var c=this._map,b=this.renderer,d,l=this._rndForScale;c&&(c.loaded&&
b&&b.getRendererInfo)&&(d="zoom"===b.rangeType?b.getRendererInfoByZoom(c.getZoom()):b.getRendererInfoByScale(c.getScale()));this._rndForScale=d&&d.renderer;!a&&this._rndForScale!=l&&this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(a){var c=this._rndForScale||this.renderer;a&&(c&&c.getObservationRenderer)&&(c=c.getObservationRenderer(a));return c},_getSymbol:function(a){var c=this._getRenderer();return a.symbol||c&&c.getSymbol(a)},_getVariable:function(a,c){var b;a&&
(b=(b=a.getVisualVariablesForType(c))&&b[0]);return b},_applyOpacity:function(a,c,b,d){c=c.getOpacity(d,{opacityInfo:b});null!=c&&(a=new m(a),a.a=c);return a},_symbolizeShape:function(c,b,d,l){var g=b.getStroke(),h=b.getFill();b=b.type;var e,p,m=this._getVariable(d,"sizeInfo"),u=this._getVariable(d,"colorInfo"),f=this._getVariable(d,"opacityInfo"),m=m?d.getSize(l,{sizeInfo:m,resolution:this._map.getResolutionInMeters()}):null;if(d&&(u||f)&&"picturefillsymbol"!==b)-1!==b.indexOf("linesymbol")?(e=g&&
g.color,u&&(e=d.getColor(l,{colorInfo:u})||e),e&&f&&(e=this._applyOpacity(e,d,f,l))):h&&h.toCss&&(p=h,u&&(p=d.getColor(l,{colorInfo:u})||p),p&&f&&(p=this._applyOpacity(p,d,f,l)));c.setStroke(null==m&&!e?g:a.mixin({},g,null!=m?{width:m}:null,e&&{color:e})).setFill(p||h)},_smsToPath:function(){return A?function(a,c,b,d,l,g,h,e,p){switch(c){case a.STYLE_SQUARE:return["M",l+","+h,"L",g+","+h,g+","+e,l+","+e,"X","E"];case a.STYLE_CROSS:return["M",b+","+h,"L",b+","+e,"M",l+","+d,"L",g+","+d,"E"];case a.STYLE_X:return["M",
l+","+h,"L",g+","+e,"M",l+","+e,"L",g+","+h,"E"];case a.STYLE_DIAMOND:return["M",b+","+h,"L",g+","+d,b+","+e,l+","+d,"X","E"];case a.STYLE_TARGET:return["M",l+","+h,"L",g+","+h,g+","+e,l+","+e,l+","+h,"M",l-p+","+d,"L",l+","+d,"M",b+","+(h-p),"L",b+","+h,"M",g+p+","+d,"L",g+","+d,"M",b+","+(e+p),"L",b+","+e,"E"]}}:function(a,c,b,d,l,g,h,e,p){switch(c){case a.STYLE_SQUARE:return["M",l+","+h,g+","+h,g+","+e,l+","+e,"Z"];case a.STYLE_CROSS:return["M",b+","+h,b+","+e,"M",l+","+d,g+","+d];case a.STYLE_X:return["M",
l+","+h,g+","+e,"M",l+","+e,g+","+h];case a.STYLE_DIAMOND:return["M",b+","+h,g+","+d,b+","+e,l+","+d,"Z"];case a.STYLE_TARGET:return["M",l+","+h,g+","+h,g+","+e,l+","+e,l+","+h,"M",l-p+","+d,l+","+d,"M",b+","+(h-p),b+","+h,"M",g+p+","+d,g+","+d,"M",b+","+(e+p),b+","+e]}}}(),_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(a,
c){var b=c&&c.shape&&c.shape.type,d=a&&a.type,l=a&&a.style;"rect"===b&&(b="path");d&&(l=this._typeMaps[d]||l);this._pathStyles[l]&&(l="path");return"shieldlabelsymbol"===d?!0:!(!b||!(l&&b!==l))},_drawPoint:function(a,d,l,g,h,e,p){var m=l.type,u=this._map,f=u.__visibleRect,s=y.toScreenPoint(u.extent,u.width,u.height,d).offset(-f.x+h[0],-f.y),f=s.x,v=s.y,w;d=[];var k,n=e&&e.rotationInfo?e.getRotationAngle(p):null,x=this._getVariable(e,"sizeInfo"),u=x?e.getSize(p,{sizeInfo:x,shape:l.style,resolution:u.getResolutionInMeters()}):
null;n&&d.push(b.rotategAt(n,s));if(0!==l.xoffset||0!==l.yoffset)k=b.translate(l.xoffset,-l.yoffset),d.push(k);0!==l.angle&&d.push(b.rotategAt(l.angle,s));if("simplemarkersymbol"===m)switch(w=l.style,e=Math.round,u=null!=u?u:l.size,w){case c.STYLE_SQUARE:case c.STYLE_CROSS:case c.STYLE_X:case c.STYLE_DIAMOND:l=isNaN(u)?16:u/2;w=this._drawPath(a,g,this._smsToPath(c,w,f,v,e(f-l),e(f+l),e(v-l),e(v+l)));break;case c.STYLE_TARGET:p=l._targetWidth/2;s=l._targetHeight/2;w=this._drawPath(a,g,this._smsToPath(c,
w,f,v,e(f-p),e(f+p),e(v-s),e(v+s),l._spikeSize));break;case c.STYLE_PATH:w=this._drawPath(a,g,l.path,!0);l=w.getBoundingBox();a=this._getScaleMatrix(l,u);(1!==a.xx||1!==a.yy)&&d.push(b.scaleAt(a.xx,a.yy,s));d.push(b.translate(-(l.x+l.width/2)+f,-(l.y+l.height/2)+v));break;default:l=isNaN(u)?16:u/2,w=this._drawCircle(a,g,{cx:f,cy:v,r:l})}else if("shieldlabelsymbol"===m)w=l.width,s=l.height,g=a.createGroup(),w=a.createImage({x:f-w/2,y:v-s/2,width:w,height:s,src:l.url}),g.add(w),null!=l.font&&(v+=0.2*
l.getHeight(),a=a.createText({type:"text",text:l.text,x:f,y:v,align:"middle",decoration:l.decoration,rotated:l.rotated,kerning:l.kerning}),a.setFont(l.font),a.setFill(l.color),g.add(a)),w=g;else if("picturemarkersymbol"===m){if(null==u?(w=l.width,s=l.height):(s=u,w=s*(l.width/l.height),k&&(null!=k.dx&&(k.dx=w*(k.dx/l.width)),null!=k.dy&&(k.dy=s*(k.dy/l.height)))),w=this._drawImage(a,g,{x:f-w/2,y:v-s/2,width:w,height:s,src:l.url}),D&&(a=w.getNode()))l=(l=this._getVariable(e,"opacityInfo"))?e.getOpacity(p,
{opacityInfo:l}):null,null!=l?a.setAttribute("opacity",l):a.setAttribute("opacity",1)}else"textsymbol"===m&&(e=l.font,null!=u&&e&&(e=new e.constructor(e.toJson()),e.setSize(u)),w=this._drawText(a,g,{type:"text",text:l.text,x:f,y:v,align:l.getSVGAlign(),decoration:l.decoration||e&&e.decoration,rotated:l.rotated,kerning:l.kerning}),e&&w.setFont(e),D&&(a=w.getNode(),f=l.getSVGBaseline(),l=l.getSVGBaselineShift(),a&&(a.setAttribute("dominant-baseline",f),l&&a.setAttribute("baseline-shift",l))));w.setTransform(b.multiply(d));
w._wrapOffsets=h;return w},_getScaleMatrix:function(a,c){var b=a.width/a.height,d=1,l=1;isNaN(c)||(1<b?(d=c/a.width,l=c/b/a.height):(l=c/a.height,d=c*b/a.width));return{xx:d,yy:l}},_symbolizePoint:function(b,d,l,g){var h=d.type,e=d.style;if(!("shieldlabelsymbol"===h||"picturemarkersymbol"===h)){var p=d.getStroke();d=d.getFill();var e=e===c.STYLE_X||e===c.STYLE_CROSS,m=p&&p.color,u=e?m:d;if(l){var f=this._getVariable(l,"colorInfo"),s=this._getVariable(l,"opacityInfo");f&&(u=l.getColor(g,{colorInfo:f})||
u);u&&s&&(u=this._applyOpacity(u,l,s,g));u&&(e?u!==m&&(p=p?a.mixin({},p):{},p.color=u):u!==d&&(d=u))}"textsymbol"===h?b.setFill(d):"simplemarkersymbol"===h&&b.setFill(d).setStroke(p)}},_drawMarkers:function(a,c,b,d){var l=a.geometry,g=l.points,h=a.getDojoShape()||this._div.createGroup(),e,p,u=g.length,m=[],f=0,s,v=b?b.length:0;h.children[0]&&this._isInvalidShape(c,h.children[0])&&h.clear();for(p=0;p<u;p++){e=g[p];for(s=0;s<v;s++)m[0]=b[s],this._drawPoint(h,{x:e[0],y:e[1],spatialReference:l.spatialReference},
c,h.children[f++],m,d,a)}c=h.children.length;if(u*b.length<c)for(p=c-1;p>=u*b.length;p--)h.children[p].removeShape();a._shape=h},_symbolizeMarkers:function(a,c,b){var d=a.getDojoShape().children,l,g=d.length;for(l=0;l<g;l++)this._symbolizePoint(d[l],c,b,a)},_errorHandler:function(a,c){a.message=c?"Unable to draw graphic (geometry:"+(c.geometry?c.geometry.declaredClass:null)+", symbol:"+(c.symbol?c.symbol.declaredClass:null)+"): "+a.message:"Unable to draw graphic (null): "+a.message;this.inherited(arguments)},
_rendererLimits:function(){var a,c,b;u("ff")?(a=16125,c=-32250,b=32250):A?(a=1E5,c=-1E5,b=1E5):u("chrome")&&6>u("chrome")&&(a=8150,c=-1E4,b=1E4);if(a)return{clipLimit:a,rangeMin:c,rangeMax:b,clipBBox:[-a,-a,a,a],clipSegments:[[[-a,-a],[a,-a]],[[a,-a],[a,a]],[[a,a],[-a,a]],[[-a,a],[-a,-a]]]}}(),_clipPolyline:function(a,c){var b=this._getCorners(a,c),d=b.br,l=this._rendererLimits,g=l.rangeMin,h=l.rangeMax,e=l.clipBBox,p=l.clipSegments,l=this._isPointWithinRange,u=this._isPointWithinBBox,m=this._getClipperIntersection,
s=this._getPlaneIndex;if(!l(b.tl,g,h)||!l(d,g,h)){A&&this._createSegments(a);var v=[];f.forEach(a.segments,function(a){a=a.args;var c=a.length,b=[],d;for(d=0;d<c;d+=2){var l=[a[d],a[d+1]],g=[a[d+2],a[d+3]],h=u(l,e),f=u(g,e);if(h^f){if(f=m([l,g],p))h?(d?b.push(f[1]):b.push(l,f[1]),v.push(b),b=[]):b.push(f[1],g)}else h?d?b.push(g):b.push(l,g):(f=s(l,e),h=s(g,e),-1===f||(-1===h||f===h)||(l=m([l,g],p,!0),0<l.length&&(l[f]||(f=l[f[0]]?f[0]:f[1]),l[h]||(h=l[h[0]]?h[0]:h[1]),g=l[f],l=l[h],g&&b.push(g),l&&
(b.push(l),v.push(b),b=[]))))}v.push(b)});a.setShape(this._getPathStringFromPaths(v))}},_clipPolygon:function(c,b){var d=this._getCorners(c,b),l=d.br,g=this._rendererLimits,h=g.clipLimit,e=g.rangeMin,p=g.rangeMax,u=g.clipBBox,m=g.clipSegments,g=this._isPointWithinRange,s=this._isPointWithinBBox,v=this._getClipperIntersection,w=this._getPlaneIndex,y=x._pointLineDistance;if(!g(d.tl,e,p)||!g(l,e,p))A&&this._createSegments(c),d=f.map(c.segments,function(c){var b=c.args,d=b.length,l=[];c=[];var g;for(g=
0;g<d;g+=2){var e=[b[g],b[g+1]],p=[b[g+2],b[g+3]];if(g===d-2){l.push(e);break}var k=s(e,u),n=s(p,u);l.push(e);if(k^n){if(n=v([e,p],m))e=n[1],e[k?"inOut":"outIn"]=!0,l.push(e),c.push([k?"INOUT":"OUTIN",l.length-1,n[0]])}else if(!k){var k=w(e,u),x=w(p,u);-1===k||(-1===x||k===x)||(n=v([e,p],m,!0),0<n.length?(n[k]||(k=n[k[0]]?k[0]:k[1]),n[x]||(x=n[x[0]]?x[0]:x[1]),e=n[k],p=n[x],e&&(e.outIn=!0,l.push(e),c.push(["OUTIN",l.length-1,k])),p&&(p.inOut=!0,l.push(p),c.push(["INOUT",l.length-1,x]))):a.isArray(k)&&
a.isArray(x)&&(n=k.concat(x),n.sort(),"0123"===n.join("")&&(n=[],3===k[0]+k[1]?n.push([h,-h],[-h,h]):n.push([-h,-h],[h,h]),k=y(n[0],[e,p]),e=y(n[1],[e,p]),l.push(k<e?n[0]:n[1]))))}}var t=u[0],r=u[1],B=u[2],A=u[3];f.forEach(l,function(a){a[0]<t&&(a[1]>=r&&a[1]<=A?a[0]=t:(a[0]=t,a[1]=a[1]<r?r:A))});f.forEach(l,function(a){a[1]<r&&(a[0]>=t&&a[0]<=B?a[1]=r:(a[1]=r,a[0]=a[0]<t?t:B))});f.forEach(l,function(a){a[0]>B&&(a[1]>=r&&a[1]<=A?a[0]=B:(a[0]=B,a[1]=a[1]<r?r:A))});f.forEach(l,function(a){a[1]>A&&(a[0]>=
t&&a[0]<=B?a[1]=A:(a[1]=A,a[0]=a[0]<t?t:B))});b=0;d=c.length;if(0<d){do{p=c[b];g=c[(b+1)%d];if(p[2]===g[2]&&"INOUT"===p[0]&&"OUTIN"===g[0])if(e=p[1],g=g[1],e<g)for(e+=1;e<g;e++)l[e][2]=!0;else if(e>g){for(e+=1;e<l.length;e++)l[e][2]=!0;for(e=0;e<g;e++)l[e][2]=!0}b=(b+1)%d}while(0!==b)}d=l[0];b=l[l.length-1];d[2]&&(b[2]=!0,f.some(c,function(c){return 1===c[1]?(l.splice(l.length-1,0,a.clone(l[1])),!0):!1}));l=f.filter(l,function(a){return a[2]?!1:!0});for(b=0;b<l.length-1;b++)if(d=l[b],(g=l[b+1])&&
!(d[0]!==g[0]||d[1]!==g[1]))g.outIn?d.outIn=!0:g.inOut&&(d.inOut=!0),l.splice(b+1,1);d=Math.abs;c=[];for(b=0;b<l.length-1;b++){p=l[b];e=p[0];p=p[1];k=d(e)===h;n=d(p)===h;g=l[b+1];x=g[0];g=g[1];var z=d(x)===h,D=d(g)===h;k&&D?c.push([b+1,[e,g]]):n&&z&&c.push([b+1,[x,p]])}for(b=c.length-1;0<=b;b--)g=c[b],e=l[g[0]-1],d=l[g[0]],!e.outIn&&(!e.inOut&&!d.outIn&&!d.inOut)&&l.splice(g[0],0,g[1]);d=l[0];b=l[l.length-1];(d[0]!==b[0]||d[1]!==b[1])&&l.push(d);return l}),c.setShape(this._getPathStringFromPaths(d))},
_getCorners:function(a,c){if(A){var b=this._map,d=c.getExtent(),g=d.spatialReference,h=b.toScreen(new l(d.xmin,d.ymax,g)),b=b.toScreen(new l(d.xmax,d.ymin,g));return{tl:h,br:b}}h=a.getTransformedBoundingBox();return{tl:h[0],br:h[2]}},_createSegments:function(a){a.shape.path=a.vmlPath;a.segmented=!1;a._confirmSegmented();var c=a.segments;1<c.length&&(a.segments=f.filter(c,function(a,c,b){c=b[c+1];return"M"===a.action&&c&&"L"===c.action?(a.args=a.args.concat(c.args),!0):!1}))},_getPathStringFromPaths:function(a){A?
(a=f.map(a,function(a){return"m "+f.map(a,function(a,c){return(1===c?"l ":"")+a.join(",")}).join(" ")}),a.push("e")):a=f.map(a,function(a){return"M "+f.map(a,function(a){return a.join(",")}).join(" ")});return a.join(" ")},_isPointWithinBBox:function(a,c){var b=c[1],d=c[2],l=c[3],g=a[0],h=a[1];return g>c[0]&&g<d&&h>b&&h<l?!0:!1},_isPointWithinRange:function(a,c,b){var d=a.x;a=a.y;return d<c||a<c||d>b||a>b?!1:!0},_getClipperIntersection:function(a,c,b){var d,l=x._getLineIntersection2,g=Math.round,
h={length:0};for(d=0;4>d;d++){var e=l(a,c[d]);if(e)if(e[0]=g(e[0]),e[1]=g(e[1]),b)h[d]=e,h.length++;else return[d,e]}return b?h:null},_getPlaneIndex:function(a,c){var b=a[0],d=a[1],l=c[0],g=c[1],h=c[2],e=c[3];return b<=l?d>=g&&d<=e?3:d<g?[0,3]:[2,3]:d<=g?b>=l&&b<=h?0:b<l?[3,0]:[1,0]:b>=h?d>=g&&d<=e?1:d<g?[0,1]:[2,1]:d>=e?b>=l&&b<=h?2:b<l?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},
onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},setInfoTemplate:function(a){this.infoTemplate=a},add:function(a,c){if(a._graphicsLayer===this)return a;c||this.graphics.push(a);a._graphicsLayer=this;a._layer=this;this._updateExtent(a);this._draw(a);if(!c)this.onGraphicAdd(a);return a},remove:function(a,c){if(!c){var b;if(-1===(b=f.indexOf(this.graphics,a)))return null;a=this.graphics.splice(b,1)[0]}a.getDojoShape()&&this._removeShape(a);a._shape=a._graphicsLayer=
null;this.onGraphicRemove(a);return a},clear:function(a,c){for(var b=this.graphics;0<b.length;)this.remove(b[0]);if(!c)this.onGraphicsClear()},_setIEOpacity:function(a,c){var b=a&&a.getNode();if(b){var d=a.strokeStyle,l=b.stroke;d&&l&&(l.opacity=d.color.a*c);d=a.fillStyle;l=b.fill;d&&l&&("tile"===l.type?r.set(b,"opacity",c):l.opacity=d.a*c)}},setOpacity:function(a,c){if(c||this.opacity!=a){var b=this._div;b&&(A?(f.forEach(this.graphics,function(c){this._setIEOpacity(c._shape,a);this._setIEOpacity(c._bgShape,
a)},this),b._esriIeOpacity=a,this._bgGroup._esriIeOpacity=a):this._canvas?r.set(b.getEventSource(),"opacity",a):b.getEventSource().setAttribute("opacity",a));this.opacity=a;if(!c)this.onOpacityChange(a)}},setRenderer:function(a){this.renderer=a;this._evalSDRenderer(!0);this.emit("renderer-change",{renderer:this._rndForScale||a})}});q=q([z,B],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=a.hitch(this,this.enableMouseEvents);this.disableMouseEvents=a.hitch(this,
this.disableMouseEvents);this._processEvent=a.hitch(this,this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var a=this.inherited("_setMap",arguments);this.enableMouseEvents();return a},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(a){var c=this._map,b=a.target,d;a.screenPoint=new w(a.pageX-c.position.x,a.pageY-c.position.y);for(a.mapPoint=c.toMap(a.screenPoint);b&&!(d=b.e_graphic);)b=
b.parentNode;if(d)return a.graphic=d,a},_onMouseOverHandler:function(a){if(this._processEvent(a))this.onMouseOver(a)},_onMouseMoveHandler:function(a){if(this._processEvent(a))this.onMouseMove(a)},_onMouseDragHandler:function(a){if(this._processEvent(a))this.onMouseDrag(a)},_onMouseOutHandler:function(a){if(this._processEvent(a))this.onMouseOut(a)},_onMouseDownHandler:function(a){this._downGr=this._downPt=null;this._processEvent(a)&&(e.disconnect(this._onmousemove_connect),e.disconnect(this._onmousedrag_connect),
this._onmousedrag_connect=e.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),this._downGr=a.graphic,this._downPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseDown(a))},_onMouseUpHandler:function(a){this._upGr=this._upPt=null;this._processEvent(a)&&(e.disconnect(this._onmousedrag_connect),e.disconnect(this._onmousemove_connect),this._onmousemove_connect=e.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=a.graphic,this._upPt=a.screenPoint.x+
","+a.screenPoint.y,this.onMouseUp(a))},_onClickHandler:function(a){if(this._processEvent(a)){var c=this._downGr,b=this._upGr;c&&(b&&c===b&&this._downPt===this._upPt)&&(A&&(d._ieGraphic=a.graphic),this.onClick(a))}},_onDblClickHandler:function(a){if(this._processEvent(a))this.onDblClick(a)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var a=
e.connect,c=this._div.getEventSource();E||(this._onmouseover_connect=a(c,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=a(c,"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=a(c,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=a(c,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=a(c,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=a(c,"onclick",this,"_onClickHandler"),this._ondblclick_connect=a(c,"ondblclick",this,
"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var a=e.disconnect;a(this._onmouseover_connect);a(this._onmousemove_connect);a(this._onmousedrag_connect);a(this._onmouseout_connect);a(this._onmousedown_connect);a(this._onmouseup_connect);a(this._onclick_connect);a(this._ondblclick_connect);this._mouseEvents=!1}}});q._GraphicsContainer=p;q._GraphicsLayer=z;return q})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],
function(q,e,a){e.switchTo(a);return e})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(q,e,a,f,k){var n=null;a.add("vml",function(a,e,b){b.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';a="adj"in b.firstChild;b.innerHTML="";return a});return{load:function(r,t,b){function g(){t(["dojox/gfx/"+d],function(a){q.renderer=d;n=a;b(a)})}if(n&&"force"!=r)b(n);else{var d=k.forceGfxRenderer;r=!d&&(e.isString(k.gfxRenderer)?
k.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var h,u;!d&&r.length;)switch(r.shift()){case "svg":"SVGAngle"in f.global&&(d="svg");break;case "vml":a("vml")&&(d="vml");break;case "silverlight":try{a("ie")?(h=new ActiveXObject("AgControl.AgControl"))&&h.IsVersionSupported("1.0")&&(u=!0):navigator.plugins["Silverlight Plug-In"]&&(u=!0)}catch(m){u=!1}finally{h=null}u&&(d="silverlight");break;case "canvas":f.global.CanvasRenderingContext2D&&(d="canvas")}"canvas"===d&&!1!==k.canvasEvents&&
(d="canvasWithEvents");k.isDebug&&console.log("gfx renderer \x3d "+d);"svg"==d&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(g):g()}}}})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s){var p=q([t],{declaredClass:"esri.layers.Layer",
_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(c,b){if(c&&f.isString(c))this._url=u.urlToObject(this.url=c);else if(this.url=this._url=null,(b=b||c)&&(b.layerDefinition||b.query))b=null;this.spatialReference=new m(4326);this.initialExtent=new s(-180,-90,180,90,new m(4326));this._map=this._div=null;this.normalization=!0;b&&(b.id&&(this.id=b.id),!1===b.visible&&(this.visible=!1),g.isDefined(b.opacity)&&
(this.opacity=b.opacity),g.isDefined(b.minScale)&&this.setMinScale(b.minScale),g.isDefined(b.maxScale)&&this.setMaxScale(b.maxScale),this.attributionDataUrl=b.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,g.isDefined(b.showAttribution)&&(this.showAttribution=b.showAttribution),this.className=b.className,this.refreshInterval=b.refreshInterval||0);this._errorHandler=f.hitch(this,this._errorHandler);this.refresh=f.hitch(this,this.refresh);if(this.managedSuspension){var d=this._setMap;
this._setMap=function(c){var b=d.apply(this,arguments);this.evaluateSuspension();if(this.suspended&&!c.loaded)var l=a.connect(c,"onLoad",this,function(){a.disconnect(l);l=null;this.evaluateSuspension()});return b}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,_errorHandler:function(a){this.loaded||(this.loadError=a);this.onError(a)},
_setMap:function(c,b,d,g){this._map=c;this._lyrZEHandle=a.connect(c,"onZoomEnd",this,this._processMapScale);if(c.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var h=a.connect(c,"onLoad",this,function(){a.disconnect(h);h=null;this._processMapScale()})},_unsetMap:function(c,b){a.disconnect(this._lyrZEHandle);this._toggleRT();this._map=this._lyrZEHandle=null;this.suspended=!0},_cleanUp:function(){this._map=this._div=null},_fireUpdateStart:function(){this.updating||(this.updating=!0,
this.attr("data-updating",""),this._toggleRT(),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(a,b){this.updating&&(this.updating=!1,this.attr("data-updating"),this._toggleRT(!0),this.onUpdateEnd(a,b),this._map&&this._map._decr())},_getToken:function(){var a=this._url,b=this.credential;return a&&a.query&&a.query.token||b&&b.token||void 0},_findCredential:function(){this.credential=b.id&&this._url&&b.id.findCredential(this._url.path)},_useSSL:function(){var a=this._url,
b=/^http:/i;this.url&&(this.url=this.url.replace(b,"https:"));a&&a.path&&(a.path=a.path.replace(b,"https:"))},refresh:function(){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(a){this.setScaleRange(a)},setMaxScale:function(a){this.setScaleRange(null,a)},setScaleRange:function(a,b){var d=g.isDefined(a),h=g.isDefined(b);this.loaded||(this._hasMin=this._hasMin||d,this._hasMax=this._hasMax||h);var e=this.minScale,p=this.maxScale;this.minScale=(d?
a:this.minScale)||0;this.maxScale=(h?b:this.maxScale)||0;if(e!==this.minScale||p!==this.maxScale)this.onScaleRangeChange(),this._processMapScale()},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?this.suspended&&this._resume():this.suspended||this._suspend()},
_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this._toggleRT();this.onSuspend();if(this._map)this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var a=void 0===this._resumedOnce,b=this.className,d=this.getNode();if(a&&(this._resumedOnce=!0,b&&d)){var g=d.getAttribute("class")||"";RegExp("(^|\\s)"+b+"(\\s|$)","i").test(g)||d.setAttribute("class",g+((g?" ":"")+b))}this._toggleRT(!0);this.onResume({firstOccurrence:a});if(this._map)this._map.onLayerResume(this)},
_processMapScale:function(){var a=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();a!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(a){return a?p.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(a){if(!a&&(!this._map||!this._map.loaded))return!1;a=a||this._map.getScale();var b=this.minScale,d=this.maxScale,g=!b,h=!d;!g&&a<=b&&(g=!0);!h&&a>=d&&(h=!0);return g&&h},getAttributionData:function(){var a=
this.attributionDataUrl,b=new k(h._dfdCanceller);this.hasAttributionData&&a?(b._pendingDfd=d({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),b._pendingDfd.then(function(a){b.callback(a)},function(a){b.errback(a)})):(a=Error("Layer does not have attribution data"),a.log=e.isDebug,b.errback(a));return b},getResourceInfo:function(){var a=this.resourceInfo;return f.isString(a)?n.fromJson(a):f.clone(a)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(a,
b){var d=this.getNode();d&&(null==b?d.removeAttribute(a):d.setAttribute(a,b));return this},setRefreshInterval:function(a){var b=this.refreshInterval;this.refreshInterval=a;this._toggleRT();a&&!this.updating&&!this.suspended&&this._toggleRT(!0);if(b!==a)this.onRefreshIntervalChange();return this},_toggleRT:function(a){a&&this.refreshInterval?(clearTimeout(this._refreshT),this._refreshT=setTimeout(this.refresh,6E4*this.refreshInterval)):this._refreshT&&(clearTimeout(this._refreshT),this._refreshT=null)},
setNormalization:function(a){this.normalization=a},setVisibility:function(a){this.visible!==a&&(this.visible=a,this.onVisibilityChange(this.visible),this.evaluateSuspension());this.attr("data-hidden",a?null:"")},onLoad:function(){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onError:function(){}});
return p})},"esri/Color":function(){define(["dojo/_base/declare","dojo/_base/Color","dojo/has","./kernel"],function(q,e,a,f){q=q([e],{declaredClass:"esri.Color"});q.toJsonColor=function(a){return a&&[a.r,a.g,a.b,1<a.a?a.a:Math.round(255*a.a)]};q.toDojoColor=function(a){return a&&new e([a[0],a[1],a[2],a[3]/255])};f="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(a=0;a<f.length;a++)q[f[a]]=e[f[a]];return q})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect",
"dojo/_base/lang","dojo/dom-style","dojo/has"],function(q,e,a,f,k){var n={show:function(a){if(a=n.getNode(a))a.style.display="block"},getNode:function(a){return a&&a.domNode||a},hide:function(a){if(a=n.getNode(a))a.style.display="none"},toggle:function(a){if(a=n.getNode(a))a.style.display="none"===a.style.display?"block":"none"},documentBox:8>=k("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(a){if(a=
this.getNode(a)){var k=0,b=0,g=0,d=0,h=0,u=0;return[e.connect(a,"ontouchstart",function(e){k=e.touches[0].screenX;b=e.touches[0].screenY;g=a.scrollWidth;d=a.scrollHeight;h=a.clientWidth;u=a.clientHeight}),e.connect(a,"ontouchmove",function(e){e.preventDefault();var s=a.firstChild;s instanceof Text&&(s=a.childNodes[1]);var p=s._currentX||0,c=s._currentY||0,p=p+(e.touches[0].screenX-k);0<p?p=0:0>p&&Math.abs(p)+h>g&&(p=-1*(g-h));s._currentX=p;c+=e.touches[0].screenY-b;0<c?c=0:0>c&&Math.abs(c)+u>d&&(c=
-1*(d-u));s._currentY=c;f.set(s,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+p+"px, "+c+"px)"});k=e.touches[0].screenX;b=e.touches[0].screenY})]}}};return n})},"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(q,e,a,f,k,n){return q(n,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(a){a&&e.isObject(a)&&(this.size=
"auto"===this.size?this.size:f.pt2px(this.size),this.xoffset=f.pt2px(this.xoffset),this.yoffset=f.pt2px(this.yoffset),this.angle&&(this.angle*=-1))},setAngle:function(a){this.angle=a;return this},setSize:function(a){this.size=a;return this},setOffset:function(a,e){this.xoffset=a;this.yoffset=e;return this},toJson:function(){var a=f.px2pt(this.size),a=isNaN(a)?void 0:a,k=f.px2pt(this.xoffset),k=isNaN(k)?void 0:k,b=f.px2pt(this.yoffset),b=isNaN(b)?void 0:b;return e.mixin(this.inherited("toJson",arguments),
{size:"auto"===this.size?this.size:a,angle:this.angle&&-1*this.angle,xoffset:k,yoffset:b})}})})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),function(q,e,a,f,k,n){return q(null,{declaredClass:"esri.symbol.Symbol",color:new n([0,0,0,1]),type:null,constructor:function(a){if(a&&e.isObject(a)&&(e.mixin(this,a),this.color&&k.isDefined(this.color[0])&&(this.color=n.toDojoColor(this.color)),(a=this.type)&&0===a.indexOf("esri")))this.type=
{esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[a]},setColor:function(a){this.color=a;return this},toJson:function(){return{color:n.toJsonColor(this.color)}}})})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),
function(q,e,a,f,k,n,r,t,b){var g={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},d={style:g.STYLE_CIRCLE,color:[255,255,255,0.25],size:12,angle:0,xoffset:0,yoffset:0};q=q(t,{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(h,u,
m,f){h?e.isString(h)?(this.style=h,u&&(this.size=u),m&&(this.outline=m),f&&(this.color=f)):(this.style=r.valueOf(this._styles,this.style),h.outline&&(this.outline=new b(h.outline))):(e.mixin(this,d),this.size=k.pt2px(this.size),this.outline=new b(this.outline),this.color=new a(this.color));this.style||(this.style=g.STYLE_CIRCLE)},setStyle:function(a){this.style=a;return this},setPath:function(a){this.path=a;this.setStyle(g.STYLE_PATH);return this},setOutline:function(a){this.outline=a;return this},
getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(a,b,d){this._targetWidth=a;this._targetHeight=b;this._spikeSize=d},getShapeDescriptors:function(){var a,b,e,f=this.style,p=(this.size||k.pt2px(d.size))/2,c=0-p,l=0+p,w=0-p,v=0+p;switch(f){case g.STYLE_CIRCLE:a={type:"circle",cx:0,cy:0,r:p};b=this.getFill();if(e=this.getStroke())e.style=e.style||"Solid";break;case g.STYLE_CROSS:a={type:"path",path:"M "+c+",0 L "+l+",0 M 0,"+w+
" L 0,"+v+" E"};b=null;e=this.getStroke();break;case g.STYLE_DIAMOND:a={type:"path",path:"M "+c+",0 L 0,"+w+" L "+l+",0 L 0,"+v+" L "+c+",0 E"};b=this.getFill();e=this.getStroke();break;case g.STYLE_SQUARE:a={type:"path",path:"M "+c+","+v+" L "+c+","+w+" L "+l+","+w+" L "+l+","+v+" L "+c+","+v+" E"};b=this.getFill();e=this.getStroke();break;case g.STYLE_X:a={type:"path",path:"M "+c+","+v+" L "+l+","+w+" M "+c+","+w+" L "+l+","+v+" E"};b=null;e=this.getStroke();break;case g.STYLE_PATH:a={type:"path",
path:this.path||""},b=this.getFill(),e=this.getStroke()}return{defaultShape:a,fill:b,stroke:e}},toJson:function(){var a=e.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[this.style]}),b=this.outline;b&&(a.outline=b.toJson());a.path=this.path;return r.fixJson(a)}});e.mixin(q,g);q.defaultProps=d;return q})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),
function(q,e,a,f,k,n,r,t){var b={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},g={color:[0,0,0,1],style:b.STYLE_SOLID,width:1};q=q(t,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",_styles:{solid:"esriSLSSolid",
dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(d,h,u){d?e.isString(d)?(this.style=d,h&&(this.color=h),u&&(this.width=u)):this.style=r.valueOf(this._styles,d.style)||b.STYLE_SOLID:(e.mixin(this,
g),this.color=new a(this.color),this.width=k.pt2px(this.width))},setStyle:function(a){this.style=a;return this},getStroke:function(){return this.style===b.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,width:this.width}},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return r.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriSLS",style:this._styles[this.style]}))}});
e.mixin(q,b);q.defaultProps=g;return q})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(q,e,a,f,k,n){return q(n,{declaredClass:"esri.symbol.LineSymbol",constructor:function(a){e.isObject(a)?this.width=f.pt2px(this.width):this.width=12},setWidth:function(a){this.width=a;return this},toJson:function(){var a=f.px2pt(this.width),a=isNaN(a)?void 0:a;return e.mixin(this.inherited("toJson",arguments),{width:a})}})})},
"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),function(q,e,a,f,k,n,r,t,b){return q(null,{declaredClass:"esri.layers.TileInfo",constructor:function(g){e.mixin(this,g);this.width=this.cols;this.height=this.rows;g=this.spatialReference;var d=this.origin;g&&(g=this.spatialReference=new r(g.toJson?g.toJson():g));d&&(this.origin=new t(d.toJson?d.toJson():d),!d.spatialReference&&
g&&this.origin.setSpatialReference(new r(g.toJson())));this.lods=a.map(this.lods,function(a){return new b(a)})},toJson:function(){return n.fixJson({rows:this.rows,cols:this.cols,dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),lods:this.lods&&a.map(this.lods,function(a){return a.toJson()})})}})})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel","../lang"],function(q,e,a,f,k){return q(null,{declaredClass:"esri.layers.LOD",constructor:function(a){e.mixin(this,a)},toJson:function(){return k.fixJson({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}})})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s){return e([d,h],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),_isReference:!1,
_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(b,c){c&&(c.roundrobin&&(q.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),c.tileServers=c.roundrobin),this._setTileServers(c.tileServers),this._loadCallback=
c.loadCallback);this._params=a.mixin({},this._url.query);if(f.some(["servicesdev.arcgisonline.com/arcgis/rest/services","services.arcgisonline.com/arcgis/rest/services","servicesqa.arcgisonline.com/arcgis/rest/services"],function(a){return-1<b.toLowerCase().indexOf(a.toLowerCase())})){if(this.resampling=!(c&&!1===c.resampling))this.tileMap=new s(this)}else this.resampling=c&&null!=c.resampling?c.resampling:void 0;this._initLayer=a.hitch(this,this._initLayer);var d=c&&c.resourceInfo;d?this._initLayer(d):
(this._load=a.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(a){if(a&&0<a.length){this.tileServers=a;var c,d=a.length;for(c=0;c<d;c++)a[c]=b.urlToObject(a[c]).path}},_initLayer:function(a,c){this.inherited(arguments);this.resourceInfo=k.toJson(a);this.tileInfo=new u(a.tileInfo);this.resampling=null==this.resampling?!!a.resampling:this.resampling;!this.spatialReference&&this.tileInfo.spatialReference&&
(this.spatialReference=new g(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;a.timeInfo&&(this.timeInfo=new m(a.timeInfo));var b=this._url.path,d=this._loadCallback,h="file:"===window.location.protocol?"http:":window.location.protocol,e=b.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),e=e&&e[2];if(!this.tileServers)if(a.tileServers)this._setTileServers(a.tileServers);
else{var f=-1!==b.search(/^https?\:\/\/server\.arcgisonline\.com/i),s=-1!==b.search(/^https?\:\/\/services\.arcgisonline\.com/i);if(f||s)this._setTileServers([b,b.replace(f?/server\.arcgisonline/i:/services\.arcgisonline/i,f?"services.arcgisonline":"server.arcgisonline")])}if(e){e=e.toLowerCase();for(b=0;b<this._agolAttrs.length;b++)if(f=this._agolAttrs[b],f.toLowerCase()===e){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||h+"//static.arcgis.com/attribution/"+f;break}for(b=
0;b<this._referenceLayers.length;b++)if(f=this._referenceLayers[b],f.toLowerCase()===e){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);d&&(delete this._loadCallback,d(this))},getTileUrl:function(a,c,d){var g=this.tileServers,h=this._getToken(),e=this._url.query;a=(g?g[c%g.length]:this._url.path)+"/tile/"+a+"/"+c+"/"+d;this.resampling&&!this.tileMap&&(a+="?blankTile\x3dfalse");e&&(a=this.resampling&&!this.tileMap?a+("\x26"+r.objectToQuery(e)):a+("?"+r.objectToQuery(e)));if(h&&(!e||!e.token))a+=
(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+h;a=this.addTimestampToURL(a);return b.addProxy(a)}})})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),function(q,e,a,f,k,
n,r,t,b,g,d,h,u,m,s,p,c,l,w,v){return q(v,{declaredClass:"esri.layers.TiledMapServiceLayer",constructor:function(c,b){e.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=b?b.displayLevels:null)?this._displayLevels[0]:0;this.resampling=b?b.resampling:void 0;this._resamplingTolerance=b?b.resamplingTolerance:null;this.exclusionAreas=b?b.exclusionAreas:null;var d=a.hitch;this._addImage=d(this,this._addImage);this._tileLoadHandler=d(this,this._tileLoadHandler);this._tileErrorHandler=
d(this,this._tileErrorHandler);this._tilePopPop=d(this,this._tilePopPop);this._cleanUpRemovedImages=d(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=d(this,this._fireOnUpdateEvent);this._transitionEnd=d(this,this._transitionEnd);this._tileMapCallback=d(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var a=this.tileInfo,b=a.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=a.width;this._tileH=a.height;var d=
this.scales=[],l=this._displayLevels,g="esri.layers.WMTSLayer"===this.declaredClass&&96!=a.dpi,h=-Infinity,e=Infinity,u=this.fullExtent,s=new c(u.xmin,u.ymax),u=new c(u.xmax,u.ymin),v=p.getContainingTileCoords,w,k,n,t=b.length;for(n=0;n<t;n++)if(k=b[n],g&&(k.scale=96*k.scale/a.dpi),w=v(a,s,k),k.startTileRow=0>w.row?0:w.row,k.startTileCol=0>w.col?0:w.col,w=v(a,u,k),k.endTileRow=w.row,k.endTileCol=w.col,!l||-1!==f.indexOf(l,k.level))d[n]=k.scale,h=k.scale>h?k.scale:h,e=k.scale<e?k.scale:e;g&&(a.dpi=
96);-Infinity!==h&&!this._hasMin&&this.setMinScale(h);Infinity!==e&&!this._hasMax&&this.setMaxScale(e);this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=m("ie")&&7>m("ie")&&(this.isPNG32||"Mixed"===a.format)},_isMapAtVisibleScale:function(){var a=this.inherited(arguments);if(a){var c;c=this._map;var a=this.scales,b=c.getScale(),d=!1,l=c.width>c.height?c.width:c.height;for(c=0;c<a.length;c++)if(Math.abs(a[c]-b)/a[c]<1/l){d=!0;break}a=d}return a},_setMap:function(a,c,d,l){this.inherited(arguments);
this._map=a;var g=this._div=n.create("div",null,c),m=a.__visibleDelta,f=e.connect,s=h._css.names,v={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},w=u.defaults.map.zoomDuration;"css-transforms"===a.navigationMode?(v[s.transform]=h._css.translate(-m.x,-m.y),b.set(g,v),delete v[s.transform],v[s.transition]=s.transformName+" "+w+"ms ease",b.set(this._active=n.create("div",null,g),v),this._active._remove=0,this._passives=[]):(v.left=-m.x+"px",v.top=-m.y+"px",b.set(g,v));
this._onResizeHandler_connect=f(a,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=f(this,"onOpacityChange",this,"_opacityChangeHandler");m=this.tileInfo;f=m.spatialReference;s=f._getInfo();(this._wrap=a.wrapAround180&&f._isWrappable()&&Math.abs(s.origin[0]-m.origin.x)<=s.dx)&&p._addFrameInfo(m,s);this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension();if(this.suspended&&!a.loaded)var k=e.connect(a,"onLoad",this,function(){e.disconnect(k);k=null;this.setExclusionAreas(this.exclusionAreas);
this.evaluateSuspension()});return g},_unsetMap:function(a,c){this.suspended||this._suspendImpl();n.destroy(this._div);this._map=this._div=null;var b=e.disconnect;b(this._onResizeHandler_connect);b(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){s.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var a=this._tiles,c=this._tileIds,b=this._loadingList,
d,l,g=e.disconnect,h=n.destroy;b&&0<b.count&&(b.forEach(function(c){if(d=a[c])g(d._onload_connect),g(d._onerror_connect),g(d._onabort_connect),d._onload_connect=d._onerror_connect=d._onabort_connect=null}),b.clear(),this._fireUpdateEnd());this._removeList.clear();for(b=c.length-1;0<=b;b--)(d=(l=c[b])&&a[l])&&h(d);if("css-transforms"===this._map.navigationMode){c=this._active;l=this._passives;var p;this._noDom=0;for(b=l.length-1;0<=b;b--)p=l[b],p._endHandle&&g(p._endHandle),p._matrix=p._multiply=p._endHandle=
null,p._marked=p._remove=0,l.splice(b,1),h(p);c._matrix=c._multiply=null;c._marked=c._remove=0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new g;this._loadingList=new g;s.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,
null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var a=this._map,c=e.connect;if("css-transforms"===a.navigationMode){if(this._onScaleHandler_connect=c(a,"onScale",this,this._onScaleHandler),m("esri-touch")||m("esri-pointer")){this._standby=[];var b=this,d=function(){b._noDom=1};this._onPanStartHandler_connect=c(a,"onPanStart",d);this._onZoomStartHandler_connect=c(a,"onZoomStart",d)}}else this._onZoomHandler_connect=c(a,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=c(a,
"onPan",this,"_onPanHandler");this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=e.disconnect;a(this._onPanHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onPanStartHandler_connect);a(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=
this._onZoomStartHandler_connect=null},_onResizeHandler:function(a,c,d){a={width:c+"px",height:d+"px"};c=b.set;c(this._div,a);if("css-transforms"===this._map.navigationMode){this._active&&c(this._active,a);for(d=this._passives.length-1;0<=d;d--)c(this._passives[d],a)}},_onExtentChangeHandler:function(a,c,g,e){c=this._map;var u=this._standby,m;clearTimeout(this._wakeTimer);this._wakeTimer=null;if(!c._isPanningOrZooming()){if("css-transforms"===c.navigationMode){if(g)for(e=this._passives.length-1;0<=
e;e--)m=this._passives[e],b.set(m,h._css.names.transition,"none"),m._marked?(this._passives.splice(e,1),m.parentNode&&m.parentNode.removeChild(m),n.destroy(m)):0<m.childNodes.length&&(m._multiply=m._multiply?d.multiply(m._matrix,m._multiply):m._matrix);this._noDom=0;if(u&&u.length)for(e=u.length-1;0<=e;e--)m=u[e],b.set(m,"visibility","visible"),this._tilePopPop(m),u.splice(e,1)}this._fireUpdateStart();this._rrIndex=0;e=p.getCandidateTileInfo(c,this.tileInfo,a);a=c.__visibleDelta;if(!this._ct||e.lod.level!==
this._ct.lod.level||g){m=e&&this._ct&&e.lod.level!==this._ct.lod.level;this._ct=e;var f=this._tiles,s=this._tileIds,v=this._tileBounds,w=this._removeList,k,r=s.length;this._cleanUpRemovedImages();for(e=0;e<r;e++)u=s[e],k=f[u],v[u]=s[e]=null,"css-transforms"===c.navigationMode&&(m&&k.parentNode&&c.fadeOnZoom)&&(k._fadeOut=m,k.parentNode._remove++),w.add(k);g&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}e=a.x;g=a.y;"css-transforms"===c.navigationMode?(u={},u[h._css.names.transform]=h._css.translate(e,
g),b.set(this._div,u)):b.set(this._div,{left:e+"px",top:g+"px"});this.__coords_dx=e;this.__coords_dy=g;this._updateImages(new l(0,0,a.width,a.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;g=this._tileW;f=this._tileH;a=new l(-a.x,-a.y,a.width,a.height);for(e=this._tileIds.length-1;0<=e;e--)(u=this._tileIds[e])?(m=this._tiles[u],s=t.getMarginBox(m),s=new l(s.l,s.t,g,f),"css-transforms"===c.navigationMode&&(s.x=m._left,
s.y=m._top),a.intersects(s)?this._tileBounds[u]=s:(this._loadingList.contains(u)&&this._tilePopPop(m),n.destroy(m),this._tileIds.splice(e,1),delete this._tileBounds[u],delete this._tiles[u])):(this._tileIds.splice(e,1),delete this._tileBounds[u],delete this._tiles[u])}},_onPanHandler:function(a,c){var d=this._map,l=d.__visibleDelta.offset(c.x,c.y);this.__coords_dx=this.__coords_dy=0;"css-transforms"===d.navigationMode?(d={},d[h._css.names.transform]=h._css.translate(l.x,l.y),b.set(this._div,d),!m("esri-touch")&&
!m("esri-pointer")&&this._updateImages({x:-l.x,y:-l.y,width:l.width,height:l.height})):(b.set(this._div,{left:l.x+"px",top:l.y+"px"}),this._updateImages({x:-l.x,y:-l.y,width:l.width,height:l.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(a,c){var l,g={},e=h._css.names,p=this._map,m=u.defaults.map.zoomDuration;for(l=this._passives.length-1;0<=l;l--){var f=this._passives[l];0===f.childNodes.length?(this._passives.splice(l,1),n.destroy(f)):
("none"===f.style[e.transition]&&b.set(f,e.transition,e.transformName+" "+m+"ms ease"),b.set(f,e.transition,c?"none":e.transformName+" "+m+"ms ease"),f._matrix=a,g[e.transform]=h._css.matrix(f._multiply?d.multiply(a,f._multiply):a),b.set(f,g))}this._active&&0===this._active.childNodes.length||(b.set(this._active,e.transition,c?"none":e.transformName+" "+m+"ms ease"),this._active._matrix=a,g[e.transform]=h._css.matrix(this._active._matrix),b.set(this._active,g),this._passives.push(this._active),g=
{position:"absolute",width:p.width+"px",height:p.height+"px",overflow:"visible"},g[e.transition]=e.transformName+" "+m+"ms ease",b.set(this._active=n.create("div",null,this._div),g),this._active._remove=0,p.fadeOnZoom&&n.place(this._active,this._div,"first"))},_onZoomHandler:function(a,c,d){a=t.getMarginBox(this._div);d=d.offset(-a.l,-a.t);if(!this._previousScale||1===c)this._previousScale=1;var l,g=this._tileW*c,h=this._tileH*c,e=this._tileBounds,p=this._tiles,u=this._previousScale,s=this._multiple,
v=b.set,w,k;if((a=m("ie"))&&8>a)f.forEach(this._tileIds,function(a){k="";l=e[a];w=p[a].style.margin.split(" ");f.forEach(w,function(a){""!==k&&(k+=" ");a=parseFloat(a);k+=a/u*c+"px"});v(p[a],{left:l.x-(g-l.width)*(d.x-l.x)/l.width+"px",top:l.y-(h-l.height)*(d.y-l.y)/l.height+"px",margin:1!==s&&-1===k.indexOf("NaN")?k:"",zoom:c})});else{var n=g*s,r=h*s,q,K;f.forEach(this._tileIds,function(a){k="";l=e[a];q=l.x-(g-l.width)*(d.x-l.x)/l.width;K=l.y-(h-l.height)*(d.y-l.y)/l.height;w=p[a].style.margin.split(" ");
f.forEach(w,function(a){""!==k&&(k+=" ");a=parseFloat(a);k+=a/u*c+"px"});v(p[a],{left:q+"px",top:K+"px",margin:1!==s&&-1===k.indexOf("NaN")?k:"",width:n+"px",height:r+"px"})})}this._previousScale=c},_updateImages:function(a){if(this._ct){var c,b=this._tileW,d=this._tileH,l=this._ct;c=l.lod;var l=l.tile,g=l.offsets,h=l.coords,e=h.row,h=h.col,p=c.level,u=this.opacity,m=this._tileIds,s=this._loadingList,v=this._addImage,w=this._map.id,k=this.id,n=a.x,t=a.y,r=c.startTileRow,q=c.endTileRow,R=c.startTileCol,
ba=c.endTileCol,S=f.indexOf,U,O,W=g.x-this.__coords_dx,aa=g.y-this.__coords_dy;O=b-W+-a.x;var V=d-aa+-a.y;U=Math.ceil;O=0<O?O%b:b-Math.abs(O)%b;V=0<V?V%d:d-Math.abs(V)%d;n=0<n?Math.floor((n+W)/b):U((n-(b-W))/b);t=0<t?Math.floor((t+aa)/d):U((t-(d-aa))/d);aa=n+U((a.width-O)/b);a=t+U((a.height-V)/d);var Y,Z,X;this._wrap&&(Y=c._frameInfo,Z=Y[0],X=Y[1],Y=Y[2]);for(V=n;V<=aa;V++)for(n=t;n<=a;n++)U=e+n,O=h+V,this._wrap&&(O<X?(O%=Z,O=O<X?O+Z:O):O>Y&&(O%=Z)),!this._isExcluded(p,U,O)&&(U>=r&&U<=q&&O>=R&&O<=
ba)&&(c=w+"_"+k+"_tile_"+p+"_"+n+"_"+V,-1===S(m,c)&&(s.add(c),m.push(c),v(p,n,U,V,O,c,b,d,u,l,g)))}},_cleanUpRemovedImages:function(){var a=this._removeList,c=n.destroy,d,l=h._css.names;a.forEach(function(a){a._fadeOut||(a.style.filter="",a.style.zoom=1,c(a))});if("css-transforms"===this._map.navigationMode)for(d=this._passives.length-1;0<=d;d--){var g=this._passives[d];0===g.childNodes.length?(this._passives.splice(d,1),c(g)):this._map.fadeOnZoom&&(!g._marked&&g._remove===g.childNodes.length)&&(g._marked=
1,2048>h._css.getScaleFromMatrix(b.get(g,l.transform))?(b.set(g,l.transition,"opacity 0.65s"),b.set(g,"opacity",0),e.disconnect(g._endHandle),g._endHandle=e.connect(g,l.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:g}))}a.clear()},_transitionEnd:function(a){var c=a.target;"opacity"===a.propertyName&&(e.disconnect(c._endHandle),c._endHandle=null,a=f.indexOf(this._passives,c),-1<a&&this._passives.splice(a,1),c.parentNode&&c.parentNode.removeChild(c),n.destroy(c))},
_addImage:function(c,d,l,g,p,u,m,f,s,v,w){if(this._patchIE)v=this._tiles[u]=n.create("div"),v.id=u,r.add(v,"layerTile"),b.set(v,{left:m*g-w.x+"px",top:f*d-w.y+"px",width:m+"px",height:f+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(c,l,p)+"', sizingMethod\x3d'scale')"}),1>s&&b.set(v,"opacity",s),c=v.appendChild(n.create("div")),b.set(c,{opacity:0,width:m+"px",height:f+"px"}),this._div.appendChild(v),this._loadingList.remove(u),this._fireOnUpdateEvent();
else{v=this._tiles[u]=n.create("img");var k=e.connect;v.id=u;r.add(v,"layerTile");g=m*g-w.x;w=f*d-w.y;d=this._map;var t=h._css.names;m={width:m+"px",height:f+"px",visibility:"hidden"};"css-transforms"===d.navigationMode?(m[t.transform]=h._css.translate(g,w),b.set(v,m),v._left=g,v._top=w):(m.left=g+"px",m.top=w+"px",b.set(v,m));1>s&&b.set(v,"opacity",s);v._onload_connect=k(v,"onload",this,"_tileLoadHandler");v._onerror_connect=k(v,"onerror",a.hitch(this,"_tileErrorHandler",l,p));v._onabort_connect=
k(v,"onabort",this,"_tileAbortHandler");if(this.tileMap)this.tileMap.getTile(c,l,p,u,this._tileMapCallback);else if(u=this.getTileUrl(c,l,p,v))this._failedRequests&&this._failedRequests[u]?(b.set(v,this._failedRequests[u].css),v.src=this._failedRequests[u].src,this._multiple=parseInt(this._failedRequests[u].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,v.src=u);"css-transforms"===d.navigationMode?this._active.appendChild(v):this._div.appendChild(v)}},
_tileMapCallback:function(a,c){var d,l;!this.suspended&&this._tiles[c.id]&&(this._multiple=2*(c.level-a.level)||1,this.isResampling=1!==this._multiple,l=this._tiles[c.id],d=this.tileMap.style(a,c),b.set(l,d),l.src=this.getTileUrl(a.level,a.row,a.col))},getTileUrl:function(a,c,b){},_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,addTimestampToURL:function(a){var c=this._refreshTS;c&&(a=this._reCheckTS.test(a)?a.replace(this._reReplaceTS,"$$$1"+c):a+((-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+
c));return a},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_tilePopPop:function(a){var c=e.disconnect;c(a._onload_connect);c(a._onerror_connect);c(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null;this._loadingList.remove(a.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(a){a=a.currentTarget;this._noDom?this._standby.push(a):(b.set(a,"visibility","visible"),this._tilePopPop(a))},
_tileAbortHandler:function(a){a=a.currentTarget;this.onError(Error("Unable to load tile: "+a.src));b.set(a,"visibility","hidden");this._tilePopPop(a)},_tileErrorHandler:function(a,c,d){d=d.currentTarget;var l,g,h=!0;if(this.tileMap||!this.resampling)h=!1;else if(l=new k(d.src),l=l.path.split("/"),l=parseInt(l[l.length-3]),g=this._ct.lod.level-l+1,this._multiple=Math.pow(2,g),l===this._lowestLevel||0===this._resamplingTolerance||this._resamplingTolerance&&Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)h=
!1;h?(this.isResampling=!0,this._resample(d,a,c)):(this.onError(Error("Unable to load tile: "+d.src)),b.set(d,"visibility","hidden"),this._tilePopPop(d))},_resample:function(a,c,d){var l=(new k(a.src)).path.split("/"),g=this._multiple,h=parseInt(l[l.length-3])-1,e=parseInt(c/g),p=parseInt(d/g),l=d%g,u=c%g,e=this.getTileUrl(h,e,p);c=this.getTileUrl(h+Math.log(g)/Math.LN2,c,d);g={width:this._tileW*g+"px",height:this._tileH*g+"px",margin:"-"+this._tileW*u+"px 0 0 "+("-"+this._tileH*l+"px")};this._failedRequests||
(this._failedRequests={});this._failedRequests[c]={src:e,css:g};b.set(a,g);m("chrome")&&a.setAttribute("src",null);a.src=e},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var c=b.set,d,l,g;if("css-transforms"===this._map.navigationMode){if(this._active){g=
this._active.childNodes;for(d=g.length-1;0<=d;d--)c(g[d],"opacity",a)}for(d=this._passives.length-1;0<=d;d--){g=this._passives[d].childNodes;for(l=g.length-1;0<=l;l--)c(g[l],"opacity",a)}}else{g=this._div.childNodes;for(d=g.length-1;0<=d;d--)c(g[d],"opacity",a)}},setExclusionAreas:function(a){this.exclusionAreas=a;if(this.loaded&&this._map&&this._map.loaded){var b=this._map.spatialReference,d=this.tileInfo,l=d.origin,g=d.lods,h=g[0].level,e=g[g.length-1].level,p,u,m,f,s,v,k,n,t;if(!this.exclusionAreas||
!this.exclusionAreas.length)this._exclusionsPerZoom=null;else{this._exclusionsPerZoom=[];u=0;for(m=a.length;u<m;u++)if(p=a[u],(t=p.geometry)&&"extent"===t.type&&t.xmin<=t.xmax&&t.ymin<=t.ymax){if(!b.equals(t.spatialReference))if(b._canProject(t.spatialReference))b.isWebMercator()?(n=c.lngLatToXY(t.xmin,t.ymin),t=c.lngLatToXY(t.xmax,t.ymax)):(n=c.xyToLngLat(t.xmin,t.ymin,!0),t=c.xyToLngLat(t.xmax,t.ymax,!0)),t=new w(n[0],n[1],t[0],t[1],b);else continue;k=-1;if(p.minZoom&&-1!==p.minZoom)k=p.minZoom;
else if(p.minScale&&-1!==p.minScale){f=0;for(s=g.length;f<s;f++)if(g[f].scale<=p.minScale){k=g[f].level;break}}k=Math.max(k,h);n=-1;if(p.maxZoom&&-1!==p.maxZoom)n=p.maxZoom;else if(p.maxScale&&-1!==p.maxScale){f=0;for(s=g.length;f<s;f++)if(g[f].scale<p.maxScale){n=g[f-1].level;break}else if(g[f].scale===p.maxScale){n=g[f].level;break}}n=-1===n?e:Math.min(n,e);for(p=k;p<=n;p++){f=0;for(s=g.length;f<s;f++)if(g[f].level===p){v=g[f];break}v&&(this._exclusionsPerZoom[p]||(this._exclusionsPerZoom[p]=[]),
f=1/v.resolution/d.rows,s=1/v.resolution/d.cols,this._exclusionsPerZoom[p].push({rowFrom:Math.floor((l.y-t.ymax)*f),rowTo:Math.ceil((l.y-t.ymin)*f),colFrom:Math.floor((t.xmin-l.x)*s),colTo:Math.ceil((t.xmax-l.x)*s)}))}}}this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(a,c,b){var d,l,g;if(!this._exclusionsPerZoom)return!1;d=this._exclusionsPerZoom[a];if(!d)return!1;l=0;for(g=d.length;l<g;l++)if(a=d[l],c>=a.rowFrom&&c<a.rowTo&&b>=a.colFrom&&
b<a.colTo)return!0;return!1}})})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(q,e,a){a.ArrayList=function(e){var k=[];e&&(k=k.concat(e));this.count=k.length;this.add=function(a){k.push(a);this.count=k.length};this.addRange=function(a){if(a.getIterator)for(a=a.getIterator();!a.atEnd();)this.add(a.get());else for(var e=0;e<a.length;e++)k.push(a[e]);this.count=k.length};this.clear=function(){k.splice(0,k.length);this.count=0};this.clone=
function(){return new a.ArrayList(k)};this.contains=function(a){for(var e=0;e<k.length;e++)if(k[e]==a)return!0;return!1};this.forEach=function(a,e){q.forEach(k,a,e)};this.getIterator=function(){return new a.Iterator(k)};this.indexOf=function(a){for(var e=0;e<k.length;e++)if(k[e]==a)return e;return-1};this.insert=function(a,e){k.splice(a,0,e);this.count=k.length};this.item=function(a){return k[a]};this.remove=function(a){a=this.indexOf(a);0<=a&&k.splice(a,1);this.count=k.length};this.removeAt=function(a){k.splice(a,
1);this.count=k.length};this.reverse=function(){k.reverse()};this.sort=function(a){a?k.sort(a):k.sort()};this.setByIndex=function(a,e){k[a]=e;this.count=k.length};this.toArray=function(){return[].concat(k)};this.toString=function(a){return k.join(a||",")}};return a.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(q,e,a){q=e.getObject("dojox.collections",!0);q.DictionaryEntry=function(a,e){this.key=a;this.value=e;this.valueOf=
function(){return this.value};this.toString=function(){return String(this.value)}};q.Iterator=function(e){var k=0;this.element=e[k]||null;this.atEnd=function(){return k>=e.length};this.get=function(){return this.atEnd()?null:this.element=e[k++]};this.map=function(k,r){return a.map(e,k,r)};this.reset=function(){k=0;this.element=e[k]}};q.DictionaryIterator=function(e){var k=[],n={},r;for(r in e)n[r]||k.push(e[r]);var t=0;this.element=k[t]||null;this.atEnd=function(){return t>=k.length};this.get=function(){return this.atEnd()?
null:this.element=k[t++]};this.map=function(b,g){return a.map(k,b,g)};this.reset=function(){t=0;this.element=k[t]}};return q})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(q,e,a,f,k,n,r,t,b,g){return q(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",infoTemplates:null,constructor:function(a,b){this.layerInfos=[];b&&(this.infoTemplates=
b.infoTemplates||null);var g=this._params={},e=this._url.query?this._url.query.token:null;e&&(g.token=e)},setInfoTemplates:function(a){this.infoTemplates=a},_load:function(){r({url:this._url.path,content:e.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(d,h){try{this._findCredential();(this.credential&&this.credential.ssl||d&&d._ssl)&&
this._useSSL();this.description=d.description;this.copyright=d.copyrightText;this.spatialReference=d.spatialReference&&new t(d.spatialReference);this.initialExtent=d.initialExtent&&new b(d.initialExtent);this.fullExtent=d.fullExtent&&new b(d.fullExtent);this.units=d.units;this.maxRecordCount=d.maxRecordCount;this.maxImageHeight=d.maxImageHeight;this.maxImageWidth=d.maxImageWidth;this.supportsDynamicLayers=d.supportsDynamicLayers;var e=this.layerInfos=[],m=d.layers,f=this._defaultVisibleLayers=[];
a.forEach(m,function(a,b){e[b]=new g(a);a.defaultVisibility&&f.push(a.id)});this.visibleLayers||(this.visibleLayers=f);this.version=d.currentVersion;this.version||(this.version="capabilities"in d||"tables"in d?10:"supportedImageFormatTypes"in d?9.31:9.3);this.capabilities=d.capabilities;n.isDefined(d.minScale)&&!this._hasMin&&this.setMinScale(d.minScale);n.isDefined(d.maxScale)&&!this._hasMax&&this.setMaxScale(d.maxScale)}catch(p){this._errorHandler(p)}}})})},"esri/layers/LayerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../lang"],function(q,e,a,f,k){return q(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(a){e.mixin(this,a)},toJson:function(){return k.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}})})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),
function(q,e,a,f,k,n,r){q=q(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(a){null!==a&&(e.mixin(this,a),a.exportOptions&&(this.exportOptions=new r(a.exportOptions)),this.timeExtent=null,a.timeExtent&&2===a.timeExtent.length&&(this.timeExtent=new k(a.timeExtent)),this.timeReference=new n(a.timeReference))}});e.mixin(q,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",
UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});return q})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(q,e,a,f){var k=q(null,{declaredClass:"esri.TimeExtent",constructor:function(a){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(a)if(e.isArray(a)){var f=
a[0],k=a[1];this.startTime=null===f||"null"===f?null:new Date(f);this.endTime=null===k||"null"===k?null:new Date(k)}else a instanceof Date&&this._create(a,null)},offset:function(a,e){var f=new k,b=this.startTime,g=this.endTime;b&&(f.startTime=this._getOffsettedDate(b,a,e));g&&(f.endTime=this._getOffsettedDate(g,a,e));return f},intersection:function(a){return this._intersection(this,a)},toJson:function(){var a=[],e=this.startTime;a.push(e?e.getTime():"null");e=this.endTime;a.push(e?e.getTime():"null");
return a},_create:function(a,e){this.startTime=a?new Date(a.getTime()):null;this.endTime=e?new Date(e.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",
setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(a,e){if(a&&e){var f=a.startTime,b=a.endTime,
g=e.startTime,d=e.endTime,f=f?f.getTime():-Infinity,g=g?g.getTime():-Infinity,b=b?b.getTime():Infinity,d=d?d.getTime():Infinity,h,u;g>=f&&g<=b?h=g:f>=g&&f<=d&&(h=f);b>=g&&b<=d?u=b:d>=f&&d<=b&&(u=d);if(!isNaN(h)&&!isNaN(u))return f=new k,f.startTime=-Infinity===h?null:new Date(h),f.endTime=Infinity===u?null:new Date(u),f}return null},_getOffsettedDate:function(a,e,f){var b=this._refData;a=new Date(a.getTime());e&&f&&(b=b[f],a[b.setter](a[b.getter]()+e*b.multiplier));return a}});return k})},"esri/layers/TimeReference":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(q,e,a,f){return q(null,{declaredClass:"esri.layers.TimeReference",constructor:function(a){a&&e.mixin(this,a)}})})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(q,e,a,f,k){return q(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(a){a&&e.mixin(this,a)},toJson:function(){return k.fixJson({timeDataCumulative:this.timeDataCumulative,timeOffset:this.timeOffset,
timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime})}})})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils".split(" "),function(q,e,a,f,k,n,r){return q(null,{declaredClass:"esri.layers.TileMap",constructor:function(a){this.layer=a;this._tileMaps={}},getTile:function(a,b,g,d,h){a={id:d,level:a,row:b,col:g};b=this._getResamplingBudget();0<b?this._process({tile:a,requestedTile:a,callback:h,resamplingBudget:b}):
(h||this.callback).call(this,a,a)},statusOf:function(a,b,g){var d=this._getResamplingBudget();a={level:a,row:b,col:g};if(0===d)return 1;for(;0<=d;){b=this._tileToTileMap(a);if(!this._tileMaps[b.uid])return-1;b=this._tileMaps[b.uid];if(!b.promise.isFulfilled())return-1;if(this._isTileAvailable(a,b))return 1;a=this._parentTile(a);if(!a)break;d--}return 0},style:function(a,b){if(!(a.level===b.level&&a.row===b.row&&a.col===b.col)){for(var g=this.layer.tileInfo,d=g.lods,h=g.cols,g=g.rows,e,m,f=d.length-
1;!e||!m;)!e&&d[f].level===a.level&&(e=d[f]),!m&&d[f].level===b.level&&(m=d[f]),f--;d=Math.round(e.resolution/m.resolution);return{width:h*d+"px",height:g*d+"px",margin:"-"+b.row%d*g+"px 0 0 -"+b.col%d*h+"px"}}},_process:function(a){var b=a.tile,g=this._tileToTileMap(b),d=this._parentTile(b);this._getTileMap(g).then(e.hitch(this,function(h){g=h;this._isTileAvailable(b,g)?(a.callback||this.callback).call(this,b,a.requestedTile):0<a.resamplingBudget&&d?(a.resamplingBudget--,a.tile=d,this._process(a)):
(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}),e.hitch(this,function(){(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}))},_getTileMap:function(a){var b,g,d,h,u=null;this._tileMaps[a.uid]?(a=this._tileMaps[a.uid],b=a.promise):(this._tileMaps[a.uid]=a,g=new f,n({url:this._getTileMapUrl(a.level,a.row,a.col),handleAs:"json",callbackParamName:"callback",timeout:3E3,load:function(b){e.mixin(a,b);if(a.data&&0<a.data.length){h=a.data.length;if(1===h)u=a.data[0];
else{u=a.data[0];for(d=1;d<h;d++)if(a.data[d]!==u){u=null;break}}null!==u&&(delete a.data,a.value=u)}g.resolve(a)},error:function(a){g.reject()}}),b=a.promise=g.promise);return b},_parentTile:function(e){var b=this.layer.tileInfo.lods,g,d,h=null;a.some(b,function(a,b){return e.level===a.level?(g=a,d=b,!0):!1});0<d&&(b=b[d-1],h={id:e.id,level:b.level,row:Math.floor(e.row*g.resolution/b.resolution+0.01),col:Math.floor(e.col*g.resolution/b.resolution+0.01)});return h},_tileToTileMap:function(a){var b=
8*Math.floor(a.row/8),g=8*Math.floor(a.col/8);return{uid:a.level+"_"+b+"_"+g,level:a.level,row:b,col:g}},_isTileAvailable:function(a,b){var g,d;b.valid?void 0!==b.value?g=b.value:(g=b.location.left,d=b.location.top,g=(a.row-d)*b.location.width+(a.col-g),g=g<b.data.length?b.data[g]:0):g=0;return g},_getTileMapUrl:function(a,b,g){var d=this.layer,h=d.tileServers,e=d._getToken(),f=d._url.query;a=(h?h[b%h.length]:d._url.path)+"/tilemap/"+a+"/"+b+"/"+g+"/8/8";f&&(a+="?"+k.objectToQuery(f));if(e&&(!f||
!f.token))a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+e;a=d.addTimestampToURL(a);return r.addProxy(a)},_getResamplingBudget:function(){var a=this.layer,b=0;if(a.resampling&&(b=a._resamplingTolerance,null===b||void 0===b))b=a.tileInfo.lods.length;return b}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u){var m=q([u],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(b){this.inherited(arguments,[null,b]);this._mapImages=[];var d=a.hitch;this._panStart=d(this,this._panStart);this._pan=d(this,this._pan);this._extentChange=d(this,this._extentChange);this._zoom=d(this,this._zoom);this._zoomStart=d(this,this._zoomStart);this._scale=d(this,this._scale);this._resize=d(this,this._resize);e.connect(this,"onSuspend",this,this._onSuspend);
e.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var b=this._mapImages.push(a),b=b-1;a._idx=b;a._layer=this;this._div&&this._createImage(a,b)},removeImage:function(a){if(a){var b=a._idx,c=this._mapImages;if(c[b]===a){delete c[b];if(b=a._node)this._clearEvents(b),b.e_idx=b.e_bl=b.e_tr=b.e_l=b.e_t=b.e_w=b.e_h=null,b.parentNode&&(b.parentNode.removeChild(b),k.destroy(b));a._node=a._idx=a._layer=null}}},removeAllImages:function(){var a=this._mapImages,
b,c=a.length;for(b=0;b<c;b++){var d=a[b];d&&this.removeImage(d)}this._mapImages=[]},getImages:function(){var a=this._mapImages,b=[],c,d=a.length;for(c=0;c<d;c++)a[c]&&b.push(a[c]);return b},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var d=this._div,c,l;if(d)if(!b("ie")||8<b("ie"))n.set(d,"opacity",a);else{l=d.childNodes;c=l.length;for(d=0;d<c;d++)n.set(l[d],"opacity",a)}},_createImage:function(a,
d){var c=k.create("img");n.set(c,{position:"absolute"});1>a.opacity?n.set(c,"opacity",a.opacity):8>=b("ie")&&n.set(c,"opacity",this.opacity);a.rotation&&!(9>b("ie"))&&n.set(c,r._css.names.transform,r._css.rotate(360-a.rotation));a._node=c;c.e_idx=d;c.e_layer=this;c.e_load=e.connect(c,"onload",m.prototype._imageLoaded);c.e_error=e.connect(c,"onerror",m.prototype._imageError);c.e_abort=e.connect(c,"onabort",m.prototype._imageError);c.src=a.href},_imageLoaded:function(a,b){var c=b||a.target||a.currentTarget,
d=c.e_layer,g=d._mapImages[c.e_idx],h=d._map;h&&(h.__zooming||h.__panning||!d._sr)?d._standby.push(c):(d._clearEvents(c),g&&g._node===c&&h&&d._attach(g))},_imageError:function(a){a=a.target||a.currentTarget;var b=a.e_layer,c=b._mapImages[a.e_idx];b._clearEvents(a);c&&(c._node=null)},_clearEvents:function(a){var b=e.disconnect;b(a.e_load);b(a.e_error);b(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(a){var b=a.extent,c=b.spatialReference,l=this._sr,g=this._div,e=a._node,f=
new d({x:b.xmin,y:b.ymin,spatialReference:c}),b=new d({x:b.xmax,y:b.ymax,spatialReference:c});l.equals(c)||(l.isWebMercator()&&4326===c.wkid?(f=h.geographicToWebMercator(f),b=h.geographicToWebMercator(b)):c.isWebMercator()&&4326===l.wkid&&(f=h.webMercatorToGeographic(f),b=h.webMercatorToGeographic(b)));e.e_bl=f;e.e_tr=b;a.visible&&(this._setPos(e,g._left,g._top),(this._active||g).appendChild(e))},_setPos:function(a,b,c){var d=a.e_bl,g=a.e_tr,h=this._map,d=h.toScreen(d),g=h.toScreen(g);b=d.x-b;c=g.y-
c;var e=Math.abs(g.x-d.x),d=Math.abs(d.y-g.y),g={width:e+"px",height:d+"px"},f=this._mapImages[a.e_idx];"css-transforms"===h.navigationMode?g[r._css.names.transform]=r._css.translate(b,c)+(f.rotation?" "+r._css.rotate(360-f.rotation):""):(g.left=b+"px",g.top=c+"px");n.set(a,g);a.e_l=b;a.e_t=c;a.e_w=e;a.e_h=d},managedSuspension:!0,_setMap:function(a,d){this.inherited(arguments);var c=this._div=k.create("div",null,d),l=r._css.names,h={position:"absolute"},e=a.__visibleDelta;if(!b("ie")||8<b("ie"))h.opacity=
this.opacity;"css-transforms"===a.navigationMode?(h[l.transform]=r._css.translate(e.x,e.y),n.set(c,h),c._left=e.x,c._top=e.y,h={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},this._active=k.create("div",null,c),n.set(this._active,h),this._passive=k.create("div",null,c),n.set(this._passive,h)):(c._left=0,c._top=0,n.set(c,h));this._standby=[];l=this._mapImages;e=l.length;for(h=0;h<e;h++){var f=l[h];f._node||this._createImage(f,f._idx)}g.hide(c);return c},_unsetMap:function(a,
b){this._disconnect();var c=this._div;if(c){var d=this._mapImages,g,h=d.length;for(g=0;g<h;g++){var e=d[g];if(e){var f=e._node;f&&(this._clearEvents(f),f.e_idx=f.e_bl=f.e_tr=f.e_l=f.e_t=f.e_w=f.e_h=null);e._node=null}}b.removeChild(c);k.destroy(c)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();g.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());
a=this._map;var b=this._div,c=a.__visibleDelta;"css-transforms"===a.navigationMode&&(b._left=c.x,b._top=c.y,n.set(b,r._css.names.transform,r._css.translate(b._left,b._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);g.show(b)},_connect:function(a){if(!this._connections){var b=e.connect,c="css-transforms"===a.navigationMode;this._connections=[b(a,"onPanStart",this._panStart),b(a,"onPan",this._pan),b(a,"onExtentChange",this._extentChange),c&&b(a,"onZoomStart",this._zoomStart),
c?b(a,"onScale",this._scale):b(a,"onZoom",this._zoom),c&&b(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(f.forEach(this._connections,e.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,b){var c=this._div;c._left=this._panL+b.x;c._top=this._panT+b.y;"css-transforms"===this._map.navigationMode?n.set(c,r._css.names.transform,r._css.translate(c._left,c._top)):n.set(c,{left:c._left+"px",top:c._top+
"px"})},_extentChange:function(a,b,c){c?this._redraw("css-transforms"===this._map.navigationMode):b&&this._pan(a,b);this._processStandbyList()},_processStandbyList:function(){var a,b=this._standby;if(b&&b.length)for(a=b.length-1;0<=a;a--)this._imageLoaded(null,b[a]),b.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var b=r._css.names;n.set(a,b.transition,"none");this._moveImages(a,this._active);n.set(a,b.transform,"none")}a=this._active||this._div;var b=this._div._left,c=this._div._top,d,g=
a.childNodes.length,h;for(d=0;d<g;d++)h=a.childNodes[d],this._setPos(h,b,c)},_zoom:function(a,b,c){a=this._div;var d=a._left,g=a._top,h,e=a.childNodes.length,f;for(h=0;h<e;h++){f=a.childNodes[h];var u=f.e_w*b,m=f.e_h*b,k=(c.x-d-f.e_l)*(u-f.e_w)/f.e_w,t=(c.y-g-f.e_t)*(m-f.e_h)/f.e_h,k=isNaN(k)?0:k,t=isNaN(t)?0:t;n.set(f,{left:f.e_l-k+"px",top:f.e_t-t+"px",width:u+"px",height:m+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,b){var c=a.childNodes,
d;d=c.length;if(0<d)for(d-=1;0<=d;d--)b.appendChild(c[d])},_scale:function(a,b){var c=r._css.names,d=this._passive;n.set(d,c.transition,b?"none":c.transformName+" "+t.defaults.map.zoomDuration+"ms ease");r._css.matrix(a);n.set(d,c.transform,r._css.matrix(a))},_resize:function(a,b,c){n.set(this._active,{width:b+"px",height:c+"px"});n.set(this._passive,{width:b+"px",height:c+"px"})}});return m})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(q,e,a,f,k,n,r,t,b){return q(t,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(a){this.spatialReference=new n({wkid:102100});this.tileInfo=new b({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:0.597164283559817},{level:19,scale:1128.497176,resolution:0.298582141647617}]});this.fullExtent=
new r({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new r({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=a&&a.tileServers||["http://a.tile.openstreetmap.org","http://b.tile.openstreetmap.org","http://c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=a?a.displayLevels:null;this.copyright=a&&a.copyright||
"Map data \x26copy; OpenStreetMap contributors, CC-BY-SA";this.loaded=!0;this.onLoad(this);(a=a&&a.loadCallback)&&a(this)},getTileUrl:function(a,b,h){a=this.tileServers[b%this.serversLength]+"/"+a+"/"+h+"/"+b+".png";a=this.addTimestampToURL(a);return k.addProxy(a)}})})},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z){return q([y,B,t],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(a,c){this.initialize();e.mixin(this,a);this.domNode=g.byId(c);var b=this._nls=e.mixin({},z.widgets.popup),l=this.domNode;h.add(l,"esriPopup");(this._isRTL=
!m.isBodyLtr())&&s.set(l,"direction","rtl");d.set(l,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+b.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+b.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+b.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
b.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+b.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d"+b.NLS_zoomTo+" class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+b.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=k.query(".sizer",l);b=k.query(".titlePane",l)[0];g.setSelectable(b,!1);this._title=k.query(".title",b)[0];this._prevFeatureButton=k.query(".prev",b)[0];this._nextFeatureButton=k.query(".next",b)[0];this._maxButton=k.query(".maximize",b)[0];this._spinner=k.query(".spinner",b)[0];this._contentPane=k.query(".contentPane",l)[0];this._positioner=k.query(".esriPopupWrapper",l)[0];this._pointer=k.query(".pointer",l)[0];this._outerPointer=k.query(".outerPointer",l)[0];this._actionList=k.query(".actionsPane .actionList",
l)[0];this._eventConnections=[f.connect(k.query(".close",b)[0],"onclick",this,this.hide),f.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),f.connect(this._nextFeatureButton,"onclick",this,this.selectNext),f.connect(this._maxButton,"onclick",this,this._toggleSize),f.connect(k.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),f.connect(this,"onClearFeatures",this,this._featuresCleared),f.connect(this,"onSelectionChange",this,this._featureSelected),f.connect(this,
"onDfdComplete",this,this._updateUI)];n("esri-touch")&&(l=w.setScrollable(this._contentPane),this._eventConnections.push(l[0],l[1]));this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(a){this.inherited(arguments);u.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a);this._maxHeight=s.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){if(this.popupWindow){if(!l.isDefined(a)||
""===a)a="\x26nbsp;";this.destroyDijits(this._title);this.place(a,this._title);this.isShowing&&(this.startupDijits(this._title),this.reposition())}},setContent:function(a){if(this.popupWindow){if(!l.isDefined(a)||""===a)a="\x26nbsp;";this.destroyDijits(this._contentPane);this.place(a,this._contentPane);this.isShowing&&(this.startupDijits(this._contentPane),this.reposition())}},show:function(a,c){if(this.popupWindow)if(this._delayHide=!1,a){var b=this.map,d;a.spatialReference?(this.location=a,d=b.toScreen(a)):
(this.location=b.toMap(a),d=a);var l=b._getFrameWidth();if(-1!==l&&(d.x%=l,0>d.x&&(d.x+=l),b.width>l))for(b=(b.width-l)/2;d.x<b;)d.x+=l;this._maximized?this.restore():this._setPosition(d);c&&c.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this.startupDijits(this._contentPane),this.reposition(),this.showHighlight(),this.onShow())}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),
this._unfollowMap(),this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(a,c){this.popupWindow&&(this._sizers.style({width:a+"px"}),s.set(this._contentPane,"maxHeight",c+"px"),this._maxHeight=c,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&(this.location&&!this._maximized&&this.isShowing)&&this._setPosition(this.map.toScreen(this.location))},maximize:function(){var a=this.map;if(a&&!this._maximized&&this.popupWindow){this._maximized=
!0;var c=this._maxButton;h.remove(c,"maximize");h.add(c,"restore");d.set(c,"title",this._nls.NLS_restore);var c=this.marginLeft,b=this.marginTop,l=a.width-2*c,a=a.height-2*b;s.set(this.domNode,{left:this._isRTL?null:c+"px",right:this._isRTL?c+"px":null,top:b+"px",bottom:null});s.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=s.get(this._sizers[0],"width");this._savedHeight=s.get(this._contentPane,"maxHeight");this._sizers.style({width:l+"px"});s.set(this._contentPane,
{maxHeight:a-65+"px",height:a-65+"px"});this._showPointer("");this._unfollowMap();h.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&this._maximized&&this.popupWindow){this._maximized=!1;var a=this._maxButton;h.remove(a,"restore");h.add(a,"maximize");d.set(a,"title",this._nls.NLS_maximize);s.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();
h.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._content);a.forEach(this._eventConnections,f.disconnect);u.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=
this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},postscript:null,_highlightSetter:function(a){var c=this.highlight,b=this.map;this.highlight=a;if(b&&a!==c)if(a){if(this.enableHighlight(b),a=this.features&&this.features[this.selectedIndex])this.updateHighlight(b,a),this.showHighlight()}else this.disableHighlight(b)},
_pagingControlsSetter:function(a){var c=this.pagingControls,b=this.map;this.pagingControls=a;b&&a!==c&&this._updatePagingControls()},_pagingInfoSetter:function(a){var c=this.pagingInfo,b=this.map;this.pagingInfo=a;b&&(a!==c&&this.features&&this.features.length)&&this._updatePagingInfo()},_popupWindowSetter:function(a){var c=this.popupWindow,b=this.map;this.popupWindow=a;b&&a!==c&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var c=this.anchor;
this.anchor=a;this.map&&a!==c&&this.reposition()},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var c=this.features[a].getContent(),b;!this.titleInBody&&c&&e.isString(c.id)&&(b=p.byId(c.id))&&(b.set&&/_PopupRenderer/.test(b.declaredClass))&&b.set("showTitle",!1);this.setContent(c);
this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(a){s.set(this.domNode,"visibility",a?"visible":"hidden");h.toggle(this.domNode,"esriPopupVisible",a)},_waitAndHide:function(a){var c=this;this._delayHide=!0;setTimeout(function(){c._delayHide&&(c._delayHide=!1,c.hide())},a)},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[f.connect(a,"onPanStart",this,this._onPanStart),
f.connect(a,"onPan",this,this._onPan),f.connect(a,"onZoomStart",this,this._onZoomStart),f.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var c=this._handles;c&&(a.forEach(c,f.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,c){var b=this._panOrigin,d=c.x,l=c.y,g=b.left,h=b.top,e=b.right,b=b.bottom;g&&(g=parseFloat(g)+d+"px");h&&(h=parseFloat(h)+
l+"px");e&&(e=parseFloat(e)-d+"px");b&&(b=parseFloat(b)-l+"px");s.set(this.domNode,{left:g,top:h,right:e,bottom:b})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,c,b){b&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_setPosition:function(a){var c=a.x,b=a.y;a=this.offsetX||0;var d=this.offsetY||0,l=0,g=0,h=m.position(this.map.container,!0),e=h.w,
p=h.h,f="Left",u="bottom",v=m.getContentBox(this._positioner),w=v.w/2,k=v.h/2,n=s.get(this._sizers[0],"height")+this._maxHeight+s.get(this._sizers[2],"height"),y=n/2,t=0,x=0,B=c,q=b,z=this.anchor.toLowerCase();if("auto"===z){if(z=r.getBox)z=z(),t=Math.max(z.l,h.x),e=Math.min(z.l+z.w,h.x+h.w),x=Math.max(z.t,h.y),p=Math.min(z.t+z.h,h.y+h.h),B+=h.x,q+=h.y;h=q-x>=n;n=p-q>=n;z=e-B>=v.w;v=B-t>=v.w;q-x>y&&p-q>=y&&(z?(u="",f="Left"):v&&(u="",f="Right"));f&&u&&(B-t>w&&e-B>=w)&&(h?(f="",u="bottom"):n&&(f="",
u="top"));f&&u&&(z&&h?(f="Left",u="bottom"):z&&n?(f="Left",u="top"):v&&n?(f="Right",u="top"):v&&h&&(f="Right",u="bottom"))}else u=f="",-1!==z.indexOf("top")?u="bottom":-1!==z.indexOf("bottom")&&(u="top"),-1!==z.indexOf("left")?f="Right":-1!==z.indexOf("right")&&(f="Left");y=u+f;switch(y){case "top":case "bottom":g=14;break;case "Left":case "Right":l=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":g=14,l=-16}s.set(this.domNode,{left:c+"px",top:b+"px",right:null,bottom:null});
c={left:null,right:null,top:null,bottom:null};f?c[f.toLowerCase()]=l+a+"px":c.left=-w+"px";u?c[u]=g+d+"px":c.top=-k+"px";s.set(this._positioner,c);this._showPointer(y)},_showPointer:function(a){h.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));h.remove(this._outerPointer,["right","left","hidden"]);"Right"===a||"Left"===a?(a=a.toLowerCase(),h.add(this._outerPointer,a)):h.add(this._pointer,a)},_setPagerCallbacks:function(a,c,b){if(this.pagingControls&&
!(a===this&&(!this._pagerScope||this._pagerScope===this))&&a!==this._pagerScope){this._pagerScope=a;a===this&&(c=this.selectPrevious,b=this.selectNext);var d=this._eventConnections;f.disconnect(d[1]);f.disconnect(d[2]);c&&(d[1]=f.connect(this._prevFeatureButton,"onclick",a,c));b&&(d[2]=f.connect(this._nextFeatureButton,"onclick",a,b))}},_getLocation:function(c){var b=this.map,d,l,g=0,h;if(c=c&&c.geometry)switch(c.type){case "point":d=c;break;case "multipoint":d=c.getPoint(0);l=c.getExtent();break;
case "polyline":d=c.getPoint(0,0);l=c.getExtent();-1!==b._getFrameWidth()&&(a.forEach(c.paths,function(a){a=(new v({paths:[a,b.spatialReference]})).getExtent();var c=Math.abs(a.ymax-a.ymin),d=Math.abs(a.xmax-a.xmin),c=d>c?d:c;c>g&&(g=c,h=a)}),h.spatialReference=l.spatialReference,l=h);break;case "polygon":d=c.getPoint(0,0),l=c.getExtent(),-1!==b._getFrameWidth()&&(a.forEach(c.rings,function(a){a=(new x({rings:[a,b.spatialReference]})).getExtent();var c=Math.abs(a.ymax-a.ymin),d=Math.abs(a.xmax-a.xmin),
c=d>c?d:c;c>g&&(g=c,h=a)}),h.spatialReference=l.spatialReference,l=h)}return[d,l]},_zoomToFeature:function(a){a.preventDefault();var c=this.features,b=this.selectedIndex;a=this.map;if(c){b=this._getLocation(c[b]);c=b[0];b=b[1];c||(c=this.location);if(!b||!b.intersects(this.location))this.location=c;if(b&&b.getWidth()&&b.getHeight())a.setExtent(b,!0);else{var d=a.getNumLevels(),b=a.getLevel(),l=a.getMaxZoom(),g=this.zoomFactor||1;0<d?b!==l&&(d=b+g,d>l&&(d=l),a.navigationManager._wheelZoom({value:d-
b,mapPoint:c},!0)):a.navigationManager._wheelZoom({value:2*(1/Math.pow(2,g)),mapPoint:c},!0)}}},_updatePagingControls:function(){var a=this._prevFeatureButton,c=this._nextFeatureButton,b=this.selectedIndex,d=this.features?this.features.length:0;this.pagingControls&&1<d?(0===b?h.add(a,"hidden"):h.remove(a,"hidden"),b===d-1?h.add(c,"hidden"):h.remove(c,"hidden")):(h.add(a,"hidden"),h.add(c,"hidden"))},_updatePagingInfo:function(){var a=this.features?this.features.length:0,c=this._nls,b="\x26nbsp;";
this.pagingInfo&&(1<a&&c.NLS_pagingInfo)&&(b=l.substitute({index:this.selectedIndex+1,total:a},c.NLS_pagingInfo));if(a&&(c=this.getSelectedFeature(),a=c.getInfoTemplate(),c=c.getTitle(),(!a||/esri\.InfoTemplate/.test(a.declaredClass)||!this.titleInBody)&&c))b=c+("\x26nbsp;"===b?"":" "+b);this.setTitle(b)},_updateUI:function(){if(this.popupWindow){var a=this.features,c=this.deferreds,b=a?a.length:0,d=this._spinner,l=this._actionList,g=this._nls;this._updatePagingControls();this._updatePagingInfo();
b?h.remove(l,"hidden"):h.add(l,"hidden");c&&c.length?a?h.remove(d,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+g.NLS_searching+"...\x3c/div\x3e"):(h.add(d,"hidden"),b||(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+g.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay)))}}})})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),function(q,e,a,f,k,
n,r){e.add("rtl-adjust-position-for-verticalScrollBar",function(b,g){var d=a.body(g),h=r.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},d,"last"),e=r.create("div",{style:{overflow:"hidden",direction:"ltr"}},h,"last"),f=0!=k.position(e).x;h.removeChild(e);d.removeChild(h);return f});e.add("position-fixed-support",function(b,g){var d=a.body(g),h=r.create("span",{style:{visibility:"hidden",
position:"fixed",left:"1px",top:"1px"}},d,"last"),e=r.create("span",{style:{position:"fixed",left:"0",top:"0"}},h,"last"),f=k.position(e).x!=k.position(h).x;h.removeChild(e);d.removeChild(h);return f});var t={getBox:function(b){b=b||a.doc;var g="BackCompat"==b.compatMode?a.body(b):b.documentElement,d=k.docScroll(b);if(e("touch")){var h=t.get(b);b=h.innerWidth||g.clientWidth;g=h.innerHeight||g.clientHeight}else b=g.clientWidth,g=g.clientHeight;return{l:d.x,t:d.y,w:b,h:g}},get:function(a){if(e("ie")&&
t!==document.parentWindow){a.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var g=a._parentWindow;a._parentWindow=null;return g}return a.parentWindow||a.defaultView},scrollIntoView:function(b,g){try{b=f.byId(b);var d=b.ownerDocument||a.doc,h=a.body(d),u=d.documentElement||h.parentNode,m=e("ie"),s=e("webkit");if(!(b==h||b==u))if(!e("mozilla")&&(!m&&!s&&!e("opera")&&!e("trident"))&&"scrollIntoView"in b)b.scrollIntoView(!1);else{var p="BackCompat"==d.compatMode,c=Math.min(h.clientWidth||
u.clientWidth,u.clientWidth||h.clientWidth),l=Math.min(h.clientHeight||u.clientHeight,u.clientHeight||h.clientHeight),d=s||p?h:u,w=g||k.position(b),v=b.parentNode,s=function(a){return 6>=m||7==m&&p?!1:e("position-fixed-support")&&"fixed"==n.get(a,"position").toLowerCase()},t=this,y=function(a,c,b){"BODY"==a.tagName||"HTML"==a.tagName?t.get(a.ownerDocument).scrollBy(c,b):(c&&(a.scrollLeft+=c),b&&(a.scrollTop+=b))};if(!s(b))for(;v;){v==h&&(v=d);var r=k.position(v),q=s(v),D="rtl"==n.getComputedStyle(v).direction.toLowerCase();
if(v==d){r.w=c;r.h=l;if(d==u&&(m||e("trident"))&&D)r.x+=d.offsetWidth-r.w;if(0>r.x||!m||9<=m||e("trident"))r.x=0;if(0>r.y||!m||9<=m||e("trident"))r.y=0}else{var E=k.getPadBorderExtents(v);r.w-=E.w;r.h-=E.h;r.x+=E.l;r.y+=E.t;var A=v.clientWidth,G=r.w-A;0<A&&0<G&&(D&&e("rtl-adjust-position-for-verticalScrollBar")&&(r.x+=G),r.w=A);A=v.clientHeight;G=r.h-A;0<A&&0<G&&(r.h=A)}q&&(0>r.y&&(r.h+=r.y,r.y=0),0>r.x&&(r.w+=r.x,r.x=0),r.y+r.h>l&&(r.h=l-r.y),r.x+r.w>c&&(r.w=c-r.x));var C=w.x-r.x,H=w.y-r.y,I=C+w.w-
r.w,L=H+w.h-r.h,J,F;if(0<I*C&&(v.scrollLeft||v==d||v.scrollWidth>v.offsetHeight)){J=Math[0>C?"max":"min"](C,I);if(D&&(8==m&&!p||9<=m||e("trident")))J=-J;F=v.scrollLeft;y(v,J,0);J=v.scrollLeft-F;w.x-=J}if(0<L*H&&(v.scrollTop||v==d||v.scrollHeight>v.offsetHeight))J=Math.ceil(Math[0>H?"max":"min"](H,L)),F=v.scrollTop,y(v,0,J),J=v.scrollTop-F,w.y-=J;v=v!=d&&!q&&v.parentNode}}}catch(N){console.error("scrollIntoView: "+N),b.scrollIntoView(!1)}}};q.setObject("dojo.window",t);return t})},"dojo/Stateful":function(){define(["./_base/declare",
"./_base/lang","./_base/array","./when"],function(q,e,a,f){return q("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var e=this._attrPairNames;return e[a]?e[a]:e[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,e){return"function"===typeof this[e.g]?this[e.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,e){if("object"===typeof a){for(var r in a)a.hasOwnProperty(r)&&"_watchCallbacks"!=r&&this.set(r,
a[r]);return this}r=this._getAttrNames(a);var t=this._get(a,r);r=this[r.s];var b;"function"===typeof r?b=r.apply(this,Array.prototype.slice.call(arguments,1)):this[a]=e;if(this._watchCallbacks){var g=this;f(b,function(){g._watchCallbacks(a,t,e)})}return this},_changeAttrValue:function(a,e){var f=this.get(a);this[a]=e;this._watchCallbacks&&this._watchCallbacks(a,f,e);return this},watch:function(e,f){var r=this._watchCallbacks;if(!r)var t=this,r=this._watchCallbacks=function(a,b,g,e){var f=function(e){if(e){e=
e.slice();for(var c=0,l=e.length;c<l;c++)e[c].call(t,a,b,g)}};f(r["_"+a]);e||f(r["*"])};!f&&"function"===typeof e?(f=e,e="*"):e="_"+e;var b=r[e];"object"!==typeof b&&(b=r[e]=[]);b.push(f);var g={};g.unwatch=g.remove=function(){var d=a.indexOf(b,f);-1<d&&b.splice(d,1)};return g}})})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d){return q(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=e.hitch;this.__set_title=a(this,this.__set_title);this.__err_title=a(this,this.__err_title);this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},
place:function(a,b){g.isDefined(a)?e.isObject(a)?n.place(a,b,"only"):b.innerHTML=a:b.innerHTML=""},startupDijits:function(a){this._processDijits(a)},destroyDijits:function(a){this._processDijits(a,!0)},_processDijits:function(b,d){if(b&&1===b.children.length){var g=b.children[0];if(g){var e=t.byNode(g),g=e?[e]:t.findWidgets(g);a.forEach(g,function(a){if(d){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(c){console.debug("An error occurred when destroying a widget embedded within InfoWindow: "+
c.message)}}else if(!a._started)try{a.startup()}catch(b){console.debug("An error occurred when starting a widget embedded within InfoWindow: "+b.message)}})}}},__registerMapListeners:function(){this.__unregisterMapListeners();var a=this.map;this.__handles=[f.connect(a,"onPan",this,this.__onMapPan),f.connect(a,"onZoomStart",this,this.__onMapZmStart),f.connect(a,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var b=this.__handles;b&&(a.forEach(b,f.disconnect,f),this.__handles=
null)},__onMapPan:function(a,b){this.move(b,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new d(this.coords));this.hide(null,!0)},__onMapExtChg:function(a,b,d){a=this.map;var g=this.mapCoords;g?this.show(g,null,!0):(b=d?a.toScreen(this.__mcoords):this.coords.offset(b&&b.x||0,b&&b.y||0),this.show(b,null,!0))},__setValue:function(a,b){this[a].innerHTML="";var d="_dfd"+a,e=this[d];e&&-1===e.fired&&(e.cancel(),this[d]=null);g.isDefined(b)&&(b instanceof k?(this[d]=b,b.addCallbacks(this["__set"+
a],this["__err"+a])):this.__render(a,b))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=null},__set_content:function(a){this._dfd_content=null;this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,b){var d=this[a];this.place(b,d);this.isShowing&&(this.startupDijits(d),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}})})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l){function w(a){return"sizeInfo"===a.type}return q(l,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",e.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
e.hitch(this,this._processFeatures));this.on("set-features",e.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners()},setFeatures:function(c){if(c&&c.length){this.clearFeatures();var b,d;c[0]instanceof k?d=c:b=c;b?this._updateFeatures(null,b):(this.deferreds=d,d=d.slice(0),a.forEach(d,function(a){a.addBoth(e.hitch(this,this._updateFeatures,a))},this))}},clearFeatures:function(){this.features=this.deferreds=this._marked=null;this.count=
0;var a=this.selectedIndex;this.selectedIndex=-1;if(-1<a)this.onSelectionChange();this.onClearFeatures()},getSelectedFeature:function(){var a=this.features;if(a)return a[this.selectedIndex]},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.onSelectionChange())},enableHighlight:function(a){this._highlighted=a.graphics.add(new t(new b(0,0,a.spatialReference)));this._highlighted.hide();this.markerSymbol||(a=this.markerSymbol=new u,a.setStyle(u.STYLE_TARGET),a._setDim(16,16,0),a.setOutline(new s(m.STYLE_SOLID,
new f([0,255,255]),2,s.CAP_ROUND,s.JOIN_ROUND)),a.setColor(new f([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new m(m.STYLE_SOLID,new f([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new p(p.STYLE_NULL,new m(m.STYLE_SOLID,new f([0,255,255]),2),new f([0,0,0,0])))},disableHighlight:function(a){var c=this._highlighted;c&&(c.hide(),a.graphics.remove(c),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=this.features&&this.features[this.selectedIndex];
this._highlighted&&(a&&a.geometry)&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(a,c){var b=c.geometry,d=this._highlighted;if(!b||!d)d&&d.hide();else{d.hide();!d._graphicsLayer&&a&&a.graphics.add(d);d.setGeometry(g.fromJson(b.toJson()));var l;switch(b.type){case "point":case "multipoint":l=this.markerSymbol;l.setOffset(0,0);l.setAngle(0);var h=c.getLayer();if(h){var b=h._getSymbol(c),e,p,f=0,u=0,m=0;if(b){h=!c.symbol?h._getRenderer(c):
null;if(f=this._getSizeInfo(h))e=p=h.getSize(c,{sizeInfo:f,shape:b.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()});else switch(b.type){case "simplemarkersymbol":e=p=b.size||0;break;case "picturemarkersymbol":e=b.width||0,p=b.height||0}f=b.xoffset||0;u=b.yoffset||0;m=b.angle||0}e&&p&&l._setDim(e+1,p+1,0);l.setOffset(f,u);l.setAngle(m)}break;case "polyline":l=this.lineSymbol;break;case "polygon":l=this.fillSymbol}d.setSymbol(l)}},showClosestFirst:function(a){var c=this.features;
if(c&&c.length){if(1<c.length){var b,l=Infinity,g=-1,e,p=d.getLength,f,u=a.spatialReference,m,s;a=a.normalize();for(b=c.length-1;0<=b;b--)if(e=c[b].geometry){m=e.spatialReference;f=0;try{s="point"===e.type?e:e.getExtent().getCenter(),s=s.normalize(),u&&(m&&!u.equals(m)&&u._canProject(m))&&(s=u.isWebMercator()?h.geographicToWebMercator(s):h.webMercatorToGeographic(s)),f=p(a,s)}catch(w){}0<f&&f<l&&(l=f,g=b)}0<g&&(c.splice(0,0,c.splice(g,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=a)},
_unbind:function(c){c=a.indexOf(this.deferreds,c);if(-1!==c)return this.deferreds.splice(c,1),!this.deferreds.length?(this.deferreds=null,2):1},_fireComplete:function(a){var c=this._marked;c&&(this._marked=null,this.showClosestFirst(c));this.onDfdComplete(a)},_updateFeatures:function(c,b){if(c){if(this.deferreds){var d=this._unbind(c);if(d)if(b&&b instanceof Error){if(this._fireComplete(b),2===d)this.onSetFeatures()}else if(b&&b.length)if(this.features){var l=a.filter(b,function(c){return-1===a.indexOf(this.features,
c)},this);this.features=this.features.concat(l);this.count=this.features.length;this._fireComplete();if(2===d)this.onSetFeatures()}else{this.features=b;this.count=b.length;this.selectedIndex=0;this._fireComplete();if(2===d)this.onSetFeatures();this.select(0)}else if(this._fireComplete(),2===d)this.onSetFeatures()}}else this.features=b,this.count=b.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(c){return c?c.sizeInfo||a.filter(c.visualVariables,w)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers=
{};a.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){a.forEach(this.features,function(a){if((a=a.getLayer())&&!this._featureLayers[a.id]&&1===a.currentMode&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&("esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType||a.hasXYFootprint()))this._featureLayers[a.id]=a,a=a.on("update-end",e.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a)},this)},
_fLyrUpdateEndHandler:function(b){if(!b.error){var d=this,l=b.target,g={},h=[];a.forEach(this.features,function(a){if(a.getLayer()===l){var c=a.attributes[l.objectIdField];g[c]=a;h.push(c)}});h.length&&(b=new c,b.objectIds=h,l.queryFeatures(b,function(c){a.forEach(c.features,function(a){var c=g[a.attributes[l.objectIdField]];c.geometry!==a.geometry&&(c.setGeometry(a.geometry),this._highlighted&&c===this.getSelectedFeature()&&this._highlighted.setGeometry(a.geometry))},d)}))}}})})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),
function(q,e,a,f,k,n,r,t,b){q=q(null,{declaredClass:"esri.Graphic",constructor:function(a,d,h,e){a&&!a.declaredClass?(this.geometry=a.geometry?t.fromJson(a.geometry):null,this.symbol=a.symbol?b.fromJson(a.symbol):null,this.attributes=a.attributes||null,this.infoTemplate=a.infoTemplate?new r(a.infoTemplate):null):(this.geometry=a,this.symbol=d,this.attributes=h,this.infoTemplate=e)},_shape:null,_graphicsLayer:null,_visible:!0,visible:!0,getDojoShape:function(){return this._shape},getShapes:function(){var a=
[];this._shape&&a.push(this._shape);this._bgShape&&a.push(this._bgShape);return a},getNode:function(){var a=this._shape&&this._shape.getNode();return a&&a.nodeType?a:null},getNodes:function(){var a=this.getShapes(),b,h,e=a.length,f=[];for(h=0;h<e;h++)(b=a[h]&&a[h].getNode())&&b.nodeType&&f.push(b);return f},getLayer:function(){return this._layer},draw:function(){var a=this._graphicsLayer;a&&a._draw(this,!0);return this},setGeometry:function(a){this.geometry=a;if(a=this._graphicsLayer)a._updateExtent(this),
a._draw(this,!0);return this},setSymbol:function(a,b){var h=this._graphicsLayer,e=this._shape;this.symbol=a;h&&(b&&e&&h._removeShape(this),h._draw(this,!0));return this},setAttributes:function(a){this.attributes=a;return this},setInfoTemplate:function(a){this.infoTemplate=a;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var a=this.getLayer();return this.infoTemplate||a&&a.infoTemplate},getTitle:function(){var a=this.getInfoTemplate(),b=a&&
a.title;if(e.isFunction(b))b=b.call(a,this);else if(e.isString(b))var h=(a=this.getLayer())&&a._getDateOpts,b=n.substitute(this.attributes,b,{first:!0,dateFormat:h&&h.call(a)});return b},getContent:function(){var a=this.getInfoTemplate(),b=a&&a.content;if(e.isFunction(b))b=b.call(a,this);else if(e.isString(b))var h=(a=this.getLayer())&&a._getDateOpts,b=n.substitute(this.attributes,b,{dateFormat:h&&h.call(a)});return b},attr:function(a,b){var h=this.getNodes(),e,f=h.length;for(e=0;e<f;e++)null==b?
h[e].removeAttribute(a):h[e].setAttribute(a,b);return this},show:function(){this.visible=this._visible=!0;var a,b,h;if(this.getShapes().length){a=this.getNodes();h=a.length;this.attr("data-hidden");for(b=0;b<h;b++)k.show(a[b])}else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;var a=this._graphicsLayer,b,h;if(a)if("canvas-2d"===a.surfaceType)a._removeShape(this);else if(a=this.getNodes(),h=a.length){this.attr("data-hidden","");for(b=
0;b<h;b++)k.hide(a[b])}return this},toJson:function(){var a={};this.geometry&&(a.geometry=this.geometry.toJson());this.attributes&&(a.attributes=e.mixin({},this.attributes));this.symbol&&(a.symbol=this.symbol.toJson());this.infoTemplate&&(a.infoTemplate=this.infoTemplate.toJson());return a}});q.prototype.getShape=q.prototype.getDojoShape;return q})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(q,e,a,f,k){return q(null,{declaredClass:"esri.InfoTemplate",
constructor:function(a,f){a&&e.isObject(a)&&!e.isFunction(a)?e.mixin(this,a):(this.title=a||"${*}",this.content=f||"${*}")},setTitle:function(a){this.title=a;return this},setContent:function(a){this.content=a;return this},toJson:function(){return k.fixJson({title:this.title,content:this.content})}})})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(q,e,a,f,k,n,r,t){return{fromJson:function(a){if(void 0!==
a.x&&void 0!==a.y)return new f(a);if(void 0!==a.paths)return new k(a);if(void 0!==a.rings)return new n(a);if(void 0!==a.points)return new r(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new t(a)},getJsonType:function(a){return a instanceof f?"esriGeometryPoint":a instanceof k?"esriGeometryPolyline":a instanceof n?"esriGeometryPolygon":a instanceof t?"esriGeometryEnvelope":a instanceof r?"esriGeometryMultipoint":null},getGeometryType:function(a){return"esriGeometryPoint"===
a?f:"esriGeometryPolyline"===a?k:"esriGeometryPolygon"===a?n:"esriGeometryEnvelope"===a?t:"esriGeometryMultipoint"===a?r:null}}})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),function(q,e,a,f,k,n,r,t,b,g){return{fromJson:function(a){var h=null;switch(a.type){case "esriSMS":h=new f(a);break;case "esriPMS":h=new k(a);
break;case "esriTS":h=new g(a);break;case "esriSLS":h=void 0!==a.cap?new r(a):new n(a);break;case "esriCLS":h=new r(a);break;case "esriSFS":h=new t(a);break;case "esriPFS":h=new b(a)}return h},getShapeDescriptors:function(a){return a&&a.getShapeDescriptors?a.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(q,e,a,f,k,n,r,t){var b={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};q=q(t,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(g,d,h){g?e.isString(g)?(this.url=g,d&&(this.width=d),h&&(this.height=h)):(this.width=f.pt2px(g.width),this.height=f.pt2px(g.height),d=g.imageData,!(9>a("ie"))&&d&&(h=this.url,this.url="data:"+(g.contentType||"image")+";base64,"+d,this.imageData=h)):(e.mixin(this,b),this.width=f.pt2px(this.width),this.height=f.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(a){this.width=a;return this},setHeight:function(a){this.height=a;return this},setUrl:function(a){a!==this.url&&(delete this.imageData,delete this.contentType);this.url=a;return this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var a=this.url,b=
this.imageData;if(0===a.indexOf("data:"))var h=a,a=b,b=h.indexOf(";base64,")+8,b=h.substr(b);if(e.isString(a)&&(0===a.indexOf("/")||0===a.indexOf("//")||0===a.indexOf("./")||0===a.indexOf("../")))a=r.getAbsoluteUrl(a);var h=f.px2pt(this.width),h=isNaN(h)?void 0:h,u=f.px2pt(this.height),u=isNaN(u)?void 0:u,a=n.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:a,imageData:b,contentType:this.contentType,width:h,height:u}));delete a.color;delete a.size;a.imageData||delete a.imageData;
return a}});q.defaultProps=b;return q})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(q,e,a,f,k,n,r,t){var b={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},g={color:[0,0,0,1],style:b.STYLE_SOLID,width:1,cap:b.CAP_BUTT,join:b.JOIN_MITER,miterLimit:10};q=q(t,{declaredClass:"esri.symbol.CartographicLineSymbol",type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",
bevel:"esriLJSBevel"},constructor:function(b,h,f,m,s,p){b?e.isString(b)?(this.style=b,h&&(this.color=h),void 0!==f&&(this.width=f),m&&(this.cap=m),s&&(this.join=s),void 0!==p&&(this.miterLimit=p)):(this.cap=r.valueOf(this._caps,b.cap),this.join=r.valueOf(this._joins,b.join),this.width=k.pt2px(b.width),this.miterLimit=k.pt2px(b.miterLimit)):(e.mixin(this,g),this.color=new a(this.color),this.width=k.pt2px(this.width),this.miterLimit=k.pt2px(this.miterLimit))},setCap:function(a){this.cap=a;return this},
setJoin:function(a){this.join=a;return this},setMiterLimit:function(a){this.miterLimit=a;return this},getStroke:function(){return e.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===b.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){var a=k.px2pt(this.miterLimit),a=isNaN(a)?void 0:a;return r.fixJson(e.mixin(this.inherited("toJson",
arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:a}))}});e.mixin(q,b);q.defaultProps=g;return q})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),function(q,e,a,f,k,n,r,t,b,g){var d={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",
STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},h={style:d.STYLE_SOLID,color:[0,0,0,0.25]};q=q(t,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",patternUrlPrefix:g.toUrl("../images/symbol/sfs/"),_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",
backwarddiagonal:"esriSFSBackwardDiagonal",cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(d,g,f){d?e.isString(d)?(this.style=d,void 0!==g&&(this.outline=g),void 0!==f&&(this.color=f)):this.style=r.valueOf(this._styles,d.style):(e.mixin(this,h),this.outline=new b(this.outline),this.color=new a(this.color))},setStyle:function(a){this.style=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var a=this.style;return a===
d.STYLE_NULL?null:a===d.STYLE_SOLID?this.color:e.mixin({},k.defaultPattern,{src:this.patternUrlPrefix+a+".png",width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 E"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return r.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriSFS",style:this._styles[this.style]}))}});e.mixin(q,d);q.defaultProps=h;return q})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),
function(q,e,a,f,k,n){return q(k,{declaredClass:"esri.symbol.FillSymbol",constructor:function(a){a&&(e.isObject(a)&&a.outline)&&(this.outline=new n(a.outline))},setOutline:function(a){this.outline=a;return this},toJson:function(){var a=this.inherited("toJson",arguments);this.outline&&(a.outline=this.outline.toJson());return a}})})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),
function(q,e,a,f,k,n,r,t){var b={xoffset:0,yoffset:0,width:12,height:12};q=q(t,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(g,d,h,u){g?e.isString(g)?(this.url=g,void 0!==d&&(this.outline=d),void 0!==h&&(this.width=h),void 0!==u&&(this.height=u)):(this.xoffset=f.pt2px(g.xoffset),this.yoffset=f.pt2px(g.yoffset),this.width=f.pt2px(g.width),this.height=f.pt2px(g.height),d=g.imageData,!(9>a("ie"))&&d&&(h=this.url,this.url=
"data:"+(g.contentType||"image")+";base64,"+d,this.imageData=h)):(e.mixin(this,b),this.width=f.pt2px(this.width),this.height=f.pt2px(this.height))},setWidth:function(a){this.width=a;return this},setHeight:function(a){this.height=a;return this},setOffset:function(a,b){this.xoffset=a;this.yoffset=b;return this},setUrl:function(a){a!==this.url&&(delete this.imageData,delete this.contentType);this.url=a;return this},setXScale:function(a){this.xscale=a;return this},setYScale:function(a){this.yscale=a;
return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return e.mixin({},f.defaultPattern,{src:this.url,width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 E"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=this.url,b=this.imageData;if(0===a.indexOf("data:"))var h=a,a=b,b=h.indexOf(";base64,")+
8,b=h.substr(b);if(e.isString(a)&&(0===a.indexOf("/")||0===a.indexOf("//")||0===a.indexOf("./")||0===a.indexOf("../")))a=r.getAbsoluteUrl(a);var h=f.px2pt(this.width),h=isNaN(h)?void 0:h,u=f.px2pt(this.height),u=isNaN(u)?void 0:u,m=f.px2pt(this.xoffset),m=isNaN(m)?void 0:m,s=f.px2pt(this.yoffset),s=isNaN(s)?void 0:s,a=n.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:a,imageData:b,contentType:this.contentType,width:h,height:u,xoffset:m,yoffset:s,xscale:this.xscale,yscale:this.yscale}));
a.imageData||delete a.imageData;return a}});q.defaultProps=b;return q})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(q,e,a,f,k,n,r,t,b){var g={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:f.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},d={start:"left",middle:"center",end:"right"},h={left:"start",center:"middle",right:"end",
justify:"start"},u={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},m=document.createElement("canvas");q=q(t,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(a,d,c){e.mixin(this,g);this.font=new b(this.font);this.color=new r(this.color);a&&(e.isObject(a)?(e.mixin(this,a),this.color&&n.isDefined(this.color[0])&&(this.color=r.toDojoColor(this.color)),this.type="textsymbol",this.font=new b(this.font),this.xoffset=f.pt2px(this.xoffset),
this.yoffset=f.pt2px(this.yoffset),this.angle&&(this.angle*=-1)):(this.text=a,d&&(this.font=d),c&&(this.color=c)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(a){this.font=a;return this},setSize:function(a){this.font.size=a;return this},setAngle:function(a){this.angle=a;return this},setOffset:function(a,b){this.xoffset=a;this.yoffset=b;return this},setAlign:function(a){this.align=a;this.setHorizontalAlignment(a&&d[a.toLowerCase()]||"center");return this},setHorizontalAlignment:function(a){this.horizontalAlignment=
a;return this},getSVGAlign:function(){var a=this.horizontalAlignment;return a=a&&h[a.toLowerCase()]||"middle"},setVerticalAlignment:function(a){this.verticalAlignment=a;return this},getSVGBaseline:function(){var a=this.verticalAlignment;return a&&u[a.toLowerCase()]||"alphabetic"},getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(a){this.decoration=a;this.font||this.setFont(new b);this.font.setDecoration(a);return this},setRotated:function(a){this.rotated=
a;return this},setKerning:function(a){this.kerning=a;return this},setText:function(a){this.text=a;return this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var a=m&&m.getContext&&m.getContext("2d");if(a){var b=this.font;a.font=(b.style?b.style:f.defaultFont.style)+" "+(b.weight?b.weight:f.defaultFont.weight)+" "+(b.size?b.size:f.defaultFont.size)+"px "+(b.family?b.family:f.defaultFont.family);return a.measureText(this.text).width}var a=this.getHeight(),
b=0,c,d;for(c=0;c<this.text.length;c++)d=this.text.charAt(c),b=d==d.toUpperCase()?b+0.7*a:b+0.5*a;return b},getHeight:function(){return f.normalizedLength(this.font.size)},getShapeDescriptors:function(){var a=this.font,b;a&&(b={},a.size&&(b.size=a.size),a.style&&(b.style=a.style),a.variant&&(b.variant=a.variant),a.decoration&&(b.decoration=a.decoration),a.weight&&(b.weight=a.weight),a.family&&(b.family=a.family));return{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",
decoration:this.decoration||a&&a.decoration,rotated:this.rotated,kerning:this.kerning},font:b,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=f.px2pt(this.xoffset),b=f.px2pt(this.yoffset),a=isNaN(a)?void 0:a,b=isNaN(b)?void 0:b;return n.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:this.haloSize,haloColor:this.haloColor,verticalAlignment:this.verticalAlignment,
horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:a,yoffset:b,text:this.text,rotated:this.rotated,kerning:this.kerning,font:this.font.toJson()}))}});e.mixin(q,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});q.defaultProps=g;return q})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),
function(q,e,a,f,k,n){q=q(null,{declaredClass:"esri.symbol.Font",constructor:function(k,n,b,g,d){k?e.isObject(k)?e.mixin(this,k):(this.size=k,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==n&&(this.style=n),void 0!==b&&(this.variant=b),void 0!==g&&(this.weight=g),void 0!==d&&(this.family=d)):e.mixin(this,f.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>a("ie")&&(this.size&&e.isString(this.size)&&-1<this.size.indexOf("em"))&&(this.size=f.pt2px(12*parseFloat(this.size))+
"px");this.size=this._convert2PxSize(this.size)},setSize:function(a){this.size=this._convert2PxSize(a);return this},_convert2PxSize:function(a){var k;parseFloat(a)==a?k=a:e.isString(a)&&(-1<a.indexOf("pt")?k=f.pt2px(parseFloat(a)):-1<a.indexOf("px")?k=parseFloat(a):-1<a.indexOf("em")?k=f.pt2px(12*parseFloat(a)):-1<a.indexOf("%")&&(k=f.pt2px(0.12*parseFloat(a))));return k},setStyle:function(a){this.style=a;return this},setVariant:function(a){this.variant=a;return this},setWeight:function(a){this.weight=
a;return this},setFamily:function(a){this.family=a;return this},setDecoration:function(a){this.decoration=a;return this},toJson:function(){return n.fixJson({size:f.px2pt(this.size),style:this.style,variant:this.variant,decoration:this.decoration,weight:this.weight,family:this.family})}});e.mixin(q,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});
return q})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),function(q,e,a,f,k,n,r,t){var b=q(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=b.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,
outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,quantizationParameters:null,_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(g){var d={text:this.text,where:this.where,returnGeometry:this.returnGeometry,
spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},h=g&&g.geometry||this.geometry,e=this.objectIds,m=this.outFields,s=this.outSpatialReference,p=this.groupByFieldsForStatistics,c=this.orderByFields,l=this.outStatistics;g=this.distance;h&&(d.geometry=h,d.geometryType=r.getJsonType(h),d.inSR=h.spatialReference.wkid||f.toJson(h.spatialReference.toJson()));e&&(d.objectIds=e.join(","));m&&(d.outFields=m.join(","));this.returnDistinctValues&&
(d.returnDistinctValues=!0);p&&(d.groupByFieldsForStatistics=p.join(","));c&&(d.orderByFields=c.join(","));if(l){var w=[];a.forEach(l,function(a){w.push(a.toJson())});d.outStatistics=f.toJson(w)}s?d.outSR=s.wkid||f.toJson(s.toJson()):h&&(d.outSR=h.spatialReference.wkid||f.toJson(h.spatialReference.toJson()));h=this.timeExtent;d.time=h?h.toJson().join(","):null;if((h=this.relationParam)&&this.spatialRelationship===b.SPATIAL_REL_RELATION)d.relationParam=h;g&&(d.distance=this.distance,this.hasOwnProperty("units")?
d.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),d.units=this._units.meters));this.hasOwnProperty("start")&&(d.resultOffset=this.start,d.resultRecordCount=10,""===d.where&&(d.where="1\x3d1"));this.hasOwnProperty("num")&&(d.resultRecordCount=this.num);d.pixelSize=this.pixelSize?f.toJson(this.pixelSize.toJson()):null;d.multipatchOption=this.multipatchOption;this.quantizationParameters&&(d.quantizationParameters=f.toJson(this.quantizationParameters));
d._ts=this._ts;return d}});e.mixin(b,t);return b})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(q,e,a){return{SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",
SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"}})},"esri/plugins/popupManager":function(){define(["../PopupManager"],function(q){return{add:function(e,a){e.popupManager||(e.popupManager=new q(a),e.popupManager.setMap(e))},remove:function(e){var a=e.popupManager;a&&(a.unsetMap(),e.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s){var p;return t(m,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(a){this._mapClickHandler=g.hitch(this,this._mapClickHandler)},setMap:function(a){if(this.map)if(a!==this.map)this.unsetMap();else return;this.map=a;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(a){var b;
if(a&&(b=a.getLayer()))if(a=b.id,this._featureLayersCache[a]){var d=a.lastIndexOf("_");-1<d&&(a=a.substring(0,d),b=this.map.getLayer(a))}return b},_enabledSetter:function(a){this.enabled=a;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(a){var b=this.map.infoWindow,d=a.graphic;b&&this.map.loaded&&
(b.clearFeatures&&b.setFeatures?this._showPopup(a):d&&d.getInfoTemplate()&&this._showInfoWindow(d,a.mapPoint))},_showPopup:function(a){var d=this.map,g=d.infoWindow,h=this,p=[],f=[d.graphics].concat(r.map(d.graphicsLayerIds,d.getLayer,d));r.forEach(f,function(a){a&&(a.loaded&&a.infoTemplate&&!a.suspended)&&p.push(a)});var m=[];r.forEach(d.layerIds,function(a){(a=d.getLayer(a))&&(a.loaded&&!a.suspended)&&(h._isImageServiceLayer(a)&&a.infoTemplate?p.push(a):("esri.layers.ArcGISDynamicMapServiceLayer"===
a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass)&&a.infoTemplates&&m.push(a))});this._getSubLayerFeatureLayers(m).then(function(f){p=p.concat(f);f=null;a.graphic&&(a.graphic.getInfoTemplate()&&!h._isImageServiceLayer(a.graphic._layer))&&(f=a.graphic);if(p.length||f){var m=h._calculateClickTolerance(p),u=a.screenPoint,s=d.toMap(new e(u.x-m,u.y+m)),m=d.toMap(new e(u.x+m,u.y-m)),n=new q(s.x,s.y,m.x,m.y,d.spatialReference),y=new k,t=!!f,B=!0,s=r.map(p,function(g){var e;y.timeExtent=
g.useMapTime?d.timeExtent:null;if(h._isImageServiceLayer(g))y.geometry=a.mapPoint,B=!1,e=g.queryVisibleRasters(y,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),e.addCallback(function(){var a=g.getVisibleRasters();t=t||0<a.length;return a});else if(h._featureLayersCache[g.id]||"function"===typeof g.queryFeatures&&(0===g.currentMode||1===g.currentMode))y.geometry=n,e=g.queryFeatures(y),e.addCallback(function(a){a=a.features;t=t||0<a.length;return a});else{e=new b;var p=r.filter(g.graphics,
function(a){return a&&a.visible&&n.intersects(a.geometry)});t=t||0<p.length;e.resolve(p)}return e});f&&(m=new b,m.resolve([f]),s.unshift(m));!r.some(s,function(a){return!a.isFulfilled()})&&!t?(g.hide(),g.clearFeatures()):(g.setFeatures(s),g.show(a.mapPoint,{closestFirst:B}))}})},_getSubLayerFeatureLayers:function(a,d){var g=d||new b,e=[],m=a.length,k=Math.floor(this.map.extent.getWidth()/this.map.width),n=this.map.getScale(),t=!1,q=this,E=0;a:for(;E<m;E++){var A=a[E],G=A.dynamicLayerInfos||A.layerInfos;
if(G){var C=null;if(A._params&&(A._params.layers||A._params.dynamicLayers))C=A.visibleLayers;for(var C=f._getVisibleLayers(G,C),H=f._getLayersForScale(n,G),I=G.length,L=0;L<I;L++){var J=G[L],F=J.id,N=A.infoTemplates[F];if(!J.subLayerIds&&N&&N.infoTemplate&&-1<r.indexOf(C,F)&&-1<r.indexOf(H,F)){if(!p){t=!0;break a}var M=A.id+"_"+F,K=this._featureLayersCache[M];if(!K||!K.loadError)K||((K=N.layerUrl)||(K=J.source?this._getLayerUrl(A.url,"/dynamicLayer"):this._getLayerUrl(A.url,F)),K=new p(K,{id:M,drawMode:!1,
mode:p.MODE_SELECTION,outFields:this._getOutFields(N.infoTemplate),resourceInfo:N.resourceInfo,source:J.source}),this._featureLayersCache[M]=K),K.setDefinitionExpression(A.layerDefinitions&&A.layerDefinitions[F]),K.setGDBVersion(A.gdbVersion),K.setInfoTemplate(N.infoTemplate),K.setMaxAllowableOffset(k),K.setUseMapTime(!!A.useMapTime),A.layerDrawingOptions&&(A.layerDrawingOptions[F]&&A.layerDrawingOptions[F].renderer)&&K.setRenderer(A.layerDrawingOptions[F].renderer),e.push(K)}}}}if(t){var P=new b;
s(["./layers/FeatureLayer"],function(a){p=a;P.resolve()});P.then(function(){q._getSubLayerFeatureLayers(a,g)})}else{var Q=[];r.forEach(e,function(a){if(!a.loaded){var c=new b;h.once(a,"load, error",function(){c.resolve()});Q.push(c.promise)}});Q.length?u(Q).then(function(){e=r.filter(e,function(a){return!a.loadError&&a.isVisibleAtScale(n)});g.resolve(e)}):(e=r.filter(e,function(a){return a.isVisibleAtScale(n)}),g.resolve(e))}return g.promise},_getLayerUrl:function(a,b){var d=a.indexOf("?");return-1===
d?a+"/"+b:a.substring(0,d)+"/"+b+a.substring(d)},_getOutFields:function(a){var b;a.info&&"esri.dijit.PopupTemplate"===a.declaredClass?(b=[],r.forEach(a.info.fieldInfos,function(a){var c=a.fieldName&&a.fieldName.toLowerCase();c&&("shape"!==c&&0!==c.indexOf("relationships/"))&&b.push(a.fieldName)})):b=["*"];return b},_calculateClickTolerance:function(a){var b=6,d,g;r.forEach(a,function(a){if(d=a.renderer)"esri.renderer.SimpleRenderer"===d.declaredClass?((g=d.symbol)&&g.xoffset&&(b=Math.max(b,Math.abs(g.xoffset))),
g&&g.yoffset&&(b=Math.max(b,Math.abs(g.yoffset)))):("esri.renderer.UniqueValueRenderer"===d.declaredClass||"esri.renderer.ClassBreaksRenderer"===d.declaredClass)&&r.forEach(d.infos,function(a){(g=a.symbol)&&g.xoffset&&(b=Math.max(b,Math.abs(g.xoffset)));g&&g.yoffset&&(b=Math.max(b,Math.abs(g.yoffset)))})});return b},_showInfoWindow:function(a,b){var d=this.map.infoWindow,h=a.geometry,h=h&&"point"===h.type?h:b,e=a.getContent();d.setTitle(a.getTitle());if(e&&g.isString(e.id)){var p=n.byId(e.id);p&&
(p.set&&/_PopupRenderer/.test(p.declaredClass))&&p.set("showTitle",!1)}d.setContent(e);d.show(h)},_isImageServiceLayer:function(a){return"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass}})})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(q,e,a,f,k){return{_serializeLayerDefinitions:function(f){var k=[],t=!1,b=/[:;]/;if(f&&(e.forEach(f,function(a,g){a&&
(k.push([g,a]),!t&&b.test(a)&&(t=!0))}),0<k.length)){var g;t?(g={},e.forEach(k,function(a){g[a[0]]=a[1]}),g=a.toJson(g)):(g=[],e.forEach(k,function(a){g.push(a[0]+":"+a[1])}),g=g.join(";"));return g}return null},_serializeTimeOptions:function(f,k){if(f){var t=[];e.forEach(f,function(b,g){if(b){var d=b.toJson();k&&-1!==e.indexOf(k,g)&&(d.useTime=!1);t.push('"'+g+'":'+a.toJson(d))}});if(t.length)return"{"+t.join(",")+"}"}},_getVisibleLayers:function(a,f){var k=[],b,g,d;if(!a)return k;if(f){k=f.concat();
for(d=0;d<a.length;d++)b=a[d],g=e.indexOf(a,b.id),b.subLayerIds&&-1<g&&(k.splice(g,1),k=k.concat(b.subLayerIds))}else k=this._getDefaultVisibleLayers(a);return k},_getDefaultVisibleLayers:function(a){var f=[],k;if(!a)return f;for(k=0;k<a.length;k++)0<=a[k].parentLayerId&&-1===e.indexOf(f,a[k].parentLayerId)&&e.some(a,function(b){return b.id===a[k].parentLayerId})||a[k].defaultVisibility&&f.push(a[k].id);return f},_getLayersForScale:function(a,f){var k=[];if(0<a&&f){var b;for(b=0;b<f.length;b++)if(!(0<=
f[b].parentLayerId&&-1===e.indexOf(k,f[b].parentLayerId)&&e.some(f,function(a){return a.id===f[b].parentLayerId}))&&0<=f[b].id){var g=!0,d=f[b].maxScale,h=f[b].minScale;if(0<d||0<h)0<d&&0<h?g=d<=a&&a<=h:0<d?g=d<=a:0<h&&(g=a<=h);g&&k.push(f[b].id)}}return k}}})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(q,e,a,f,k){var n=k.doc.documentElement;k=f("ie");var r=f("opera"),t=Math.floor,b=f("ff"),g=q.boxModel.replace(/-/,""),r={dj_quirks:f("quirks"),
dj_opera:r,dj_khtml:f("khtml"),dj_webkit:f("webkit"),dj_safari:f("safari"),dj_chrome:f("chrome"),dj_gecko:f("mozilla"),dj_ios:f("ios"),dj_android:f("android")};k&&(r.dj_ie=!0,r["dj_ie"+t(k)]=!0,r.dj_iequirks=f("quirks"));b&&(r["dj_ff"+t(b)]=!0);r["dj_"+g]=!0;var d="",h;for(h in r)r[h]&&(d+=h+" ");n.className=e.trim(n.className+" "+d);a(function(){if(!q.isBodyLtr()){var a="dj_rtl dijitRtl "+d.replace(/ /g,"-rtl ");n.className=e.trim(n.className+" "+a+"dj_rtl dijitRtl "+d.replace(/ /g,"-rtl "))}});
return f})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y){var B=f.connect,z=f.disconnect,D=u("chrome"),E=u("safari"),
A=[r.NUMPAD_PLUS,61,r.NUMPAD_MINUS,r.UP_ARROW,r.NUMPAD_8,r.RIGHT_ARROW,r.NUMPAD_6,r.DOWN_ARROW,r.NUMPAD_2,r.LEFT_ARROW,r.NUMPAD_4,r.PAGE_UP,r.NUMPAD_9,r.PAGE_DOWN,r.NUMPAD_3,r.END,r.NUMPAD_1,r.HOME,r.NUMPAD_7];return q(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(a,c){this.map=a;e.mixin(this,c);var l=a.__container;u("esri-pointer")?(this.pointerEvents=new d(l,{map:a}),this.eventModel="pointer"):u("esri-touch")?(u("ios")||(this.mouseEvents=new b(l,{map:a})),this.touchEvents=
new g(l,{map:a,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new b(l,{map:a}),this.eventModel="mouse");this._zoomRect=new p(null,new y(h.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=e.hitch(this,this._adjustPinch);this._adjustPinchEnd=e.hitch(this,this._adjustPinchEnd)},_panInit:function(a){var c=this.mouseEvents;n.isLeft(a)&&(this.map.isPan&&!a.shiftKey)&&(this._dragOrigin=new l(0,0),e.mixin(this._dragOrigin,a.screenPoint),this._panStartHandle=
B(c,"onMouseDragStart",this,this._panStart),this._panHandle=B(c,"onMouseDrag",this,this._pan),this._panEndHandle=B(c,"onMouseUp",this,this._panEnd),(D||E)&&a.preventDefault())},_panStart:function(a){this.map.setCursor("move");this.map.__panStart(a.screenPoint.x,a.screenPoint.y)},_pan:function(a){this.map.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)},_panEnd:function(a){z(this._panStartHandle);z(this._panHandle);z(this._panEndHandle);this._panStartHandle=this._panHandle=
this._panEndHandle=null;var c=this.map;c.__panning&&(c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y),c.resetMapCursor())},_zoomInit:function(a){var c=this.map,b=this.pointerEvents||this.mouseEvents;if((n.isLeft(a)||a.pointerType)&&c.isRubberBandZoom&&a.shiftKey)c.setCursor("crosshair"),this._dragOrigin=e.mixin({},a.screenPoint),this._zoomDir=a.ctrlKey||a.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=B(b,"onSwipeMove",this,this._zoom),this._zoomEndHandle=B(b,"onSwipeEnd",
this,this._zoomEnd)):(this._zoomHandle=B(b,"onMouseDrag",this,this._zoom),this._zoomEndHandle=B(b,"onMouseUp",this,this._zoomEnd)),D&&a.preventDefault()},_zoom:function(a){var c=this.map,b=this._normalizeRect(a).offset(c.__visibleRect.x,c.__visibleRect.y);a=c.graphics;var d=this._zoomRect;d.geometry||c.setCursor("crosshair");d.geometry&&a.remove(d,!0);var g=c.toMap(new l(b.x,b.y)),b=c.toMap(new l(b.x+b.width,b.y+b.height)),b=new v(g.x,g.y,b.x-g.x,g.y-b.y,c.spatialReference);b._originOnly=!0;d.setGeometry(b);
a.add(d,!0)},_zoomEnd:function(a){var c=this._zoomRect,b=this.map,d=b.extent,l=b.spatialReference;z(this._zoomHandle);z(this._zoomEndHandle);this._zoomHandle=this._zoomEndHandle=null;if(b._canZoom(this._zoomDir)&&c.getDojoShape()){b.graphics.remove(c);c.geometry=null;a=this._normalizeRect(a);a.x+=b.__visibleRect.x;a.y+=b.__visibleRect.y;if(-1===this._zoomDir){var g=d.getWidth();a=(g*b.width/a.width-g)/2;l=new w(d.xmin-a,d.ymin-a,d.xmax+a,d.ymax+a,l)}else d=b.toMap({x:a.x,y:a.y+a.height}),a=b.toMap({x:a.x+
a.width,y:a.y}),l=new w(d.x,d.y,a.x,a.y,l);b._extentUtil(null,null,l)}c.getDojoShape()&&b.graphics.remove(c,!0);this._zoomDir=0;b.resetMapCursor()},_wheelZoom:function(a,c){var b=this.map;if(!c){if(b.smartNavigation&&!a.shiftKey&&!b._isPanningOrZooming()){b.disableScrollWheelZoom();this._setScrollWheelPan(!0);this._wheelPan(a);return}var d=a.timeStamp;if(!m.isDefined(d)||0>=d)d=(new Date).getTime();if(100>(this._mwts?d-this._mwts:d))return;this._mwts=d}b._canZoom(a.value)&&b._extentUtil({numLevels:a.value,
mapAnchor:a.mapPoint,screenAnchor:a.screenPoint})},_wheelPan:function(a){var c=this.map;if(a.shiftKey&&!c._isPanningOrZooming())this._setScrollWheelPan(!1),c.enableScrollWheelZoom(),this._wheelZoom(a);else{var b=0,d=0;u("ff")?a.axis===a.HORIZONTAL_AXIS?b=-a.detail:d=-a.detail:(b=a.wheelDeltaX,d=a.wheelDeltaY);c.translate(b,d)}},_setScrollWheelPan:function(a){this.map.isScrollWheelPan=a;this.mouseEvents.enableMouseWheel(a);z(this._mwMacHandle);this._mwMacHandle=null;a&&(this._mwMacHandle=B(this.mouseEvents,
"onMouseWheel",this,this._wheelPan))},_recenter:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(a.mapPoint)},_recenterZoom:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&(a.value=a.ctrlKey||a.metaKey?-1:1,this._wheelZoom(a,!0))},_dblClickZoom:function(a){this.map._isPanningOrZooming()||(a.value=1,this._wheelZoom(a,!0))},_twoFingerTap:function(a){this.map._isPanningOrZooming()||(a.value=-1,this._wheelZoom(a,!0))},_keyDown:function(c){var b=c.keyCode,d=this.map;
if(-1!==a.indexOf(A,b)){if(b===r.NUMPAD_PLUS||61===b)d._extentUtil({numLevels:1});else if(b===r.NUMPAD_MINUS)d._extentUtil({numLevels:-1});else{d.__panning||d.__panStart(0,0);switch(b){case r.UP_ARROW:case r.NUMPAD_8:this._keyDy+=10;break;case r.RIGHT_ARROW:case r.NUMPAD_6:this._keyDx-=10;break;case r.DOWN_ARROW:case r.NUMPAD_2:this._keyDy-=10;break;case r.LEFT_ARROW:case r.NUMPAD_4:this._keyDx+=10;break;case r.PAGE_UP:case r.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case r.PAGE_DOWN:case r.NUMPAD_3:this._keyDx-=
10;this._keyDy-=10;break;case r.END:case r.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case r.HOME:case r.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}d.__pan(this._keyDx,this._keyDy)}k.stop(c)}},_keyEnd:function(a){var c=this.map;c.__panning&&a.keyCode!==r.SHIFT&&(c.__panEnd(this._keyDx,this._keyDy),this._keyDx=this._keyDy=0)},_swipeInit:function(a){var c=this.map,c=c._zoomAnim||c._panAnim;if(a.shiftKey)return!1;c&&c._active&&(c.stop(),c._fire("onEnd",[c.node]));this._dragOrigin=
new l(0,0);e.mixin(this._dragOrigin,a.screenPoint);z(this._swipeHandle);z(this._swipeEndHandle);this._swipeHandle=B(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe);this._swipeEndHandle=B(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)},_swipe:function(a){var c=this.map;c.__panning?(this._panX=a.screenPoint.x,this._panY=a.screenPoint.y,c.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)):(c.setCursor("move"),c.__panStart(a.screenPoint.x,
a.screenPoint.y))},_swipeEnd:function(a){z(this._swipeHandle);z(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var c=this.map;c.__panning&&(c.resetMapCursor(),c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(a){var c=this.map,b=c._zoomAnim||c._panAnim;b&&b._active?(b.stop(),b._fire("onEnd",[b.node])):c.__panning&&(a.screenPoint=new l(this._panX,this._panY),a.mapPoint=c.toMap(a.screenPoint),this._swipeEnd(a));z(this._pinchHandle);
z(this._pinchEndHandle);this._pinchHandle=B(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=B(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(a){var c=this.map;a.screenPoints&&(this.currLength=x.getLength(a.screenPoints[0],a.screenPoints[1]),c.__zooming?(a=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(c.extent,a,this._dragOrigin),c.__zoom(this._zoomStartExtent,a,this._dragOrigin)):(this._dragOrigin=
new l((a.screenPoints[0].x+a.screenPoints[1].x)/2,(a.screenPoints[0].y+a.screenPoints[1].y)/2),this._length=this.currLength,c.__zoomStart(c.extent,this._dragOrigin)),c._fireOnScale(this.currLength/this._length,this._dragOrigin,!0))},_pinchEnd:function(a){a=this.map;z(this._pinchHandle);z(this._pinchEndHandle);this._pinchHandle=this._pinchEndHandle=null;if(a.__zooming&&null===a._zoomAnim){var b=this.currLength/this._length,d=a.extent.getWidth();this._zoomAnimAnchor=a.toMap(this._dragOrigin);this._zoomStartExtent=
this.__scaleExtent(a.extent,1/b,this._zoomAnimAnchor);if(a.__tileInfo){var l=c.getCandidateTileInfo(a,a.__tileInfo,this._zoomStartExtent),g=a.__getExtentForLevel(l.lod.level,this._zoomAnimAnchor),e=a.getMinZoom(),p=a.getMaxZoom(),f=g.extent,g=g.lod,m=d/f.getWidth(),u=l.lod.level;1>b?m>b&&u--:m<b&&u++;u<e?u=e:u>p&&(u=p);u!==l.lod.level&&(g=a.__getExtentForLevel(u,this._zoomAnimAnchor),f=g.extent,g=g.lod);this._zoomEndExtent=f;this._zoomEndLod=g;a._zoomAnim=s.animateRange({range:{start:d/this._zoomStartExtent.getWidth(),
end:m},duration:h.defaults.map.zoomDuration,rate:h.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});a._zoomAnim.play();a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=this._zoomStartExtent,a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(a){var c=this.__scaleExtent(this.map.extent,a,this._zoomAnimAnchor);this.map.__zoom(c,a,this._dragOrigin)},
_adjustPinchEnd:function(){var a=this.map,c=a.extent.getWidth()/this._zoomEndExtent.getWidth(),b=this.__scaleExtent(a.extent,1/c,this._zoomAnimAnchor),d=this._dragOrigin,l=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=this._dragOrigin=a._zoomAnim=this._zoomAnimAnchor=null;a.__zoomEnd(b,c,d,l,!0)},__scaleExtent:function(a,c,b){b=b||a.getCenter();c=a.expand(c);var d=a.xmin-(c.getWidth()-a.getWidth())*(b.x-a.xmin)/a.getWidth();b=a.ymax-(c.getHeight()-a.getHeight())*(b.y-
a.ymax)/a.getHeight();return new w(d,b-c.getHeight(),d+c.getWidth(),b,a.spatialReference)},_normalizeRect:function(a){a=a.screenPoint;var c=this._dragOrigin.x,b=this._dragOrigin.y;a=new v((a.x<c?a.x:c)-this.map.__visibleRect.x,(a.y<b?a.y:b)-this.map.__visibleRect.y,Math.abs(a.x-c),Math.abs(a.y-b));delete a.spatialReference;0===a.width&&(a.width=1);0===a.height&&(a.height=1);return a},setImmediateClick:function(a){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(a);break;case "touch":this.touchEvents.setImmediateTap(a);
this.mouseEvents&&this.mouseEvents.setImmediateClick(a);break;case "pointer":this.pointerEvents.setImmediateTap(a)}},enablePan:function(){this.disablePan();switch(this.eventModel){case "mouse":this._panInitHandle=B(this.mouseEvents,"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=B(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=B(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=B(this.pointerEvents,"onSwipeStart",
this,this._swipeInit)}},disablePan:function(){z(this._panInitHandle);this._panInitHandle=null;z(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=this.pointerEvents?B(this.pointerEvents,"onSwipeStart",this,this._zoomInit):B(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){z(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();if("touch"===
this.eventModel||"pointer"===this.eventModel)this._pinchInitHandle=B(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit)},disablePinchZoom:function(){z(this._pinchInitHandle);this._pinchInitHandle=null},enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=B(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){z(this._wheelHandle);this._wheelHandle=null},enableDoubleClickZoom:function(){this.disableDoubleClickZoom();
switch(this.eventModel){case "mouse":this._dblClickHandle=B(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=B(this.mouseEvents,"onDblClick",this,this._dblClickZoom);this._dblTapHandle=B(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=B(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=B(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=B(this.pointerEvents,
"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){z(this._dblClickHandle);z(this._zoomOutHandle);this._dblTapHandle&&z(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=B(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){z(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();
this._recenterHandle=B(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){z(this._recenterHandle);this._recenterHandle=null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=B(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=B(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){z(this._keyHandle);z(this._keyEndHandle);this._keyHandle=
this._keyEndHandle=null},enableNavigation:function(){var a=this.map;a&&a.loaded&&(a.enableDoubleClickZoom(),a.enableClickRecenter(),a.enablePan(),a.enableRubberBandZoom(),this.enablePinchZoom(),a.enableKeyboardNavigation(),a.smartNavigation?this._setScrollWheelPan(!0):a.enableScrollWheelZoom())},disableNavigation:function(){var a=this.map;a&&a.loaded&&(a.disableDoubleClickZoom(),a.disableClickRecenter(),a.disablePan(),a.disableRubberBandZoom(),this.disablePinchZoom(),a.disableKeyboardNavigation(),
a.disableScrollWheelZoom(),a.smartNavigation&&this._setScrollWheelPan(!1))},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&this.mouseEvents.destroy();this.pointerEvents&&this.pointerEvents.destroy();var a,c=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,
this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];for(a=0;a<c.length;a++)z(c[a]);this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=
this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=this._pinchInitHandle=this._pinchHandle=this._pinchEndHandle=null}})})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(q,e,a,f,k,n,r,t,b,g){var d=k.connect,h=k.disconnect;
return q([t],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==f("mac")?1:3,wheelDivisor:2>f("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(b,g){this.node=b;a.mixin(this,g);var h=function(a){n.stop(a);return!1};f("mozilla")&&e.style(b,"MozUserSelect","none");this._handles=[d(b,"onselectstart",h),d(b,"ondragstart",h),d(b,"onmouseenter",this,this._onMouseEnterHandler),d(b,"onmouseleave",this,this._onMouseLeaveHandler),
d(b,"onmousedown",this,this._onMouseDownHandler),d(b,"onclick",this,this._onClickHandler),d(b,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=d(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=d(b,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=a.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(h=this.map)?h.isScrollWheelZoom||h.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},
_fire:function(a,b){if(!this._preventClick||!("onClick"===a||"onDblClick"===a)){if(this[a])this[a](b);if(this.map&&this.map[a])this.map[a](b)}},_processEvent:function(a){a=n.fix(a,a.target);var d=this.map,h=d&&d.position;h&&("DOMMouseScroll"===a.type&&3>f("ff")?a.screenPoint=new g(window.scrollX+a.screenX-h.x,window.scrollY+a.screenY-h.y):a.screenPoint=new g(a.pageX-h.x,a.pageY-h.y),a.mapPoint=d.extent?d.toMap(a.screenPoint):new b);a.numPoints=0;return a},_onMouseEnterHandler:function(a){h(this._onKeyDown_connect);
h(this._onKeyUp_connect);this._onKeyDown_connect=d(document,"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=d(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(a))},_onMouseLeaveHandler:function(a){h(this._onKeyDown_connect);h(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(a))},_onMouseMoveHandler:function(a){this._dragEnd?this._dragEnd=!1:this._fire("onMouseMove",this._processEvent(a))},
_onMouseDownHandler:function(a){h(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);this._onMouseDragHandler_connect=d(document,"onmousemove",this,this._onMouseDragHandler);this._startX=a.pageX;this._startY=a.pageY;this._fire("onMouseDown",this._processEvent(a))},_onMouseUpHandler:function(a){var b=this.node;b.releaseCapture&&b.releaseCapture();h(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;h(this._onMouseMoveHandler_connect);
this._onMouseMoveHandler_connect=d(b,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(a))},_onMouseDragHandler:function(a){h(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=d(document,"onmousemove",this,this._onMouseDraggingHandler);h(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=d(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=d(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",
this._processEvent(a))},_onMouseDraggingHandler:function(a){n.stop(a);this._fire("onMouseDrag",this._processEvent(a))},_onDragMouseUpHandler:function(a){var b=this.node;b.releaseCapture&&b.releaseCapture();this._dragEnd=!0;h(this._docLeaveConnect);h(this._onMouseDragHandler_connect);h(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=d(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=d(b,"onmouseup",
this,this._onMouseUpHandler);a=this._processEvent(a);this._fire("onMouseDragEnd",a);this._fire("onMouseUp",a)},_onDocMouseOut:function(a){var b=9>f("ie")?a.toElement:a.relatedTarget,d=b&&b.nodeName.toLowerCase();(!b||f("chrome")&&"html"===d)&&this._onDragMouseUpHandler(a)},_onClickHandler:function(b){b=this._processEvent(b);b.pageX!==this._startX||b.pageY!==this._startY||(clearTimeout(this._clickTimer),this._clickEvent=a.mixin({},b),this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration))},
_fireClickEvent:function(){clearTimeout(this._clickTimer);9>f("ie")&&(this._clickEvent.graphic=r._ieGraphic,delete r._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(a){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(a))},_onMouseWheelHandler:function(a){var b=this.map;(b?b.isScrollWheelZoom||b.isScrollWheelPan:this.preventPageScroll)&&n.stop(a);var b=f("ff")||f("mozilla")?-a.detail/this.mozWheelDivisor:a.wheelDelta/this.wheelDivisor,d=Math.abs(b),
d=d<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>b?-d:d;this._fire("onMouseWheel",this._processEvent(a))},_onKeyDownHandler:function(a){this._fire("onKeyDown",a)},_onKeyUpHandler:function(a){this._fire("onKeyUp",a)},enableMouseWheel:function(a){h(this._scrollHandle);this._scrollHandle=d(this.node,f("ff")||f("mozilla")?a?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},setImmediateClick:function(a){this.doubleClickDuration=a?0:this._initialDuration},
preventClickEvents:function(a){this._preventClick=a},destroy:function(){var a=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),b;for(b=0;b<a.length;b++)h(a[b]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=
this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}})})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(q,e,a,f,k,n,r,t,b){return q([r],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,constructor:function(b,d){this.node=b;a.mixin(this,d);e.setSelectable(b,!1);this._touchStart=
a.hitch(this,this._touchStart);this._touchMove=a.hitch(this,this._touchMove);this._touchEnd=a.hitch(this,this._touchEnd);this._touchCancel=a.hitch(this,this._touchCancel);b.addEventListener("touchstart",this._touchStart,!1);b.addEventListener("touchmove",this._touchMove,!1);b.addEventListener("touchend",this._touchEnd,!1);b.addEventListener("touchcancel",this._touchCancel,!1);this.map&&f("ios")&&(this._mouseOver=a.hitch(this,this._mouseOver),this._mouseOut=a.hitch(this,this._mouseOut),this._mouseDown=
a.hitch(this,this._mouseDown),this._mouseUp=a.hitch(this,this._mouseUp),this._mouseClick=a.hitch(this,this._mouseClick),b.addEventListener("mouseover",this._mouseOver,!1),b.addEventListener("mouseout",this._mouseOut,!1),b.addEventListener("mousedown",this._mouseDown,!1),b.addEventListener("mouseup",this._mouseUp,!1),b.addEventListener("click",this._mouseClick,!1));this._numTouches=0;this._nodeTouches=[];this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(a){var b=
this._touches,h,e=a.changedTouches.length,m,s,p,c,l=(new Date).getTime();if(!f("android")||!f("safari")||!(1===a.targetTouches.length&&a.touches.length===a.targetTouches.length&&a.targetTouches.length===a.changedTouches.length&&0===a.changedTouches[0].identifier&&b[a.changedTouches[0].identifier])){this._addTouch(a);for(h=0;h<e;h++)m=a.changedTouches[h],s=b[m.identifier]={},s.startX=m.pageX,s.startY=m.pageY,s.startTS=l,-1===this._touchIds.indexOf(m.identifier)&&this._touchIds.push(m.identifier);this._swipeActive&&
(p=this._nodeTouches[0]);this._pinchActive&&(c=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,p))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[p,c]))):2===this._numTouches?this._swipeActive&&(p&&(s=b[this._touchIds[0]],s.startX=p.pageX,s.startY=p.pageY,s.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,p))):this._swipeActive?(this._swipeActive=
!1,this._fire("onSwipeEnd",this._processTouchEvent(a,p))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[p,c])))}},_touchMove:function(a){a.preventDefault();this._updateTouch(a);var b=this._touches,h,e=a.changedTouches.length,m,s,p,c;if(!f("android")||!f("safari")||!(1===a.targetTouches.length&&a.touches.length===a.targetTouches.length&&a.targetTouches.length===a.changedTouches.length&&0===a.changedTouches[0].identifier&&b[a.changedTouches[0].identifier]&&
1<this._touchIds.length)){for(h=0;h<e;h++)if(m=a.changedTouches[h],s=b[m.identifier]){p=Math.abs(m.pageX-s.startX);m=Math.abs(m.pageY-s.startY);if(!s.moved&&(p>=this.tapRadius||m>=this.tapRadius))s.moved=s.absMoved=!0;c=c?c:s.moved}1===this._numTouches?(h=a.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(a,h)):c&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(a,h)))):2===this._numTouches&&(h=this._nodeTouches[0],e=this._nodeTouches[1],
this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(a,[h,e])):c&&(c=b[h.identifier],s=b[e.identifier],b=Math.abs(c.startX-s.startX),c=Math.abs(c.startY-s.startY),b=Math.sqrt(b*b+c*c),c=Math.abs(h.pageX-e.pageX),s=Math.abs(h.pageY-e.pageY),c=Math.sqrt(c*c+s*s),Math.abs(c-b)>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(a,[h,e])))))}},_touchEnd:function(a){this._removeTouch(a);var b=this._touches,h=a.changedTouches,e,f=h.length,s,p,c=(new Date).getTime(),
l=this._touchIds;for(e=0;e<f;e++)if(p=b[h[e].identifier])p.absMoved&&(s=!0),p.pageX=h[e].pageX,p.pageY=h[e].pageY,p.endTS=c;if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,h[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,h));else{if(!s){f=Infinity;s=-Infinity;var c=Infinity,k=-Infinity,v=this.tapStartTolerance,n=[],y=!0;for(e=0;e<l.length;e++)p=
b[l[e]],n.push(p),p.startTS<f&&(f=p.startTS),p.startTS>s&&(s=p.startTS),p.endTS<c&&(c=p.endTS),p.endTS>k&&(k=p.endTS),delete b[l[e]];if(1===n.length&&h[0]&&(b=Math.abs(h[0].pageX-n[0].startX),h=Math.abs(h[0].pageY-n[0].startY),b>=this.tapRadius||h>=this.tapRadius))y=!1;y&&(Math.abs(s-f)<=v&&Math.abs(k-c)<=v)&&this._basicTap(a,n)}}else 1===this._numTouches&&this._pinchActive&&(e=this._nodeTouches[0],p=b[e.identifier],p.startX=e.pageX,p.startY=e.pageY,this._pinchActive=p.moved=!1,this._fire("onPinchEnd",
this._processTouchEvent(a,[h[0],e])))},_touchCancel:function(a){this._numTouches&&this._touchEnd(a)},_basicTap:function(a,b){var e=(new Date).getTime(),f=this;a=this._processTouchEvent(a,b);this._taps.push({touchInfos:b,ts:e,event:a});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",a);clearTimeout(this._tapTimer);this._immediate?this._analyzeTap(!0):this._tapTimer=setTimeout(function(){var a=f;f=null;clearTimeout(a._tapTimer);a._analyzeTap()},2===this._taps.length?this.doubleTapDuration/
2:this.doubleTapDuration)},_analyzeTap:function(a){var b=this._taps,e=b[0],f=b[1],m=e.touchInfos,s=f&&f.touchInfos;b.length&&(a||(this._taps=[]),e&&f?m.length===s.length?f.ts-e.ts<=this.doubleTapDuration?(1===m.length?(a=Math.abs(m[0].startX-s[0].startX),m=Math.abs(m[0].startY-s[0].startY),m=a<=this.doubleTapRadius&&m<=this.doubleTapRadius):m=!0,m?this._processedDoubleTap(b):this._processedTap(f)):this._processedTap(f):this._processedTap(f):this._processedTap(e||f))},_processedTap:function(a){var b=
a.event;this._fire("onProcessedTap",b);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(b)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",b)},_processedDoubleTap:function(a){var b=1===a[1].touchInfos.length,e;b&&(e=[this._fixEvent(a[0].event),this._fixEvent(a[1].event)],e[1].relatedEvents=e);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);b&&(this._fire("onDoubleTap",e[1]),this._fire("onDblClick",e[1]))},_addTouch:function(a){var b=a.changedTouches,
e=this._nodeTouches,f,m,s;this._numTouches+=b.length;for(a=0;a<b.length;a++){m=e.length;s=!1;for(f=0;f<m&&!(s=e[f].identifier===b[a].identifier);f++);s?this._numTouches--:e.push(b[a])}for(a=e.length-1;0<=a;a--)k.isDescendant(e[a].target,document.body)||(e.splice(a,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(a){var b=[],e=[],f=a.changedTouches,m=this._nodeTouches;this._numTouches-=f.length;0>this._numTouches&&(this._numTouches=0);for(a=0;a<f.length;a++)b.push(f[a].identifier);
for(a=m.length-1;0<=a;a--)-1!==b.indexOf(m[a].identifier)&&e.push(m.splice(a,1)[0]);return e},_updateTouch:function(a){var b=[],e,f=a.changedTouches,m=this._nodeTouches;for(a=0;a<f.length;a++)b.push(f[a].identifier);for(a=0;a<m.length;a++)e=b.indexOf(m[a].identifier),-1!==e&&m.splice(a,1,f[e])},_mouseOver:function(a){this._fire("onMouseOver",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",this._processMouseEvent(a))},_mouseDown:function(a){this._fire("onMouseDown",this._processMouseEvent(a))},
_mouseUp:function(a){this._fire("onMouseUp",this._processMouseEvent(a))},_mouseClick:function(a){this._fire("onClick",this._processMouseEvent(a))},_fire:function(a,b){if("onDblClick"===a&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var e=this;setTimeout(function(){e.mouseEvents.preventClickEvents(!1)},350)}if(this[a])this[a](b);if(this.map&&this.map[a])this.map[a](b)},_fixEvent:function(a){var b={},e;for(e in a)b[e]=a[e];this.map&&(b.screenPoint=b.screenPoints[0],b.mapPoint=b.mapPoints[0]);
return b},_processTouchEvent:function(g,d){var e=this.map,f=e&&e.position,m=0;if(f&&d)if(a.isArray(d)){var s,p;g.screenPoints=[];g.mapPoints=[];for(s=0;s<d.length;s++)d[s]?(p=new b(d[s].pageX-f.x,d[s].pageY-f.y),g.screenPoints.push(p),g.mapPoints.push(e.extent?e.toMap(p):new t)):m++}else g.screenPoint=new b(d.pageX-f.x,d.pageY-f.y),g.mapPoint=e.extent?e.toMap(g.screenPoint):new t;g.numPoints=d?a.isArray(d)?d.length-m:1:0;return g},_processMouseEvent:function(a){var d=this.map,e=d&&d.position;e&&(a.screenPoint=
new b(a.pageX-e.x,a.pageY-e.y),a.mapPoint=d.extent?d.toMap(a.screenPoint):new t);return a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("touchstart",this._touchStart,!1);a.removeEventListener("touchmove",this._touchMove,!1);a.removeEventListener("touchend",this._touchEnd,!1);a.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&(a.removeEventListener("mouseover",this._mouseOver,!1),a.removeEventListener("mouseout",this._mouseOut,
!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,!1),a.removeEventListener("click",this._mouseClick,!1));e.setSelectable(a,!0);clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(q,e,
a,f,k,n,r,t){return q([n],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==f("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,constructor:function(a,g){this.node=a;e.mixin(this,g);void 0!==a.style.msTouchAction?a.style.msTouchAction="none":void 0!==a.style.touchAction&&(a.style.touchAction="none");var d=navigator.msPointerEnabled,h=function(a){a.preventDefault()};a.addEventListener("selectstart",
h,!1);a.addEventListener("dragstart",h,!1);this._pointerDown=e.hitch(this,this._pointerDown);this._pointerMove=e.hitch(this,this._pointerMove);this._pointerUp=e.hitch(this,this._pointerUp);this._pointerCancel=e.hitch(this,this._pointerCancel);a.addEventListener(d?"MSPointerDown":"pointerdown",this._pointerDown,!1);a.addEventListener(d?"MSPointerMove":"pointermove",this._pointerMove,!1);a.addEventListener(d?"MSPointerUp":"pointerup",this._pointerUp,!1);a.addEventListener(d?"MSPointerCancel":"pointercancel",
this._pointerCancel,!1);this.map&&(this._mouseOver=e.hitch(this,this._mouseOver),this._mouseOut=e.hitch(this,this._mouseOut),this._mouseLeave=e.hitch(this,this._mouseLeave),this._mouseDown=e.hitch(this,this._mouseDown),this._mouseUp=e.hitch(this,this._mouseUp),this._mouseClick=e.hitch(this,this._mouseClick),this._mouseWheel=e.hitch(this,this._mouseWheel),this._mouseMove=e.hitch(this,this._mouseMove),this._mouseEnter=e.hitch(this,this._mouseEnter),this._onKeyDown=e.hitch(this,this._onKeyDown),this._onKeyUp=
e.hitch(this,this._onKeyUp),a.addEventListener("mouseover",this._mouseOver,!1),a.addEventListener("mouseout",this._mouseOut,!1),a.addEventListener("mouseleave",this._mouseLeave,!1),a.addEventListener("mousedown",this._mouseDown,!1),a.addEventListener("mouseup",this._mouseUp,!1),a.addEventListener("click",this._mouseClick,!1),a.addEventListener("mousewheel",this._mouseWheel,!1),a.addEventListener("mousemove",this._mouseMove,!1),a.addEventListener("mouseenter",this._mouseEnter,!1));this._numTouches=
0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(b){if(-1<a.indexOf(this._touchIds,b.pointerId))this._pointerUp(b);else{var g=this._touches,d=b.target,e=b.pointerId,f=this._touchIds,m,s=(new Date).getTime();m=g[e]={};m.pointerId=e;m.startX=m.pageX=b.pageX;m.startY=m.pageY=b.pageY;m.startTS=s;f.push(e);this._numTouches++;d.setPointerCapture?d.setPointerCapture(e):d.msSetPointerCapture&&d.msSetPointerCapture(e);d=g[f[0]];g=g[f[1]];1!==this._numTouches&&(2===
this._numTouches?this._swipeActive&&(d&&(d.startX=d.pageX,d.startY=d.pageY,d.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,d))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,d))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,[d,g]))))}},_pointerMove:function(a){var g=this._touches,d=this._touchIds,e,f,m;if((e=g[a.pointerId])&&!(e.pageX===a.pageX&&e.pageY===a.pageY)){e.pageX=
a.pageX;e.pageY=a.pageY;f=Math.abs(e.pageX-e.startX);m=Math.abs(e.pageY-e.startY);if(!e.moved&&(f>=this.tapRadius||m>=this.tapRadius))e.moved=e.absMoved=!0;if(1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(a,a)):e.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(a,a)));else if(2===this._numTouches)if(e=g[d[0]],g=g[d[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(a,[e,g]));else if(e.moved||g.moved)d=Math.abs(e.startX-
g.startX),f=Math.abs(e.startY-g.startY),d=Math.sqrt(d*d+f*f),f=Math.abs(e.pageX-g.pageX),m=Math.abs(e.pageY-g.pageY),f=Math.sqrt(f*f+m*m),Math.abs(f-d)>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(a,[e,g])))}},_pointerUp:function(b){var g=this._touches,d,e=this.node,f=b.target,m=b.pointerId,s=this._touchIds,p=s.slice(0),c=a.map(p,function(a){return g[a]}),l=(new Date).getTime();if(d=g[m])if(d.pageX=b.pageX,d.pageY=b.pageY,d.endTS=l,this._numTouches--,
f.releasePointerCapture?f.releasePointerCapture(m):f.msReleasePointerCapture&&f.msReleasePointerCapture(m),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,b));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,b));else{if(!d.absMoved){var f=Infinity,m=-Infinity,s=Infinity,l=-Infinity,k=this.tapStartTolerance,v;for(v=0;v<p.length;v++)d=c[v],d.startTS<f&&
(f=d.startTS),d.startTS>m&&(m=d.startTS),d.endTS<s&&(s=d.endTS),d.endTS>l&&(l=d.endTS);Math.abs(m-f)<=k&&Math.abs(l-s)<=k&&this._basicTap(b,c)}}else 1===this._numTouches&&this._pinchActive&&(s.splice(a.indexOf(s,b.pointerId),1),delete g[b.pointerId],d=g[s[0]],d.startX=d.pageX,d.startY=d.pageY,d.moved=!1,document.msElementsFromPoint&&(p=document.msElementsFromPoint(d.pageX,d.pageY),a.some(p,function(a){return a===e})||(this._touches={},this._touchIds=[],this._numTouches=0)),this._pinchActive=!1,this._fire("onPinchEnd",
this._processTouchEvent(b,[b,d])))},_pointerCancel:function(a){this._numTouches&&this._pointerUp(a)},_basicTap:function(a,g){var d=(new Date).getTime(),e=this,f=this._immediate;a=this._processTouchEvent(a,g);this._taps.push({touchInfos:g,ts:d,event:a});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",a);clearTimeout(this._tapTimer);d=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var a=e;e=null;clearTimeout(a._tapTimer);a._analyzeTap(f)},
f?0:d)},_analyzeTap:function(a){var g=this._taps,d=g[0],e=g[1],f=d.touchInfos,m=e&&e.touchInfos;g.length&&(a||(this._taps=[]),d&&e?f.length===m.length?e.ts-d.ts<=this.doubleTapDuration?(1===f.length?(a=Math.abs(f[0].startX-m[0].startX),f=Math.abs(f[0].startY-m[0].startY),f=a<=this.doubleTapRadius&&f<=this.doubleTapRadius):f=!0,f?this._processedDoubleTap(g):this._processedTap(e)):this._processedTap(e):this._processedTap(e):this._processedTap(d||e))},_processedTap:function(a){var g=a.event;this._fire("onProcessedTap",
g);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(g)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",g)},_processedDoubleTap:function(a){var g=1===a[1].touchInfos.length,d;g&&(d=[this._fixEvent(a[0].event),this._fixEvent(a[1].event)],d[1].relatedEvents=d);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);g&&(this._fire("onDoubleTap",d[1]),this._fire("onDblClick",d[1]))},_mouseOver:function(a){this._fire("onMouseOver",this._processMouseEvent(a))},
_mouseMove:function(a){this._fire("onMouseMove",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",this._processMouseEvent(a))},_mouseLeave:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(event))},_mouseDown:function(a){this._downX=a.pageX;this._downY=a.pageY;this._fire("onMouseDown",this._processMouseEvent(a))},_mouseUp:function(a){this._fire("onMouseUp",
this._processMouseEvent(a))},_mouseClick:function(a){Math.abs(a.pageX-this._downX)<=this.clickRadius&&Math.abs(a.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(a))},_mouseWheel:function(a){var g=this.map;(g?g.isScrollWheelZoom||g.isScrollWheelPan:this.preventPageScroll)&&a.preventDefault();var g=a.wheelDelta?a.wheelDelta/this.wheelDivisor:-a.detail/this.mozWheelDivisor,d=Math.abs(g),d=d<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>g?-d:d;
this._fire("onMouseWheel",this._processMouseEvent(a))},_mouseEnter:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",this._processMouseEvent(a))},_onKeyDown:function(a){this._fire("onKeyDown",a)},_onKeyUp:function(a){this._fire("onKeyUp",a)},_fire:function(a,g){if(this[a])this[a](g);if(this.map&&
this.map[a])this.map[a](g)},_fixEvent:function(a){var g={},d;for(d in a)g[d]=a[d];this.map&&(g.screenPoint=g.screenPoints[0],g.mapPoint=g.mapPoints[0]);return g},_processTouchEvent:function(a,g){var d=this.map,h=d&&d.position,f=0;if(h&&g)if(e.isArray(g)){var m,s;a.screenPoints=[];a.mapPoints=[];for(m=0;m<g.length;m++)g[m]?(s=new t(g[m].pageX-h.x,g[m].pageY-h.y),a.screenPoints.push(s),a.mapPoints.push(d.extent?d.toMap(s):new r)):f++}else a.screenPoint=new t(g.pageX-h.x,g.pageY-h.y),a.mapPoint=d.extent?
d.toMap(a.screenPoint):new r;a.numPoints=g?e.isArray(g)?g.length-f:1:0;return a},_processMouseEvent:function(a){var g=this.map,d=g&&g.position;d&&(a.screenPoint=new t(a.pageX-d.x,a.pageY-d.y),a.mapPoint=g.extent?g.toMap(a.screenPoint):new r);return a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("MSPointerDown",this._pointerDown,!1);a.removeEventListener("MSPointerMove",this._pointerMove,!1);a.removeEventListener("MSPointerUp",this._pointerUp,
!1);a.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(a.removeEventListener("mouseover",this._mouseOver,!1),a.removeEventListener("mousemove",this._mouseMove,!1),a.removeEventListener("mouseout",this._mouseOut,!1),a.removeEventListener("mouseleave",this._mouseLeave,!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,!1),a.removeEventListener("click",this._mouseClick,!1),a.removeEventListener("mouseenter",this._mouseEnter,
!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer".split(" "),function(q,e,a,f,k,n,
r,t,b,g,d,h,u,m,s,p,c){return{fromJson:function(a){var c;switch(a.type||""){case "simple":c=new t(a);break;case "uniqueValue":c=new b(a);break;case "classBreaks":c=new g(a);break;case "vectorField":c=new d(a);break;case "scaleDependent":c=this._scaleDependentFromJson(a);break;case "dotDensity":c=this._dotDensityFromJson(a);break;case "temporal":c=this._temporalFromJson(a);break;case "heatmap":c=this._heatmapFromJson(a)}return c},_scaleDependentFromJson:function(a){var c={},b=a.minScale;c.rendererInfos=
q.map(a.rendererInfos,function(a){var c=a.maxScale;a={minScale:b,maxScale:c,renderer:a.renderer&&this.fromJson(a.renderer)};b=c;return a},this);return new u(c)},_dotDensityFromJson:function(a){a.backgroundColor&&e.isArray(a.backgroundColor)&&(a.backgroundColor=n.toDojoColor(a.backgroundColor));0<a.dotSize&&(a.dotSize=f.pt2px(a.dotSize));a.fields&&q.forEach(a.fields,function(a){a&&e.isArray(a.color)&&(a.color=n.toDojoColor(a.color))});a.legendOptions&&(a.legendOptions.backgroundColor&&e.isArray(a.legendOptions.backgroundColor)&&
(a.legendOptions.backgroundColor=n.toDojoColor(a.legendOptions.backgroundColor)),a.legendOptions.outline&&(a.legendOptions.outline=r.fromJson(a.legendOptions.outline)));a.outline&&(a.outline=r.fromJson(a.outline));return new h(a)},_temporalFromJson:function(a){var c,b,d;a=a||{};c=this.fromJson(a.observationRenderer);b=a.latestObservationRenderer?this.fromJson(a.latestObservationRenderer):null;d=a.trackRenderer?this.fromJson(a.trackRenderer):null;a=this._agerFromJson(a.observationAger);return new p(c,
b,d,a)},_agerFromJson:function(a){var c;a=a||{};a.colorRange||a.sizeRange||a.alphaRange?c=this._timeRampFromJson(a):a.agerClassBreakInfos&&(c=this._timeClassBreaksFromJson(a));return c},_timeRampFromJson:function(a){var c,b,d;a.colorRange&&1<a.colorRange.length&&(c=[n.toDojoColor(a.colorRange[0]),n.toDojoColor(a.colorRange[1])]);a.sizeRange&&1<a.sizeRange.length&&(b=[a.sizeRange[0],a.sizeRange[1]]);a.alphaRange&&1<a.alphaRange.length&&(d=[a.alphaRange[0]/255,a.alphaRange[1]/255]);return new s(c,b,
d)},_timeClassBreaksFromJson:function(a){var c=a.agerClassBreakInfos,b,d,g=[],e;b=m.UNIT_DAYS;switch(a.timeUnits){case "esriTimeUnitsSeconds":b=m.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":b=m.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":b=m.UNIT_HOURS;break;case "esriTimeUnitsMinutes":b=m.UNIT_MINUTES;break;case "esriTimeUnitsMonths":b=m.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":b=m.UNIT_WEEKS;break;case "esriTimeUnitsYears":b=m.UNIT_YEARS}for(e=0;e<c.length;e+=1)a=c[e],d={minAge:0,
maxAge:a.oldestAge||Infinity},a.color&&(d.color=n.toDojoColor(a.color)),a.alpha&&(d.alpha=a.alpha/255),d.size=a.size,g[e]=d;return new m(g,b)},_heatmapFromJson:function(a){var b=a.colorStops;b&&b instanceof Array&&q.forEach(b,function(a){a.color=n.toDojoColor(a.color)});return new c(a)}}})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(q,e,a,f,k,n,r){return q(r,{declaredClass:"esri.renderer.SimpleRenderer",
constructor:function(a){if(a&&!a.declaredClass){var b=a;this.symbol=(a=b.symbol)&&(a.declaredClass?a:n.fromJson(a));this.label=b.label;this.description=b.description}else this.symbol=a},getSymbol:function(a){return this.symbol},toJson:function(){var a=e.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return k.fixJson(a)}})})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color".split(" "),
function(q,e,a,f,k,n,r){var t=Math.PI;return q(null,{declaredClass:"esri.renderer.Renderer",constructor:function(a){this._ipDataCache={};if(a&&!a.declaredClass){this.rotationInfo=a.rotationInfo;if(!this.rotationInfo){var g=a.rotationType,d=a.rotationExpression;if(g||d)this.rotationInfo={type:g,expression:d}}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(a.sizeInfo));this.setColorInfo(this._readColorInfo(a.colorInfo));this.setOpacityInfo(this._readOpacityInfo(a.transparencyInfo));
this.setVisualVariables(this._readVariables(a.visualVariables));this.setAuthoringInfo(a.authoringInfo)}this.getSymbol=e.hitch(this,this.getSymbol)},getSymbol:function(a){},_readSizeInfo:function(a){a&&(a.minSize&&(a.minSize=k.pt2px(a.minSize)),a.maxSize&&(a.maxSize=k.pt2px(a.maxSize)));return a},_readColorInfo:function(b){b&&(a.forEach(b.colors,function(a,d){e.isArray(a)&&(b.colors[d]=r.toDojoColor(a))}),a.forEach(b.stops,function(a,d){a.color&&e.isArray(a.color)&&(b.stops[d].color=r.toDojoColor(a.color))}));
return b},_readOpacityInfo:function(b){var g;b&&(g=e.mixin({},b),g.transparencyValues&&(g.opacityValues=a.map(g.transparencyValues,function(a){return 1-a/100}),delete g.transparencyValues),g.stops&&(g.stops=a.map(g.stops,function(a){a=e.mixin({},a);a.opacity=1-a.transparency/100;delete a.transparency;return a})));return g},_readVariables:function(b){b&&(b=a.map(b,function(a){"sizeInfo"===a.type?a=this._readSizeInfo(a):"colorInfo"===a.type?a=this._readColorInfo(a):"transparencyInfo"===a.type&&(a=this._readOpacityInfo(a),
a.type="opacityInfo");return a},this));return b},setAuthoringInfo:function(a){this.authoringInfo=a},setRotationInfo:function(a){if((a=this.rotationInfo="string"===typeof a?{field:a}:a)&&a.expression&&!a.field){var g=a.expression.match(this.rotationRE);g&&g[1]&&(a.field=g[1])}return this},rotationRE:/^\[([^\]]+)\]$/i,getRotationAngle:function(a){var g=this.rotationInfo,d="arithmetic"===g.type,g=g.field,h=a.attributes,f=0;g&&(e.isFunction(g)?f=g.apply(this,arguments):h&&(f=h[g]||0),f=(f+(d?-90:0))*
(d?-1:1));return f},setVisualVariables:function(b){var g=this._ipDataCache;a.forEach(this.visualVariables,function(a,b){g.hasOwnProperty(b)&&(g[b]=null)},this);this.visualVariables=b;a.forEach(b,function(a,b){"colorInfo"===a.type?g[b]=this._processColorInfo(a):"opacityInfo"===a.type&&(g[b]=this._processOpacityInfo(a))},this);return this},getVisualVariableValues:function(b){var g=this.visualVariables,d;g&&(d=a.map(g,function(a){var d;switch(a.type){case "sizeInfo":d=this.getSize(b,{sizeInfo:a});break;
case "colorInfo":d=this.getColor(b,{colorInfo:a});break;case "opacityInfo":d=this.getOpacity(b,{opacityInfo:a})}return{variable:a,value:d}},this));return d},hasVisualVariables:function(){return!(!this.getVisualVariablesForType("sizeInfo")&&!this.getVisualVariablesForType("colorInfo")&&!this.getVisualVariablesForType("opacityInfo"))},getVisualVariablesForType:function(b){var g=this.visualVariables,d;this[b]?d=[this[b]]:g&&(d=a.filter(g,function(a){return a.type===b}))&&0===d.length&&(d=void 0);return d},
setSizeInfo:function(a){this.sizeInfo=this.proportionalSymbolInfo=a;return this},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);return this},getSize:function(a,g){var d=a.attributes,h=g&&g.sizeInfo||this.sizeInfo,f=h&&h.field,m=0,s="number"===typeof a,p=s?a:null;if(f){var c=h.minSize,l=h.maxSize,k=h.minDataValue,v=h.maxDataValue,n=h.valueUnit||"unknown",y=h.valueRepresentation,r=h.scaleBy,q=h.normalizationField,D=d?parseFloat(d[q]):void 0,h=g&&g.shape;"number"!==typeof p&&(e.isFunction(f)?
p=f.apply(this,arguments):d&&(p=d[f]));if(null==p||q&&!s&&(isNaN(D)||0===D))return null;!isNaN(D)&&!s&&(p/=D);if(null!=c&&null!=l&&null!=k&&null!=v)p<=k?m=c:p>=v?m=l:(p=(p-k)/(v-k),"area"===r&&h?(c=(y="circle"===h)?t*Math.pow(c/2,2):c*c,l=y?t*Math.pow(l/2,2):l*l,l=c+p*(l-c),m=y?2*Math.sqrt(l/t):Math.sqrt(l)):m=c+p*(l-c));else if("unknown"===n)null!=c&&null!=k&&(c&&k?(p/=k,m="circle"===h?2*Math.sqrt(p*Math.pow(c/2,2)):"square"===h||"diamond"===h||"image"===h?Math.sqrt(p*Math.pow(c,2)):p*c):m=p+(c||
k),m=m<c?c:m,null!=l&&m>l&&(m=l));else{r=(g&&g.resolution?g.resolution:1)*this._meterIn[n];if("area"===y)m=Math.sqrt(p/t)/r,m*=2;else if(m=p/r,"radius"===y||"distance"===y)m*=2;null!=c&&m<c&&(m=c);null!=l&&m>l&&(m=l)}}else h&&(m=h.minSize);return m=isNaN(m)?0:m},setColorInfo:function(a){this.colorInfo=a;this._ipDataCache.colorInfo=this._processColorInfo(a);return this},_processColorInfo:function(b){b&&(a.forEach(b.colors,function(a,d){e.isArray(a)&&(b.colors[d]=new r(a))}),a.forEach(b.stops,function(a,
d){a.color&&e.isArray(a.color)&&(b.stops[d].color=new r(a.color))}));return this._interpolateData(b)},getColor:function(b,g){var d,e=g&&g.colorInfo;e&&"colorInfo"===e.type?(d=a.indexOf(this.visualVariables,e),e=this.visualVariables[d]):(d="colorInfo",e=this.colorInfo);return this._getColorComponent(b,e,this._ipDataCache[d])},setOpacityInfo:function(a){this.opacityInfo=a;this._ipDataCache.opacityInfo=this._processOpacityInfo(a);return this},_processOpacityInfo:function(a){return this._interpolateData(a)},
getOpacity:function(b,g){var d,e=g&&g.opacityInfo;e&&"opacityInfo"===e.type?(d=a.indexOf(this.visualVariables,e),e=this.visualVariables[d]):(d="opacityInfo",e=this.opacityInfo);return this._getColorComponent(b,e,this._ipDataCache[d],!0)},_getColorComponent:function(a,g,d,h){var f=a.attributes,m=g&&g.field,s="number"===typeof a?a:null,p;if(m){var c=g.normalizationField,l=f?parseFloat(f[c]):void 0;"number"!==typeof s&&(e.isFunction(m)?s=m.apply(this,arguments):f&&(s=f[m]));null!=s&&(c&&(!isNaN(l)&&
0!==l)&&(s/=l),p=h?this._getOpacity(s,g,d):this._getColor(s,g,d))}else g&&(f=g.stops,h?(p=f&&f[0]&&f[0].opacity,null==p&&(p=g.opacityValues&&g.opacityValues[0])):p=f&&f[0]&&f[0].color||g.colors&&g.colors[0]);return p},_interpolateData:function(b){var g;if(b&&b.field)if(b.colors||b.opacityValues){var d=(b.colors||b.opacityValues).length,e=b.minDataValue,f=(b.maxDataValue-e)/(d-1);g=[];for(b=0;b<d;b++)g[b]=e+b*f}else b.stops&&(g=a.map(b.stops,function(a){return a.value}));return g},_getOpacity:function(a,
g,d){a=this._lookupData(a,d);var e;g=g||this.opacityInfo;a&&(d=a[0],e=a[1],d===e?e=this._getOpacValue(g,d):(d=this._getOpacValue(g,d),g=this._getOpacValue(g,e),e=d+(g-d)*a[2]));return e},_getOpacValue:function(a,g){return a.opacityValues?a.opacityValues[g]:a.stops[g].opacity},_getColor:function(a,g,d){a=this._lookupData(a,d);var e;g=g||this.colorInfo;a&&(e=a[0],d=a[1],e=e===d?this._getColorObj(g,e):r.blendColors(this._getColorObj(g,e),this._getColorObj(g,d),a[2]));return e},_getColorObj:function(a,
g){return a.colors?a.colors[g]:a.stops[g].color},_lookupData:function(b,g){var d;if(g){var e=0,f=g.length-1;a.some(g,function(a,d){if(b<a)return f=d,!0;e=d;return!1});d=[e,f,(b-g[e])/(g[f]-g[e])]}return d},_meterIn:{inches:39.3701,feet:3.28084,yards:1.09361,miles:6.21371E-4,"nautical-miles":5.39957E-4,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:0.001,"decimal-degrees":180/20015077},_writeSizeInfo:function(a){if(a){a=e.mixin({},a);a.minSize&&(a.minSize=k.px2pt(a.minSize));a.maxSize&&
(a.maxSize=k.px2pt(a.maxSize));var g=a.legendOptions;if(g&&(a.legendOptions=e.mixin({},g),g=g.customValues))a.legendOptions.customValues=g.slice(0)}return a},_writeColorInfo:function(b){b&&(b=e.mixin({},b),b.colors&&(b.colors=a.map(b.colors,function(a){return r.toJsonColor(a)})),b.stops&&(b.stops=a.map(b.stops,function(a){a=e.mixin({},a);a.color&&(a.color=r.toJsonColor(a.color));return a})));return b},_writeOpacityInfo:function(b){var g;b&&(g=e.mixin({},b),g.opacityValues&&(g.transparencyValues=a.map(g.opacityValues,
function(a){return 100*(1-a)}),delete g.opacityValues),g.stops&&(g.stops=a.map(g.stops,function(a){a=e.mixin({},a);a.transparency=100*(1-a.opacity);delete a.opacity;return a})));return g},toJson:function(){var b=this.visualVariables,g=this.rotationInfo,d=g&&g.field,h=e.clone(this.authoringInfo),d=g&&(g.expression||d&&(e.isFunction(d)?d:"["+d+"]"));b&&(b=a.map(b,function(a){"sizeInfo"===a.type?a=this._writeSizeInfo(a):"colorInfo"===a.type?a=this._writeColorInfo(a):"opacityInfo"===a.type&&(a=this._writeOpacityInfo(a),
a.type="transparencyInfo");return a},this));h&&a.forEach(h.visualVariables,function(a){"opacityInfo"===a.type&&(a.type="transparencyInfo")});return{rotationType:d&&(g.type||"geographic"),rotationExpression:d,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:b,authoringInfo:h}}})})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),
function(q,e,a,f,k,n,r,t){return q(t,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(a,g,d,h,f){this.values=[];this._symbols={};this.infos=[];a&&!a.declaredClass?(g=a,this.defaultSymbol=(a=g.defaultSymbol)&&(a.declaredClass?a:r.fromJson(a)),this.attributeField=g.field1,this.attributeField2=g.field2,this.attributeField3=g.field3,this.fieldDelimiter=g.fieldDelimiter,this.defaultLabel=g.defaultLabel,e.forEach(g.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=a,
this.attributeField=g,this.attributeField2=d,this.attributeField3=h,this.fieldDelimiter=f);this._multiple=!!this.attributeField2},addValue:function(b,g){var d=a.isObject(b)?b:{value:b,symbol:g};this._addValueInfo(d)},removeValue:function(a){var g=e.indexOf(this.values,a);-1!==g&&(this.values.splice(g,1),delete this._symbols[a],this.infos.splice(g,1))},getUniqueValueInfo:function(b){var g=this.attributeField,d=b.attributes,e,f;this._multiple?(b=this.attributeField2,e=this.attributeField3,f=[],g&&f.push(d[g]),
b&&f.push(d[b]),e&&f.push(d[e]),g=f.join(this.fieldDelimiter||"")):g=a.isFunction(g)?g(b):d[g];return this._symbols[g]},getSymbol:function(a){return(a=this.getUniqueValueInfo(a))&&a.symbol||this.defaultSymbol},_addValueInfo:function(a){var g=a.value;this.values.push(g);this.infos.push(a);var d=a.symbol;d&&!d.declaredClass&&(a.symbol=r.fromJson(d));this._symbols[g]=a},toJson:function(){var b=n.fixJson,g=a.mixin(this.inherited(arguments),{type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,
field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:e.map(this.infos||[],function(d){d=a.mixin({},d);d.symbol=d.symbol&&d.symbol.toJson();d.value+="";return b(d)})});return b(g)}})})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(q,e,a,f,
k,n,r,t){return q(t,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(a,g){this.breaks=[];this._symbols={};this.infos=[];this.isMaxInclusive=!0;if(a&&!a.declaredClass){var d=a;this.attributeField=d.field;this.defaultSymbol=(a=d.defaultSymbol)&&(a.declaredClass?a:r.fromJson(a));this.backgroundFillSymbol=(a=d.backgroundFillSymbol)&&(a.declaredClass?a:r.fromJson(a));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],
d,this);var h=d.minValue;(d=d.classBreakInfos)&&(d[0]&&n.isDefined(d[0].classMaxValue))&&e.forEach(d,function(a){var b=a.classMaxValue;a.minValue=h;h=a.maxValue=b},this);e.forEach(d,this._addBreakInfo,this)}else this.defaultSymbol=a,this.attributeField=g},addBreak:function(b,g,d){b=a.isObject(b)?b:{minValue:b,maxValue:g,symbol:d};this._addBreakInfo(b)},removeBreak:function(a,g){var d,e=this.breaks,f,m=e.length,s=this._symbols;for(f=0;f<m;f++)if(d=e[f],d[0]==a&&d[1]==g){e.splice(f,1);delete s[a+"-"+
g];this.infos.splice(f,1);break}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(b){var g=this.attributeField,d=b.attributes,e=this.breaks,f=e.length,m=this.isMaxInclusive;if(a.isFunction(g))b=g(b);else{b=parseFloat(d[g]);var g=this.normalizationType,s;g&&(s=parseFloat(this.normalizationTotal),d=parseFloat(d[this.normalizationField]),"log"===g?b=Math.log(b)*Math.LOG10E:"percent-of-total"===g&&!isNaN(s)?b=100*(b/s):"field"===g&&!isNaN(d)&&(b/=d))}for(d=
0;d<f;d++)if(g=e[d],g[0]<=b&&(m?b<=g[1]:b<g[1]))return d;return-1},getBreakInfo:function(a){a=this.getBreakIndex(a);return-1!==a?this.infos[a]:null},getSymbol:function(a){return(a=this.breaks[this.getBreakIndex(a)])?this._symbols[a[0]+"-"+a[1]]:this.defaultSymbol},setMaxInclusive:function(a){this.isMaxInclusive=a},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks",
"esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"]],_copy:function(a,g,d){e.forEach(a,function(a){var b=a.split(":"),e,f,p;1<b.length&&(a=b[0],e=this["_"+a+"Enums"],"rest"===b[1]?(f="1",p="0"):"sdk"===b[1]&&(f="0",p="1"));b=g[a];if(void 0!==b&&(d[a]=b,e&&f)){var c,l=e.length;for(c=0;c<l;c++)if(e[c][f]===b){d[a]=e[c][p];break}}},
this)},_addBreakInfo:function(a){var e=a.minValue,d=a.maxValue;this.breaks.push([e,d]);this.infos.push(a);var h=a.symbol;h&&!h.declaredClass&&(a.symbol=r.fromJson(h));this._symbols[e+"-"+d]=a.symbol},toJson:function(){var b=this.infos||[],g=n.fixJson,d=b[0]&&b[0].minValue,h=this.backgroundFillSymbol,b=a.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:h&&h.toJson(),minValue:-Infinity===
d?-Number.MAX_VALUE:d,classBreakInfos:e.map(b,function(b){b=a.mixin({},b);b.symbol=b.symbol&&b.symbol.toJson();b.classMaxValue=Infinity===b.maxValue?Number.MAX_VALUE:b.maxValue;delete b.minValue;delete b.maxValue;return g(b)})});this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],this,b);b.hasOwnProperty("normalizationType")&&!b.normalizationType&&delete b.normalizationType;b.hasOwnProperty("classificationMethod")&&!b.classificationMethod&&
delete b.classificationMethod;return g(b)}})})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){var s=q(t,{declaredClass:"esri.renderer.VectorFieldRenderer",patternUrlPrefix:m.toUrl("../images/symbol/sfs/"),
constructor:function(a){n.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);q.safeMixin(this,a);this.style=this.style||s.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:u.fromJson(this.singleArrowSymbol));this.renderer=new b(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||
this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){a=f.filter(a,function(a){if("sizeInfo"===a.type)return n.isDefined(this._updateSizeInfo(a))},this);this.inherited(arguments);return this},setSizeInfo:function(a){this._updateSizeInfo(a);this.inherited(arguments);return this},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);return this},setColorInfo:function(a){return this},_updateRenderer:function(a){return!n.isDefined(this.renderer)?
Error("Invalid Renderer!"):a===s.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===s.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===s.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===s.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===s.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===s.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():a===s.STYLE_OCEAN_CURRENT_M?this._createCurrentMeterRenderer():a===s.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():
a===s.STYLE_SCALAR?this._createSimpleScalarRenderer():a===s.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer()},_updateSizeInfo:function(a){return a&&n.isDefined(a.minSize)&&n.isDefined(a.maxSize)&&n.isDefined(a.minDataValue)&&n.isDefined(a.maxDataValue)?(this.style===s.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([56,
168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(n.isDefined(this.minDataValue)&&n.isDefined(this.maxDataValue)){var c=(this.maxDataValue-this.minDataValue)/5,a=[],b,d;d=this.minDataValue;for(b=0;6>b;b++)a[b]=d,d+=c}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,
47,39]));this._addBreaks([0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,
250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];f.forEach(a,function(c,b){a[b]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=
[0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];f.forEach(a,function(c,b){a[b]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=[0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];f.forEach(a,function(c,b){a[b]*=3.6});
this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([177,177,177]));this._addBreaks([0,0.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=
this._getDefaultSymbol(new r([177,177,177]));this._addBreaks([0,0.25,0.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new d({url:this.patternUrlPrefix+"scalar.png",height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var a=[],c,b;for(c=0;150>=c;c+=5)a.push(c);b="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var e=new d({url:this.patternUrlPrefix+"windbarb.png",height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=e;for(c=0;c<a.length-1;c++)0==c?this.renderer.addBreak({minValue:a[c],maxValue:a[c+1],symbol:e}):this.renderer.addBreak({minValue:a[c],maxValue:a[c+1],symbol:(new g).setPath(b[c]).setOutline((new h).setWidth(1.5)).setSize(20).setColor(new r([0,0,0,255]))})},_getDefaultSymbol:function(a){return(new g).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new h).setWidth(0)).setSize(20).setColor(a||
new r([0,92,230]))},_getRotationInfo:function(a){var c=a&&a.flowRepresentation||s.FLOW_FROM,b=a&&a.rotationField||"Direction",d=s.FLOW_FROM;return{field:function(a){a=a.attributes[b];return c===d?a:a+180},type:"geographic"}},_addBreaks:function(a,c){if(!n.isDefined(this.renderer))return Error("Invalid Renderer!");if(!a||!c||!a.length||!c.length||!(a.length>=c.length))return Error("AddBreaks: Input arguments break values and colors not valid");var b;for(b=0;b<c.length;b++)this.renderer.addBreak({minValue:a[b],
maxValue:a[b+1],symbol:this._getDefaultSymbol(new r(c[b]))})},toJson:function(){var a=e.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});this.renderer&&(this.renderer.defaultSymbol&&this.style===s.STYLE_SINGLE_ARROW)&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson());return n.fixJson(a)}});e.mixin(s,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"});return s})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u){return q(g,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){var b,g;this._currentGraphic=a;if(!this._supportsCanvas)return null;this._map||(this._map=a.getLayer()._map,this._objectIdField=a.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",
e.hitch(this,function(a){this._currentMapScale=this._map.getScale();this._currentResolution=a.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]])return b=this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]],g=this._getShapeProperties(a),b.setOffset(g.dx,g.dy),b;b=this._generateFieldsCount(this.fields,a.attributes,this.dotValue);g=this._getShapeProperties(a);
b=new d(this._generateImageSrc(g.width,g.height,b,g.minXY,g.maxXY),this.outline,g.width,g.height);b.setOffset(g.dx,g.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=b},_generateFieldsCount:function(a,b,d){var c,l;for(l=a.length-1;0<=l;l--)c=b[a[l].name]/d,a[l].numPoints=Math.round(c);return a},_getShapeProperties:function(a){var b,d,c,l;b=a.geometry.getExtent();b.contains(this._map.extent)&&
(b=this._map.extent);c=Math.ceil(b.getWidth()/this._currentResolution);l=Math.ceil(b.getHeight()/this._currentResolution);d=this._map.toScreen(new u(b.xmin,b.ymin,b.spatialReference));b=this._map.toScreen(new u(b.xmax,b.ymax,b.spatialReference));a=a.getLayer().getNode().getCTM();return{minXY:d,maxXY:b,dx:(d.x-a.e)%c,dy:(b.y-a.f)%l,width:c,height:l}},_generateImageSrc:function(a,b,d,c,l,g){var e=this.dotSize,h,f,u;this._canvas?(this._canvas.width=a,this._canvas.height=b):this._canvas=this._initCanvas(a,
b);h=this._canvas.getContext("2d");if(g=g||this.backgroundColor)h.fillStyle=g.toCss(!0),h.fillRect(0,0,a,b),h.fill();for(g=d.length-1;0<=g;g--){h.fillStyle=d[g].color.toCss(!0);for(f=d[g].numPoints-1;0<=f;f--)u=this._getRandomPoint(a,b,c,l),"square"===this.dotShape?h.fillRect(u.x,u.y,e,e):"circle"===this.dotShape&&(h.beginPath(),h.arc(u.x,u.y,e/2,0,2*Math.PI,!0)),h.fill()}return this._canvas.toDataURL()},_initCanvas:function(a,b){var d=f.create("canvas",{id:"canvas",width:a+"px",height:b+"px",style:"position: absolute; left: -10000px; top: 0px;"},
null);document.body.appendChild(d);return d},_getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},_getRandomPoint:function(a,b,d,c){var l={},g=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&a*b>this._exactCountMinArea){do l.x=this._getRandomInt(d.x,c.x),l.y=this._getRandomInt(c.y,d.y),a=new h(l.x,l.y),a=this._checkPointShapeBounds(a,this.dotSize+g,this._currentGraphic.geometry),!0===a&&(l.x-=d.x,l.y-=c.y);while(!1===a)}else l.x=this._getRandomInt(0,
a),l.y=this._getRandomInt(0,b);return l},_checkPointShapeBounds:function(a,b,d){var c=null,c=!1,l=!0,g=0;do{switch(g){case 1:a.x+=b;break;case 2:a.y+=b;break;case 3:a.x-=b}c=this._map.toMap(a);c=d.contains(c);!1===c&&(l=!1);g+=1}while(3>=g&&!0===l);return c},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=a},toJson:function(){var d=e.mixin(this.inherited(arguments),
{type:"dotDensity",backgroundColor:b.toJsonColor(this.backgroundColor),dotShape:this.dotShape,dotSize:0<this.dotSize?n.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:a.map(this.fields,function(a){return t.fixJson({color:b.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&t.fixJson({backgroundColor:b.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),
outline:this.outline&&this.outline.toJson()});return t.fixJson(d)}})})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(q,e,a,f,k,n,r){return q(r,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(a){this.setRendererInfos(a&&a.rendererInfos||[])},setRendererInfos:function(a){this.rendererInfos=a;this._setRangeType();return this},getSymbol:function(a){var b=
this.getRendererInfo(a);return b&&b.renderer&&b.renderer.getSymbol(a)},getRendererInfo:function(a){a=a.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(a.getZoom()):this.getRendererInfoByScale(a.getScale())},getRendererInfoByZoom:function(a){var b,g=this.rendererInfos,d,e=0;do b=g[e],a>=b.minZoom&&a<=b.maxZoom&&(d=b),e++;while(!d&&e<g.length);return d},getRendererInfoByScale:function(a){var b,g=this.rendererInfos,d,e=0,f,m,s,p;do b=g[e],f=b.minScale,m=b.maxScale,s=!f,p=
!m,!s&&a<=f&&(s=!0),!p&&a>=m&&(p=!0),s&&p&&(d=b),e++;while(!d&&e<g.length);return d},addRendererInfo:function(a){var b,g=0,d,e=this.rendererInfos,f=a.hasOwnProperty("minZoom")?"minZoom":"minScale",m=e.length;do{d=e[g];if(m===g||a[f]<d[f])e.splice(g,0,a),this._setRangeType(),b=!0;g++}while(!b&&g<m);return this},_setRangeType:function(){var a=this.rendererInfos;if(a=a&&a[0])this.rangeType=a.hasOwnProperty("minZoom")?"zoom":a.hasOwnProperty("minScale")?"scale":""},toJson:function(){if("zoom"===this.rangeType)return null;
var f=this.rendererInfos||[],b=f[0]&&f[0].minScale,f=a.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<b?b:0,rendererInfos:e.map(f,function(a){return n.fixJson({maxScale:0<a.maxScale?a.maxScale:0,renderer:a.renderer&&a.renderer.toJson()})})});return n.fixJson(f)}})})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(q,e,a,
f,k,n,r,t,b,g){var d=q(g,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,b){this.infos=a;this.timeUnits=b||"day";a.sort(function(a,b){return a.minAge<b.minAge?-1:a.minAge>b.minAge?1:0})},getAgedSymbol:function(a,b){var d=b.getLayer(),g=b.attributes,f=r.isDefined;a=t.fromJson(a.toJson());var c=d._map.timeExtent.endTime;if(!c)return a;var l=k.difference(new Date(g[d._startTimeField]),c,this.timeUnits);e.some(this.infos,function(c){if(l>=c.minAge&&l<=c.maxAge){var b=c.color,
d=c.size;c=c.alpha;b&&a.setColor(b);f(d)&&this._setSymbolSize(a,d);f(c)&&a.color&&(a.color.a=c);return!0}},this);return a},toJson:function(){var a={agerClassBreakInfos:[]},d,e,g;a.timeUnits=this._getRestUnits(this.timeUnits);for(d=0;d<this.infos.length;d+=1)e=this.infos[d],g={},g.oldestAge=Infinity===e.maxAge?null:e.maxAge,g.size=e.size,e.color&&(g.color=b.toJsonColor(e.color)),e.alpha&&(g.alpha=Math.round(255*e.alpha)),a.agerClassBreakInfos[d]=g;return a},_getRestUnits:function(a){var b="esriTimeUnitsDays";
switch(a){case d.UNIT_SECONDS:b="esriTimeUnitsSeconds";break;case d.UNIT_MILLISECONDS:b="esriTimeUnitsMilliseconds";break;case d.UNIT_HOURS:b="esriTimeUnitsHours";break;case d.UNIT_MINUTES:b="esriTimeUnitsMinutes";break;case d.UNIT_MONTHS:b="esriTimeUnitsMonths";break;case d.UNIT_WEEKS:b="esriTimeUnitsWeeks";break;case d.UNIT_YEARS:b="esriTimeUnitsYears"}return b}});a.mixin(d,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",UNIT_SECONDS:"second",
UNIT_WEEKS:"week",UNIT_YEARS:"year"});return d})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(q,e,a,f){return q(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(a,e){},_setSymbolSize:function(a,e){switch(a.type){case "simplemarkersymbol":a.setSize(e);break;case "picturemarkersymbol":a.setWidth(e);a.setHeight(e);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(e);break;case "simplefillsymbol":case "picturefillsymbol":a.outline&&
a.outline.setWidth(e)}}})})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(q,e,a,f,k,n,r,t){return q(t,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(a,e,d){this.colorRange=a;this.sizeRange=e;this.alphaRange=d},getAgedSymbol:function(b,e){var d=e.getLayer(),h=e.attributes;b=n.fromJson(b.toJson());var f=d._map.timeExtent,m=f.startTime,f=f.endTime;
if(!m||!f)return b;m=m.getTime();f=f.getTime();d=new Date(h[d._startTimeField]);d=d.getTime();d<m&&(d=m);m=f===m?1:(d-m)/(f-m);if(d=this.sizeRange)h=d[0],f=d[1],d=Math.abs(f-h)*m,this._setSymbolSize(b,h<f?h+d:h-d);if(d=this.colorRange){var f=d[0],s=d[1],p=Math.round,h=new a,c=f.r,l=s.r,d=Math.abs(l-c)*m;h.r=p(c<l?c+d:c-d);c=f.g;l=s.g;d=Math.abs(l-c)*m;h.g=p(c<l?c+d:c-d);c=f.b;l=s.b;d=Math.abs(l-c)*m;h.b=p(c<l?c+d:c-d);f=f.a;s=s.a;d=Math.abs(s-f)*m;h.a=f<s?f+d:f-d;b.setColor(h)}h=b.color;if((d=this.alphaRange)&&
h)f=d[0],s=d[1],d=Math.abs(s-f)*m,h.a=f<s?f+d:f-d;return b},toJson:function(){var a={};this.sizeRange&&(a.sizeRange=this.sizeRange);this.colorRange&&(a.colorRange=[r.toJsonColor(this.colorRange[0]),r.toJsonColor(this.colorRange[1])]);this.alphaRange&&(a.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]);return a}})})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(q,e,a,f,k){return q(k,
{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(a,e,f,b){this.observationRenderer=a;this.latestObservationRenderer=e;this.trackRenderer=f;this.observationAger=b},getSymbol:function(a){var e=a.getLayer(),f=this.getObservationRenderer(a),b=f&&f.getSymbol(a),g=this.observationAger;e.timeInfo&&(e._map.timeExtent&&f===this.observationRenderer&&g&&b)&&(b=g.getAgedSymbol(b,a));return b},getObservationRenderer:function(a){return 0===a.getLayer()._getKind(a)?this.observationRenderer:this.latestObservationRenderer||
this.observationRenderer},toJson:function(){var a={type:"temporal"};a.observationRenderer=this.observationRenderer.toJson();this.latestObservationRenderer&&(a.latestObservationRenderer=this.latestObservationRenderer.toJson());this.trackRenderer&&(a.trackRenderer=this.trackRenderer.toJson());this.observationAger&&(a.observationAger=this.observationAger.toJson());return a}})})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),
function(q,e,a,f,k,n,r,t,b,g){return q([g],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,field:null,fieldOffset:null,colorStops:null,constructor:function(a){(this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1)?("string"==typeof a&&(a=JSON.parse(a)),e.mixin(this,a),this._canvas=null,!this.colors&&!this.colorStops&&(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:0.75,color:"rgba(255, 140, 0, 1)"},{ratio:0.9,
color:"rgba(255, 0,   0, 1)"}]),this.gradient=this._generateGradient(this.colorStops||this.colors)):console.log("The HeatmapRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){if(!this._supportsCanvas)return!1;var b=a.attributes.imageData;a=a.attributes.size;if(!a)return null;var e=this._getContext(a[0],a[1]),g=e.getImageData(0,0,a[0],a[1]);window.ArrayBuffer&&b instanceof ArrayBuffer?b=window.Uint8ClampedArray?new Uint8ClampedArray(b):new Uint8Array(b):
b.BYTES_PER_ELEMENT&&1!==b.BYTES_PER_ELEMENT&&(b=window.Uint8ClampedArray?new Uint8ClampedArray(b.buffer):new Uint8Array(b.buffer));if(window.CanvasPixelArray&&g.data instanceof window.CanvasPixelArray)for(var f=g.data,p=f.length;p--;)f[p]=b[p];else g.data.set(b);e.putImageData(g,0,0);return new t(e.canvas.toDataURL(),a[0],a[1])},setColors:function(a){if(a&&(a instanceof Array||a.colors))this.gradient=this._generateGradient(a.colors||a),this.colors=a;return this},setColorStops:function(a){if(a&&(a instanceof
Array||a.colorStops))this.gradient=this._generateGradient(a.colorStops||a),this.colorStops=a;return this},setMaxPixelIntensity:function(a){this.maxPixelIntensity=a;return this},setMinPixelIntensity:function(a){this.minPixelIntensity=a;return this},setField:function(a){this.field=a;return this},setFieldOffset:function(a){this.fieldOffset=a;return this},setBlurRadius:function(a){this.blurRadius=a;return this},getStats:function(){},getHistogramData:function(){},toJson:function(){var d=e.mixin(this.inherited(arguments),
{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});null!=this.fieldOffset&&(d.fieldOffset=this.fieldOffset);a.forEach(d.colorStops,function(a){a.color=b.toJsonColor(a.color)});return r.fixJson(d)},_getContext:function(a,b){this._canvas?(this._canvas.width=a,this._canvas.height=b):this._canvas=this._initCanvas(a,b);return this._canvas.getContext("2d")},
_initCanvas:function(a,b){var e=f.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: -10000px; top: 0px;"},null);e.width=a;e.height=b;document.body.appendChild(e);return e},_generateGradient:function(a,b){b||(b=512);for(var e=this._colorsToStops(a),g=this._getContext(1,b||512),f=g.createLinearGradient(0,0,0,b),p=0,c;p<e.length;p++)c=e[p],f.addColorStop(c.ratio,c.color.toCss(!0));g.fillStyle=f;g.fillRect(0,0,1,b);return g.getImageData(0,0,1,b).data},_colorsToStops:function(b){var e=
[];if(!b[0])return e;if(null!=b[0].ratio)e=a.map(b,function(a){return{ratio:a.ratio,color:this._toColor(a.color)}},this);else if(null!=b[0].value){var g=Infinity,e=-Infinity,f=0,s;for(s=0;s<b.length;s++){var p=b[s].value;p<g&&(g=p);p>e&&(e=p)}f=e-g;this.maxPixelIntensity=e;this.minPixelIntensity=g;e=a.map(b,function(a){var c=a.value;a=this._toColor(a.color);return{value:c,ratio:(c-g)/f,color:a}},this)}else var c=b.length-1,e=a.map(b,function(a,b){return{color:this._toColor(a),ratio:b/c}},this);return e},
_toColor:function(a){!a.toRgba&&!a.declaredClass&&(a=new b(a));return a}})})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(q,e,a,f,k,n,r,t){return q([n,r],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,g){e.mixin(this,g);this.initialize(a,g)},getTitle:function(a){var e;this.info&&(e=this.titleHasRelatedFields?
"":this._getPopupValues(a,!0).title);return e||""},getContent:function(a){return this.info?(new t({template:this,graphic:a,chartTheme:this.chartTheme},f.create("div"))).domNode:""}})})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),function(q,e,a,f,k,n,
r,t,b,g,d,h,u,m,s,p){return q(null,{declaredClass:"esri.PopupInfo",initialize:function(c,b){if(c){e.mixin(this,b);this.info=c;this.title=this.getTitle;this.content=this.getContent;var d=this._fieldLabels={},g=this._fieldsMap={};c.fieldInfos&&a.forEach(c.fieldInfos,function(a){d[a.fieldName]=a.label;g[a.fieldName]=a});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!!(c.title&&-1!==c.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return f.fromJson(f.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(c){var b;a.some(this.info&&this.info.fieldInfos,function(a){a.fieldName===c&&(b=a);return!!b});return b},getComponents:function(c){var b=this.info,d=new r,g,h;b.fieldInfos&&(h=a.filter(b.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this));h&&0<h.length&&(g=this._getRelatedRecords({graphic:c,fieldsInfo:h}));g?g.always(e.hitch(this,function(){d.resolve(this._getPopupValues(c))})):d.resolve(this._getPopupValues(c));
return d.promise},getAttachments:function(a){var b=a.getLayer();a=a.attributes;if(this.info.showAttachments&&(b&&b.hasAttachments&&b.objectIdField)&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},_getPopupValues:function(c,b){var d=this.info,h=c.getLayer(),f=e.clone(c.attributes)||{},p=e.clone(f),m=d.fieldInfos,u="",s="",k,n,r,t,q,I=h&&h._getDateOpts&&h._getDateOpts().properties,L={dateFormat:{properties:I,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};
if(this._relatedInfo)for(t in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(t)){var J=this._relatedInfo[t],F=this._relatedLayersInfo[t];J&&(a.forEach(J.relatedFeatures,function(a){for(q in a.attributes)if(a.attributes.hasOwnProperty(q)&&"esriRelCardinalityOneToOne"===F.relation.cardinality){var c=this._toRelatedFieldName([F.relation.id,q]);f[c]=p[c]=a.attributes[q]}},this),a.forEach(J.relatedStatsFeatures,function(a){for(q in a.attributes)if(a.attributes.hasOwnProperty(q)){var c=this._toRelatedFieldName([F.relation.id,
q]);f[c]=p[c]=a.attributes[q]}},this))}m&&a.forEach(m,function(c){n=c.fieldName;p[n]=this._formatValue(p[n],n,L);I&&(c.format&&c.format.dateFormat)&&(c=a.indexOf(I,n),-1<c&&I.splice(c,1))},this);if(h){t=h.types;var N=(J=h.typeIdField)&&f[J];for(n in f)if(f.hasOwnProperty(n)&&-1===n.indexOf(this._relatedFieldPrefix)&&(r=f[n],g.isDefined(r))){var M=this._getDomainName(h,c,t,N,n,r);g.isDefined(M)?p[n]=M:n===J&&(M=this._getTypeName(h,c,r),g.isDefined(M)&&(p[n]=M))}}d.title&&(u=this._processFieldsInLinks(this._fixTokens(d.title),
f),u=e.trim(g.substitute(p,u,L)||""));if(b)return{title:u};d.description&&(s=this._processFieldsInLinks(this._fixTokens(d.description),f),s=e.trim(g.substitute(p,s,L)||""));m&&(k=[],a.forEach(m,function(a){(n=a.fieldName)&&a.visible&&k.push([a.label||n,g.substitute(p,"${"+n+"}",L)||""])}));var K,P;d.mediaInfos&&(K=[],a.forEach(d.mediaInfos,function(c){P=0;r=c.value;switch(c.type){case "image":var b=r.sourceURL,b=b&&e.trim(g.substitute(f,this._fixTokens(b)));P=!!b;break;case "piechart":case "linechart":case "columnchart":case "barchart":P=
a.some(r.fields,function(a){return g.isDefined(f[a])||-1!==a.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(P){c=e.clone(c);r=c.value;var b=c.title?this._processFieldsInLinks(this._fixTokens(c.title),f):"",d=c.caption?this._processFieldsInLinks(this._fixTokens(c.caption),f):"";c.title=b?e.trim(g.substitute(p,b,L)||""):"";c.caption=d?e.trim(g.substitute(p,d,L)||""):"";if("image"===c.type)r.sourceURL=g.substitute(f,this._fixTokens(r.sourceURL)),r.linkURL&&(r.linkURL=
e.trim(g.substitute(f,this._fixTokens(r.linkURL))||""));else{var l,h;a.forEach(r.fields,function(a,c){if(-1!==a.indexOf(this._relatedFieldPrefix))h=this._getRelatedChartInfos(a,r,f,L),h instanceof Array?r.fields=h:r.fields[c]=h;else{var b=f[a],b=void 0===b?null:b;l=f[r.normalizeField]||0;b&&l&&(b/=l);r.fields[c]={y:b,tooltip:(this._fieldLabels[a]||a)+":\x3cbr/\x3e"+this._formatValue(b,a,L,!!l)}}},this)}K.push(c)}},this));return{title:u,description:s,fields:k&&k.length?k:null,mediaInfos:K&&K.length?
K:null,formatted:p,editSummary:h&&h.getEditSummary?h.getEditSummary(c):""}},_getRelatedChartInfos:function(c,b,d,e){var g,h,f,p,m,u;g=[];u=this._fromRelatedFieldName(c);m=u[0];h=this._relatedInfo[m];m=this._relatedLayersInfo[m];h&&a.forEach(h.relatedFeatures,function(a){a=a.attributes;var h,m;for(m in a)if(a.hasOwnProperty(m)&&m===u[1]){h={};p=a[m];b.normalizeField&&(f=-1!==b.normalizeField.indexOf(this._relatedFieldPrefix)?a[this._fromRelatedFieldName(b.normalizeField)[1]]:d[b.normalizeField]);p&&
f&&(p/=f);if(b.tooltipField)if(-1!==b.tooltipField.indexOf(this._relatedFieldPrefix)){var s=this._fromRelatedFieldName(b.tooltipField)[1];h.tooltip=a[s]+":\x3cbr/\x3e"+this._formatValue(p,a[s],e,!!f)}else h.tooltip=(this._fieldLabels[c]||c)+":\x3cbr/\x3e"+this._formatValue(p,b.tooltipField,e,!!f);else h.tooltip=p;h.y=p;g.push(h)}},this);return"esriRelCardinalityOneToMany"===m.relation.cardinality||"esriRelCardinalityManyToMany"===m.relation.cardinality?g:g[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",
shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",
shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",
shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_fixTokens:function(a){return a.replace(/(\{[^\{\r\n]+\})/g,"$$$1")},_encodeAttributes:function(a){a=e.clone(a)||{};var b,d;for(b in a)if((d=a[b])&&"string"===typeof d)d=encodeURIComponent(d).replace(/\'/g,"\x26apos;"),a[b]=d;return a},_processFieldsInLinks:function(a,b){var d=this._encodeAttributes(b),e=this;a&&(a=a.replace(this._reHref,
function(a,c){return e._addValuesToHref(a,c,b,d)}).replace(this._reHrefApos,function(a,c){return e._addValuesToHref(a,c,b,d)}));return a},_addValuesToHref:function(a,b,d,h){b=b&&e.trim(b);return g.substitute(b&&0===b.indexOf("${")?d:h,a)},_formatValue:function(c,b,d,e){var h=this._fieldsMap[b],f=h&&h.format;b="number"===typeof c&&-1===a.indexOf(d.dateFormat.properties,b)&&(!f||!f.dateFormat);if(!g.isDefined(c)||!h||!g.isDefined(f))return b?this._forceLTR(c):c;var m="",u=[],h=f.hasOwnProperty("places")||
f.hasOwnProperty("digitSeparator"),s=f.hasOwnProperty("digitSeparator")?f.digitSeparator:!0;if(h)m="NumberFormat",u.push("places: "+(g.isDefined(f.places)&&(!e||0<f.places)?Number(f.places):"Infinity")),u.length&&(m+="("+u.join(",")+")");else if(f.dateFormat)m="DateFormat"+this._insertOffset(this._dateFormats[f.dateFormat]||this._dateFormats.shortDateShortTime);else return b?this._forceLTR(c):c;c=g.substitute({myKey:c},"${myKey:"+m+"}",d)||"";h&&!s&&p.group&&(c=c.replace(RegExp("\\"+p.group,"g"),
""));return b?this._forceLTR(c):c},_forceLTR:function(a){var b=t("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&(a=g.isDefined(this.utcOffset)?a.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,b,d,e,g,h){return(a=a.getDomain&&a.getDomain(g,{feature:b}))&&a.codedValues?a.getName(h):null},_getTypeName:function(a,b,d){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=
a.graphic,d=new r,g;this._relatedLayersInfo?this._queryRelatedLayers(b).then(e.hitch(this,function(a){this._setRelatedRecords(b,a);d.resolve(a)}),e.hitch(this,this._handlerErrorResponse,d)):this._getRelatedLayersInfo(a).then(e.hitch(this,function(a){for(g in a)a.hasOwnProperty(g)&&a[g]&&(this._relatedLayersInfo[g].relatedLayerInfo=a[g]);this._queryRelatedLayers(b).then(e.hitch(this,function(a){this._setRelatedRecords(b,a);d.resolve(a)}),e.hitch(this,this._handlerErrorResponse,d))}),e.hitch(this,this._handlerErrorResponse,
d));return d.promise},_getRelatedLayersInfo:function(c){var d=c.fieldsInfo,e,g,f={};e=c.graphic.getLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});a.forEach(d,function(c){var b,d,l,g;b=this._fromRelatedFieldName(c.fieldName);d=b[0];b=b[1];d&&(this._relatedLayersInfo[d]||(a.some(e.relationships,function(a){if(a.id==d)return g=a,!0}),g&&(this._relatedLayersInfo[d]={relation:g,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[d]&&(this._relatedLayersInfo[d].relatedFields.push(b),
c.statisticType&&(l=new s,l.statisticType=c.statisticType,l.onStatisticField=b,l.outStatisticFieldName=b,this._relatedLayersInfo[d].outStatistics.push(l))))},this);for(g in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(g)&&this._relatedLayersInfo[g]&&(c=this._relatedLayersInfo[g].relation,c=e.url.replace(/[0-9]+$/,c.relatedTableId),this._relatedLayersInfo[g].relatedLayerUrl=c,f[g]=h({url:c,content:{f:"json"},callbackParamName:"callback"}));return b(f)},_queryRelatedLayers:function(a){var d=
{},e;for(e in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(e)&&(d[e]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[e]}));return b(d)},_queryRelatedLayer:function(c){var d,e,g,h,f,p,s,k,n,r;d=c.graphic;e=d.getLayer().url.match(/[0-9]+$/g)[0];k=c.relatedInfo;s=k.relatedLayerInfo;n=k.relatedLayerUrl;r=k.relation;a.some(s.relationships,function(a){if(a.relatedTableId===parseInt(e,10))return g=a,!0},this);g&&(c=new u,a.some(s.fields,function(c){if(c.name===g.keyField)return f=
-1!==a.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],c.type)?"number":"string",!0}),h="string"===f?g.keyField+"\x3d'"+d.attributes[r.keyField]+"'":g.keyField+"\x3d"+d.attributes[r.keyField],c.where=h,c.outFields=k.relatedFields,k.outStatistics&&(0<k.outStatistics.length&&s.supportsStatistics)&&(p=new u,p.where=c.where,p.outFields=c.outFields,p.outStatistics=k.outStatistics),d=new m(n),h=[],h.push(d.execute(c)),p&&h.push(d.execute(p)));return b(h)},
_setRelatedRecords:function(a,b){this._relatedInfo=[];for(var d in b)if(b.hasOwnProperty(d)&&b[d]){var e=b[d];this._relatedInfo[d]={};this._relatedInfo[d].relatedFeatures=e[0].features;g.isDefined(e[1])&&(this._relatedInfo[d].relatedStatsFeatures=e[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b="";a&&0<a.length&&(b=this._relatedFieldPrefix+
a[0]+"/"+a[1]);return b}})})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u){q=q(h,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},
constructor:function(a,b){this._handler=e.hitch(this,this._handler);this._relationshipQueryHandler=e.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=e.hitch(this,this._executeForIdsHandler);this._countHandler=e.hitch(this,this._countHandler);this._extentHandler=e.hitch(this,this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],
e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(a,b,d,c,l){var g=l.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json"},a.toJson(g&&g[0])));var h=this._handler,f=this._errorHandler;this.source&&(g={source:this.source.toJson()},
a.layer=k.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return t({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,c){h(a,c,b,d,l.dfd)},error:function(a){f(a,d,l.dfd)},callbackSuffix:c},this.requestOptions)},executeRelationshipQuery:function(a,d,g){a=this._encode(e.mixin({},this._url.query,{f:"json"},a.toJson()));var c=this._relationshipQueryHandler,l=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var h=new f(b._dfdCanceller);h._pendingDfd=
t({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,b){c(a,b,d,g,h)},error:function(a){l(a,g,h)}},this.requestOptions);return h},executeForIds:function(a,b,d,c){var l=c.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},a.toJson(l&&l[0])));var g=this._executeForIdsHandler,h=this._errorHandler;this.source&&(l={source:this.source.toJson()},a.layer=k.toJson(l));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return t({url:this._url.path+
"/query",content:a,callbackParamName:"callback",load:function(a,l){g(a,l,b,d,c.dfd)},error:function(a){h(a,d,c.dfd)}},this.requestOptions)},executeForCount:function(a,b,d,c){var l=c.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(l&&l[0])));var g=this._countHandler,h=this._errorHandler;this.source&&(l={source:this.source.toJson()},a.layer=k.toJson(l));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return t({url:this._url.path+"/query",content:a,
callbackParamName:"callback",load:function(a,l){g(a,l,b,d,c.dfd)},error:function(a){h(a,d,c.dfd)}},this.requestOptions)},executeForExtent:function(a,b,d,c){var l=c.assembly;a=this._encode(e.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(l&&l[0])));var g=this._extentHandler,h=this._errorHandler;this.source&&(l={source:this.source.toJson()},a.layer=k.toJson(l));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return t({url:this._url.path+"/query",content:a,callbackParamName:"callback",
load:function(a,l){g(a,l,b,d,c.dfd)},error:function(a){h(a,d,c.dfd)}},this.requestOptions)},_handler:function(a,b,d,c,l){try{var e=new u(a);this._successHandler([e],"onComplete",d,l)}catch(g){this._errorHandler(g,c,l)}},_relationshipQueryHandler:function(b,d,e,c,l){try{var g=b.geometryType,h=b.spatialReference,f={};a.forEach(b.relatedRecordGroups,function(a){var c={};c.geometryType=g;c.spatialReference=h;c.features=a.relatedRecords;c=new u(c);if(null!=a.objectId)f[a.objectId]=c;else for(var b in a)a.hasOwnProperty(b)&&
"relatedRecords"!==b&&(f[a[b]]=c)});this._successHandler([f],"onExecuteRelationshipQueryComplete",e,l)}catch(k){this._errorHandler(k,c,l)}},_executeForIdsHandler:function(a,b,d,c,l){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",d,l)}catch(e){this._errorHandler(e,c,l)}},_countHandler:function(a,b,d,c,l){try{var e,g=a.features,h=a.objectIds;if(h)e=h.length;else{if(g)throw Error("Unable to perform query. Please check your parameters.");e=a.count}this._successHandler([e],"onExecuteForCountComplete",
d,l)}catch(f){this._errorHandler(f,c,l)}},_extentHandler:function(a,b,d,c,l){try{a.extent&&(a.extent=new g(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",d,l)}catch(e){this._errorHandler(e,c,l)}}});d._createWrappers(q);return q})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(q,e,a,f,k,n,r,t,b,g,d){function h(a,
c){return Math.ceil((a-c)/(2*c))}function u(a,c){var b=a.paths||a.rings,d,l,e=b.length,g;for(d=0;d<e;d++){g=b[d].length;for(l=0;l<g;l++){var h=a.getPoint(d,l);a.setPoint(d,l,h.offset(c,0))}}return a}function m(a,c){if(!(a instanceof t||a instanceof b))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var d=a instanceof t,l=[],e;q.forEach(d?a.paths:a.rings,function(a){l.push(e=
[]);e.push([a[0][0],a[0][1]]);var b,d,g,h,f,p,m,u,s,k,v,n;for(f=0;f<a.length-1;f++){b=a[f][0];d=a[f][1];g=a[f+1][0];h=a[f+1][1];m=Math.sqrt((g-b)*(g-b)+(h-d)*(h-d));u=(h-d)/m;s=(g-b)/m;k=m/c;if(1<k){for(p=1;p<=k-1;p++)n=p*c,v=s*n+b,n=u*n+d,e.push([v,n]);p=(m+Math.floor(k-1)*c)/2;v=s*p+b;n=u*p+d;e.push([v,n])}e.push([g,h])}});return d?new t({paths:l,spatialReference:a.spatialReference}):new b({rings:l,spatialReference:a.spatialReference})}function s(a,c,b){c&&(a=m(a,1E6),a=g.webMercatorToGeographic(a,
!0));b&&(a=u(a,b));return a}function p(a,c,b){var d=a.x||a[0],l;d>c?(l=h(d,c),a.x?a=a.offset(l*-2*c,0):a[0]=d+l*-2*c):d<b&&(l=h(d,b),a.x?a=a.offset(l*-2*b,0):a[0]=d+l*-2*b);return a}function c(a,c){var b=-1;q.forEach(c.cutIndexes,function(d,l){var e=c.geometries[l];q.forEach(e.rings||e.paths,function(a,c){q.some(a,function(b){if(!(180>b[0])){b=0;var d,l=a.length,g;for(d=0;d<l;d++)g=a[d][0],b=g>b?g:b;b=Number(b.toFixed(9));b=-360*h(b,180);l=a.length;for(d=0;d<l;d++)g=e.getPoint(c,d),e.setPoint(c,d,
g.offset(b,0))}return!0})});d===b?e.rings?q.forEach(e.rings,function(c){a[d]=a[d].addRing(c)}):q.forEach(e.paths,function(c){a[d]=a[d].addPath(c)}):(b=d,a[d]=e)});return a}function l(l,e,f,m){var k=new a;k.addCallbacks(f,m);e=e||n.defaults.geometryService;var v=[],w=[],r,x,I,L,J,F,N,M,K=0;q.forEach(l,function(a){if(a)if(r||(r=a.spatialReference,x=r._getInfo(),L=(I=r._isWebMercator())?2.0037508342788905E7:180,J=I?-2.0037508342788905E7:-180,F=I?102100:4326,N=new t({paths:[[[L,J],[L,L]]],spatialReference:{wkid:F}}),
M=new t({paths:[[[J,J],[J,L]]],spatialReference:{wkid:F}})),x){var c=d.fromJson(a.toJson()),l=a.getExtent();"point"===a.type?v.push(p(c,L,J)):"multipoint"===a.type?(c.points=q.map(c.points,function(a){return p(a,L,J)}),v.push(c)):"extent"===a.type?(c=l._normalize(null,null,x),v.push(c.rings?new b(c):c)):l?(a=h(l.xmin,J)*2*L,c=0===a?c:u(c,a),l=l.offset(a,0),l.intersects(N)&&l.xmax!==L?(K=l.xmax>K?l.xmax:K,c=s(c,I),w.push(c),v.push("cut")):l.intersects(M)&&l.xmin!==J?(K=l.xmax*2*L>K?l.xmax*2*L:K,c=
s(c,I,360),w.push(c),v.push("cut")):v.push(c)):v.push(c)}else v.push(a);else v.push(a)});f=new t;m=h(K,L);for(var P=-90,Q=m;0<m;){var R=-180+360*m;f.addPath([[R,P],[R,-1*P]]);P*=-1;m--}0<w.length&&0<Q?e?e.cut(w,f,function(a){w=c(w,a);var b=[];q.forEach(v,function(a,c){if("cut"===a){var d=w.shift();l[c].rings&&1<l[c].rings.length&&d.rings.length>=l[c].rings.length?(v[c]="simplify",b.push(d)):v[c]=!0===I?g.geographicToWebMercator(d):d}});0<b.length?e.simplify(b,function(a){q.forEach(v,function(c,b){"simplify"===
c&&(v[b]=!0===I?g.geographicToWebMercator(a.shift()):a.shift())});k.callback(v)},function(a){k.errback(a)}):k.callback(v)},function(a){k.errback(a)}):k.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(q.forEach(v,function(a,c){if("cut"===a){var b=w.shift();v[c]=!0===I?g.geographicToWebMercator(b):b}}),k.callback(v));return k}function w(a,c,b,d){var l=!1,g;e.isObject(a)&&a&&(e.isArray(a)?a.length&&((g=a[0]&&a[0].declaredClass)&&-1!==g.indexOf("Graphic")?
(a=q.map(a,function(a){return a.geometry}),l=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(l=!0)):(g=a.declaredClass)&&-1!==g.indexOf("FeatureSet")?(a=q.map(a.features||[],function(a){return a.geometry}),l=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(l=!0));l&&c.push({index:b,property:d,value:a})}function v(a,c){var b=[];q.forEach(c,function(c){var d=c.i,l=a[d];c=c.p;var g;if(e.isObject(l)&&l)if(c)if("*"===c[0])for(g in l)l.hasOwnProperty(g)&&w(l[g],b,d,g);else q.forEach(c,function(a){w(e.getObject(a,
!1,l),b,d,a)});else w(l,b,d)});return b}function x(a,c){var b=0,d={};q.forEach(c,function(c){var l=c.index,g=c.property,h=c.value,f=h.length||1,p=a.slice(b,b+f);e.isArray(h)||(p=p[0]);b+=f;delete c.value;g?(d[l]=d[l]||{},d[l][g]=p):d[l]=p});return d}return{normalizeCentralMeridian:l,_foldCutResults:c,_prepareGeometryForCut:s,_offsetMagnitude:h,_pointNormalization:p,_updatePolyGeometry:u,_straightLineDensify:m,_createWrappers:function(c){var b=e.isObject(c)?c.prototype:e.getObject(c+".prototype");
q.forEach(b.__msigns,function(c){var d=b[c.n];b[c.n]=function(){var b=this,e=[],g,h=new a(r._dfdCanceller);c.f&&r._fixDfd(h);for(g=0;g<c.c;g++)e[g]=arguments[g];var f={dfd:h};e.push(f);var p,m=[],u;b.normalization&&!b._isTable&&(p=v(e,c.a),q.forEach(p,function(a){m=m.concat(a.value)}),m.length&&(u=l(m)));u?(h._pendingDfd=u,u.addCallbacks(function(a){h.canceled||(f.assembly=x(a,p),h._pendingDfd=d.apply(b,e))},function(a){var d=b.declaredClass;d&&-1!==d.indexOf("FeatureLayer")?b._resolve([a],null,e[c.e],
h,!0):b._errorHandler(a,e[c.e],h)})):h._pendingDfd=d.apply(b,e);return h}})},_disassemble:v,_addToBucket:w,_reassemble:x}})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(q,e,a,f,k,n,r,t){return q(t,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(a,g){a&&e.isString(a)&&(this._url=r.urlToObject(this.url=a));g&&g.requestOptions&&
(this.requestOptions=g.requestOptions);this.normalization=!0;this._errorHandler=e.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var a=this._url,e=/^http:/i;this.url&&(this.url=this.url.replace(e,"https:"));a&&a.path&&(a.path=a.path.replace(e,"https:"))},_encode:function(b,g,d){var h,f,m={},k,p;for(k in b)if("declaredClass"!==k&&(h=b[k],f=typeof h,null!==h&&void 0!==h&&"function"!==f))if(e.isArray(h)){m[k]=[];p=h.length;for(f=0;f<p;f++)m[k][f]=this._encode(h[f])}else"object"===
f?h.toJson&&(f=h.toJson(d&&d[k]),"esri.tasks.FeatureSet"===h.declaredClass&&f.spatialReference&&(f.sr=f.spatialReference,delete f.spatialReference),m[k]=g?f:a.toJson(f)):m[k]=h;return m},_successHandler:function(a,e,d,h){e&&this[e].apply(this,a);d&&d.apply(null,a);h&&n._resDfd(h,a)},_errorHandler:function(a,e,d){this.onError(a);e&&e(a);d&&d.errback(a)},setNormalization:function(a){this.normalization=a},onError:function(){}})})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d){return q(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(b){if(b){e.mixin(this,b);var f=this.features,m=b.spatialReference,k=g.getGeometryType(b.geometryType),m=this.spatialReference=new t(m);this.geometryType=b.geometryType;b.fields&&(this.fields=b.fields);a.forEach(f,function(a,c){var b=a.geometry&&a.geometry.spatialReference;f[c]=new r(k&&a.geometry?new k(a.geometry):null,a.symbol&&d.fromJson(a.symbol),a.attributes);f[c].geometry&&!b&&f[c].geometry.setSpatialReference(m)});
this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var d={};this.displayFieldName&&(d.displayFieldName=this.displayFieldName);this.fields&&(d.fields=this.fields);this.spatialReference?d.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(d.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(d.geometryType=
g.getJsonType(this.features[0].geometry)),d.features=b._encodeGraphics(this.features,a));d.exceededTransferLimit=this.exceededTransferLimit;d.transform=this.transform;return n.fixJson(d)},_hydrate:function(){var a=this.transform;if(a){var b=this.features,d,e=a.translate[0],g=a.translate[1],c=a.scale[0],l=a.scale[1],f=function(a,c,b){if("esriGeometryPoint"===a)return function(a){a.x=c(a.x);a.y=b(a.y)};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=a.rings||a.paths;var d,
l,e,g,h,f,p,m;d=0;for(l=a.length;d<l;d++){h=a[d];e=0;for(g=h.length;e<g;e++)f=h[e],0<e?(p+=f[0],m+=f[1]):(p=f[0],m=f[1]),f[0]=c(p),f[1]=b(m)}};if("esriGeometryEnvelope"===a)return function(a){a.xmin=c(a.xmin);a.ymin=b(a.ymin);a.xmax=c(a.xmax);a.ymax=b(a.ymax)};if("esriGeometryMultipoint"===a)return function(a){a=a.points;var d,l,e,g,h;d=0;for(l=a.length;d<l;d++)e=a[d],0<d?(g+=e[0],h+=e[1]):(g=e[0],h=e[1]),e[0]=c(g),e[1]=b(h)}}(this.geometryType,function(a){return a*c+e},function(a){return g-a*l}),
a=0;for(d=b.length;a<d;a++)b[a].geometry&&f(b[a].geometry);this.transform=null}},quantize:function(a){var b=a.translate[0],d=a.translate[1],e=a.scale[0],g=a.scale[1],c=this.features,l=function(a,c,b){var d,l,e,g,h,f,p=[];d=0;for(l=a.length;d<l;d++)if(e=a[d],0<d){if(f=c(e[0]),e=b(e[1]),f!==g||e!==h)p.push([f-g,e-h]),g=f,h=e}else g=c(e[0]),h=b(e[1]),p.push([g,h]);return 0<p.length?p:null},f=function(a,c,b){if("esriGeometryPoint"===a)return function(a){a.x=c(a.x);a.y=b(a.y);return a};if("esriGeometryPolyline"===
a||"esriGeometryPolygon"===a)return function(a){var d,e,g,h,f;g=a.rings||a.paths;f=[];d=0;for(e=g.length;d<e;d++)h=g[d],(h=l(h,c,b))&&f.push(h);return 0<f.length?(a.rings?a.rings=f:a.paths=f,a):null};if("esriGeometryMultipoint"===a)return function(a){var d;d=l(a.points,c,b);return 0<d.length?(a.points=d,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,function(a){return Math.round((a-b)/e)},function(a){return Math.round((d-a)/g)}),k,n;k=0;for(n=c.length;k<n;k++)f(c[k].geometry)||
(c.splice(k,1),k--,n--);this.transform=a;return this}})})},"esri/graphicsUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(q,e,a,f,k){return{graphicsExtent:function(a){var e=a[0].geometry,f=e.getExtent(),b,g,d=a.length;null===f&&(f=new k(e.x,e.y,e.x,e.y,e.spatialReference));for(g=1;g<d;g++)b=(e=a[g].geometry).getExtent(),null===b&&(b=new k(e.x,e.y,e.x,e.y,e.spatialReference)),f=f.union(b);return 0>f.getWidth()&&0>f.getHeight()?null:
f},getGeometries:function(a){return e.map(a,function(a){return a.geometry})},_encodeGraphics:function(a,f){var k=[],b,g,d;e.forEach(a,function(a,e){b=a.toJson();g={};b.geometry&&(d=f&&f[e],g.geometry=d&&d.toJson()||b.geometry);b.attributes&&(g.attributes=b.attributes);k[e]=g});return k}}})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(q,e,a,f){return q(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,
onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}})})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v){var x=0;return e([w,s,p],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=f.mixin({},v.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(f.hitch(this,this._handleComponentsSuccess),f.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,c=a.length,b=this.domNode,l=this._prevMedia,e=this._nextMedia;if(1<c){var h=0,f=0;k.forEach(a,function(a){"image"===a.type?h++:-1!==a.type.indexOf("chart")&&f++});h&&(g.set(this._imageCount,"innerHTML",h),n.query(".summary .image",b).removeClass("hidden"));f&&(g.set(this._chartCount,"innerHTML",f),n.query(".summary .chart",b).removeClass("hidden"))}else n.query(".summary",
b).addClass("hidden"),d.add(l,"hidden"),d.add(e,"hidden");a=this._mediaPtr;0===a?d.add(l,"hidden"):d.remove(l,"hidden");a===c-1?d.add(e,"hidden"):d.remove(e,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],c=a.title,b=a.caption,l=n.query(".mediaSection .hzLine",this.domNode)[0];g.set(this._mediaTitle,"innerHTML",c);d[c?"remove":"add"](this._mediaTitle,"hidden");g.set(this._mediaCaption,"innerHTML",b);d[b?"remove":"add"](this._mediaCaption,"hidden");d[c&&
b?"remove":"add"](l,"hidden");this._rid=null;if("image"===a.type)this._showImage(a.value);else{var e=this,c=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],b=a.value.theme||this.chartTheme;f.isString(b)&&(b=b.replace(/\./gi,"/"),-1===b.indexOf("/")&&(b="dojox/charting/themes/"+b));b||(b="./Rainbow");c.push(b);try{var h=this._rid=x++;q(c,function(c,b,d){h===e._rid&&(e._rid=null,e._showChart(a.type,a.value,c,b,d))})}catch(p){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=
a&&f.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(c){d.add(this._mediaFrame,"image");var b=u.get(this._gallery,"height"),l;c.linkURL&&(l=h.create("a",{href:c.linkURL,target:this._preventNewTab(c.linkURL)?"":"_blank"},this._mediaFrame));h.create("img",{className:"esriPopupMediaImage",src:c.sourceURL},l||this._mediaFrame);var e=n.query(".esriPopupMediaImage",this._mediaFrame)[0],g=this,f;f=a.connect(e,"onload",function(){a.disconnect(f);f=null;g._imageLoaded(e,
b)})},_showChart:function(a,c,b,l,e){d.remove(this._mediaFrame,"image");b=this._chart=new b(h.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});e&&b.setTheme(e);switch(a){case "piechart":b.addPlot("default",{type:"Pie",labels:!1});b.addSeries("Series A",c.fields);break;case "linechart":b.addPlot("default",{type:"Markers"});b.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});b.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});k.forEach(c.fields,
function(a,c){a.x=c+1});b.addSeries("Series A",c.fields);break;case "columnchart":b.addPlot("default",{type:"Columns",gap:3});b.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});b.addSeries("Series A",c.fields);break;case "barchart":b.addPlot("default",{type:"Bars",gap:3}),b.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),b.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),b.addSeries("Series A",c.fields)}this._action=new l(b);b.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);g.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,c){var b=a.height;b<c&&(b=Math.round((c-b)/2),u.set(a,"marginTop",b+"px"))},_attListHandler:function(a,c){if(a===this._dfd){this._dfd=null;var b="";!(c instanceof Error)&&(c&&c.length)&&k.forEach(c,function(a){b+="\x3cli\x3e";b+="\x3ca href\x3d'"+l.addProxy(a.url)+"' target\x3d'_blank'\x3e"+
(a.name||"[No name]")+"\x3c/a\x3e";b+="\x3c/li\x3e"});g.set(this._attachmentsList,"innerHTML",b||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(a){if(a){var c=this.showTitle?a.title:"",l=a.description,e=a.fields,h=a.mediaInfos,p=this.domNode,u=this._nls,s=this,v=this.template,w=this.graphic;this._prevMedia.title=u.NLS_prevMedia;this._nextMedia.title=u.NLS_nextMedia;g.set(this._title,"innerHTML",c);c||d.add(this._title,"hidden");!l&&e&&(l="",k.forEach(e,function(a){l+=
"\x3ctr valign\x3d'top'\x3e";l+="\x3ctd class\x3d'attrName'\x3e"+m.encode(a[0])+"\x3c/td\x3e";l+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+u.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";l+="\x3c/tr\x3e"}),l&&(l="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+l+"\x3c/table\x3e"));g.set(this._description,"innerHTML",l);l||d.add(this._description,"hidden");n.query("a",this._description).forEach(function(a){s._preventNewTab(a.href)?
"_blank"===a.target&&g.remove(a,"target"):g.set(a,"target","_blank")});c&&l?n.query(".mainSection .hzLine",p).removeClass("hidden"):c||l?n.query(".mainSection .hzLine",p).addClass("hidden"):n.query(".mainSection",p).addClass("hidden");if(c=this._dfd=v.getAttachments(w))c.addBoth(f.hitch(this,this._attListHandler,c)),g.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+u.NLS_searching+"...\x3c/li\x3e"),n.query(".attachmentsSection",p).removeClass("hidden");h&&h.length&&(n.query(".mediaSection",p).removeClass("hidden"),
b.setSelectable(this._mediaFrame,!1),this._mediaInfos=h,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(g.set(this._editSummary,"innerHTML",a.editSummary),h&&h.length&&d.remove(this._mediaBreak,"hidden"),d.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){console.log("PopupRenderer: error loading template",a)}})})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(q){var e=q.getObject("dojox.html.entities",!0),a=function(a,e){var f,
t;if(e._encCache&&e._encCache.regexp&&e._encCache.mapper&&e.length==e._encCache.length)f=e._encCache.mapper,t=e._encCache.regexp;else{f={};t=["["];var b;for(b=0;b<e.length;b++)f[e[b][0]]="\x26"+e[b][1]+";",t.push(e[b][0]);t.push("]");t=RegExp(t.join(""),"g");e._encCache={mapper:f,regexp:t,length:e.length}}return a=a.replace(t,function(a){return f[a]})},f=function(a,e){var f,t;if(e._decCache&&e._decCache.regexp&&e._decCache.mapper&&e.length==e._decCache.length)f=e._decCache.mapper,t=e._decCache.regexp;
else{f={};t=["("];var b;for(b=0;b<e.length;b++){var g="\x26"+e[b][1]+";";b&&t.push("|");f[g]=e[b][0];t.push(g)}t.push(")");t=RegExp(t.join(""),"g");e._decCache={mapper:f,regexp:t,length:e.length}}return a=a.replace(t,function(a){return f[a]})};e.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];e.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],
["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],
["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de",
"THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8",
"oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],
["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7",
"chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4",
"hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264",
"le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],
["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];e.encode=function(f,n){f&&(n?f=a(f,n):(f=a(f,e.html),f=a(f,e.latin)));return f};e.decode=function(a,n){a&&
(n?a=f(a,n):(a=f(a,e.html),a=f(a,e.latin)));return a};return e})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u){function m(){}function s(b){return function(c,d,e,g){return c&&"string"==typeof d&&c[d]==m?c.on(d.substring(2).toLowerCase(),r.hitch(e,g)):b.apply(a,
arguments)}}q.around(a,"connect",s);n.connect&&q.around(n,"connect",s);q=f("dijit._Widget",[d,h,u],{onClick:m,onDblClick:m,onKeyDown:m,onKeyPress:m,onKeyUp:m,onMouseDown:m,onMouseMove:m,onMouseOut:m,onMouseOver:m,onMouseLeave:m,onMouseEnter:m,onMouseUp:m,constructor:function(a){this._toConnect={};for(var c in a)this[c]===m&&(this._toConnect[c.replace(/^on/,"").toLowerCase()]=a[c],delete a[c])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);
delete this._toConnect},on:function(b,c){return this[this._onMap(b)]===m?a.connect(this.domNode,b.toLowerCase(),this,c):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,c){n.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,c)},attr:function(a,c){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){n.deprecated(this.declaredClass+
"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?t("[widgetId]",this.containerNode).map(g.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});k("dijit-legacy-requires")&&b(0,function(){require(["dijit/_base"])});return q})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B){function z(a){return function(c){t[c?"set":"remove"](this.domNode,a,c);this._set(a,c)}}u.add("dijit-legacy-requires",!m.isAsync);u.add("dojo-bidi",!1);u("dijit-legacy-requires")&&c(0,function(){q(["dijit/_base/manager"])});var D={};f=n("dijit._WidgetBase",[l,x],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:z("lang"),dir:"",_setDirAttr:z("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:f.blankGif||q.toUrl("dojo/resources/blank.gif"),_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var c=a.prototype,b=a._setterAttrs=[],a=a._onMap={},d;for(d in c.attributeMap)b.push(d);for(d in c)/^on/.test(d)&&(a[d.substring(2).toLowerCase()]=d),/^_set[A-Z](.*)Attr$/.test(d)&&(d=d.charAt(4).toLowerCase()+d.substr(5,
d.length-9),(!c.attributeMap||!(d in c.attributeMap))&&b.push(d))}},postscript:function(a,c){this.create(a,c)},create:function(a,c){this._introspect();this.srcNodeRef=r.byId(c);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,s.mixin(this,a));this.postMixInProperties();this.id||(this.id=B.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=this.ownerDocument||
(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=v.body(this.ownerDocument);B.add(this);this.buildRendering();var b;if(this.domNode){this._applyAttributes();var d=this.srcNodeRef;d&&(d.parentNode&&this.domNode!==d)&&(d.parentNode.replaceChild(this.domNode,d),b=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();b&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},c;for(c in this.params||{})a[c]=this._get(c);e.forEach(this.constructor._setterAttrs,
function(c){if(!(c in a)){var b=this._get(c);b&&this.set(c,b)}},this);for(c in a)this.set(c,a[c])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(e.map(a,function(a){return a+"Rtl"})));b.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,e.forEach(this.getChildren(),function(a){!a._started&&
(!a._destroyed&&s.isFunction(a.startup))&&(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function c(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();e.forEach(this._connects,s.hitch(this,"disconnect"));e.forEach(this._supportingWidgets,c);this.domNode&&e.forEach(B.findWidgets(this.domNode,this.containerNode),c);this.destroyRendering(a);
B.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?t.remove(this.domNode,"widgetId"):g.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||g.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){e.forEach(this.getChildren(),function(c){c.destroyRecursive&&c.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var c=this.domNode;s.isObject(a)?
h.set(c,a):c.style.cssText=c.style.cssText?c.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,c,d){d=3<=arguments.length?d:this.attributeMap[a];e.forEach(s.isArray(d)?d:[d],function(d){var e=this[d.node||d||"domNode"];switch(d.type||"attribute"){case "attribute":s.isFunction(c)&&(c=s.hitch(this,c));d=d.attribute?d.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;e.tagName?t.set(e,d,c):e.set(d,c);break;case "innerText":e.innerHTML="";e.appendChild(this.ownerDocument.createTextNode(c));
break;case "innerHTML":e.innerHTML=c;break;case "class":b.replace(e,c,this[a])}},this)},get:function(a){var c=this._getAttrNames(a);return this[c.g]?this[c.g]():this._get(a)},set:function(a,c){if("object"===typeof a){for(var b in a)this.set(b,a[b]);return this}b=this._getAttrNames(a);var d=this[b.s];if(s.isFunction(d))var e=d.apply(this,Array.prototype.slice.call(arguments,1));else{var d=this.focusNode&&!s.isFunction(this.focusNode)?"focusNode":"domNode",l=this[d]&&this[d].tagName,g;if(g=l)if(!(g=
D[l])){g=this[d];var h={},f;for(f in g)h[f.toLowerCase()]=!0;g=D[l]=h}f=g;b=a in this.attributeMap?this.attributeMap[a]:b.s in this?this[b.s]:f&&b.l in f&&"function"!=typeof c||/^aria-|^data-|^role$/.test(a)?d:null;null!=b&&this._attrToDom(a,c,b);this._set(a,c)}return e||this},_attrPairNames:{},_getAttrNames:function(a){var c=this._attrPairNames;if(c[a])return c[a];var b=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});return c[a]={n:a+"Node",s:"_set"+b+"Attr",
g:"_get"+b+"Attr",l:b.toLowerCase()}},_set:function(a,c){var b=this[a];this[a]=c;if(this._created&&!(b===c||b!==b&&c!==c))this._watchCallbacks&&this._watchCallbacks(a,b,c),this.emit("attrmodified-"+a,{detail:{prevValue:b,newValue:c}})},_get:function(a){return this[a]},emit:function(a,c,b){c=c||{};void 0===c.bubbles&&(c.bubbles=!0);void 0===c.cancelable&&(c.cancelable=!0);c.detail||(c.detail={});c.detail.widget=this;var d,e=this["on"+a];e&&(d=e.apply(this,b?b:[c]));this._started&&!this._beingDestroyed&&
p.emit(this.domNode,a.toLowerCase(),c);return d},on:function(c,b){var d=this._onMap(c);return d?a.after(this,d,b,!0):this.own(p(this.domNode,c,b))[0]},_onMap:function(a){var c=this.constructor,b=c._onMap;if(!b){var b=c._onMap={},d;for(d in c.prototype)/^on/.test(d)&&(b[d.replace(/^on/,"").toLowerCase()]=d)}return b["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?B.findWidgets(this.containerNode):
[]},getParent:function(){return B.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,c,b){return this.own(k.connect(a,c,this,b))[0]},disconnect:function(a){a.remove()},subscribe:function(a,c){return this.own(w.subscribe(a,s.hitch(this,c)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():d.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=h.get(this.domNode,"display")},placeAt:function(a,c){var b=
!a.tagName&&B.byId(a);b&&b.addChild&&(!c||"number"===typeof c)?b.addChild(this,c):(b=b&&"domNode"in b?b.containerNode&&!/after|before|replace/.test(c||"")?b.containerNode:b.domNode:r.byId(a,this.ownerDocument),g.place(this.domNode,b,c),!this._started&&(this.getParent()||{})._started&&this.startup());return this},defer:function(a,c){var b=setTimeout(s.hitch(this,function(){b&&(b=null,this._destroyed||s.hitch(this,a)())}),c||0);return{remove:function(){b&&(clearTimeout(b),b=null);return null}}}});u("dojo-bidi")&&
f.extend(y);return f})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(q,e,a){return a("dijit.Destroyable",null,{destroy:function(a){this._destroyed=!0},own:function(){var a=["destroyRecursive","destroy","remove"];q.forEach(arguments,function(k){function n(){t.remove();q.forEach(b,function(a){a.remove()})}var r,t=e.before(this,"destroy",function(a){k[r](a)}),b=[];k.then?(r="cancel",k.then(n,n)):q.forEach(a,function(a){"function"===typeof k[a]&&
(r||(r=a),b.push(e.after(k,a,n,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(q,e,a,f,k,n){q=f("dijit._OnDijitClickMixin",null,{connect:function(a,e,b){return this.inherited(arguments,[a,"ondijitclick"==e?n:e,b])}});q.a11yclick=n;return q})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(q,e,a,f){function k(a){if((a.keyCode===
q.ENTER||a.keyCode===q.SPACE)&&!/input|button|textarea/i.test(a.target.nodeName))for(a=a.target;a;a=a.parentNode)if(a.dojoClick)return!0}var n;a(document,"keydown",function(a){k(a)?(n=a.target,a.preventDefault()):n=null});a(document,"keyup",function(e){k(e)&&e.target==n&&(n=null,a.emit(e.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,altKey:e.altKey,_origType:e.type}))});var r=function(e,b){e.dojoClick=!0;return a(e,"click",b)};r.click=r;r.press=function(k,
b){var g=a(k,f.press,function(a){("mousedown"!=a.type||e.isLeft(a))&&b(a)}),d=a(k,"keydown",function(a){(a.keyCode===q.ENTER||a.keyCode===q.SPACE)&&b(a)});return{remove:function(){g.remove();d.remove()}}};r.release=function(k,b){var g=a(k,f.release,function(a){("mouseup"!=a.type||e.isLeft(a))&&b(a)}),d=a(k,"keyup",function(a){(a.keyCode===q.ENTER||a.keyCode===q.SPACE)&&b(a)});return{remove:function(){g.remove();d.remove()}}};r.move=f.move;return r})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),
function(q,e,a,f,k,n,r,t,b,g){function d(a,b,d){return s&&d?function(a,c){return n(a,d,c)}:c?function(c,d){var e=n(c,b,function(a){d.call(this,a);A=(new Date).getTime()}),l=n(c,a,function(a){(!A||(new Date).getTime()>A+1E3)&&d.call(this,a)});return{remove:function(){e.remove();l.remove()}}}:function(c,b){return n(c,a,b)}}function h(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function u(c,b,d){var e=h(c.target);if(w=!c.target.disabled&&e&&e.dojoClick)if(x=(v="useTarget"==w)?e:c.target,
v&&c.preventDefault(),y=c.changedTouches?c.changedTouches[0].pageX-g.global.pageXOffset:c.clientX,B=c.changedTouches?c.changedTouches[0].pageY-g.global.pageYOffset:c.clientY,z=("object"==typeof w?w.x:"number"==typeof w?w:0)||4,D=("object"==typeof w?w.y:"number"==typeof w?w:0)||4,!l){l=!0;var p=function(c){w=v?a.isDescendant(g.doc.elementFromPoint(c.changedTouches?c.changedTouches[0].pageX-g.global.pageXOffset:c.clientX,c.changedTouches?c.changedTouches[0].pageY-g.global.pageYOffset:c.clientY),x):
w&&(c.changedTouches?c.changedTouches[0].target:c.target)==x&&Math.abs((c.changedTouches?c.changedTouches[0].pageX-g.global.pageXOffset:c.clientX)-y)<=z&&Math.abs((c.changedTouches?c.changedTouches[0].pageY-g.global.pageYOffset:c.clientY)-B)<=D};g.doc.addEventListener(b,function(a){p(a);v&&a.preventDefault()},!0);g.doc.addEventListener(d,function(c){p(c);if(w){E=(new Date).getTime();var b=v?x:c.target;"LABEL"===b.tagName&&(b=a.byId(b.getAttribute("for"))||b);var d=c.changedTouches?c.changedTouches[0]:
c,e=document.createEvent("MouseEvents");e._dojo_click=!0;e.initMouseEvent("click",!0,!0,c.view,c.detail,d.screenX,d.screenY,d.clientX,d.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null);setTimeout(function(){n.emit(b,"click",e);E=(new Date).getTime()},0)}},!0);c=function(a){g.doc.addEventListener(a,function(c){!c._dojo_click&&((new Date).getTime()<=E+1E3&&!("INPUT"==c.target.tagName&&f.contains(c.target,"dijitOffScreen")))&&(c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),
"click"==a&&(("INPUT"!=c.target.tagName||"radio"==c.target.type||"checkbox"==c.target.type)&&"TEXTAREA"!=c.target.tagName&&"AUDIO"!=c.target.tagName&&"VIDEO"!=c.target.tagName)&&c.preventDefault())},!0)};c("click");c("mousedown");c("mouseup")}}var m=5>r("ios"),s=r("pointer-events")||r("MSPointer"),p=function(){var a={},c;for(c in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[c]=r("MSPointer")?"MSPointer"+c.charAt(0).toUpperCase()+c.slice(1):"pointer"+c;return a}(),c=r("touch-events"),l,w,v=!1,x,y,B,
z,D,E,A,G;s?b(function(){g.doc.addEventListener(p.down,function(a){u(a,p.move,p.up)},!0)}):c&&b(function(){function a(c){var b=k.delegate(c,{bubbles:!0});6<=r("ios")&&(b.touches=c.touches,b.altKey=c.altKey,b.changedTouches=c.changedTouches,b.ctrlKey=c.ctrlKey,b.metaKey=c.metaKey,b.shiftKey=c.shiftKey,b.targetTouches=c.targetTouches);return b}G=g.body();g.doc.addEventListener("touchstart",function(a){A=(new Date).getTime();var c=G;G=a.target;n.emit(c,"dojotouchout",{relatedTarget:G,bubbles:!0});n.emit(G,
"dojotouchover",{relatedTarget:c,bubbles:!0});u(a,"touchmove","touchend")},!0);n(g.doc,"touchmove",function(c){A=(new Date).getTime();var b=g.doc.elementFromPoint(c.pageX-(m?0:g.global.pageXOffset),c.pageY-(m?0:g.global.pageYOffset));b&&(G!==b&&(n.emit(G,"dojotouchout",{relatedTarget:b,bubbles:!0}),n.emit(b,"dojotouchover",{relatedTarget:G,bubbles:!0}),G=b),n.emit(b,"dojotouchmove",a(c))||c.preventDefault())});n(g.doc,"touchend",function(c){A=(new Date).getTime();var b=g.doc.elementFromPoint(c.pageX-
(m?0:g.global.pageXOffset),c.pageY-(m?0:g.global.pageYOffset))||g.body();n.emit(b,"dojotouchend",a(c))})});e={press:d("mousedown","touchstart",p.down),move:d("mousemove","dojotouchmove",p.move),release:d("mouseup","dojotouchend",p.up),cancel:d(t.leave,"touchcancel",s?p.cancel:null),over:d("mouseover","dojotouchover",p.over),out:d("mouseout","dojotouchout",p.out),enter:t._eventHandler(d("mouseover","dojotouchover",p.over)),leave:t._eventHandler(d("mouseout","dojotouchout",p.out))};return q.touch=e})},
"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(q,e,a,f){f.extend(e,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return a("dijit._FocusMixin",null,{_focusManager:q})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c){var l,w,v=new (e([h,r],{curNode:null,activeStack:[],constructor:function(){var c=t.hitch(this,function(c){a.isDescendant(this.curNode,c)&&this.set("curNode",null);a.isDescendant(this.prevNode,c)&&this.set("prevNode",null)});q.before(n,"empty",c);q.before(n,"destroy",c)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,c){var e=this,l=a.document&&a.document.body;if(l){var g=d("pointer-events")?"pointerdown":d("MSPointer")?
"MSPointerDown":d("touch-events")?"mousedown, touchstart":"mousedown",h=b(a.document,g,function(a){if(!a||!(a.target&&null==a.target.parentNode))e._onTouchNode(c||a.target,"mouse")}),f=b(l,"focusin",function(a){if(a.target.tagName){var b=a.target.tagName.toLowerCase();"#document"==b||"body"==b||(s.isFocusable(a.target)?e._onFocusNode(c||a.target):e._onTouchNode(c||a.target))}}),p=b(l,"focusout",function(a){e._onBlurNode(c||a.target)});return{remove:function(){h.remove();f.remove();p.remove();l=h=
f=p=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<l+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(t.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<w+100||(this._clearActiveWidgetsTimer=setTimeout(t.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,c){w=(new Date).getTime();
this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);k.contains(a,"dijitPopup")&&(a=a.firstChild);var b=[];try{for(;a;){var d=f.get(a,"dijitPopupParent");if(d)a=p.byId(d).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===u.body())break;a=m.get(a.ownerDocument).frameElement}else{var e=a.getAttribute&&a.getAttribute("widgetId"),l=e&&p.byId(e);l&&!("mouse"==c&&l.get("disabled"))&&b.unshift(e);a=a.parentNode}}}catch(g){}this._setStack(b,
c)},_onFocusNode:function(a){a&&9!=a.nodeType&&(l=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,c){var b=this.activeStack,d=b.length-1,e=a.length-1;if(a[e]!=b[d]){this.set("activeStack",a);var l;for(l=d;0<=l&&b[l]!=a[l];l--)if(d=p.byId(b[l]))d._hasBeenBlurred=!0,d.set("focused",!1),d._focusManager==this&&d._onBlur(c),
this.emit("widget-blur",d,c);for(l++;l<=e;l++)if(d=p.byId(a[l]))d.set("focused",!0),d._focusManager==this&&d._onFocus(c),this.emit("widget-focus",d,c)}},focus:function(a){if(a)try{a.focus()}catch(c){}}}));g(function(){var a=v.registerWin(m.get(document));d("ie")&&b(window,"unload",function(){a&&(a.remove(),a=null)})});c.focus=function(a){v.focus(a)};for(var x in v)/^_/.test(x)||(c.focus[x]="function"==typeof v[x]?t.hitch(v,x):v[x]);v.watch(function(a,b,d){c.focus[a]=d});return v})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),
function(q,e,a,f,k,n,r){var t={_isElementShown:function(b){var e=f.get(b);return"hidden"!=e.visibility&&"collapsed"!=e.visibility&&"none"!=e.display&&"hidden"!=a.get(b,"type")},hasDefaultTabStop:function(b){switch(b.nodeName.toLowerCase()){case "a":return a.has(b,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var e;try{var d=b.contentDocument;if("designMode"in d&&"on"==d.designMode)return!0;e=d.body}catch(h){try{e=b.contentWindow.document.body}catch(f){return!1}}return e&&
("true"==e.contentEditable||e.firstChild&&"true"==e.firstChild.contentEditable);default:return"true"==b.contentEditable}},effectiveTabIndex:function(b){return a.get(b,"disabled")?void 0:a.has(b,"tabIndex")?+a.get(b,"tabIndex"):t.hasDefaultTabStop(b)?0:void 0},isTabNavigable:function(a){return 0<=t.effectiveTabIndex(a)},isFocusable:function(a){return-1<=t.effectiveTabIndex(a)},_getTabNavigable:function(b){function e(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&
a.name&&a.name.toLowerCase()}var d,h,f,m,k,p,c={},l=t._isElementShown,w=t.effectiveTabIndex,v=function(b){for(b=b.firstChild;b;b=b.nextSibling)if(!(1!=b.nodeType||9>=n("ie")&&"HTML"!==b.scopeName||!l(b))){var r=w(b);if(0<=r){if(0==r)d||(d=b),h=b;else if(0<r){if(!f||r<m)m=r,f=b;if(!k||r>=p)p=r,k=b}r=e(b);a.get(b,"checked")&&r&&(c[r]=b)}"SELECT"!=b.nodeName.toUpperCase()&&v(b)}};l(b)&&v(b);return{first:c[e(d)]||d,last:c[e(h)]||h,lowest:c[e(f)]||f,highest:c[e(k)]||k}},getFirstInTabbingOrder:function(a,
g){var d=t._getTabNavigable(e.byId(a,g));return d.lowest?d.lowest:d.first},getLastInTabbingOrder:function(a,g){var d=t._getTabNavigable(e.byId(a,g));return d.last?d.last:d.highest}};k.mixin(r,t);return t})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(q,e,a,f){a(function(){e("highcontrast")&&q.add(f.body(),"dijit_a11y")});return e})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(q,e,a,f,k,n,r){k.add("highcontrast",function(){var a=r.doc.createElement("div");a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(e.blankGif||q.toUrl("./resources/blank.gif"))+'");';r.body().appendChild(a);var b=f.getComputedStyle(a),g=b.backgroundImage,b=b.borderTopColor==b.borderRightColor||g&&("none"==g||"url(invalid-url:)"==g);8>=k("ie")?a.outerHTML="":r.body().removeChild(a);return b});n(function(){k("highcontrast")&&
a.add(r.body(),"dj_a11y")});return k})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(q,e,a,f,k,n,r){n.extend(q,{waiRole:"",waiState:""});return k("dijit._Templated",[e,a],{widgetsInTemplate:!1,constructor:function(){r.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},
_processNode:function(a,b){var e=this.inherited(arguments),d=b(a,"waiRole");d&&a.setAttribute("role",d);(d=b(a,"waiState"))&&f.forEach(d.split(/\s*,\s*/),function(b){-1!=b.indexOf("-")&&(b=b.split("-"),a.setAttribute("aria-"+b[0],b[1]))});return e}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(q,e,a,f,k,n,r,t){var b=e("dijit._TemplatedMixin",t,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var b=this.declaredClass,e=this;return r.substitute(a,this,function(a,g){"!"==g.charAt(0)&&(a=f.getObject(g.substr(1),!1,e));if("undefined"==typeof a)throw Error(b+" template:"+g);return null==a?"":"!"==g.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=q(this.templatePath,{sanitize:!0}));var e=b.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),d;if(f.isString(e)){if(d=a.toDom(this._stringRepl(e),this.ownerDocument),1!=d.nodeType)throw Error("Invalid template: "+e);}else d=e.cloneNode(!0);this.domNode=d}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var b=this.containerNode;if(a&&b)for(;a.hasChildNodes();)b.appendChild(a.firstChild)}});
b._templateCache={};b.getCachedTemplate=function(e,d,h){var f=b._templateCache,m=e,k=f[m];if(k){try{if(!k.ownerDocument||k.ownerDocument==(h||document))return k}catch(p){}a.destroy(k)}e=r.trim(e);if(d||e.match(/\$\{([^\}]+)\}/g))return f[m]=e;d=a.toDom(e,h);if(1!=d.nodeType)throw Error("Invalid template: "+e);return f[m]=d};n("ie")&&k(window,"unload",function(){var e=b._templateCache,d;for(d in e){var h=e[d];"object"==typeof h&&a.destroy(h);delete e[d]}});return b})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(q){return q.cache})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(q,e,a,f){var k;k=function(a,b,e){f(a,{sync:!!b,headers:{"X-Requested-With":null}}).then(e)};var n={},r=function(a){if(a){a=a.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var b=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(a=b[1])}else a="";return a},t={},b={};q.cache=function(a,b,h){var f;"string"==typeof a?/\//.test(a)?(f=a,h=b):f=e.toUrl(a.replace(/\./g,
"/")+(b?"/"+b:"")):(f=a+"",h=b);a=void 0!=h&&"string"!=typeof h?h.value:h;h=h&&h.sanitize;if("string"==typeof a)return n[f]=a,h?r(a):a;if(null===a)return delete n[f],null;f in n||k(f,!0,function(a){n[f]=a});return h?r(n[f]):n[f]};return{dynamic:!0,normalize:function(a,b){var e=a.split("!"),f=e[0];return(/^\./.test(f)?b(f):f)+(e[1]?"!"+e[1]:"")},load:function(a,d,e){a=a.split("!");var f=1<a.length,m=a[0],s=d.toUrl(a[0]);a="url:"+s;var p=t,c=function(a){e(f?r(a):a)};m in n?p=n[m]:d.cache&&a in d.cache?
p=d.cache[a]:s in n&&(p=n[s]);if(p===t)if(b[s])b[s].push(c);else{var l=b[s]=[c];k(s,!d.async,function(a){n[m]=n[s]=a;for(var c=0;c<l.length;)l[c++](a);delete b[s]})}else c(p)}}})},"dojo/request":function(){define(["./request/default!"],function(q){return q})},"dojo/request/default":function(){define(["exports","require","../has"],function(q,e,a){var f=a("config-requestProvider");f||(f="./xhr");q.getPlatformDefaultId=function(){return"./xhr"};q.load=function(a,n,r,t){e(["platform"==a?"./xhr":f],function(a){r(a)})}})},
"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(q,e,a,f,k,n,r,t,b){var g=k.delegate(t,{mouseenter:n.enter,mouseleave:n.leave,keypress:a._keypress}),d;a=f("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},
_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,b,d){var e=!0,g=this.attachScope||this,c=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(c)for(var l=c.split(/\s*,\s*/);c=l.shift();)k.isArray(g[c])?
g[c].push(a):g[c]=a,e="containerNode"!=c,this._attachPoints.push(c);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event")){c=b.split(/\s*,\s*/);for(l=k.trim;b=c.shift();)if(b){var f=null;-1!=b.indexOf(":")?(f=b.split(":"),b=l(f[0]),f=l(f[1])):b=l(b);f||(f=b);this._attachEvents.push(d(a,b,k.hitch(g,f)))}}return e},_attach:function(a,b,e){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?d||(d=q("./a11yclick")):g[b]||b;return r(a,b,e)},_detachTemplateNodes:function(){var a=this.attachScope||
this;e.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];e.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});k.extend(b,{dojoAttachEvent:"",dojoAttachPoint:""});return a})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(q,e,a,f,k){return a("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,widgetsInTemplate:!0,contextRequire:null,_beforeFillContent:function(){if(this.widgetsInTemplate){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);k.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(f.hitch(this,function(a){this._startupWidgets=a;for(var e=0;e<a.length;e++)this._processTemplateNode(a[e],
function(a,e){return a[e]},function(a,e,d){return e in a?a.connect(a,e,d):a.on(e,d,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,e,f){return e(a,"dojoType")||e(a,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){q.forEach(this._startupWidgets,function(a){a&&(!a._started&&a.startup)&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p){function c(a){return eval("("+a+")")}function l(a){var c=
a._nameCaseMap,b=a.prototype;if(!c||c._extendCnt<v){var c=a._nameCaseMap={},d;for(d in b)"_"!==d.charAt(0)&&(c[d.toLowerCase()]=d);c._extendCnt=v}return c}function w(c,b){var d=c.join();if(!x[d]){for(var e=[],l=0,g=c.length;l<g;l++){var h=c[l];e[e.length]=x[h]=x[h]||a.getObject(h)||~h.indexOf("/")&&(b?b(h):q(h))}l=e.shift();x[d]=e.length?l.createSubclass?l.createSubclass(e):l.extend.apply(l,e):l}return x[d]}new Date("X");var v=0;b.after(a,"extend",function(){v++},!0);var x={},y={_clearCache:function(){v++;
x={}},_functionFromScript:function(a,c){var b="",d="",e=a.getAttribute(c+"args")||a.getAttribute("args"),l=a.getAttribute("with"),e=(e||"").split(/\s*,\s*/);l&&l.length&&f.forEach(l.split(/\s*,\s*/),function(a){b+="with("+a+"){";d+="}"});return new Function(e,b+a.innerHTML+d)},instantiate:function(a,c,b){c=c||{};b=b||{};var d=(b.scope||e._scopeName)+"Type",l="data-"+(b.scope||e._scopeName)+"-",g=l+"type",h=l+"mixins",p=[];f.forEach(a,function(a){var b=d in c?c[d]:a.getAttribute(g)||a.getAttribute(d);
if(b){var e=a.getAttribute(h),b=e?[b].concat(e.split(/\s*,\s*/)):[b];p.push({node:a,types:b})}});return this._instantiate(p,c,b)},_instantiate:function(a,c,b,d){function e(a){!c._started&&!b.noStart&&f.forEach(a,function(a){"function"===typeof a.startup&&!a._started&&a.startup()});return a}a=f.map(a,function(a){var d=a.ctor||w(a.types,b.contextRequire);if(!d)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(d,a.node,c,b,a.scripts,a.inherited)},this);return d?
g(a).then(e):e(a)},construct:function(g,h,p,k,v,n){function w(c){K&&a.setObject(K,c);for(N=0;N<S.length;N++)b[S[N].advice||"after"](c,S[N].method,a.hitch(c,S[N].func),!0);for(N=0;N<U.length;N++)U[N].call(c);for(N=0;N<O.length;N++)c.watch(O[N].prop,O[N].func);for(N=0;N<W.length;N++)s(c,W[N].event,W[N].func);return c}var r=g&&g.prototype;k=k||{};var y={};k.defaults&&a.mixin(y,k.defaults);n&&a.mixin(y,n);var x;u("dom-attributes-explicit")?x=h.attributes:u("dom-attributes-specified-flag")?x=f.filter(h.attributes,
function(a){return a.specified}):(n=(/^input$|^img$/i.test(h.nodeName)?h:h.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),x=f.map(n.split(/\s+/),function(a){var c=a.toLowerCase();return{name:a,value:"LI"==h.nodeName&&"value"==a||"enctype"==c?h.getAttribute(c):h.getAttributeNode(c).value}}));var q=k.scope||e._scopeName;n="data-"+q+"-";var F={};"dojo"!==q&&(F[n+"props"]="data-dojo-props",F[n+"type"]="data-dojo-type",F[n+"mixins"]=
"data-dojo-mixins",F[q+"type"]="dojoType",F[n+"id"]="data-dojo-id");for(var N=0,M,q=[],K,P;M=x[N++];){var Q=M.name,R=Q.toLowerCase();M=M.value;switch(F[R]||R){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":P=M;break;case "data-dojo-id":case "jsid":K=M;break;case "data-dojo-attach-point":case "dojoattachpoint":y.dojoAttachPoint=M;break;case "data-dojo-attach-event":case "dojoattachevent":y.dojoAttachEvent=M;break;case "class":y["class"]=h.className;break;
case "style":y.style=h.style&&h.style.cssText;break;default:if(Q in r||(Q=l(g)[R]||Q),Q in r)switch(typeof r[Q]){case "string":y[Q]=M;break;case "number":y[Q]=M.length?Number(M):NaN;break;case "boolean":y[Q]="false"!=M.toLowerCase();break;case "function":""===M||-1!=M.search(/[^\w\.]+/i)?y[Q]=new Function(M):y[Q]=a.getObject(M,!1)||new Function(M);q.push(Q);break;default:R=r[Q],y[Q]=R&&"length"in R?M?M.split(/\s*,\s*/):[]:R instanceof Date?""==M?new Date(""):"now"==M?new Date:d.fromISOString(M):R instanceof
t?e.baseUrl+M:c(M)}else y[Q]=M}}for(x=0;x<q.length;x++)F=q[x].toLowerCase(),h.removeAttribute(F),h[F]=null;if(P)try{P=c.call(k.propsThis,"{"+P+"}"),a.mixin(y,P)}catch(ba){throw Error(ba.toString()+" in data-dojo-props\x3d'"+P+"'");}a.mixin(y,p);v||(v=g&&(g._noScript||r._noScript)?[]:m("\x3e script[type^\x3d'dojo/']",h));var S=[],U=[],O=[],W=[];if(v)for(N=0;N<v.length;N++)F=v[N],h.removeChild(F),p=F.getAttribute(n+"event")||F.getAttribute("event"),k=F.getAttribute(n+"prop"),P=F.getAttribute(n+"method"),
q=F.getAttribute(n+"advice"),x=F.getAttribute("type"),F=this._functionFromScript(F,n),p?"dojo/connect"==x?S.push({method:p,func:F}):"dojo/on"==x?W.push({event:p,func:F}):y[p]=F:"dojo/aspect"==x?S.push({method:P,advice:q,func:F}):"dojo/watch"==x?O.push({prop:k,func:F}):U.push(F);g=(v=g.markupFactory||r.markupFactory)?v(y,h,g):new g(y,h);return g.then?g.then(w):w(g)},scan:function(a,c){function b(a){if(!a.inherited){a.inherited={};var c=a.node,d=b(a.parent),c={dir:c.getAttribute("dir")||d.dir,lang:c.getAttribute("lang")||
d.lang,textDir:c.getAttribute(u)||d.textDir},e;for(e in c)c[e]&&(a.inherited[e]=c[e])}return a.inherited}var d=[],l=[],g={},p=(c.scope||e._scopeName)+"Type",m="data-"+(c.scope||e._scopeName)+"-",k=m+"type",u=m+"textdir",m=m+"mixins",s=a.firstChild,v=c.inherited;if(!v){var n=function(a,c){return a.getAttribute&&a.getAttribute(c)||a.parentNode&&n(a.parentNode,c)},v={dir:n(a,"dir"),lang:n(a,"lang"),textDir:n(a,u)},r;for(r in v)v[r]||delete v[r]}for(var v={inherited:v},t,y;;)if(s)if(1!=s.nodeType)s=s.nextSibling;
else if(t&&"script"==s.nodeName.toLowerCase())(x=s.getAttribute("type"))&&/^dojo\/\w/i.test(x)&&t.push(s),s=s.nextSibling;else if(y)s=s.nextSibling;else{var x=s.getAttribute(k)||s.getAttribute(p);r=s.firstChild;if(!x&&(!r||3==r.nodeType&&!r.nextSibling))s=s.nextSibling;else{y=null;if(x){var R=s.getAttribute(m);t=R?[x].concat(R.split(/\s*,\s*/)):[x];try{y=w(t,c.contextRequire)}catch(ba){}y||f.forEach(t,function(a){~a.indexOf("/")&&!g[a]&&(g[a]=!0,l[l.length]=a)});R=y&&!y.prototype._noScript?[]:null;
v={types:t,ctor:y,parent:v,node:s,scripts:R};v.inherited=b(v);d.push(v)}else v={node:s,scripts:t,parent:v};t=R;y=s.stopParser||y&&y.prototype.stopParser&&!c.template;s=r}}else{if(!v||!v.node)break;s=v.node.nextSibling;y=!1;v=v.parent;t=v.scripts}var S=new h;l.length?(c.contextRequire||q)(l,function(){S.resolve(f.filter(d,function(a){if(!a.ctor)try{a.ctor=w(a.types,c.contextRequire)}catch(b){}for(var d=a.parent;d&&!d.types;)d=d.parent;var e=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(e&&e.stopParser&&
!c.template);a.instantiate=!d||d.instantiate&&d.instantiateChildren;return a.instantiate}))}):S.resolve(d);return S.promise},_require:function(b,d){var e=c("{"+b.innerHTML+"}"),l=[],g=[],f=new h,p=d&&d.contextRequire||q,m;for(m in e)l.push(m),g.push(e[m]);p(g,function(){for(var c=0;c<l.length;c++)a.setObject(l[c],arguments[c]);f.resolve(arguments)});return f.promise},_scanAmd:function(a,c){var b=new h,d=b.promise;b.resolve(!0);var e=this;m("script[type\x3d'dojo/require']",a).forEach(function(a){d=
d.then(function(){return e._require(a,c)});a.parentNode.removeChild(a)});return d},parse:function(c,b){var d;!b&&c&&c.rootNode?(b=c,d=b.rootNode):c&&a.isObject(c)&&!("nodeType"in c)?b=c:d=c;d=d?n.byId(d):r.body();b=b||{};var e=b.template?{template:!0}:{},l=[],g=this,h=this._scanAmd(d,b).then(function(){return g.scan(d,b)}).then(function(a){return g._instantiate(a,e,b,!0)}).then(function(a){return l=l.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});a.mixin(l,
h);return l}};e.parser=y;k.parseOnLoad&&p(100,y,"parse");return y})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(q,e){var a={};q.setObject("dojo.date.stamp",a);a.fromISOString=function(f,k){a._isoRegExp||(a._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var n=a._isoRegExp.exec(f),r=null;if(n){n.shift();n[1]&&n[1]--;n[6]&&(n[6]*=1E3);k&&(k=new Date(k),e.forEach(e.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),
function(a){return k["get"+a]()}),function(a,b){n[b]=n[b]||a}));r=new Date(n[0]||1970,n[1]||0,n[2]||1,n[3]||0,n[4]||0,n[5]||0,n[6]||0);100>n[0]&&r.setFullYear(n[0]||1970);var t=0,b=n[7]&&n[7].charAt(0);"Z"!=b&&(t=60*(n[8]||0)+(Number(n[9])||0),"-"!=b&&(t*=-1));b&&(t-=r.getTimezoneOffset());t&&r.setTime(r.getTime()+6E4*t)}return r};a.toISOString=function(a,e){var n=function(a){return 10>a?"0"+a:a};e=e||{};var r=[],t=e.zulu?"getUTC":"get",b="";"time"!=e.selector&&(b=a[t+"FullYear"](),b=["0000".substr((b+
"").length)+b,n(a[t+"Month"]()+1),n(a[t+"Date"]())].join("-"));r.push(b);if("date"!=e.selector){b=[n(a[t+"Hours"]()),n(a[t+"Minutes"]()),n(a[t+"Seconds"]())].join(":");t=a[t+"Milliseconds"]();e.milliseconds&&(b+="."+(100>t?"0":"")+n(t));if(e.zulu)b+="Z";else if("time"!=e.selector)var t=a.getTimezoneOffset(),g=Math.abs(t),b=b+((0<t?"-":"+")+n(Math.floor(g/60))+":"+n(g%60));r.push(b)}return r.join("T")};return a})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),
function(q,e,a,f,k,n){return q([n,k],{_onMap:function(a){var e=this.constructor._onMap,b;if(!e||!e.FINAL)delete this.constructor._onMap,e=this.registerConnectEvents(),e.FINAL=!0;a=a.toLowerCase();e[a]?b=this[e[a].method]:(a=this._onCamelCase(a),this[a]&&(b=a));return b},on:function(a,e){var b=this._onMap(a),g=a.replace(/\-/g,""),d="on"+g in this.domNode;return b||!d?this.inherited(arguments):this.own(f(this.domNode,g,e))[0]},emit:function(a,f,b){var g,d,h,k=a.toLowerCase(),m=this.constructor._onMap||
this.registerConnectEvents();d=this[this._onMap(k)];f=f||{};f.target||(f.target=this);d&&(m&&m[k])&&(this._onObj2Arr(function(){g=Array.prototype.slice.call(arguments)},m[k].argKeys)(f),h=e.mixin({},arguments),h[2]=g,h[0]=m[k].name.replace(/^on/,""));return this.inherited(h||arguments)}})})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s){q=q(g,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=e.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var c=[],b,d=a.length;for(b=0;b<d;b++)c.push(a[b].toJson());
return{geometryType:s.getJsonType(a[0]),geometries:c}},_decodeGeometries:function(b,c,d){var g=s.getGeometryType(c);b=b.geometries;var h=[],f={spatialReference:d.toJson()},m=e.mixin;a.forEach(b,function(a,c){h[c]=new g(m(a,f))});return h},_toProjectGeometry:function(a){var c=a.spatialReference.toJson();return a instanceof d?new u({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:c}):new h({paths:[[].concat(a.points)],spatialReference:c})},
_fromProjectedGeometry:function(a,c,b){return"esriGeometryEnvelope"===c?(a=a.rings[0],new d(a[0][0],a[0][1],a[2][0],a[2][1],b)):new m({points:a.paths[0],spatialReference:b.toJson()})},project:function(a,c,d,g){var h=e.mixin({},this._url.query,{f:"json"}),m;a.geometries?(g=d,d=c,c=a.outSR,m=a.geometries[0],h=e.mixin(h,a.toJson())):(m=a[0],h=e.mixin(h,{outSR:c.wkid||f.toJson(c.toJson()),inSR:m.spatialReference.wkid||f.toJson(m.spatialReference.toJson()),geometries:f.toJson(this._encodeGeometries(a))}));
var u=s.getJsonType(m),n=this._projectHandler,r=this._errorHandler,q=new k(b._dfdCanceller);q._pendingDfd=t({url:this._url.path+"/project",content:h,callbackParamName:"callback",load:function(a,b){n(a,b,u,c,d,g,q)},error:function(a){r(a,g,q)}});return q},_projectHandler:function(a,c,b,d,e,g,h){try{var f=this._decodeGeometries(a,b,d);this._successHandler([f],"onProjectComplete",e,h)}catch(m){this._errorHandler(m,g,h)}},onProjectComplete:function(){},simplify:function(a,c,d){var g=a[0].spatialReference,
h=e.mixin({},this._url.query,{f:"json",sr:g.wkid?g.wkid:f.toJson(g.toJson()),geometries:f.toJson(this._encodeGeometries(a))}),m=s.getJsonType(a[0]),u=this._simplifyHandler,n=this._errorHandler,r=new k(b._dfdCanceller);r._pendingDfd=t({url:this._url.path+"/simplify",content:h,callbackParamName:"callback",load:function(a,b){u(a,b,m,g,c,d,r)},error:function(a){n(a,d,r)}});return r},_simplifyHandler:function(a,c,b,d,e,g,h){try{var f=this._decodeGeometries(a,b,d);this._successHandler([f],"onSimplifyComplete",
e,h)}catch(m){this._errorHandler(m,g,h)}},onSimplifyComplete:function(){},convexHull:function(a,c,d){var g=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:f.toJson(g.toJson()),geometries:f.toJson(this._encodeGeometries(a))});var h=this._convexHullHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,b){h(a,b,g,c,d,s)},error:function(a){m(a,d,s)}});return s},_convexHullHandler:function(a,
c,b,d,e,g){try{var h=s.fromJson(a.geometry).setSpatialReference(b);this._successHandler([h],"onConvexHullComplete",d,g)}catch(f){this._errorHandler(f,e,g)}},onConvexHullComplete:function(){},union:function(a,c,d){var g=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:f.toJson(g.toJson()),geometries:f.toJson(this._encodeGeometries(a))});var h=this._unionHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,b){h(a,b,g,c,d,s)},error:function(a){m(a,d,s)}});return s},_unionHandler:function(a,c,b,d,e,g){try{var h=s.fromJson(a.geometry).setSpatialReference(b);this._successHandler([h],"onUnionComplete",d,g)}catch(f){this._errorHandler(f,e,g)}},onUnionComplete:function(){},autoComplete:function(a,c,d,g){var h=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:f.toJson(h.toJson()),polygons:f.toJson(this._encodeGeometries(a).geometries),polylines:f.toJson(this._encodeGeometries(c).geometries)});
var m=this._autoCompleteHandler,s=this._errorHandler,u=new k(b._dfdCanceller);u._pendingDfd=t({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(a,c){m(a,c,h,d,g,u)},error:function(a){s(a,g,u)}});return u},_autoCompleteHandler:function(a,c,b,d,e,g){try{var h=a.geometries;a=[];var f,m=h.length;for(f=0;f<m;f++)a[f]=new u({spatialReference:b,rings:h[f].rings});this._successHandler([a],"onAutoCompleteComplete",d,g)}catch(k){this._errorHandler(k,e,g)}},onAutoCompleteComplete:function(){},
reshape:function(a,c,d,g){var h=a.spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:f.toJson(h.toJson()),target:f.toJson({geometryType:s.getJsonType(a),geometry:a.toJson()}),reshaper:f.toJson(c.toJson())});var m=this._reshapeHandler,u=this._errorHandler,n=new k(b._dfdCanceller);n._pendingDfd=t({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(a,c){m(a,c,h,d,g,n)},error:function(a){u(a,g,n)}});return n},_reshapeHandler:function(a,c,b,d,e,g){try{var h=s.fromJson(a.geometry).setSpatialReference(b);
this._successHandler([h],"onReshapeComplete",d,g)}catch(f){this._errorHandler(f,e,g)}},onReshapeComplete:function(){},cut:function(d,c,l,g){var h=d[0].spatialReference,m=a.map(d,function(a){return a.toJson()});d=e.mixin({},this._url.query,{f:"json",sr:f.toJson(h.toJson()),target:f.toJson({geometryType:s.getJsonType(d[0]),geometries:m}),cutter:f.toJson(c.toJson())});var u=this._cutHandler,n=this._errorHandler,r=new k(b._dfdCanceller);r._pendingDfd=t({url:this._url.path+"/cut",content:d,callbackParamName:"callback",
load:function(a,c){u(a,c,h,l,g,r)},error:function(a){n(a,g,r)}});return r},_cutHandler:function(b,c,d,e,g,h){try{var f=b.geometries,m={};m.cutIndexes=b.cutIndexes;m.geometries=[];a.forEach(f,function(a){m.geometries.push(s.fromJson(a).setSpatialReference(d))});this._successHandler([m],"onCutComplete",e,h)}catch(k){this._errorHandler(k,g,h)}},onCutComplete:function(){},intersect:function(a,c,d,g){var h=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:f.toJson(h.toJson()),geometries:f.toJson(this._encodeGeometries(a)),
geometry:f.toJson({geometryType:s.getJsonType(c),geometry:c.toJson()})});var m=this._intersectHandler,u=this._errorHandler,n=new k(b._dfdCanceller);n._pendingDfd=t({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(a,c){m(a,c,h,d,g,n)},error:function(a){u(a,g,n)}});return n},_intersectHandler:function(b,c,d,e,g,h){try{var f=[];a.forEach(b.geometries,function(a){f.push(s.fromJson(a).setSpatialReference(d))});this._successHandler([f],"onIntersectComplete",e,h)}catch(m){this._errorHandler(m,
g,h)}},onIntersectComplete:function(){},difference:function(a,c,d,g){var h=a[0].spatialReference;a=e.mixin({},this._url.query,{f:"json",sr:f.toJson(h.toJson()),geometries:f.toJson(this._encodeGeometries(a)),geometry:f.toJson({geometryType:s.getJsonType(c),geometry:c.toJson()})});var m=this._differenceHandler,u=this._errorHandler,n=new k(b._dfdCanceller);n._pendingDfd=t({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(a,c){m(a,c,h,d,g,n)},error:function(a){u(a,
g,n)}});return n},_differenceHandler:function(b,c,d,e,g,h){try{var f=[];a.forEach(b.geometries,function(a){f.push(s.fromJson(a).setSpatialReference(d))});this._successHandler([f],"onDifferenceComplete",e,h)}catch(m){this._errorHandler(m,g,h)}},onDifferenceComplete:function(){},buffer:function(a,c,d){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),h=a.outSpatialReference||a.geometries[0].spatialReference,f=this._bufferHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+
"/buffer",content:g,callbackParamName:"callback",load:function(a,b){f(a,b,h,c,d,s)},error:function(a){m(a,d,s)}});return s},_bufferHandler:function(a,c,b,d,e,g){try{var h=a.geometries;a=[];var f,m=h.length;for(f=0;f<m;f++)a[f]=new u({spatialReference:b,rings:h[f].rings});this._successHandler([a],"onBufferComplete",d,g)}catch(k){this._errorHandler(k,e,g)}},onBufferComplete:function(){},areasAndLengths:function(a,c,d){a=e.mixin({},this._url.query,{f:"json"},a.toJson());var g=this._areasAndLengthsHandler,
h=this._errorHandler,f=new k(b._dfdCanceller);f._pendingDfd=t({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,b){g(a,b,c,d,f)},error:function(a){h(a,d,f)}});return f},_areasAndLengthsHandler:function(a,c,b,d,e){try{this._successHandler([a],"onAreasAndLengthsComplete",b,e)}catch(g){this._errorHandler(g,d,e)}},onAreasAndLengthsComplete:function(){},lengths:function(a,c,d){a=e.mixin({},this._url.query,{f:"json"},a.toJson());var g=this._lengthsHandler,h=this._errorHandler,
f=new k(b._dfdCanceller);f._pendingDfd=t({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,b){g(a,b,c,d,f)},error:function(a){h(a,d,f)}});return f},_lengthsHandler:function(a,c,b,d,e){try{this._successHandler([a],"onLengthsComplete",b,e)}catch(g){this._errorHandler(g,d,e)}},onLengthsComplete:function(){},labelPoints:function(d,c,l){var g=a.map(d,function(a){return a.toJson()}),h=d[0].spatialReference,g=e.mixin({},this._url.query,{f:"json",sr:h.wkid?h.wkid:f.toJson(h.toJson()),
polygons:f.toJson(g)}),m=this._labelPointsHandler,s=this._errorHandler,u=new k(b._dfdCanceller);u._pendingDfd=t({url:this._url.path+"/labelPoints",content:g,callbackParamName:"callback",load:function(a,b){m(a,b,d,h,c,l,u)},error:function(a){s(a,l,u)}});return u},_labelPointsHandler:function(b,c,d,e,g,h,f){try{var m=[];a.forEach(b.labelPoints,function(a){m.push(s.fromJson(a).setSpatialReference(e))});this._successHandler([m],"onLabelPointsComplete",g,f)}catch(k){this._errorHandler(k,h,f)}},onLabelPointsComplete:function(){},
relation:function(a,c,d){a=e.mixin({},this._url.query,{f:"json"},a.toJson());var g=this._relationHandler,h=this._errorHandler,f=new k(b._dfdCanceller);f._pendingDfd=t({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,b){g(a,b,c,d,f)},error:function(a){h(a,d,f)}});return f},_relationHandler:function(a,c,b,d,e){try{this._successHandler([a.relations],"onRelationComplete",b,e)}catch(g){this._errorHandler(g,d,e)}},onRelationComplete:function(){},trimExtend:function(a,
c,d){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),h=a.sr,f=this._trimExtendHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/trimExtend",content:g,callbackParamName:"callback",load:function(a,b){f(a,b,h,c,d,s)},error:function(a){m(a,d,s)}});return s},_trimExtendHandler:function(a,c,b,d,e,g){try{var f=a.geometries;a=[];var m,k=f.length;for(m=0;m<k;m++)a[m]=new h({spatialReference:b,paths:f[m].paths});this._successHandler([a],"onTrimExtendComplete",
d,g)}catch(s){this._errorHandler(s,e,g)}},onTrimExtendComplete:function(){},densify:function(a,c,d){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),h=a.geometries[0].spatialReference,f=this._densifyHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/densify",content:g,callbackParamName:"callback",load:function(a,b){f(a,b,h,c,d,s)},error:function(a){m(a,d,s)}});return s},_densifyHandler:function(b,c,d,e,g,h){try{var f=[];a.forEach(b.geometries,function(a){f.push(s.fromJson(a).setSpatialReference(d))});
this._successHandler([f],"onDensifyComplete",e,h)}catch(m){this._errorHandler(m,g,h)}},onDensifyComplete:function(){},generalize:function(a,c,d){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),h=a.geometries[0].spatialReference,f=this._generalizeHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/generalize",content:g,callbackParamName:"callback",load:function(a,b){f(a,b,h,c,d,s)},error:function(a){m(a,d,s)}});return s},_generalizeHandler:function(b,
c,d,e,g,h){try{var f=[];a.forEach(b.geometries,function(a){f.push(s.fromJson(a).setSpatialReference(d))});this._successHandler([f],"onGeneralizeComplete",e,h)}catch(m){this._errorHandler(m,g,h)}},onGeneralizeComplete:function(){},offset:function(a,c,d){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),h=a.geometries[0].spatialReference,f=this._offsetHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/offset",content:g,callbackParamName:"callback",load:function(a,
b){f(a,b,h,c,d,s)},error:function(a){m(a,d,s)}});return s},_offsetHandler:function(b,c,d,e,g,h){try{var f=[];a.forEach(b.geometries,function(a){f.push(s.fromJson(a).setSpatialReference(d))});this._successHandler([f],"onOffsetComplete",e,h)}catch(m){this._errorHandler(m,g,h)}},onOffsetComplete:function(){},distance:function(a,c,d){var g=e.mixin({},this._url.query,{f:"json"},a.toJson()),h=a.geometry1.spatialReference,f=this._distanceHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=
t({url:this._url.path+"/distance",content:g,callbackParamName:"callback",load:function(a,b){f(a,b,h,c,d,s)},error:function(a){m(a,d,s)}});return s},_distanceHandler:function(a,c,b,d,e,g){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",d,g)}catch(h){this._errorHandler(h,e,g)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,c,d){var g={};e.isObject(a.sr)?g.sr=a.sr.wkid||f.toJson(a.sr.toJson()):g.sr=a.sr;g.coordinates=f.toJson(a.coordinates);g.conversionType=a.conversionType||
"MGRS";g.conversionMode=a.conversionMode;g.numOfDigits=a.numOfDigits;g.rounding=a.rounding;g.addSpaces=a.addSpaces;a=e.mixin({},this._url.query,{f:"json"},g);var h=this._toGeoCoordinateHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,b){h(a,b,c,d,s)},error:function(a){m(a,d,s)}});return s},_toGeoCoordinateHandler:function(a,c,b,d,e){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
b,e)}catch(g){this._errorHandler(g,d,e)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,c,d){var g={};e.isObject(a.sr)?g.sr=a.sr.wkid||f.toJson(a.sr.toJson()):g.sr=a.sr;g.strings=f.toJson(a.strings);g.conversionType=a.conversionType||"MGRS";g.conversionMode=a.conversionMode;a=e.mixin({},this._url.query,{f:"json"},g);var h=this._fromGeoCoordinateHandler,m=this._errorHandler,s=new k(b._dfdCanceller);s._pendingDfd=t({url:this._url.path+"/fromGeoCoordinateString",content:a,
callbackParamName:"callback",load:function(a,b){h(a,b,c,d,s)},error:function(a){m(a,d,s)}});return s},_fromGeoCoordinateHandler:function(a,c,b,d,e){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",b,e)}catch(g){this._errorHandler(g,d,e)}},onFromGeoCoordinateStringComplete:function(){}});e.mixin(q,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return q})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/sniff dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/promise/all ../kernel ../lang ../request ../config ../deferredUtils ../SpatialReference ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./TrackManager ./HeatmapManager dojo/i18n!../nls/jsapi require".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z,D,E,A,G,C,H,I,L,J,F,N,M,K,P,Q,R,ba,S,U,O,W,aa,V,Y,Z,X){var $=w.defaults,T=a(K,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],"delete-attachments-complete":["results"],
"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(a,c){this._preventInit||this._initFeatureLayer(a,c)},_initFeatureLayer:function(a,b){this.i18n=X;b=b||{};this.showLabels=null!=b.showLabels?b.showLabels:!0;
this._outFields=b.outFields;this._defnExpr=b.definitionExpression;this._loadCallback=b.loadCallback;var d=b._usePatch;this._usePatch=null===d||void 0===d?!0:d;this._trackIdField=b.trackIdField;this.objectIdField=b.objectIdField;this._maxOffset=null!=b.maxAllowableOffset?b.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=b.quantize?b.quantize:!0;this._optEditable=b.editable;this._optAutoGen=b.autoGeneralize;this.editSummaryCallback=b.editSummaryCallback;this.userId=b.userId;this.userIsAdmin=
b.userIsAdmin;this.useMapTime=b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0;this.source=b.source;this.gdbVersion=b.gdbVersion;this.orderByFields=b.orderByFields;this.maxPointCountForAuto=null!=b.maxPointCountForAuto?b.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=b.maxRecordCountForAuto?b.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=b.maxVertexCountForAuto?b.maxVertexCountForAuto:this.maxVertexCountForAuto;this.generalizeForScale=
null!=b.generalizeForScale?b.generalizeForScale:this.generalizeForScale;this.queryPagination=null!=b.queryPagination?b.queryPagination:this.url?this.reHostedFS.test(this.url):!1;this.multipatchOption=b.multipatchOption;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var e=T,d=this.mode=c.isDefined(b.mode)?b.mode:e.MODE_ONDEMAND;this._isStream&&(this.mode=d=e.MODE_STREAM);switch(d){case e.MODE_SNAPSHOT:this.currentMode=
e.MODE_SNAPSHOT;this._mode=new O(this);this._isSnapshot=!0;break;case e.MODE_ONDEMAND:case e.MODE_AUTO:this.currentMode=e.MODE_ONDEMAND;this._tileWidth=b.tileWidth||512;this._tileHeight=b.tileHeight||512;this._mode=new W(this);this.latticeTiling=b.latticeTiling;break;case e.MODE_SELECTION:this.currentMode=e.MODE_SELECTION;this._mode=new aa(this);this._isSelOnly=!0;break;case e.MODE_STREAM:this.currentMode=e.MODE_STREAM,this._mode=new V(this),this._isStream=!0}this._initLayer=k.hitch(this,this._initLayer);
this._selectHandler=k.hitch(this,this._selectHandler);this._editable=!1;if(k.isObject(a)&&a.layerDefinition)return this._collection=!0,this.mode=this._isStream?e.MODE_STREAM:e.MODE_SNAPSHOT,this._initLayer(a),this;this._task=new C(this.url,{source:this.source,gdbVersion:this.gdbVersion});d=this._url.path;this._fserver=!1;-1!==d.search(/\/FeatureServer\//i)&&(this._fserver=!0);this.mode===e.MODE_AUTO&&this.reHostedFS.test(this.url)&&this._queryLimit();(e=b.resourceInfo)?this._initLayer(e):(this.source&&
(e={source:this.source.toJson()},this._url.query=k.mixin(this._url.query,{layer:r.toJson(e)})),this.gdbVersion&&(this._url.query=k.mixin(this._url.query,{gdbVersion:this.gdbVersion})),l({url:d,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));this.registerConnectEvents()},_initLayer:function(a,b){if(a||b){this._json=a;this._findCredential();if(this.credential&&this.credential.ssl||a&&a._ssl)this._useSSL(),this._task._useSSL();
this._collection&&(this._isStream||(this.currentMode=T.MODE_SNAPSHOT,this._mode=new O(this)),this._isSnapshot=!0,this._featureSet=a.featureSet,this._nextId=a.nextObjectId,a=a.layerDefinition);this.geometryType=a.geometryType;"string"!==typeof this.multipatchOption&&"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint");if(a.hasOwnProperty("capabilities")){var d=this.capabilities=a.capabilities;d&&-1!==d.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=
!1}else this._collection||(this._editable=this._fserver);c.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=!1);this._json=r.toJson(this._json);if(this.isEditable())this._setMaxOffset(null);else if(this.currentMode!==T.MODE_SNAPSHOT&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint()))this._autoGeneralize=c.isDefined(this._optAutoGen)?this._optAutoGen:
this.currentMode===T.MODE_ONDEMAND,delete this._optAutoGen;var d=a.effectiveMinScale||a.minScale,e=a.effectiveMaxScale||a.maxScale;!this._hasMin&&d&&this.setMinScale(d);!this._hasMax&&e&&this.setMaxScale(e);this.layerId=a.id;this.name=a.name;this.description=a.description;this.copyright=a.copyrightText;this.type=a.type;this.displayField=a.displayField;this.defaultDefinitionExpression=a.definitionExpression;this.fullExtent=new J(a.extent);this.initialExtent=new J(this.fullExtent.toJson());this.fullExtent.spatialReference&&
(this.spatialReference=new x(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=a.defaultVisibility;if("esriGeometryPoint"===this.geometryType||"esriGeometryMultipoint"===this.geometryType)this.latticeTiling=!1;this.indexedFields=a.indexedFields;this.maxRecordCount=a.maxRecordCount;this.canModifyLayer=a.canModifyLayer;this.supportsStatistics=a.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:a.supportsAdvancedQueries;this.supportsCalculate=a.supportsCalculate;this.supportsAttachmentsByUploadId=
a.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=a.supportsCoordinatesQuantization;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;this.hasLabels=a.hasLabels;this.canScaleSymbols=a.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=a.supportsRollbackOnFailure;this.syncCanReturnChanges=a.syncCanReturnChanges;this.isDataVersioned=a.isDataVersioned;this.editFieldsInfo=a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=
a.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=a.relationships;this.allowGeometryUpdates=c.isDefined(a.allowGeometryUpdates)?a.allowGeometryUpdates:!0;this.advancedQueryCapabilities=a.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};this._setMaxOffset(this._maxOffset,
!0);this._isTable="Table"===this.type;for(var l=this.fields=[],e=a.fields,d=0;d<e.length;d++)l.push(new P(e[d]));if(!this.objectIdField){this.objectIdField=a.objectIdField;if(!this.objectIdField){e=a.fields;for(d=0;d<e.length;d++)if(l=e[d],"esriFieldTypeOID"===l.type){this.objectIdField=l.name;break}}!this.objectIdField&&!this._isStream&&console.debug("esri.layers.FeatureLayer: "+c.substitute({url:this.url},"objectIdField is not set [url: ${url}]"))}if(!c.isDefined(this._nextId)){e=this.objectIdField;
l=-1;if(this._collection&&e)for(var h=(d=this._featureSet)&&d.features,f=h?h.length:0,m,d=0;d<f;d++)m=(m=h[d].attributes)&&m[e],m>l&&(l=m);this._nextId=l+1}this.globalIdField=a.globalIdField;if(d=this.typeIdField=a.typeIdField)if(d=!this._getField(d)&&this._getField(d,!0))this.typeIdField=d.name;this.visibilityField=a.visibilityField;if(e=a.defaultSymbol)this.defaultSymbol=D.fromJson(e);var p=this.types=[],s=a.types,u,v,l=(d=this.editFieldsInfo)&&d.creatorField,h=d&&d.editorField;m=l||h;f=[];if(s)for(d=
0;d<s.length;d++)u=new R(s[d]),v=u.templates,m&&(v&&v.length)&&(f=f.concat(v)),p.push(u);s=a.templates;u=this.templates=[];if(s)for(d=0;d<s.length;d++)p=new ba(s[d]),m&&f.push(p),u.push(p);for(d=0;d<f.length;d++)if(m=k.getObject("prototype.attributes",!1,f[d]))l&&delete m[l],h&&delete m[h];if(d=a.timeInfo)this.timeInfo=new Q(d),this._startTimeField=d.startTimeField,this._endTimeField=d.endTimeField,this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?d.trackIdField=
this._trackIdField:this._trackIdField=d.trackIdField;this.hasAttachments=!this._collection&&a.hasAttachments?!0:!1;this.htmlPopupType=a.htmlPopupType;var d=a.drawingInfo,w;if((l=d&&d.labelingInfo)&&!this.labelingInfo)this.labelingInfo=n.map(l,function(a){return new U(a)}),this._fixLabelExpr();if(!this.renderer)if(d&&d.renderer){if(w=d.renderer,this.setRenderer(G.fromJson(w)),"classBreaks"===w.type&&this.renderer.setMaxInclusive(!0),!this._collection){var t=w.type,e=[];w=this.renderer;switch(t){case "simple":e.push(w.symbol);
break;case "uniqueValue":case "classBreaks":e.push(w.defaultSymbol),e=e.concat(n.map(w.infos,function(a){return a.symbol}))}var e=n.filter(e,c.isDefined),q=this._url.path+"/images/",C=this._getToken();n.forEach(e,function(a){var c=a.url;c&&(-1===c.search(/https?\:/)&&-1===c.indexOf("data:")&&(a.url=q+c),C&&-1!==a.url.search(/https?\:/)&&(a.url+="?token\x3d"+C))})}}else if(e)s=this.types,0<s.length?(w=new A(this.defaultSymbol,this.typeIdField),n.forEach(s,function(a){w.addValue(a.id,a.symbol)})):w=
new E(this.defaultSymbol),this.setRenderer(w);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":t=new y;break;case "esriGeometryPolyline":t=new B;break;case "esriGeometryPolygon":t=new z;break;default:this.hasXYFootprint()&&(t=new z)}this.setRenderer(t?new E(t):null)}t=d&&d.transparency||0;!this.hasOwnProperty("opacity")&&0<t&&(this.opacity=1-t/100);this.version=a.currentVersion;this.version||(this.version="capabilities"in a||"drawingInfo"in a||
"hasAttachments"in a||"htmlPopupType"in a||"relationships"in a||"timeInfo"in a||"typeIdField"in a||"types"in a?10:9.3);if((g("ie")||7<=g("trident")||g("safari"))&&this.isEditable()&&10.02>this.version)this._ts=!0;this.statistics=a.statistics;this._fixRendererFields();this._checkFields();this._updateCaps();var H=function(){this.currentMode!==T.MODE_SNAPSHOT&&(this.queryPagination=!1);this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))};this._collection?
(t=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new I(t)),this._fcAdded=!0,H.call(this)):this._forceIdentity(this._limitPromise?function(){var a=this;this._limitPromise.then(function(c){a._checkMode(c)});this._limitPromise.always(function(){a._limitPromise=null;H.call(a)})}:H)}},setShowLabels:function(a){this.showLabels=a;this.onShowLabelsChange()},onShowLabelsChange:function(){},onRendererChange:function(a){this.inherited(arguments);var b=this._map;this._ager=!(!a||!a.observationAger||
!a.observationRenderer);a&&"colors"in a&&"blurRadius"in a&&"maxPixelIntensity"in a?"esriGeometryPoint"==this.geometryType&&(!this._heatmapManager&&b)&&(this._heatmapManager=new Z(this),this._heatmapManager.initialize(b)):this.renderer&&this.renderer.getRendererInfo?n.some(this.renderer.rendererInfos,function(a){return a.renderer&&"colors"in a.renderer&&"blurRadius"in a.renderer})||(this._heatmapManager=null):this._heatmapManager=null;if(a){var d=[],b=n.filter([a,a.observationRenderer,a.latestObservationRenderer,
a.trackRenderer],c.isDefined),e=function(a){return null!=a&&"function"!=typeof a&&a};n.forEach(b,function(a){var c=e(a.attributeField),b=e(a.attributeField2);a=e(a.attributeField3);!1!==c&&d.push(c);!1!==b&&d.push(b);!1!==a&&d.push(a)});this._rendererFields=d}else this._rendererFields=[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._rendererFields),this._collection&&(this._typesDirty=!0))},redraw:function(){this.inherited(arguments);this._trackManager&&this._trackManager.container&&
this._trackManager.container.redraw()},_evalSDRenderer:function(){this.inherited(arguments);var a=this._getRenderer();this._ager=!(!a||!a.observationAger||!a.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(a&&a.trackRenderer)},_setMap:function(a){var c=this.inherited(arguments),b=this._mode,d=this;b&&b.initialize(a);this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase());this._addHandle=
this.on("graphic-node-add",function(a){a=a.graphic.attributes;(a=d._selectedFeatures[a&&a[d.objectIdField]])&&a.attr("data-selected","")});return c},_unsetMap:function(a){var c=this._mode;c&&c.suspend();this._trackManager&&(this._trackManager.destroy(),this._trackManager=null);f.disconnect(this._zoomConnect);f.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},refresh:function(){var a=this._mode;a&&a.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===
this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return n.filter(this._getOutFields(),function(a){return"*"===a||!!this._getField(a)},this)},getField:function(a){return this._getField(a,!0)},getDomain:function(a,c){var b,d,e=c&&c.feature,g=e&&this.typeIdField&&e.attributes&&e.attributes[this.typeIdField];null!=g&&n.some(this.types,function(c){if(c.id==g){if((b=c.domains&&c.domains[a])&&"inherited"===b.type)b=this._getLayerDomain(a),d=!0;return!0}return!1},this);!d&&
!b&&(b=this._getLayerDomain(a));return b},_getLayerDomain:function(a){var c;n.some(this.fields,function(b){b.name===a&&(c=b.domain);return!!c});return c},getType:function(a){var c,b=a&&this.typeIdField&&a.attributes&&a.attributes[this.typeIdField];n.some(this.types,function(a){a.id==b&&(c=a);return!!c});return c},setEditable:function(a){if(!this._collection)return console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service"),this;if(!this.loaded)return this._optEditable=
a,this;var c=this._editable;this._editable=a;this._updateCaps();if(c!==a)this.onCapabilitiesChange();return this},getEditCapabilities:function(a){var c={canCreate:!1,canUpdate:!1,canDelete:!1};if(!this.loaded||!this.isEditable())return c;var b=a&&a.feature;a=a&&a.userId;var d=n.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],k.trim),e=-1<n.indexOf(d,"editing"),g=e&&-1<n.indexOf(d,"create"),c=e&&-1<n.indexOf(d,"update"),d=e&&-1<n.indexOf(d,"delete"),l=this.ownershipBasedAccessControlForFeatures,
h=this.editFieldsInfo,f=h&&h.creatorField,h=h&&h.realm,b=(b=b&&b.attributes)&&f?b[f]:void 0,m=!!this.userIsAdmin,f=!l||m||!(!l.allowOthersToUpdate&&!l.allowUpdateToOthers),l=!l||m||!(!l.allowOthersToDelete&&!l.allowDeleteToOthers);if(m||e&&!g&&!c&&!d)g=c=d=!0;e={canCreate:g,canUpdate:c,canDelete:d};null===b?(e.canUpdate=c&&f,e.canDelete=d&&l):""!==b&&b&&((a=a||this.getUserId())&&h&&(a=a+"@"+h),a.toLowerCase()!==b.toLowerCase()&&(e.canUpdate=c&&f,e.canDelete=d&&l));return e},getUserId:function(){var a;
this.loaded&&(a=this.credential&&this.credential.userId||this.userId||"");return a},setUserIsAdmin:function(a){this.userIsAdmin=a},setEditSummaryCallback:function(a){this.editSummaryCallback=a},getEditSummary:function(a,b,d){d=c.isDefined(d)?d:(new Date).getTime();var e="";d=this.getEditInfo(a,b,d);(b=b&&b.callback||this.editSummaryCallback)&&(d=b(a,d)||"");if(k.isString(d))e=d;else{if(d){a=d.action;b=d.userId;var g=d.timeValue,l=0;a&&l++;b&&l++;c.isDefined(g)&&l++;1<l&&(e=("edit"===a?"edit":"create")+
(b?"User":"")+(c.isDefined(g)?d.displayPattern:""))}e=e&&c.substitute(d,this.i18n.layers.FeatureLayer[e])}return e},getEditInfo:function(a,b,d){if(this.loaded){d=c.isDefined(d)?d:(new Date).getTime();b=b&&b.action||"last";var e=this.editFieldsInfo,g=e&&e.creatorField,l=e&&e.creationDateField,h=e&&e.editorField,e=e&&e.editDateField,h=(a=a&&a.attributes)&&h?a[h]:void 0,e=a&&e?a[e]:null,g=this._getEditData(a&&g?a[g]:void 0,a&&l?a[l]:null,d);d=this._getEditData(h,e,d);var f;switch(b){case "creation":f=
g;break;case "edit":f=d;break;case "last":f=d||g}f&&(f.action=f===d?"edit":"creation");return f}},_getEditData:function(a,d,e){var g,l,h;c.isDefined(d)&&(l=e-d,h=0>l?"Full":6E4>l?"Seconds":12E4>l?"Minute":36E5>l?"Minutes":72E5>l?"Hour":864E5>l?"Hours":6048E5>l?"WeekDay":"Full");if(void 0!==a||h)g=g||{},g.userId=a,h&&(a=b.format,e=new Date(d),g.minutes=Math.floor(l/6E4),g.hours=Math.floor(l/36E5),g.weekDay=a(e,{datePattern:"EEEE",selector:"date"}),g.formattedDate=a(e,{selector:"date"}),g.formattedTime=
a(e,{selector:"time"}),g.displayPattern=h,g.timeValue=d);return g},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},setMaxAllowableOffset:function(a){this.isEditable()||this._setMaxOffset(a,!0);return this},getMaxAllowableOffset:function(){var a=this._quantizationParameters?this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?this._maxOffset:a},_setMaxOffset:function(a,c){if(null==a)return delete this._maxOffset,delete this._quantizationParameters,this;this.quantize&&
this.supportsCoordinatesQuantization?("esriGeometryPolyline"===this.geometryType?this._maxOffset=a:delete this._maxOffset,this._quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:a,extent:this.fullExtent}):(c||(a=Math.floor(a)),this._maxOffset=a,delete this._quantizationParameters);return this},setAutoGeneralize:function(a){if(this.loaded){if(!this.isEditable()&&this.currentMode!==T.MODE_SNAPSHOT&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||
this.hasXYFootprint()))(this._autoGeneralize=a)?(a=this._map)&&a.loaded&&this._setMaxOffset(a.extent.getWidth()/a.width):this._setMaxOffset(null)}else this._optAutoGen=a;return this},setGDBVersion:function(a){if(!this._collection&&a!==this.gdbVersion&&(a||this.gdbVersion))this.gdbVersion=a,this._task.gdbVersion=a,this._url.query=k.mixin(this._url.query,{gdbVersion:a}),this.loaded&&(this.clearSelection(),this._map&&this.refresh()),this.onGDBVersionChange();return this},setDefinitionExpression:function(a){this._defnExpr=
a;(a=this._mode)&&a.propertyChangeHandler(1);return this},getDefinitionExpression:function(){return this._defnExpr},setTimeDefinition:function(a){this._isSnapshot?(this._timeDefn=a,(a=this._mode)&&a.propertyChangeHandler(2)):console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id \x3d "+this.id+", Layer URL \x3d "+this.url);return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(a,c){this._timeOffset=
a;this._timeOffsetUnits=c;var b=this._mode;b&&b.propertyChangeHandler(0);return this},setUseMapTime:function(a){this.useMapTime=a;this._toggleTime(!this.suspended);(a=this._mode)&&a.propertyChangeHandler(0)},selectFeatures:function(a,c,b,d){c=c||T.SELECTION_NEW;a=this._getShallowClone(a);var e=this._map,g,l=this,h=v._fixDfd(new t(v._dfdCanceller));a.outFields=this.getOutFields();a.returnGeometry=!0;a.multipatchOption=this.multipatchOption;e&&(a.outSpatialReference=new x(e.spatialReference.toJson()));
if(!this._applyQueryFilters(a,!0))return g={features:[]},this._selectHandler(g,c,b,d,h),h;if(e=this._canDoClientSideQuery(a))h._pendingDfd=m(this._doQuery(a,e)),h._pendingDfd.then(function(a){g={features:a};l._selectHandler(g,c,b,d,h)});else{if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,d,h,!0),h;var f=this;this._ts&&(a._ts=(new Date).getTime());(h._pendingDfd=this._task.execute(a)).addCallbacks(function(a){f._selectHandler(a,c,b,d,h)},
function(a){f._resolve([a],null,d,h,!0)})}return h},getSelectedFeatures:function(){var a=this._selectedFeatures,c=[],b;for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c},clearSelection:function(a){var c=this._selectedFeatures,b=this._mode,d;for(d in c)c.hasOwnProperty(d)&&(this._unSelectFeatureIIf(d,b),b._removeFeatureIIf(d));this._selectedFeatures={};this._isSelOnly&&b._applyTimeFilter(!0);if(!a)this.onSelectionClear();return this},setSelectionSymbol:function(a){if(this._selectionSymbol=a){var c=
this._selectedFeatures,b;for(b in c)c.hasOwnProperty(b)&&c[b].setSymbol(a)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this.onLabelingInfoChange()},_fixLabelExpr:function(){var a=/\[([^\[\]]+)\]/ig,c,b=this,d=function(a,c){var d=b._getField(c,!0);return"["+(d&&d.name||c)+"]"};n.forEach(this.labelingInfo,function(b){if(c=b.labelExpression)b.labelExpression=
c.replace(a,d)})},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(a,c,b,d,e,g){var h=g.assembly,f=g.dfd;this._applyNormalized(a,h&&h[0]);this._applyNormalized(c,h&&h[1]);this.onBeforeApplyEdits(a,c,b);var m={},p=this.objectIdField,h={f:"json"},s=!1;if(this._collection)g={},g.addResults=a?n.map(a,function(){s=!0;return{objectId:this._nextId++,success:!0}},this):null,g.updateResults=c?n.map(c,function(a){s=!0;var c=a.attributes[p];m[c]=a;return{objectId:c,success:!0}},this):
null,g.deleteResults=b?n.map(b,function(a){s=!0;return{objectId:a.attributes[p],success:!0}},this):null,s?this._editHandler(g,a,m,d,e,f):this._resolve([g.addResults,g.updateResults,g.deleteResults],null,d,f);else{a&&0<a.length&&(h.adds=this._convertFeaturesToJson(a,0,1),s=!0);if(c&&0<c.length){for(g=0;g<c.length;g++){var u=c[g];m[u.attributes[p]]=u}h.updates=this._convertFeaturesToJson(c,0,0,1);s=!0}if(b&&0<b.length){c=[];for(g=0;g<b.length;g++)c.push(b[g].attributes[p]);h.deletes=c.join(",");s=!0}if(s){var v=
this;return l({url:this._url.path+"/applyEdits",content:k.mixin(h,this._url.query),callbackParamName:"callback",load:function(c){v._editHandler(c,a,m,d,e,f)},error:function(a){v._resolve([a],null,e,f,!0)}},{usePost:!0})}this._resolve([],null,d,f)}},queryFeatures:function(a,c,b){return this._query("execute","onQueryFeaturesComplete",a,c,b)},queryRelatedFeatures:function(a,c,b){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",a,c,b)},queryIds:function(a,c,b){return this._query("executeForIds",
"onQueryIdsComplete",a,c,b)},queryCount:function(a,c,b){return this._query("executeForCount","onQueryCountComplete",a,c,b)},queryExtent:function(a,c,b){return this._query("executeForExtent","onQueryExtentComplete",a,c,b)},queryAttachmentInfos:function(a,c,b){var e=this._url.path+"/"+a+"/attachments",g=new t(v._dfdCanceller),h=this;g._pendingDfd=l({url:e,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(b){b=b.attachmentInfos;var l;n.forEach(b,function(c){l=d.objectToQuery({gdbVersion:h._url.query&&
h._url.query.gdbVersion,layer:h._url.query&&h._url.query.layer,token:h._getToken()});c.url=e+"/"+c.id+(l?"?"+l:"");c.objectId=a});h._resolve([b],"onQueryAttachmentInfosComplete",c,g)},error:function(a){h._resolve([a],null,b,g,!0)}});return g},addAttachment:function(a,c,b,d){return this._sendAttachment("add",a,c,b,d)},updateAttachment:function(a,c,b,d,e){b.appendChild(h.create("input",{type:"hidden",name:"attachmentId",value:c}));return this._sendAttachment("update",a,b,d,e)},deleteAttachments:function(a,
c,b,d){var e=this._url.path+"/"+a+"/deleteAttachments",g=new t(v._dfdCanceller),h=this;c={f:"json",attachmentIds:c.join(",")};g._pendingDfd=l({url:e,content:k.mixin(c,this._url.query),callbackParamName:"callback",load:k.hitch(this,function(c){c=c.deleteAttachmentResults;c=n.map(c,function(c){c=new S(c);c.attachmentId=c.objectId;c.objectId=a;return c});h._resolve([c],"onDeleteAttachmentsComplete",b,g)}),error:function(a){h._resolve([a],null,d,g,!0)}},{usePost:!0});return g},addType:function(a){var c=
this.types;if(c){if(n.some(c,function(c){return c.id==a.id?!0:!1}))return!1;c.push(a)}else this.types=[a];return this._typesDirty=!0},deleteType:function(a){if(this._collection){var c=this.types;if(c){var b=-1;n.some(c,function(c,d){return c.id==a?(b=d,!0):!1});if(-1<b)return this._typesDirty=!0,c.splice(b,1)[0]}}},toJson:function(){var a=this._json;if(a=k.isString(a)?r.fromJson(a):k.clone(a)){var a=a.layerDefinition?a:{layerDefinition:a},c=a.layerDefinition,b=this._collection;if(b&&this._typesDirty){c.types=
n.map(this.types||[],function(a){return a.toJson()});var d=this.renderer,e=this.labelingInfo,g=c.drawingInfo;if((d||e)&&!g)g=c.drawingInfo={};g&&(d&&-1===d.declaredClass.indexOf("TemporalRenderer"))&&(g.renderer=d.toJson());e&&(g.labelingInfo=n.map(e,function(a){return a.toJson()}))}d=null;if(!b||this._fcAdded)d={geometryType:c.geometryType,features:this._convertFeaturesToJson(this.graphics,!0)};a.featureSet=k.mixin({},a.featureSet||{},d);a.featureSet.transform&&(e=a.featureSet.transform,delete a.featureSet.transform,
d=new I(a.featureSet),d.quantize(e),a.featureSet=d.toJson());b&&(a.nextObjectId=this._nextId,c.capabilities=this.capabilities);return a}},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},
onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},_forceIdentity:function(a){var c=this,b=this._url&&this._url.path;(this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&b&&p.id&&p.id._hasPortalSession()&&p.id._doPortalSignIn(b)?p.id.getCredential(b).then(function(){c._findCredential();a.call(c)},function(){a.call(c)}):
a.call(this)},_checkMode:function(a){var c=this.geometryType,b=this.maxRecordCount;a=(a=a&&a.features&&a.features[0])&&a.attributes&&a.attributes.exceedslimit;if(this.mode===T.MODE_AUTO&&!this.isEditable()&&0===a&&(this.queryPagination||("esriGeometryPolyline"===c||"esriGeometryPolygon"===c||"esriGeometryMultipoint"===c||this.hasXYFootprint())&&b>=this.maxRecordCountForAuto||"esriGeometryPoint"===c&&b>=this.maxPointCountForAuto))this.currentMode=T.MODE_SNAPSHOT,this._mode=new O(this),this._isSnapshot=
!0,this._autoGeneralize=!1},_queryLimit:function(){var a=this,c=new t;this._limitPromise=c.promise;setTimeout(function(){var b=new H,d=new L;d.statisticType="exceedslimit";d.maxPointCount=a.maxPointCountForAuto;d.maxRecordCount=a.maxRecordCountForAuto;d.maxVertexCount=a.maxVertexCountForAuto;d.outStatisticFieldName="exceedslimit";b.outStatistics=[d];a.queryFeatures(b).promise.then(function(a){c.resolve(a)},function(a){c.reject(a)})},0)},_updateCaps:function(){var a=this._editable,c=k.trim(this.capabilities||
""),b=n.map(c?c.split(","):[],k.trim),d=n.map(c?c.toLowerCase().split(","):[],k.trim),c=n.indexOf(d,"editing"),e,d={Create:n.indexOf(d,"create"),Update:n.indexOf(d,"update"),Delete:n.indexOf(d,"delete")};if(a&&-1===c)b.push("Editing");else if(!a&&-1<c){a=[c];for(e in d)-1<d[e]&&a.push(d[e]);a.sort();for(e=a.length-1;0<=e;e--)b.splice(a[e],1)}this.capabilities=b.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);
var a=this._mode;a&&a.suspend()},onResume:function(a){this.inherited(arguments);this._toggleTime(!0);this._updateMaxOffset();var c=this._mode,b=this._map,d=this._getRenderer();if(a.firstOccurrence){this._fixRendererFields();this._checkFields();this.clearSelection();if(this.timeInfo&&!this._trackManager&&(this._trackIdField||d&&(d.latestObservationRenderer||d.trackRenderer)))this._trackManager=new Y(this),this._trackManager.initialize(b);d&&("colors"in d&&"blurRadius"in d&&"maxPixelIntensity"in d)&&
("esriGeometryPoint"==this.geometryType&&!this._heatmapManager)&&(this._heatmapManager=new Z(this),this._heatmapManager.initialize(b));if(this.mode===T.MODE_AUTO&&this.currentMode===T.MODE_SNAPSHOT&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint())&&!this.getMaxAllowableOffset())d=this.generalizeForScale,d=this.maxScale?this.maxScale:this.minScale?Math.min(d,this.minScale):Math.min(d,M.getScale(b,this.initialExtent)),this.isEditable()||
this._setMaxOffset(b.extent.getWidth()/b.width/b.getScale()*d,!0);this._zoomConnect=f.connect(b,"onZoomEnd",this,this._updateMaxOffset)}c&&(a.firstOccurrence?c.startup():c.resume())},_updateMaxOffset:function(){var a=this._map;a&&a.loaded&&this._autoGeneralize&&this._setMaxOffset(a.extent.getWidth()/a.width)},_toggleTime:function(a){var c=this._map;a&&this.timeInfo&&this.useMapTime&&c?(this._mapTimeExtent=c.timeExtent,this._timeConnect||(this._timeConnect=f.connect(c,"onTimeExtentChange",this,this._timeChangeHandler))):
(this._mapTimeExtent=null,f.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(a){this._mapTimeExtent=a;(a=this._mode)&&a.propertyChangeHandler(0)},_getOffsettedTE:function(a){var c=this._timeOffset,b=this._timeOffsetUnits;return a&&c&&b?a.offset(-1*c,b):a},_getTimeOverlap:function(a,c){return a&&c?a.intersection(c):a||c},_getTimeFilter:function(a){var c=this.getTimeDefinition(),b;if(c&&(b=this._getTimeOverlap(c,null),!b))return[!1];if(a){if(a=b?this._getTimeOverlap(a,
b):a,!a)return[!1]}else a=b;return[!0,a]},_getAttributeFilter:function(a){var c=this.getDefinitionExpression();return a?c?"("+c+") AND ("+a+")":a:c},_applyQueryFilters:function(a,c){a.where=this._getAttributeFilter(a.where);a.maxAllowableOffset||(a.maxAllowableOffset=this._maxOffset);a.quantizationParameters=this._quantizationParameters;c&&this.supportsAdvancedQueries&&(a.orderByFields=a.orderByFields||this.getOrderByFields());if(this.timeInfo){var b=this._getTimeFilter(a.timeExtent);if(b[0])a.timeExtent=
b[1];else return!1}return!0},_add:function(a){var c=this._selectionSymbol,b=a.attributes,d=this.visibilityField;c&&this._isSelOnly&&a.setSymbol(c);if(d&&b&&b.hasOwnProperty(d))a[b[d]?"show":"hide"]();return this.add.apply(this,arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(a){var c=[],b=this._map;if(!(this._isTable||!b&&!this._collection))if(!a.text&&!(a.where&&a.where!==this.getDefinitionExpression()||a.orderByFields&&a.orderByFields.length||
a.outStatistics||a.returnDistinctValues)){var d=this._isSnapshot,e=this._isSelOnly,g=a.geometry;if(g)if(!e&&a.spatialRelationship===H.SPATIAL_REL_INTERSECTS&&"extent"===g.type&&(d||b.extent.contains(g)))c.push(1);else return;if(b=a.objectIds)if(d)c.push(2);else{var g=b.length,l=this._mode,h=0,f;for(f=0;f<g;f++)l._getFeature(b[f])&&h++;if(h===g)c.push(2);else return}if(this.timeInfo)if(a=a.timeExtent,b=this._mapTimeExtent,d)a&&c.push(3);else if(e){if(a)return}else if(b)if(-1!==n.indexOf(c,2))a&&c.push(3);
else if(-1!==n.indexOf(c,1))a==b&&c.push(3);else return;else if(0<c.length)a&&c.push(3);else if(a)return;return 0<c.length?c:null}},_getAbsMid:function(a){return q.toAbsMid?q.toAbsMid(a):e.id.replace(/\/[^\/]*$/ig,"/")+a},_doQuery:function(a,c,b){var d=[],e=this.objectIdField,g=this,l=new t,h=new t,f=this.graphics;if(-1!==n.indexOf(c,1)){var m=this.spatialIndex||this._map&&this._map.spatialIndex,p,s=a.geometry._normalize(null,!0);null==m&&$.autoSpatialIndexing?p=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(k.hitch(this,
k.partial(this._getFromIndex,s,m)),function(a){h.resolve(k.hitch(this,k.partial(this._filterByExtent,f,s)))}):m&&(p=this._getFromIndex(s,m));p?p.then(function(a){for(var c=0;c<a.length;c++)a[c].results&&(d=d.concat(a[c].results));h.resolve(d)}).otherwise(function(a){h.reject(a)}):h.resolve(this._filterByExtent(f,s))}else h.resolve(f);h.then(function(h){d=h;if(-1!==n.indexOf(c,2)){var f=a.objectIds;d=n.filter(d,function(a){return-1<n.indexOf(f,a.attributes[e])})}-1!==n.indexOf(c,3)&&g.timeInfo&&(h=
a.timeExtent,d=g._filterByTime(d,h.startTime,h.endTime).match);b&&(d=n.map(d,function(a){return a.attributes[e]},this));l.resolve(d)});return l},_getFromIndex:function(a,c){c=c||this.spatialIndex||this._map.spatialIndex;a instanceof Array||(a=[a]);var b=this.id;return s(n.map(a,function(a){return c.intersects(a,b)}))},_filterByExtent:function(a,c){for(var b=[],d=0,e=a.length;d<e;d++){var g=a[d],l=g.geometry;l&&(this.normalization&&c.length?(c[0].intersects(l)||c[1].intersects(l))&&b.push(g):c.intersects(l)&&
b.push(g))}return b},_filterByTime:function(a,b,d){var e=this._startTimeField,g=this._endTimeField,l;this._twoTimeFields||(l=e||g);var h=c.isDefined,f=[],m=[],p,s=a.length,k,u;b=b?b.getTime():-Infinity;d=d?d.getTime():Infinity;if(l)for(p=0;p<s;p++)k=a[p],u=k.attributes,e=u[l],e>=b&&e<=d?f.push(k):m.push(k);else for(p=0;p<s;p++)k=a[p],u=k.attributes,l=u[e],u=u[g],l=h(l)?l:-Infinity,u=h(u)?u:Infinity,l>=b&&l<=d||u>=b&&u<=d||b>=l&&d<=u?f.push(k):m.push(k);return{match:f,noMatch:m}},_resolve:function(a,
c,b,d,e){c&&this[c].apply(this,a);b&&b.apply(null,a);d&&v._resDfd(d,a,e)},_getShallowClone:function(a){var c=new H,b;for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c},_query:function(a,c,b,d,e){var g=this,l=this._map,h=new t(v._dfdCanceller),f=b,p=function(b,e){if(!e&&("execute"===a||"executeRelationshipQuery"===a)){var l,f;if("execute"===a){l=b.features;f=l.length;for(f-=1;0<=f;f--)if(l[f]._layer=g,!g._isTable){var m=g._mode._getFeature(l[f].attributes[g.objectIdField]);m&&l.splice(f,1,m)}}else for(m in b)if(b.hasOwnProperty(m)){l=
b[m].features;f=l.length;for(f-=1;0<=f;f--)l[f]._layer=g}}g._resolve([b],c,d,h)};if("executeRelationshipQuery"!==a){f=this._getShallowClone(b);f.outFields||(f.outFields=this.getOutFields());f.returnGeometry=b.hasOwnProperty("returnGeometry")?b.returnGeometry:!b.outStatistics;f.returnGeometry&&(f.multipatchOption=this.multipatchOption);var s;l&&(f.outSpatialReference=new x(l.spatialReference.toJson()));if(!this._applyQueryFilters(f,"execute"===a&&!f.outStatistics)){switch(a){case "execute":s=new I({features:[]});
break;case "executeForIds":s=[];break;case "executeForCount":s=0;break;case "executeForExtent":s={}}p(s,!0);return h}if(b="executeForExtent"!==a&&this._canDoClientSideQuery(f))return h._pendingDfd=m(this._doQuery(f,b,"executeForIds"===a||"executeForCount"===a)),h._pendingDfd.then(function(c){switch(a){case "execute":s=new I;s.features=c;break;case "executeForIds":s=c;break;case "executeForCount":s=c.length}p(s,!0)}),h}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+this.invalidParams)],
null,e,h,!0),h;this._ts&&(f._ts=(new Date).getTime());(h._pendingDfd=this._task[a](f)).addCallbacks(function(a){p(a,!!f.outStatistics)},function(a){g._resolve([a],null,e,h,!0)});return h},_convertFeaturesToJson:function(a,c,b,d){var e=[],g=this._selectionSymbol,l=this.visibilityField,h,f=this.objectIdField;if(this.loaded&&(b||d))h=n.filter(this.fields,function(a){return!1===a.editable&&(!d||a.name!==f)});for(b=0;b<a.length;b++){var m=a[b],p={},s=m.geometry,u=m.attributes,v=m.symbol;if(s&&(!d||!this.loaded||
this.allowGeometryUpdates))p.geometry=s.toJson();l?(p.attributes=u=k.mixin({},u),u[l]=m.visible?1:0):u&&(p.attributes=k.mixin({},u));p.attributes&&(h&&h.length)&&n.forEach(h,function(a){delete p.attributes[a.name]});v&&v!==g&&(p.symbol=v.toJson());e.push(p)}return c?e:r.toJson(e)},_selectHandler:function(a,c,b,d,e){var g;d=T;switch(c){case d.SELECTION_NEW:this.clearSelection(!0);g=!0;break;case d.SELECTION_ADD:g=!0;break;case d.SELECTION_SUBTRACT:g=!1}d=a.features;var l=this._mode,h=[],f=this.objectIdField,
m,p;if(g)for(g=0;g<d.length;g++)m=d[g],p=m.attributes[f],m=l._addFeatureIIf(p,m),h.push(m),this._selectFeatureIIf(p,m,l);else for(g=0;g<d.length;g++)m=d[g],p=m.attributes[f],this._unSelectFeatureIIf(p,l),p=l._removeFeatureIIf(p),h.push(p||m);this._isSelOnly&&l._applyTimeFilter(!0);this._resolve([h,c,a.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",b,e);if(a.exceededTransferLimit)this.onQueryLimitExceeded()},_selectFeatureIIf:function(a,c,b){var d=this._selectedFeatures,
e=d[a];e||(b._incRefCount(a),d[a]=c,this._isTable||(this._setSelectSymbol(c),c.attr("data-selected","")));return e||c},_unSelectFeatureIIf:function(a,c){var b=this._selectedFeatures[a];b&&(c._decRefCount(a),delete this._selectedFeatures[a],this._isTable||(this._setUnSelectSymbol(b),b.attr("data-selected")));return b},_isSelected:function(a){},_setSelectSymbol:function(a){var c=this._selectionSymbol;c&&!this._isSelOnly&&a.setSymbol(c)},_setUnSelectSymbol:function(a){var c=this._selectionSymbol;c&&
!this._isSelOnly&&c===a.symbol&&a.setSymbol(null,!0)},_getOutFields:function(){var a=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields).concat(this.dataAttributes),a=n.filter(a,function(a,c,b){return!!a&&n.indexOf(b,a)===c}),c=k.clone(this._outFields);if(c){if(-1!==n.indexOf(c,"*"))return c;n.forEach(a,function(a){-1===n.indexOf(c,a)&&c.push(a)});return c}return a},_checkFields:function(a){var b=a||this._getOutFields();
n.forEach(b,function(a){"*"!==a&&(this._getField(a)||console.debug("esri.layers.FeatureLayer: "+c.substitute({url:this.url,field:a},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]")))},this);!a&&(!this._isTable&&!this._fserver&&!this._collection&&!this._isStream)&&(n.some(this.fields,function(a){return a&&"esriFieldTypeGeometry"===a.type?!0:!1})||console.debug("esri.layers.FeatureLayer: "+c.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]")))},
_fixFieldCase:function(a,c,b){var d=a&&a[c],e;if(d&&!k.isFunction(d)){if(e=!this._getField(d)&&this._getField(d,!0))d=a[c]=e.name;b&&b.push(d)}return d},_fixRendererFields:function(){var a=this.renderer;this._orderBy=null;if(a&&0<this.fields.length){var b=[],d,a=n.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],c.isDefined),e=[].concat(a);n.forEach(a,function(a){n.forEach(a.rendererInfos,function(a){a.renderer&&e.push(a.renderer)})});n.forEach(e,function(a){this._fixFieldCase(a,
"attributeField",b);this._fixFieldCase(a,"attributeField2",b);this._fixFieldCase(a,"attributeField3",b);this._fixFieldCase(a.rotationInfo,"field",b);if((d=this._fixFieldCase(a.sizeInfo,"field",b))&&!this._orderBy)this._orderBy=[d+" DESC"];this._fixFieldCase(a.sizeInfo,"normalizationField",b);this._fixFieldCase(a.colorInfo,"field",b);this._fixFieldCase(a.colorInfo,"normalizationField",b);this._fixFieldCase(a.field,"field",b);this._fixFieldCase(a.opacityInfo,"field",b);this._fixFieldCase(a.opacityInfo,
"normalizationField",b);n.forEach(a.visualVariables,function(a){d=this._fixFieldCase(a,"field",b);"sizeInfo"===a.type&&(d&&!this._orderBy)&&(this._orderBy=[d+" DESC"]);this._fixFieldCase(a,"normalizationField",b)},this);if(!this._orderBy&&a.addBreak&&!k.isFunction(a.attributeField)&&(a.backgroundFillSymbol||this._hasSizeDiff(a)))this._orderBy=[a.attributeField+" DESC"]},this);this._rendererFields=n.filter(b,c.isDefined)}},_hasSizeDiff:function(a){var c=Number.MAX_VALUE,b=-Number.MAX_VALUE,d,e;n.forEach(a.infos,
function(a){if(e=a.symbol){d=0;switch(e.type){case "simplemarkersymbol":d=e.size;break;case "picturemarkersymbol":d=(e.width+e.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":d=e.width;break;case "simplefillsymbol":case "picturefillsymbol":d=e.outline&&e.outline.width}d&&(c=Math.min(c,d),b=Math.max(b,d))}});return c!==Number.MAX_VALUE&&b!==-Number.MAX_VALUE&&1<Math.abs(b-c)},getOrderByFields:function(){var a=this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&
a?n.filter(a,function(a){a=a.split(" ")[0];return!!this._getField(a,!0)},this):null},_getField:function(a,c){var b=this.fields;if(!b||0===b.length)return null;var d;c&&(a=a.toLowerCase());n.some(b,function(b){var e=!1;(e=c?b&&b.name.toLowerCase()===a?!0:!1:b&&b.name===a?!0:!1)&&(d=b);return e});return d},_getDateOpts:function(){this._dtOpts||(this._dtOpts={properties:n.map(n.filter(this.fields,function(a){return!!(a&&"esriFieldTypeDate"===a.type)}),function(a){return a.name})});return this._dtOpts},
_applyNormalized:function(a,c){a&&c&&n.forEach(a,function(a,b){a&&c[b]&&a.setGeometry(c[b])})},_editHandler:function(a,c,b,d,e,g){e=a.addResults;var l=a.updateResults;a=a.deleteResults;var h,f,m,p,s=this.objectIdField,k=this._mode,u=this._isTable;h=this.editFieldsInfo;var v=this.getOutFields()||[],r=h&&h.creatorField,w=h&&h.creationDateField,t=h&&h.editorField,y=h&&h.editDateField;h=h&&h.realm;-1===n.indexOf(v,"*")&&(r&&-1===n.indexOf(v,r)&&(r=null),w&&-1===n.indexOf(v,w)&&(w=null),t&&-1===n.indexOf(v,
t)&&(t=null),y&&-1===n.indexOf(v,y)&&(y=null));var v=w||y?(new Date).getTime():null,q=r||t?this.getUserId():void 0;q&&h&&(q=q+"@"+h);if(e)for(h=0;h<e.length;h++)e[h]=new S(e[h]),u||(f=e[h],f.success&&(f=f.objectId,m=c[h],(p=m._graphicsLayer)&&p!==this&&p.remove(m),p=m.attributes||{},p[s]=f,r&&(p[r]=q),t&&(p[t]=q),w&&(p[w]=v),y&&(p[y]=v),m.setAttributes(p),k._init&&k.drawFeature(m)));if(l)for(h=0;h<l.length;h++)if(l[h]=new S(l[h]),!u&&(f=l[h],f.success)){f=f.objectId;m=b[f];if(c=k._getFeature(f))c.geometry!==
m.geometry&&c.setGeometry(F.fromJson(m.geometry.toJson())),this._repaint(c,f);m=c||m;p=m.attributes||{};t&&(p[t]=q);y&&(p[y]=v);m.setAttributes(p)}if(a){b=[];for(h=0;h<a.length;h++)if(a[h]=new S(a[h]),!u&&(f=a[h],f.success&&(f=f.objectId,m=k._getFeature(f))))this._unSelectFeatureIIf(f,k)&&b.push(m),m._count=0,k._removeFeatureIIf(f);if(0<b.length)this.onSelectionComplete(b,T.SELECTION_SUBTRACT)}this._resolve([e,l,a],"onEditsComplete",d,g)},_sendAttachment:function(a,c,b,d,e){var g=this;return l({url:this._url.path+
"/"+c+"/"+("add"===a?"addAttachment":"updateAttachment"),form:b,content:k.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(b){var e="add"===a?"onAddAttachmentComplete":"onUpdateAttachmentComplete";b=new S(b["add"===a?"addAttachmentResult":"updateAttachmentResult"]);b.attachmentId=b.objectId;b.objectId=c;g._resolve([b],e,d);return b}).addErrback(function(a){g._resolve([a],null,e,null,!0)})},_repaint:function(a,
b,d){b=c.isDefined(b)?b:a.attributes[this.objectIdField];(!(b in this._selectedFeatures)||!this._selectionSymbol)&&a.setSymbol(a.symbol,d)},_getKind:function(a){var c=this._trackManager;return c?c.isLatestObservation(a)?1:0:0}});k.mixin(T,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});
N._createWrappers(T);return T})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./RangeDomain ./CodedValueDomain".split(" "),function(q,e,a,f,k,n){return q(null,{declaredClass:"esri.layers.Field",constructor:function(a){if(a&&e.isObject(a)&&(this.name=a.name,this.type=a.type,this.alias=a.alias,this.length=a.length,this.editable=a.editable,this.nullable=a.nullable,(a=a.domain)&&e.isObject(a)))switch(a.type){case "range":this.domain=new k(a);break;case "codedValue":this.domain=
new n(a)}}})})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(q,e,a,f,k,n){return q([n],{declaredClass:"esri.layers.RangeDomain",constructor:function(a){a&&e.isObject(a)&&(this.minValue=a.range[0],this.maxValue=a.range[1])},toJson:function(){var a=this.inherited(arguments);a.range=[this.minValue,this.maxValue];return k.fixJson(a)}})})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel","../lang"],function(q,e,a,f,k){return q(null,{declaredClass:"esri.layers.Domain",constructor:function(a){a&&e.isObject(a)&&(this.name=a.name,this.type=a.type)},toJson:function(){return k.fixJson({name:this.name,type:this.type})}})})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),function(q,e,a,f,k,n,r){return q([r],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(a){a&&
e.isObject(a)&&(this.codedValues=a.codedValues)},getName:function(e){var b;a.some(this.codedValues,function(a){a.code==e&&(b=a.name);return!!b});return b},toJson:function(){var a=this.inherited(arguments);a.codedValues=e.clone(this.codedValues);return n.fixJson(a)}})})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(q,
e,a,f,k,n,r,t,b,g,d){return q(null,{declaredClass:"esri.layers.FeatureType",constructor:function(a){if(a&&e.isObject(a)){this.id=a.id;this.name=a.name;var f=a.symbol;f&&(this.symbol=r.fromJson(f));var f=a.domains,m,s=this.domains={};for(m in f)if(f.hasOwnProperty(m)){var p=f[m];switch(p.type){case "range":s[m]=new t(p);break;case "codedValue":s[m]=new b(p);break;case "inherited":s[m]=new g(p)}}if(m=a.templates){f=this.templates=[];for(a=0;a<m.length;a++)f.push(new d(m[a]))}}},toJson:function(){var b=
{id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},d,e=this.domains,g=this.templates,f=n.fixJson;if(e){var c=b.domains={};for(d in e)e.hasOwnProperty(d)&&(c[d]=e[d]&&e[d].toJson());f(c)}g&&(b.templates=a.map(g,function(a){return a.toJson()}));return f(b)}})})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(q,e,a,f,k){return q([k],{declaredClass:"esri.layers.InheritedDomain"})})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),
function(q,e,a,f,k,n){q=q(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(a){a&&e.isObject(a)&&(this.name=a.name,this.description=a.description,this.drawingTool=a.drawingTool,a=a.prototype,this.prototype=new n(a.geometry,null,a.attributes))},toJson:function(){return k.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()})}});e.mixin(q,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",
TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",
TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});return q})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(q,e,a,f){return q(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(a){a&&e.isObject(a)&&(this.objectId=a.objectId,this.success=a.success,a.success||(a=a.error,this.error=Error(),this.error.code=a.code,this.error.message=a.description))}})})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),
function(q,e,a,f,k,n,r,t){return q(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter","below-left":"esriServerPointLabelPlacementBelowLeft",
"below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd","below-after":"esriServerLinePlacementBelowAfter",
"below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd","always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},
constructor:function(a){if(a&&(e.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=n.valueOf(this._labelPlacementLookup,a.labelPlacement)),a.symbol&&(this.symbol="esriSHD"===a.symbol.type?new t(a.symbol):new r(a.symbol)),a=this.sizeInfo))a.minSize&&(a.minSize=f.pt2px(a.minSize)),a.maxSize&&(a.maxSize=f.pt2px(a.maxSize))},getSymbol:function(){return this.symbol},toJson:function(){var a=this.sizeInfo;a&&(a=e.mixin({},a),a.minSize&&(a.minSize=f.px2pt(a.minSize)),
a.maxSize&&(a.maxSize=f.px2pt(a.maxSize)));a={labelExpression:this.labelExpression,labelExpressionInfo:this.labelExpressionInfo&&e.clone(this.labelExpressionInfo),useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,where:this.where,sizeInfo:a,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return n.fixJson(a)}})})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),
function(q,e,a,f,k,n,r,t,b){var g={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};q=q(t,{declaredClass:"esri.symbol.ShieldLabelSymbol",type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:f.defaultFont,constructor:function(b,h,k,m,s){b?e.isString(b)?(this.url=b,h&&(this.color=h),k&&(this.width=k),m&&(this.height=m),void 0!==s&&(this.font=s)):(this.width=f.pt2px(b.width),this.height=f.pt2px(b.height),h=b.imageData,!(9>a("ie"))&&h&&(k=this.url,this.url="data:"+(b.contentType||
"image")+";base64,"+h,this.imageData=k)):e.mixin(this,g)},getStroke:function(){return null},getFill:function(){return this.color},setWidth:function(a){this.width=a;return this},setHeight:function(a){this.height=a;return this},setUrl:function(a){a!==this.url&&(delete this.imageData,delete this.contentType);this.url=a;return this},setFont:function(a){this.font=a;return this},setText:function(a){this.text=a;return this},getWidth:function(){return this.width},getHeight:function(){return this.height},
getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var a=this.url,g=this.imageData;if(0===a.indexOf("data:"))var k=a,a=g,g=k.indexOf(";base64,")+8,g=k.substr(g);var a=r.getAbsoluteUrl(a),k=f.px2pt(this.width),k=isNaN(k)?void 0:k,m=f.px2pt(this.height),m=isNaN(m)?void 0:m,a=n.fixJson(e.mixin(this.inherited("toJson",arguments),{type:"esriSHD",
url:a,imageData:g,contentType:this.contentType,width:k,height:m}));this.font?(g=new b(this.font),a.font=g.toJson()):a.font=null;delete a.size;a.imageData||delete a.imageData;return a}});q.defaultProps=g;return q})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../tasks/query ./RenderMode".split(" "),function(q,e,a,f,k,n,r){return q([r],{declaredClass:"esri.layers._SnapshotMode",constructor:function(a){this.featureLayer=a;this.pagination=
a.queryPagination;this._featureMap={};this._drawFeatures=e.hitch(this,this._drawFeatures);this._queryErrorHandler=e.hitch(this,this._queryErrorHandler)},startup:function(){this.pagination=this.pagination&&null!=this.featureLayer.maxRecordCount;this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},propertyChangeHandler:function(a){this._init&&(a?this.featureLayer._collection?console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id \x3d "+
this.featureLayer.id):this._fetchAll():this._applyTimeFilter())},drawFeature:function(a){var b=a.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(b,a);this._incRefCount(b)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a._collection?(a._fireUpdateStart(),a._refresh(!0),a._fireUpdateEnd()):this._fetchAll()},_getRequestId:function(a){return("_"+a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchAll:function(){var a=this.featureLayer;
!a._collection&&!a.suspended&&(a._fireUpdateStart(),this._clearIIf(),this._sendRequest())},_sendRequest:function(a){var b=this.map,e=this.featureLayer,d=e.getDefinitionExpression(),h=new n;h.outFields=e.getOutFields();h.where=d||"1\x3d1";h.returnGeometry=!0;h.outSpatialReference=new k(b.spatialReference.toJson());h.timeExtent=e.getTimeDefinition();h.maxAllowableOffset=e._maxOffset;h.quantizationParameters=e._quantizationParameters;e._ts&&(h._ts=(new Date).getTime());h.orderByFields=e.supportsAdvancedQueries?
e.getOrderByFields():null;h.multipatchOption=e.multipatchOption;this.pagination&&(this._start=h.start=null==a?0:a,h.num=e.maxRecordCount);var f;e._usePatch&&(f=this._getRequestId(e),this._cancelPendingRequest(null,f));e._task.execute(h,this._drawFeatures,this._queryErrorHandler,f)},_drawFeatures:function(a){this._purgeRequests();var b=a.features,e=this.featureLayer,d=e.objectIdField,h,f=b.length,m=a.exceededTransferLimit&&!e._collection,s,p;for(h=0;h<f;h++)s=b[h],p=s.attributes[d],this._addFeatureIIf(p,
s),this._incRefCount(p);this._applyTimeFilter(!0);if(!this.pagination||!m)e._fireUpdateEnd(null,a.exceededTransferLimit?{queryLimitExceeded:!0}:null);m&&(this.pagination&&this._sendRequest(this._start+e.maxRecordCount),e.onQueryLimitExceeded())},_queryErrorHandler:function(a){this._purgeRequests();var b=this.featureLayer;b._errorHandler(a);b._fireUpdateEnd(a)}})})},"esri/layers/RenderMode":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/io/script ../kernel".split(" "),
function(q,e,a,f,k,n,r){return e(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(q._scopeName||"dojo")+"IoScript"},initialize:function(a){this.map=a;this._init=!0},startup:function(){},propertyChangeHandler:function(a){},destroy:function(){this._init=!1},drawFeature:function(a){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(a){(a=this._featureMap[a])&&a._count++},_decRefCount:function(a){(a=this._featureMap[a])&&a._count--},
_getFeature:function(a){return this._featureMap[a]},_addFeatureIIf:function(a,b){var e=this._featureMap,d=e[a],h=this.featureLayer;d||(e[a]=b,h._add(b),b._count=0);return d||b},_removeFeatureIIf:function(a){var b=this._featureMap[a],e=this.featureLayer;if(b){if(b._count)return;delete this._featureMap[a];e._remove(b)}return b},_clearIIf:function(){var a;a=this.featureLayer;var b=a.graphics,e=a._selectedFeatures,d=a.objectIdField;for(a=b.length-1;0<=a;a--){var h=b[a],f=h.attributes[d];f in e?h._count=
1:(h._count=0,this._removeFeatureIIf(f))}},_isPending:function(a){return n[this._prefix+a]?!0:!1},_cancelPendingRequest:function(a,b){if(a=a||n[this._prefix+b])try{a.cancel(),n._validCheck(a)}catch(e){}},_purgeRequests:function(){n._validCheck(null)},_toggleVisibility:function(a){var b=this.featureLayer,e=b.graphics,d=a?"show":"hide",h,f=e.length;a=a&&b._ager;for(h=0;h<f;h++){var m=e[h];m[d]();a&&b._repaint(m)}},_applyTimeFilter:function(a){var b=this.featureLayer;if(b.timeInfo&&!b.suspended){a||
b._fireUpdateStart();var e=b._trackManager;e&&e.clearTracks();var d=b.getTimeDefinition(),h=b._getOffsettedTE(b._mapTimeExtent);h?(h=b._getTimeOverlap(d,h))?(d=b._filterByTime(b.graphics,h.startTime,h.endTime),e&&e.addFeatures(d.match),f.forEach(d.match,function(a){var d=a._shape;a.visible||(a.show(),(d=a._shape)&&d._moveToFront());b._ager&&d&&b._repaint(a)}),f.forEach(d.noMatch,function(a){a.visible&&a.hide()})):this._toggleVisibility(!1):(e&&e.addFeatures(b.graphics),this._toggleVisibility(!0));
e&&(e.moveLatestToFront(),e.drawTracks());a||b._fireUpdateEnd()}}})})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),function(q,e,a,f,k,n,r,t,b,g){return q([b],{declaredClass:"esri.layers._OnDemandMode",constructor:function(b){this.featureLayer=b;this._featureMap={};this._queryErrorHandler=a.hitch(this,this._queryErrorHandler)},initialize:function(a){this.inherited(arguments);
var b=this.featureLayer,e=b._srInfo;this._gridLayer=new g(new r(e?e.valid[0]:a.extent.xmin,a.extent.ymax,a.spatialReference),{width:b._tileWidth,height:b._tileHeight},{width:a.width,height:a.height},e);this._cellMap={};this._gridLayer.setResolution(a.extent)},startup:function(){this._ioQueue=[];this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},propertyChangeHandler:function(a){this._init&&(2>a?this._zoomHandler():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+
this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._disableConnectors();this.inherited(arguments)},drawFeature:function(a){var b=this._gridLayer,e=a.geometry,g=[];if(e)for(var g=b.getCellsInExtent("point"===e.type?{xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y}:e.getExtent(),!1).cells,b=this._cellMap,f,p=a.attributes[this.featureLayer.objectIdField],c,l,k,e=0;e<g.length;e++)f=g[e],c=f.latticeID,l=f.row,k=f.col,c?f=b[c]=b[c]||f:(b[l]=b[l]||{},f=b[l][k]=b[l][k]||f),f.features=
f.features||[],f.features.push(a),this._addFeatureIIf(p,a),this._incRefCount(p)},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},_enableConnectors:function(){var a=this.map;this._zoomConnect=e.connect(a,"onZoomEnd",this,this._zoomHandler);this._panConnect=e.connect(a,"onPanEnd",this,this._panHandler);this._resizeConnect=e.connect(a,"onResize",this,this._panHandler)},_disableConnectors:function(){e.disconnect(this._zoomConnect);
e.disconnect(this._panConnect);e.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var a=this.featureLayer,b=this.map;a.suspended||(a._fireUpdateStart(),this._clearIIf(),(a=a._trackManager)&&a.clearTracks(),this._cellMap={},this._gridLayer.setResolution(b.extent),this._sendRequest())},_panHandler:function(a){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&a)},_getRequestId:function(a,b){return("_"+a.name+a.layerId+a._ulid+"_"+b.resolution+
"_"+(b.latticeID||b.row+"_"+b.col)).replace(/[^a-zA-Z0-9\_]+/g,"_")},_sendRequest:function(a){this._exceeds=!1;var b=this.featureLayer,e=this.map;a=a||e.extent;e=this._gridLayer.getCellsInExtent(a,b.latticeTiling).cells;if(!b.isEditable())var g=this._cellMap,e=f.filter(e,function(a){if(a.lattice){if(g[a.latticeID])return!1}else if(g[a.row]&&g[a.row][a.col])return!1;return!0});var s=b.getOutFields(),p=b.getDefinitionExpression(),c=b._getOffsettedTE(b._mapTimeExtent),l=b.supportsAdvancedQueries?b.getOrderByFields():
null,k=b._usePatch,n=this._ioQueue,r,y=this,q=this._drawFeatures,z,D,E;this._pending=this._pending||0;for(r=0;r<e.length;r++){z=e[r];D=new t;D.geometry=z.extent||z.lattice;D.outFields=s;D.where=p;b.latticeTiling&&z.extent&&(D.spatialRelationship=t.SPATIAL_REL_CONTAINS);D.returnGeometry=!0;D.timeExtent=c;b._ts&&(D._ts=(new Date).getTime());D.orderByFields=l;D.multipatchOption=b.multipatchOption;D.maxAllowableOffset=b._maxOffset;D.quantizationParameters=b._quantizationParameters;E=null;if(k&&(E=this._getRequestId(b,
z),this._isPending(E)))continue;this._pending++;n.push(b._task.execute(D,function(){var a=z;return function(c){q.apply(y,[c,a])}}.call(this),this._queryErrorHandler,E))}this._removeOldCells(a);this._endCheck()},_drawFeatures:function(a,b){this._exceeds=this._exceeds||a.exceededTransferLimit;this._finalizeIO();var e=this.map.extent,g=b.extent,f=b.row,p=b.col,c=this.featureLayer.objectIdField,l=a.features,k=this._gridLayer,n=this._cellMap,r=b.latticeID,t=r?n[r]:n[f]&&n[f][p];if(b.resolution!=k._resolution||
(r?r!==k.getLatticeID(e):!k.intersects(g,e)))t&&this._removeCell(f,p,r);else if(t)this._updateCell(t,l);else{b.features=l;r?n[r]=b:(n[f]=n[f]||{},n[f][p]=b);g=l.length;for(e=0;e<g;e++)f=l[e],p=f.attributes[c],this._addFeatureIIf(p,f),this._incRefCount(p)}this._endCheck()},_queryErrorHandler:function(a){this._finalizeIO();this.featureLayer._errorHandler(a);this._endCheck(!0)},_finalizeIO:function(){this._purgeRequests();this._pending--},_endCheck:function(a){if(0===this._pending){this._processIOQueue();
var b=this.featureLayer,e=b._trackManager;e&&(e.clearTracks(),e.addFeatures(b.graphics),b._ager&&f.forEach(b.graphics,function(a){a._shape&&b._repaint(a)}),e.moveLatestToFront(),e.drawTracks());this.featureLayer._fireUpdateEnd(a&&Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)b.onQueryLimitExceeded()}},_processIOQueue:function(a){this._ioQueue=f.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});a&&f.forEach(this._ioQueue,
this._cancelPendingRequest)},_removeOldCells:function(a){var b=this._cellMap,e=this._gridLayer,g,f;for(g in b)if(b[g]){var p=b[g],c=p.latticeID,l=0,k=0;if(c)l++,c!==e.getLatticeID(a)&&(this._removeCell(null,null,c),k++);else for(f in p)p[f]&&(l++,e.intersects(p[f].extent,a)||(this._removeCell(g,f),k++));k===l&&delete b[g]}},_updateCell:function(a,b){var e=this.featureLayer,g=e.objectIdField,e=e._selectedFeatures,f,p=b.length;a.features=a.features||[];for(f=0;f<p;f++){var c=b[f],l=c.attributes[g],
k=this._addFeatureIIf(l,c);k===c?(this._incRefCount(l),a.features.push(k)):l in e||(k.setGeometry(c.geometry),k.setAttributes(c.attributes))}},_removeCell:function(a,b,e){var g=this._cellMap,f=this.featureLayer,p=f.objectIdField,c=e?g[e]:g[a]&&g[a][b];if(c){e?delete g[e]:delete g[a][b];a=c.features;for(b=0;b<a.length;b++)e=a[b].attributes[p],this._decRefCount(e),e in f._selectedFeatures||this._removeFeatureIIf(e)}}})})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline".split(" "),
function(q,e,a,f,k,n,r,t){return q(null,{declaredClass:"esri.layers._GridLayout",constructor:function(a,e,d,f){this.origin=a;this.cellWidth=e.width;this.cellHeight=e.height;this.mapWidth=d.width;this.mapHeight=d.height;this.srInfo=f},setResolution:function(a){this._resolution=(a.xmax-a.xmin)/this.mapWidth;this.srInfo&&(a=Math.round(2*this.srInfo.valid[1]/this._resolution),a=Math.round(a/this.cellWidth),this._frameStats=[a,0,a-1])},getCellCoordinates:function(a){var e=this._resolution,d=this.origin;
return{row:Math.floor((d.y-a.y)/(this.cellHeight*e)),col:Math.floor((a.x-d.x)/(this.cellWidth*e))}},normalize:function(a){var e=this._frameStats;if(e){var d=e[0],f=e[1],e=e[2];a<f?(a%=d,a=a<f?a+d:a):a>e&&(a%=d)}return a},intersects:function(b,e){var d=this.srInfo;return d?a.some(e._getParts(d),function(a){return b.intersects(a.extent)}):b.intersects(e)},getCellExtent:function(a,e){var d=this._resolution,f=this.origin,k=this.cellWidth,m=this.cellHeight;return new r(e*k*d+f.x,f.y-(a+1)*m*d,(e+1)*k*
d+f.x,f.y-a*m*d,new n(f.spatialReference.toJson()))},getLatticeID:function(a){var e=this.getCellCoordinates({x:a.xmin,y:a.ymax}),d=this.getCellCoordinates({x:a.xmax,y:a.ymin});a=e.row;var f=d.row,e=this.normalize(e.col),d=this.normalize(d.col);return a+"_"+f+"_"+e+"_"+d},sorter:function(a,e){return a<e?-1:1},getCellsInExtent:function(a,e){var d=this.getCellCoordinates({x:a.xmin,y:a.ymax}),f=this.getCellCoordinates({x:a.xmax,y:a.ymin}),k=d.row,m=f.row,d=d.col,f=f.col,s=[],p,c,l,n=[],v=[],r,y,q,z=[];
for(p=k;p<=m;p++)for(c=d;c<=f;c++)l=this.normalize(c),a=this.getCellExtent(p,l),s.push({row:p,col:l,extent:a,resolution:this._resolution}),e&&(n.push(a.xmin,a.xmax),v.push(a.ymin,a.ymax));d=this.normalize(d);f=this.normalize(f);n.sort(this.sorter);v.sort(this.sorter);c=n.length;for(p=c-1;0<=p;p--)p<c-1&&n[p]===n[p+1]&&n.splice(p,1);c=v.length;for(p=c-1;0<=p;p--)p<c-1&&v[p]===v[p+1]&&v.splice(p,1);if(n.length&&v.length){l=n[0];r=n[n.length-1];y=v[0];q=v[v.length-1];c=n.length;for(p=0;p<c;p++)z.push([[n[p],
q],[n[p],y]]);c=v.length;for(p=0;p<c;p++)z.push([[l,v[p]],[r,v[p]]]);p=new t({paths:z,spatialReference:this.origin.spatialReference.toJson()});s.push({latticeID:k+"_"+m+"_"+d+"_"+f,lattice:p,resolution:this._resolution})}return{minRow:k,maxRow:m,minCol:d,maxCol:f,cells:s}}})})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(q,e,a,f,k){return q([k],{declaredClass:"esri.layers._SelectionMode",constructor:function(a){this.featureLayer=
a;this._featureMap={}},propertyChangeHandler:function(a){this._init&&0===a&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)}})})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),function(q,e,a,f,k,n,r,t,b,g){return q([g],{declaredClass:"esri.layers._StreamMode",constructor:function(a,b){this.featureLayer=a;
this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=e.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;a.purgeOptions&&(a.purgeOptions.age&&"number"===typeof a.purgeOptions.age)&&(this._maxFeatureAge=1E3*Math.ceil(60*a.purgeOptions.age));this._drawFeatures=e.hitch(this,this._drawFeatures);this._queryErrorHandler=e.hitch(this,this._queryErrorHandler)},startup:function(){},
propertyChangeHandler:function(a){this._init&&(0===a?this._applyTimeFilter():3===a?this._redrawAllTracks():console.debug("StreamLayer: Stream Layer only supports changing map time or maximumTrackPoints. Layer id \x3d "+this.featureLayer.id))},drawFeature:function(a){var b=this.featureLayer,e=b.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,this._refreshRate));b._joinField&&this._getFeature(a.attributes[e])?this._drawBuffer.updates.push({oid:a.attributes[e],updates:a}):
this._drawBuffer.adds.push(a)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a&&(!a._relatedUrl&&!a._keepLatestUrl?(a._fireUpdateStart(),a.clear(),a._fireUpdateEnd()):(a._fireUpdateStart(),a._refreshing=!0,a.disconnect(),a.clear(),a._relatedQueried=!1,a._keepLatestQueried=!1,a.connect()))},_drawFeatures:function(a){this._purgeRequests();var b=this.featureLayer;b._create(a.features||[]);b._fireUpdateEnd(null,null)},_applyTimeFilter:function(a){this.inherited(arguments);
this._redrawAllTracks()},_removeFeatures:function(b){var e=this.featureLayer,g=e.objectIdField;b&&a.forEach(b,function(a){a=a.attributes[g];e._unSelectFeatureIIf(a,this);this._decRefCount(a);this._removeFeatureIIf(a)},this)},_addFeatures:function(b){var e=this.featureLayer,g=e._endTimeField,f=e._startTimeField,k,p,c,l=[],n=[],v=[];k=e._trackManager;p=e.objectIdField;if(k)for(c in b=k.addFeatures(b),b)b.hasOwnProperty(c)&&(l.push(c),b[c].adds&&(n=n.concat(b[c].adds)),b[c].deletes&&(v=v.concat(b[c].deletes)));
else n=b;a.forEach(n,function(a){var c=a.attributes[p],b;b=g&&a.attributes[g];!b&&this._maxFeatureAge&&(b=f&&a.attributes[f]?a.attributes[f]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);b&&(b=1E3*Math.ceil(b/1E3),this._featuresByTime[b]?this._featuresByTime[b].push(c):this._featuresByTime[b]=[c]);this._addFeatureIIf(c,a);this._incRefCount(c)},this);v.length&&this._removeFeatures(v);k&&k.refreshTracks(l)},_updateFeatures:function(b){var e=this.featureLayer,g,f,k=[];g=e._trackManager;f=e._trackIdField;
a.forEach(b,function(a){var c=a.updates;a=this._getFeature(a.oid);var b;if(a){c.geometry&&a.setGeometry(c.geometry);c=c.attributes||{};for(b in c)c.hasOwnProperty(b)&&(a.attributes[b]=c[b]);a.visible=this._checkFeatureTimeIntersects(a);g&&a.attributes[f]?k.push(a.attributes[f]):e._repaint(a,null,!0)}},this);k.length&&g.refreshTracks(k)},_redrawAllTracks:function(){var a=this.featureLayer._trackManager,b;if(a&&(b=a.trimTracks())&&0<b.length)this._removeFeatures(b),a.refreshTracks()},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);
var a=this._drawBuffer,b=a.adds.splice(0,a.adds.length),e=a.updates.splice(0,a.updates.length),a=this.featureLayer;if(!a)return!1;a.updating||a._fireUpdateStart();this._addFeatures(b);this._updateFeatures(e);if((b=this._getExpiredFeatures())&&b.length)this._removeFeatures(b),a._trackManager&&a._trackManager.removeFeatures(b);a._purge();a._fireUpdateEnd();this._timeoutId=null},_clearDrawBuffer:function(){var a=this._timeoutId,b=this._drawBuffer,e=b.adds,b=b.updates;a&&clearTimeout(a);e.splice(0,e.length);
b.splice(0,b.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(a){a=a||0===a?a:200;0>a&&(a=200);this._refreshRate=a},_checkFeatureTimeIntersects:function(a){var b=this.featureLayer,e=b.getMap().timeExtent;return!e||!b.timeInfo||!b.timeInfo.startTimeField&&!b.timeInfo.endTimeField?!0:0<b._filterByTime([a],e.startTime,e.endTime).match.length},_getRequestId:function(a){return("_"+
a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchArchive:function(a){var e=this.featureLayer,g,f,k,p,c,l;e._fireUpdateStart();if(a&&this.map)a=new t(a),g=new r,f=this.map,k=e.getFilter()||{},p=k.where||"1\x3d1",c=k.geometry?b.fromJson(k.geometry):null,k=k.outFields?k.outFields.split(","):["*"],g.geometry=c,g.where=p,g.outFields=k,g.returnGeometry=!0,g.outSpatialReference=new n(f.spatialReference.toJson()),e._usePatch&&(l=this._getRequestId(e),this._cancelPendingRequest(null,l)),a.execute(g,
this._drawFeatures,this._queryErrorHandler,l);else return this._fireUpdateEnd({error:"Archive data cannot be fetched if no feature service url is provided or if the layer is not added to a map"}),!1},_queryErrorHandler:function(a){this._purgeRequests();var b=this.featureLayer;b._errorHandler(a);b._fireUpdateEnd(a)},_getExpiredFeatures:function(){var b,e,g,f=[],k=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return k;b=1E3*Math.floor(this._lastEndTimeCheck/1E3);this._lastEndTimeCheck=
e=1E3*Math.ceil(Date.now()/1E3);if(b&&b!==e)for(g=this._featuresByTime;b<=e;b+=1E3)g[b]&&(f=f.concat(g[b]),delete g[b]);a.forEach(f,function(a){(a=this._getFeature(a))&&k.push(a)},this);return k}})})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),function(q,e,a,f,k,n,r,t){return q(null,{declaredClass:"esri.layers._TrackManager",constructor:function(a){this.layer=a;this.trackMap=
{};this.trackLineMap={}},initialize:function(a){this.map=a;var e=this.layer,d=e._getRenderer(),d=d&&d.trackRenderer;if("esriGeometryPoint"===e.geometryType){var f=this.container=new t._GraphicsLayer({id:e.id+"_tracks",_child:!0});f.loaded=!0;f.onLoad(f);f._setMap(a,e._div);f.setRenderer(d)}},addFeatures:function(b){var e=this.trackMap,d=this.layer,f=d._trackIdField,k=[];a.forEach(b,function(c){var b=c.attributes[f];(e[b]=e[b]||[]).push(c);-1===a.indexOf(k,b)&&k.push(b)});var m=d._startTimeField,s=
d.objectIdField,p=function(a,b){var d=a.attributes[m],e=b.attributes[m];return d===e?a.attributes[s]<b.attributes[s]?-1:1:d<e?-1:1};a.forEach(k,function(a){e[a].sort(p)})},trimTracks:function(b){function e(a){for(a=d[a]||[];a.length>f;)k.push(a.shift())}var d=this.trackMap,f=this.layer.maximumTrackPoints||0,k=[],m;if(!f)return k;if(b)a.forEach(b,function(a){e(a)});else for(m in d)d.hasOwnProperty(m)&&e(m);return k},drawTracks:function(b){function e(a){var b=k[a],g,p,t;p=d.trackLineMap[a];f.remove(p);
delete d.trackLineMap[a];if(!b||2>b.length)return!1;p=[];for(g=b.length-1;0<=g;g--)(t=b[g].geometry)&&p.push([t.x,t.y]);b={};b[s]=a;1<p.length&&(p=new n(new r({paths:[p],spatialReference:m}),null,b),f.add(p),d.trackLineMap[a]=p)}var d=this,f=this.container,k,m,s,p;if(f)if(k=this.trackMap,m=this.map.spatialReference,s=this.layer._trackIdField,b)a.forEach(b,function(a){e(a)});else for(p in k)k.hasOwnProperty(p)&&e(p)},refreshTracks:function(b){function e(a){var c,b;d.drawTracks([a]);if(m&&m.latestObservationRenderer){a=
f[a]||[];c=a.length;for(b=0;b<c;b++)k._repaint(a[b],null,!0)}}var d=this,f=this.trackMap,k=this.layer,m=k._getRenderer(),s;if(b)a.forEach(b,function(a){e(a)});else for(s in f)f.hasOwnProperty(s)&&e(s);this.moveLatestToFront()},moveLatestToFront:function(b){a.forEach(this.getLatestObservations(b),function(a){var b=a._shape;b&&b._moveToFront();this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(b){function e(a){a=k[a];return a[a.length-1]}var d=[],f=this.layer._getRenderer(),k=this.trackMap,
m;if(!f.latestObservationRenderer)return d;if(b)a.forEach(b,function(a){d.push(e(a))});else for(m in k)k.hasOwnProperty(m)&&d.push(e(m));return d},clearTracks:function(b){var e=this.getLatestObservations(b),d=this.container,f;b?a.forEach(b,function(a){delete this.trackMap[a];d&&(f=this.trackLineMap[a],d.remove(f),delete this.trackLineMap[a])},this):(this.trackMap={},this.trackLineMap={},d&&d.clear());a.forEach(e,function(a){this._repaint(a,null,!0)},this.layer)},isLatestObservation:function(a){var e=
this.trackMap[a.attributes[this.layer._trackIdField]];return e?e[e.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=this.container=null}})})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ./FeatureLayer ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){function s(){}function p(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}return q(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(a){this.map=a;var b=this.sourceLayer,d=b.renderer;b.setDrawMode(!1);this.imageLayer=a._getMapImageLyr();var g=this;
this.heatmapRenderer=d instanceof h?d:(d.getRendererInfoByZoom(a.getZoom())||d.getRendererInfoByScale(a.getScale())).renderer;this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=this._reprojectFeature.bind(this);
k(["../workers/heatmapCalculator"],function(a){g._calculator=new a(e.mixin({width:g.map.width,height:g.map.height},g._getOptions()));g._setupRenderer();g.heatmapRenderer.getStats=a.calculateStats;g.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},_handleRendererChange:function(a){var b=
a.renderer,d=b instanceof h;this.heatmapRenderer?d?this.heatmapRenderer=b:this._removeRenderer(a):d&&(this.heatmapRenderer=b,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var c=this._hndls,b=this.sourceLayer,e=this.map,g=this;b._originalDraw=b._draw;b._draw=s;b._div.clear();setTimeout(this._resetGraphics.bind(this),250);c.push(b.on("update-end",function(a){g.recalculateHeatmap()}));
c.push(b.on("suspend",function(a){(a=g._getImageBySourceId(g.sourceLayer.id))&&a.hide()}));c.push(b.on("resume",function(a){(a=g._getImageBySourceId(g.sourceLayer.id))&&a.show()}));c.push(a.after(b,"redraw",this.recalculateHeatmap));c.push(e.on("layer-remove",function(a){a.layer==b&&((a=g._getImageBySourceId(g.sourceLayer.id))&&g.imageLayer.removeImage(a),g._removeRenderer({target:b}))}));b._collection&&c.push(b.on("graphic-add",function(a){g._reprojectFeature(a.graphic)}));b.mode!==d.MODE_ONDEMAND&&
(c.push(e.on("resize, pan-end",function(a){setTimeout(g.recalculateHeatmap,16)})),c.push(e.on("zoom-end",function(a){setTimeout(function(){b._getRenderer().isInstanceOf(h)&&g.recalculateHeatmap()},16)})));c.push(b.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();b.graphics&&b.graphics.length&&(b.graphics[0].geometry&&!e.spatialReference.equals(b.graphics[0].geometry.spatialReference)&&f.forEach(b.graphics,function(a){this._reprojectFeature(a)}.bind(this)),
this.recalculateHeatmap())},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var d=this._getImageBySourceId(this.sourceLayer.id);d&&this.imageLayer.removeImage(d);b.renderer!=a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&
a.geometry){var d=a.geometry,e=this.map.spatialReference;e.equals(d.spatialReference)||(d=b.project(d,e),null==d?console.log("Unable to reproject features to map's spatial reference. Please convert feature geometry before adding to layer"):a.geometry=d)}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var a=this.sourceLayer,b=this.map,d=this.heatmapRenderer,f=this.map.extent,h=this.map.width,m=this.map.height,k=this._calculator,s=this,n=function(u){u=s._getScreenPoints(u.features,
b,a);u=k.calculateImageData(e.mixin({screenPoints:u,mapinfo:{extent:[f.xmin,f.ymin,f.xmax,f.ymax],resolution:b.getResolution()},width:h,height:m},s._getOptions()));u=d.getSymbol(p({geometry:b.extent,attributes:{size:[h,m],imageData:u},layer:a}));u=new g({extent:b.extent,href:u.url,opacity:0,sourceId:a.id});s._swapMapImages(u,s._getImageBySourceId(a.id));a.suspended&&u.hide()},r={geometry:b.extent,timeExtent:a.useMapTime?b.timeExtent:void 0,spatialRelationship:u.SPATIAL_REL_INTERSECTS};null!=a._canDoClientSideQuery(r)?
a.queryFeatures(r,n):n({features:a.graphics})},_getScreenPoints:function(a,b,d){var e=[],g=a.length,h=0,m=0,p,k=new t(b.extent.xmin,b.extent.ymax,b.spatialReference),s=b.toScreen(k),u=s.x,s=s.y,n=b.getResolution(),r;for((m=b.extent.getCacheValue("_parts"))&&(r=f.map(m,function(a){return d._intersects(b,a.extent)[0]}));g--;)m=a[g],m.geometry&&(p={x:Math.ceil((m.geometry.x-k.x)/n+u),y:Math.floor((k.y-m.geometry.y)/n-s),attributes:m.attributes},r&&(m=1<r.length&&p.x<-r[0]?r[1]:r[0],p.x+=m),e[h++]=p);
return e},_getImageBySourceId:function(a){var b=this.imageLayer.getImages(),b=f.filter(b,function(b){return b.sourceId==a});if(b.length)return b[b.length-1]},_swapMapImages:function(a,b){function d(){e.removeImage(b)}var e=this.imageLayer,g=this.sourceLayer.opacity||1;e.addImage(a);m.anim(a._node,{opacity:g},null,null,function(){a.opacity=g});null!=b&&m.anim(b._node,{opacity:0},null,null,d)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},
_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){for(var a=this.sourceLayer.graphics,b=a.length,d;b--;)d=a[b],d._shape=d._offsets=void 0}})})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),function(q,
e,a,f,k,n,r){return q(null,{declaredClass:"esri.layers.MapImage",constructor:function(a){e.mixin(this,a);this.extent=new r(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},show:function(){if(!this.visible){this.visible=!0;var a=this._node,b=this._layer,e;if(a){if(e=b&&b._div)b.suspended||b._setPos(a,e._left,e._top),(b._active||e).appendChild(a);n.show(a)}}},hide:function(){if(this.visible){this.visible=!1;var a=this._node;a&&(n.hide(a),
a.parentNode&&a.parentNode.removeChild(a))}},setOpacity:function(e){var b=this._node;this.opacity=e;b&&a.set(b,"opacity",e)}})})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(q,e,a,f,k,n,r,t){return q(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var b=a.map(this.geometries,
function(a){return a.toJson()}),e={};e.outSR=this.outSR.wkid||f.toJson(this.outSR.toJson());e.inSR=this.geometries[0].spatialReference.wkid||f.toJson(this.geometries[0].spatialReference.toJson());e.geometries=f.toJson({geometryType:t.getJsonType(this.geometries[0]),geometries:b});this.transformation&&(e.transformation=this.transformation.wkid||f.toJson(this.transformation));r.isDefined(this.transformForward)&&(e.transformForward=this.transformForward);return e}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang",
"jimu/shared/basePortalUrlUtils"],function(q,e){var a=q.clone(e);a.declaredClass="jimu.portalUrlUtils";a.getPortalUrlFromLocation=function(){return a.getPortalServerFromLocation()+a.getDeployContextFromLocation()};a.getPortalSignInUrlFromLocation=function(){return a.getPortalUrlFromLocation()+"home/signin.html"};a.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};a.getDeployContextFromLocation=function(){var a=window.location.href.split("?")[0],e=a.indexOf("/home");
0>e&&(e=a.indexOf("/apps"));a=a.substring(a.indexOf(window.location.host)+window.location.host.length+1,e);"/"!==a&&(a="/"+a+"/");return a};a.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+a.getDeployContextFromLocation()+"sharing/rest/"};return a})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var q={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,
"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&(String.prototype.startWith=function(e){return this.substr(0,e.length)===e});"function"!==typeof String.prototype.endWith&&(String.prototype.endWith=function(e){return this.substr(this.length-e.length,e.length)===e});q.getServerByUrl=function(e){e=(e||"").trim();e=e.replace(/^(http(s?):?)\/\//gi,"");0===e.indexOf("//")&&(e=e.slice(2));return e.split("/")[0]};q.getServerWithProtocol=function(e){var a="";if(e=(e||"").trim()){var f=
q.getServerByUrl(e);if(!f)return a;var k=q.getProtocol(e);k?a=k+"://"+f:0===e.indexOf("//")&&(a="//"+f)}return a};q.isSameServer=function(e,a){e=q.getServerByUrl(e)||"";a=q.getServerByUrl(a)||"";return e.toLowerCase()===a.toLowerCase()};q.isOnline=function(e){return 0<=q.getServerByUrl(e).toLowerCase().indexOf(".arcgis.com")};q.isArcGIScom=function(e){e=q.getServerByUrl(e).toLowerCase();return"www.arcgis.com"===e||"arcgis.com"===e};q.getStandardPortalUrl=function(e){var a=q.getServerByUrl(e);if(""===
a)return"";q.isOnline(a)?(q.isArcGIScom(a)&&(a="www.arcgis.com"),e=q.addProtocol(e),e=q.getProtocol(e)+"://"+a):(e=(e||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),e=q.addProtocol(e),e.replace(RegExp("http(s?)://"+a,"g"),"")||(e+="/arcgis"));return e};q.isSamePortalUrl=function(e,a){var f=/^http(s?):\/\//gi,k=/^\/\//gi;e=q.getStandardPortalUrl(e).toLowerCase().replace(f,"").replace(k,"");a=q.getStandardPortalUrl(a).toLowerCase().replace(f,"").replace(k,"");return e===a};q.addProtocol=
function(e){if(-1>=e.toLowerCase().indexOf("http://")&&-1>=e.toLowerCase().indexOf("https://")){var a="";"undefined"!==typeof window&&window.location?(a=window.location.protocol,e=e.startWith("//")?a+e:e.startWith("/")?a+"//"+window.location.host+e:a+"//"+e):(a="http:",e.startWith("//")&&(e=a+e))}return e};q.getProtocol=function(e){var a="";e=e.toLowerCase();0===e.indexOf("https://")?a="https":0===e.indexOf("http://")&&(a="http");return a};q.removeProtocol=function(e){return e.replace(/^http(s?):\/\//i,
"//")};q.setHttpProtocol=function(e){e=q.addProtocol(e);return e.replace(/^https:\/\//,"http://")};q.setHttpsProtocol=function(e){e=q.addProtocol(e);return e.replace(/^http:\/\//,"https://")};q.setProtocol=function(e,a){return 0<=a.indexOf("https")?q.setHttpsProtocol(e):0<=a.indexOf("http")?q.setHttpProtocol(e):e};q.getSharingUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/sharing");return a};q.getOAuth2Url=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/sharing/oauth2");
return a};q.getAppIdUrl=function(e,a){var f="",k=q.getStandardPortalUrl(e);k&&(f=k+"/sharing/oauth2/apps/"+a);return f};q.getSignInUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/home/signin.html");return a};q.getBaseSearchUrl=function(e){var a="";e=q.getStandardPortalUrl(e);(e=e.replace(/\/*$/g,""))&&(a=e+"/sharing/rest/search");return a};q.getBaseItemUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/sharing/rest/content/items");return a};q.getItemUrl=function(e,a){var f=
"",k=q.getBaseItemUrl(e);k&&a&&(f=k+"/"+a);return f};q.getItemDataUrl=function(e,a){var f="",k=q.getItemUrl(e,a);k&&(f=k+"/data");return f};q.getGenerateTokenUrl=function(e){var a="";e&&(e=q.getStandardPortalUrl(e),a=e+"/sharing/generateToken");return a};q.getItemDetailsPageUrl=function(e,a){var f="";e&&a&&(e=q.getStandardPortalUrl(e),f=e+"/home/item.html?id\x3d"+a);return f};q.getUserProfilePageUrl=function(e,a){var f="";e&&a&&(e=q.getStandardPortalUrl(e),f=e+"/home/user.html?user\x3d"+a);return f};
q.getBaseGroupUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/sharing/rest/community/groups");return a};q.getPortalSelfInfoUrl=function(e){var a="";(e=q.getStandardPortalUrl(e||""))&&(a=e+"/sharing/portals/self");return a};q.getCommunitySelfUrl=function(e){var a="";(e=q.getStandardPortalUrl(e||""))&&(a=e+"/sharing/rest/community/self");return a};q.getBaseUserUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/sharing/rest/community/users");return a};q.getUserUrl=function(e,
a){var f="",k=q.getBaseUserUrl(e);e&&a&&(f=k+"/"+a);return f};q.getUserTagsUrl=function(e,a){var f="",k=q.getUserUrl(e,a);e&&a&&(f=k+"/tags");return f};q.getContentUrl=function(e){var a="";e&&(e=q.getStandardPortalUrl(e),a=e+"/sharing/rest/content");return a};q.getUserContentUrl=function(e,a,f){var k="",k="";e&&a&&(k=q.getContentUrl(e),k=f?k+"/users/"+a+"/"+f:k+"/users/"+a);return k};q.getAddItemUrl=function(e,a,f){var k="",k="";e&&a&&(k=q.getUserContentUrl(e,a,f),k+="/addItem");return k};q.getDeleteItemUrl=
function(e,a,f){var k="";(e=q.getUserItemsUrl(e,a))&&(k=e+"/"+f+"/delete");return k};q.getUserItemsUrl=function(e,a,f){var k="",k="";e&&a&&(k=q.getUserContentUrl(e,a,f),k+="/items");return k};q.getUpdateItemUrl=function(e,a,f,k){var n="",n="";e&&a&&(n=q.getUserItemsUrl(e,a,k),n=n+"/"+f+"/update");return n};q.shareItemUrl=function(e,a,f,k){var n="",n="";e&&a&&(n=q.getUserItemsUrl(e,a,k),n=n+"/"+f+"/share");return n};q.getHomeIndexUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/home/index.html");
return a};q.getHomeMapViewerUrl=function(e,a){var f="",k=q.getStandardPortalUrl(e);k&&(f=k+"/home/webmap/viewer.html",f=a?f+("?webmap\x3d"+a):f+"?useExisting\x3d1");return f};q.getHomeGalleryUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/home/gallery.html");return a};q.getHomeGroupsUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/home/groups.html");return a};q.getHomeMyContentUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/home/content.html");return a};
q.getHomeMyOrganizationUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/home/organization.html");return a};q.getHomeUserUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/home/user.html");return a};q.getPortalHelpUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/portalhelp/en/website/help/");return a};q.getPortalProxyUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&(a=e+"/sharing/proxy");return a};q.getOAuth2SignOutUrl=function(e){var a="";(e=q.getStandardPortalUrl(e))&&
(a=e+"/sharing/oauth2/signout");return a};q.getNewPrintUrl=function(e){var a="";if(e=q.getStandardPortalUrl(e))e=q.setHttpProtocol(e),a=e+"/sharing/tools/newPrint";return a};return q})},"jimu/shared/utils":function(){define(["./basePortalUrlUtils"],function(q){function e(a,e){function f(e,b){var g,d,h,u,m="widgetOnScreen"===e;if(a[e]){if(a[e].groups)for(g=0;g<a[e].groups.length;g++){h=a[e].groups[g];b(h,{index:g,isWidget:!1,groupId:h.id,isThemeWidget:!1,isOnScreen:m});for(d=0;d<a[e].groups[g].widgets.length;d++)u=
a[e].groups[g].widgets[d],b(u,{index:d,isWidget:!0,groupId:h.id,isThemeWidget:u.uri&&-1<u.uri.indexOf("themes/"+a.theme.name),isOnScreen:m})}if(a[e].widgets)for(g=0;g<a[e].widgets.length;g++)u=a[e].widgets[g],b(a[e].widgets[g],{index:g,isWidget:!0,groupId:e,isThemeWidget:u.uri&&-1<u.uri.indexOf("themes/"+a.theme.name),isOnScreen:m})}}f("widgetOnScreen",e);f("widgetPool",e)}var a={},f="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwithched isController hasVersionManager isThemeWidget".split(" ");
a.visitElement=e;a.getConfigElementById=function(a,f){var r;if("map"===f)return a.map;e(a,function(a){if(a.id===f)return r=a,!0});return r};a.getWidgetNameFromUri=function(a){a=a.split("/");a.pop();return a.pop()};a.getAmdFolderFromUri=function(a){a=a.split("/");a.pop();return a.join("/")+"/"};a.widgetProperties=f;a.processWidgetProperties=function(a){"undefined"===typeof a.properties.isController&&(a.properties.isController=!1);"undefined"===typeof a.properties.isThemeWidget&&(a.properties.isThemeWidget=
!1);"undefined"===typeof a.properties.hasVersionManager&&(a.properties.hasVersionManager=!1);f.forEach(function(e){"undefined"===typeof a.properties[e]&&(a.properties[e]=!0)})};a.isHostedService=function(a){var e=q.getServerByUrl(a)+"/[^/]+/[^/]+/rest/services";return RegExp(e,"gi").test(a)};return a})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic esri/request ./utils ./portalUrlUtils ./tokenUtils".split(" "),
function(q,e,a,f,k,n,r,t,b,g){var d=q([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(a){this.portalUrl=b.getStandardPortalUrl(a);this.selfUrl=b.getPortalSelfInfoUrl(a)},loadSelfInfo:function(){var a=new k,c={url:this.selfUrl,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0};this.isValidCredential()&&(c.content.token=this.credential.token);r(c).then(e.hitch(this,function(c){var b=c.user;delete c.user;
e.mixin(this,c);c.user=b;a.resolve(c)}),e.hitch(this,function(c){console.error(c);a.reject(c)}));return a},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=g.getPortalCredential(this.portalUrl))},signIn:function(){var a=new k;this.updateCredential();this.isValidCredential()?setTimeout(e.hitch(this,
function(){a.resolve(this.credential)}),0):a=g.signInPortal(this.portalUrl);return a},haveSignIn:function(){return g.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new k;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(e.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(e.hitch(this,
function(c){this.user=c;a.resolve(this.user)}),e.hitch(this,function(c){console.error(c);a.reject(c)})):g.getUserIdByToken(this.credential.token,this.portalUrl).then(e.hitch(this,function(c){this.credential.userId=c;this._getUser(this.credential.userId).then(e.hitch(this,function(c){this.user=c;a.resolve(this.user)}),e.hitch(this,function(c){console.error(c);a.reject(c)}))}),e.hitch(this,function(c){console.error(c);a.reject(c)})):setTimeout(e.hitch(this,function(){a.reject("credential is null.")}),
0);return a},queryItems:function(d){this.updateCredential();var c=new k,g=b.getBaseSearchUrl(this.portalUrl),f={f:"json"};d&&(f=e.mixin(f,d));this.isValidCredential()&&(f.token=this.credential.token);!f.sortField&&!f.sortOrder&&(f.sortField="title",f.sortOrder="asc");r({url:g,handleAs:"json",content:f,callbackParamName:"callback"}).then(e.hitch(this,function(b){b.results=a.map(b.results,e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new m(a)}));
c.resolve(b)}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getItemData:function(a){this.updateCredential();a={url:b.getItemDataUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return r(a)},getItemById:function(a){var c=new k;this.updateCredential();a={url:b.getItemUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&
(a.content.token=this.credential.token);r(a).then(e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new m(a);c.resolve(a)}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getAppById:function(a){var c=new k;this.updateCredential();this.isValidCredential()?(a=b.getAppIdUrl(this.portalUrl,a),c=r({url:a,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(e.hitch(this,function(){c.reject("token is null.")}),0);
return c},queryGroups:function(d){this.updateCredential();var c=new k,g=b.getBaseGroupUrl(this.portalUrl),f={f:"json"};d&&(f=e.mixin(f,d));this.isValidCredential()&&(f.token=this.credential.token);r({url:g,handleAs:"json",content:f,callbackParamName:"callback"}).then(e.hitch(this,function(b){b.results=a.map(b.results,e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new u(a)}));c.resolve(b)}),e.hitch(this,function(a){console.error(a);c.reject(a)}));
return c},registerApp:function(a,c,d){var g=new k;this.updateCredential();if(this.isValidCredential())var f=this.credential&&this.credential.token,h=b.getOAuth2Url(this.portalUrl),g=r({url:h+"/registerApp",content:{itemId:a,appType:c,redirect_uris:JSON.stringify(d),token:f,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(e.hitch(this,function(){g.reject("token is null.")}),0);return g},createAndRegisterApp:function(a){var c=new k;this.updateCredential();this.isValidCredential()?this.getUser().then(e.hitch(this,
function(b){b.addItem({title:"Web AppBuilder for ArcGIS",type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(e.hitch(this,function(b){b.success?this.registerApp(b.id,"browser",a).then(e.hitch(this,function(a){c.resolve(a)}),e.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject("create app failed")}),e.hitch(this,function(a){console.error(a);c.reject(a)}))}),e.hitch(this,function(a){console.error(a);c.reject(a)})):setTimeout(e.hitch(this,function(){c.reject("token is null.")}),
0);return c},_getUser:function(a){this.updateCredential();var c=new k;a={url:b.getUserUrl(this.portalUrl,a),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential&&this.credential.token);r(a).then(e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new h(a);c.resolve(this.user)}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c}}),h=q([],{declaredClass:"jimu.PortalUser",
portalUrl:null,credential:null,portal:null,constructor:function(a){a&&e.mixin(this,a)},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getGroups:function(){var b=[];this.groups&&(b=a.map(this.groups,e.hitch(this,function(a){a.portalUrl=
this.portalUrl;a.credential=this.credential;a.portal=this.portal;return new u(a)})));return b},getItemsByKeywords:function(a,c){return this.portal.queryItems({start:c||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();var a={url:b.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential&&(a.content.token=this.credential.token);return r(a)},getTags:function(){this.updateCredential();
var a={url:b.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return r(a)},addItem:function(a,c){this.updateCredential();var d=new k;if(this.isValidCredential()){var g={f:"json",token:this.credential.token};a&&(g=e.mixin(g,a));r({url:b.getAddItemUrl(this.portalUrl,this.username,c),handleAs:"json",callbackParamName:"callback",content:g},{usePost:!0}).then(e.hitch(this,function(a){d.resolve(a)}),
e.hitch(this,function(a){console.error(a);d.reject(a)}))}else setTimeout(e.hitch(this,function(){d.reject("token is null.")}),0);return d},deleteItem:function(a){this.updateCredential();var c=new k;this.isValidCredential()?(a=b.getDeleteItemUrl(this.portalUrl,this.username,a),c=r({url:a,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(e.hitch(this,function(){c.reject("token is null.")}),0);return c},getItemById:function(a,c){this.updateCredential();var d=new k,
g={url:b.getUserItemsUrl(this.portalUrl,this.username,c)+"/"+a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(g.content.token=this.credential.token);r(g).then(e.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new m(a);d.resolve(a)}),e.hitch(this,function(a){console.error(a);d.reject(a)}));return d},shareItem:function(a,c,d){this.updateCredential();var g=new k;this.isValidCredential()?(c={url:b.shareItemUrl(this.portalUrl,
this.username,c,d),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},a&&(c.content=e.mixin(c.content,a)),r(c,{usePost:!0}).then(e.hitch(this,function(a){g.resolve(a)}),e.hitch(this,function(a){console.error(a);g.reject(a)}))):setTimeout(e.hitch(this,function(){g.reject("token is null.")}),0);return g},updateItem:function(a,c){this.updateCredential();var d=new k;this.isValidCredential()?this.portal.getItemById(a).then(e.hitch(this,function(g){var f={f:"json",
token:this.credential.token};c&&(f=e.mixin(f,c));r({url:b.getUpdateItemUrl(this.portalUrl,this.username,a,g.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:f},{usePost:!0}).then(e.hitch(this,function(a){d.resolve(a)}),e.hitch(this,function(a){console.error(a);d.reject(a)}))}),e.hitch(this,function(a){console.error(a);d.reject(a)})):setTimeout(e.hitch(this,function(){d.reject("token is null.")}),0);return d}}),u=q([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,
portal:null,constructor:function(a){a&&e.mixin(this,a)},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),m=q([],{declaredClass:"jimu.PortalItem",
itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,token:null,constructor:function(a){a&&e.mixin(this,a);this.itemUrl=b.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&(this.thumbnail&&this.itemUrl)&&(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=b.getItemDetailsPageUrl(this.portalUrl,
this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=b.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)}}),s={portals:[],
webMapQueryStr:" "+t.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+t.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(a){for(var c=0;c<this.portals.length;c++){var d=this.portals[c];if(b.isSamePortalUrl(a,d.portalUrl))return d.updateCredential(),d}return null},getPortal:function(a){if(!a||!("string"===typeof a&&e.trim(a)))return null;a=b.getStandardPortalUrl(a);var c=this._findPortal(a);c||(c=new d(a),c.credential=g.getPortalCredential(c.portalUrl),c.updateCredential(),
this.portals.push(c));return c},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var c="english",b="",d=new k;this.getPortal(a).getUser().then(e.hitch(this,function(a){a&&a.units?c=a.units:(b=f.locale,c=b.startWith("en")?"english":"metric");d.resolve(c)}),e.hitch(this,function(g){console.warn(g);
this.getPortalSelfInfo(a).then(e.hitch(this,function(a){b=a&&a.culture||f.locale}),e.hitch(this,function(a){console.warn(a);b=f.locale})).always(e.hitch(this,function(){c=b.startWith("en")?"english":"metric";d.resolve(c)}))}));return d.promise},_getPortalSelfGroup:function(a,c){var b=new k,d=this.getPortal(a);d||setTimeout(e.hitch(this,function(){b.reject()}),0);this.getPortalSelfInfo(a).then(e.hitch(this,function(a){d.queryGroups({f:"json",q:a[c]}).then(e.hitch(this,function(a){0<a.results.length?
(a=a.results[0],a.portalUrl=d.portalUrl,a.credential=d.credential,a.portal=d,a=new u(a),b.resolve(a)):b.reject("Can't find portal self group.")}),e.hitch(this,function(a){console.error(a);b.reject(a)}))}),e.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getWebMapsFromBasemapGalleryGroup:function(a){var c=new k;this.getBasemapGalleryGroup(a).then(e.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(e.hitch(this,function(a){c.resolve(a)}),
e.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject()}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getDefaultWebScene:function(b){var c=new k,d=this.getPortal(b);d.getUser().then(e.hitch(this,function(b){d.queryItems({start:1,num:1,f:"json",q:this.webSceneQueryStr+' AND owner:"'+b.username+'" ',sortField:"numViews",sortOrder:"desc"}).then(e.hitch(this,function(b){b=b.results;b=a.filter(b,e.hitch(this,function(a){return a.type&&"web scene"===a.type.toLowerCase()}));
0<b.length?c.resolve(b[0].id):c.resolve(null)}),e.hitch(this,function(a){c.reject(a)}))}),e.hitch(this,function(){c.reject("not sign in")}));return c},getDefaultWebMap:function(a){var c=new k;this.getPortalSelfInfo(a).then(e.hitch(this,function(b){var d=b.defaultBasemap&&b.defaultBasemap.id;d?c.resolve(d):this._getDefaultWebMapByBasemapGallery(a,b).then(e.hitch(this,function(b){b?c.resolve(b):this._getMostNumViewsWebMap(a).then(e.hitch(this,function(a){a?c.resolve(a):c.reject()}),e.hitch(this,function(a){console.error(a);
c.reject(a)}))}),e.hitch(this,function(a){console.error(a);c.reject(a)}))}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getDefaultWebMapByBasemapGallery:function(b,c){var d=new k,g=this.getPortal(b),f=c.defaultBasemap&&c.defaultBasemap.title;g.queryGroups({f:"json",q:c.basemapGalleryGroupQuery}).then(e.hitch(this,function(c){c=c.results;0<c.length?g.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+c[0].id+" AND title:"+f}).then(e.hitch(this,function(c){c=
c.results;c=a.filter(c,e.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<c.length?d.resolve(c[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),g.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+f}).then(e.hitch(this,function(c){c=c.results;c=a.filter(c,e.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));if(0<c.length){var b=c[0];g.getItemData(b.id).then(e.hitch(this,function(a){a&&(a.operationalLayers||
a.baseMap||a.version)?d.resolve(b.id):d.resolve(null)}),e.hitch(this,function(){d.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),d.resolve(null)}),e.hitch(this,function(a){console.error(a);d.reject(a)})))}),e.hitch(this,function(a){console.error(a);d.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),d.resolve(null))}),e.hitch(this,function(a){console.error(a);d.reject(a)}));return d},_getMostNumViewsWebMap:function(b){var c=new k;this.getPortal(b).queryItems({start:1,
num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(e.hitch(this,function(b){b=b.results;b=a.filter(b,e.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<b.length?c.resolve(b[0].id):c.reject("Can't find most-num-views web map.")}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c}};n.subscribe("userSignOut",function(a){(a=s._findPortal(a))&&a.clearCredentialAndUser()});return s})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/request esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){"function"!==typeof k.getAll&&(k.getAll=function(a){var b=[];(a=k(a))&&b.push(a);return b});d={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(b){console.log(b),a=!1}return!!a},isRunInPortal:function(){return window.isRunInPortal},isStringStartWith:function(a,
b){return a.substr(0,b.length)===b},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=u.getStandardPortalUrl(a))&&(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(a){var d=new f,c=u.getStandardPortalUrl(a);a=c+"/sharing";var e=u.setHttpsProtocol(c+"/sharing/generateToken?f\x3djson"),g=u.setHttpsProtocol(a);t.get(e,{jsonp:"callback"}).then(q.hitch(this,function(a){a.token?(this.webTierPortalUrls.push(c),this.removeWabAuthCookie(),
b.id.getCredential(g).then(q.hitch(this,function(c){c.token||(c.token=a.token);d.resolve(!0)}),q.hitch(this,function(){d.resolve(!0)}))):d.resolve(!1)}),q.hitch(this,function(a){console.error(a);d.reject(a)}));return d},tryRegisterCredential:function(a){return!this.isValidCredential(a)?!1:!e.some(b.id.credentials,q.hitch(this,function(b){return a.token===b.token}))?(b.id.credentials.push(a),!0):!1},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&q.trim(a)},signInPortal:function(a){var d=
new f;if(this._isInvalidPortalUrl(a)){a=u.getStandardPortalUrl(a);var c=u.getSharingUrl(a),e=this.getPortalCredential(a);e?setTimeout(q.hitch(this,function(){d.resolve(e)}),0):d=b.id.getCredential(c)}else setTimeout(q.hitch(this,function(){d.reject("Invalid portalurl.")}),0);return d},_loadPortalSelfInfo:function(a){a=u.getPortalSelfInfoUrl(a);return g({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,d){if(!a||!("string"===typeof a&&d&&"string"===
typeof d))return null;var c=b.id.findOAuthInfo(a);c||(c=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",c=new h({appId:d,expiration:20160,portalUrl:a,authNamespace:"/",popup:!0,popupCallbackUrl:c}),b.id.registerOAuthInfos([c]));c.appId=d;return c},signOutAll:function(){var a=u.getStandardPortalUrl(this.portalUrl),d=!!b.id.findCredential(a+"/sharing/rest");this.isRunInPortal()?this.removeEsriAuthCookieStorage():this.removeWabAuthCookie();b.id.destroyCredentials();
b.id._oAuthHash=null;d&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(q.trim(a||""))},isValidCredential:function(a){var b=!1;if(a){var b=a.token,c=a.server,d=a.scope,b=b&&"string"===typeof b&&q.trim(b),c=c&&"string"===typeof c&&q.trim(c),d="portal"===d||"server"===d,e=!0;a.expires&&(a=parseInt(a.expires,10),e=(new Date).getTime(),e=a>e);b=b&&c&&d&&e}return b},isValidPortalCredentialOfPortalUrl:function(a,b){var c=!1;if(this.isValidCredential(b))var c=
"portal"===b.scope,d=u.isSameServer(a,b.server),c=c&&d;return c},getPortalCredential:function(a){var d=null;a=q.trim(a||"");if(!a)return null;a=u.getStandardPortalUrl(a);return d=this._filterPortalCredential(a,b.id.credentials)},saveAndRegisterCookieToCredential:function(a){a=q.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var d=a.server+"/sharing/rest";a.server=d;b.id.registerToken(a);return b.id.findCredential(d,a.userId)},registerAuth2Hash:function(a){a=
q.clone(a);var b=1E3*parseInt(a.expires_in,10),b=(new Date).getTime()+b,c=u.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:c,token:a.access_token,expires:b,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");k("wab_auth",JSON.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");
window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,b){var c=null;if(b&&0<b.length){var d=e.filter(b,q.hitch(this,function(c){return this.isValidPortalCredentialOfPortalUrl(a,c)}));0<d.length&&(c=d[d.length-1])}return c},_removePortalCredential:function(a){var d=q.trim(a||"");if(d){d=u.getStandardPortalUrl(d);for(a=e.filter(b.id.credentials,q.hitch(this,function(a){return this.isValidPortalCredentialOfPortalUrl(d,
a)}));0<a.length;)a[0].destroy(),a.splice(0,1);b.id.credentials=e.filter(b.id.credentials,q.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(d,a)}))}},getUserIdByToken:function(a,d){var c=new f;if(a&&"string"===typeof a&&d&&"string"===typeof d){var l=u.getStandardPortalUrl(d),h=e.filter(b.id.credentials,q.hitch(this,function(c){var b=c.token===a&&c.userId;c=u.isSameServer(l,c.server);return b&&c}));if(0<h.length){var m=h[0];setTimeout(q.hitch(this,function(){c.resolve(m.userId)}),
0);return c}h=u.getCommunitySelfUrl(l);g({url:h,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(q.hitch(this,function(a){c.resolve(a&&a.username||"")}),q.hitch(this,function(a){console.error(a);c.reject("fail to get userId by token")}))}else setTimeout(q.hitch(this,function(){c.reject("invalid parameters")}),0);return c},xtGetCredentialFromCookie:function(a){var d=k("wab_auth"),c=null;if(d)try{c=n.parse(d)}catch(e){console.error(e)}if(!(c&&"object"===typeof c)||!u.isSameServer(a,
c.server)||window.location.host!==c.referer)return null;c.expires=parseInt(c.expires,10);d=(new Date).getTime();if(!(c.expires>d))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";c.server=a;(d=b.id.findCredential(a))||b.id.registerToken(c);return d=b.id.findCredential(a)},removeCookie:function(a){var b=this.getCookiePath();m.removeCookie(a,b)},_getDomainsByServerName:function(a){var b=a.split("."),c=b.length;return e.map(b,q.hitch(this,function(a,d){var g=b.slice(d,c),f="",h=g.length-
1;e.forEach(g,q.hitch(this,function(a,c){f+=a;c!==h&&(f+=".")}));return f}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{r.publish("userSignIn",a)}catch(b){console.error(b)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{r.publish("anyUserSignIn",a)}catch(b){console.error(b)}},_publishCurrentPortalUserSignOut:function(a){try{r.publish("userSignOut",a)}catch(b){console.error(b)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,
a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(b){console.error(b)}},_bindEvents:function(){a.after(b.id,"signIn",q.hitch(this,function(b,d){console.log(d[1]);a.after(b,"callback",q.hitch(this,function(a,b){this._signInSuccess(b[0],!1)}));return b}))},isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a){var d=a.esri&&a.esri.id;d&&(b.id=d,d=window.esriConfig.defaults.io,a=a.esriConfig.defaults.io,
d.corsEnabledServers=a.corsEnabledServers,d.webTierAuthServers=a.webTierAuthServers,d._processedCorsServers=a._processedCorsServers,d.corsStatus=a.corsStatus)}}this._bindEvents();this._started=!0}}};d.startup();return d})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(q,e,a,f){q=new q;e.id=f.safeMixin(q,a);return e.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/ValidationTextBox".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p){return e([s],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){k.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(c,b,d){this._nls||(this._nls=p.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var e=this._loginDialog,g=d&&d.error,h=d&&d.token,m=new f(function(){e.onCancel()});if(e.open)return c=Error("BUSY"),c.code="IdentityManager.1",c.log=a.isDebug,m.errback(c),m;u.hide(e.errMsg_);g&&(403==g.code&&h)&&(r.set(e.errMsg_,"innerHTML",this._nls.forbidden),u.show(e.errMsg_));e.dfd_=
m;e.serverInfo_=b;e.resUrl_=c;e.admin_=d&&d.isAdmin;r.set(e.resLink_,{title:c,innerHTML:"("+(this.getResourceName(c)||this._nls.lblItem)+")"});r.set(e.serverLink_,{title:b.server,innerHTML:(-1!==b.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":b.server)+" "});e.txtPwd_.set("value","");e.show();return m},_createLoginDialog:function(){var c=this._nls,e=h.substitute(c,this._dialogContent),e=h.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},e),f=new g({title:c.title,content:e,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===t.ENTER&&this.execute_()},execute_:function(){var a=this.txtUser_.get("value"),b=this.txtPwd_.get("value"),e=this.dfd_,l=this;if(a&&b){this.btnSubmit_.set("label",c.lblSigning);var f=d.id.findCredential(l.resUrl_,a),k=function(b){l.btnSubmit_.set("label",c.lblOk);l.btnSubmit_.set("disabled",
!1);u.hide(l.errMsg_);l.hide();g._DialogLevelManager.hide(l);var d=l.serverInfo_;l.dfd_=l.serverInfo_=l.generateDfd_=l.resUrl_=null;var k,p,s=f,n;b&&(k=b.token,p=h.isDefined(b.expires)?Number(b.expires):null,n=!!b.ssl,s?(s.userId=a,s.token=k,s.expires=p,s.validity=b.validity,s.ssl=n,s.creationTime=(new Date).getTime()):s=new m({userId:a,server:d.server,token:k,expires:p,ssl:n,isAdmin:l.admin_,validity:b.validity}));e.callback(s)};f&&!f._enqueued?k():(l.btnSubmit_.set("disabled",!0),l.generateDfd_=
d.id.generateToken(this.serverInfo_,{username:a,password:b},{isAdmin:this.admin_}).addCallback(k).addErrback(function(a){l.btnSubmit_.set("disabled",!1);l.generateDfd_=null;l.btnSubmit_.set("label",c.lblOk);r.set(l.errMsg_,"innerHTML",a&&a.code?c.invalidUser:c.noAuthService);u.show(l.errMsg_)}))}},cancel_:function(){f.generateDfd_&&f.generateDfd_.cancel();var b=f.dfd_,c=f.resUrl_,d=f.serverInfo_;f.btnSubmit_.set("disabled",!1);f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;u.hide(f.errMsg_);g._DialogLevelManager.hide(f);
f.esriIdMgr_.onDialogCancel({resourceUrl:c,serverInfo:d});c=Error("ABORTED");c.code="IdentityManager.2";c.log=a.isDebug;b.errback(c)}}),e=f.domNode;f.txtUser_=b.byNode(q.query(".esriIdUser",e)[0]);f.txtPwd_=b.byNode(q.query(".esriIdPwd",e)[0]);f.btnSubmit_=b.byNode(q.query(".esriIdSubmit",e)[0]);f.btnCancel_=b.byNode(q.query(".esriIdCancel",e)[0]);f.resLink_=q.query(".resLink",e)[0];f.serverLink_=q.query(".serverLink",e)[0];f.errMsg_=q.query(".esriErrorMsg",e)[0];f.connect(f.txtUser_,"onKeyPress",
f.keypressed_);f.connect(f.txtPwd_,"onKeyPress",f.keypressed_);f.connect(f.btnSubmit_,"onClick",f.execute_);f.connect(f.btnCancel_,"onClick",f.onCancel);f.connect(f,"onCancel",f.cancel_);return f}})})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z,D,E,A,G,C,H){var I=new k;I.resolve(!0);x=f("dijit._DialogBase"+(p("dojo-bidi")?"_NoBidi":""),[B,D,E,z],{templateString:H,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:x.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:0.9,closable:!0,
_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=d.getLocalization("dijit","common");u.mixin(this,a);this.inherited(arguments)},postCreate:function(){b.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);a.after(this,"onExecute",u.hitch(this,"hide"),!0);a.after(this,"onCancel",u.hitch(this,"hide"),!0);this._modalconnects=[]},onLoad:function(){this.resize();
this._position();this.autofocus&&J.isTop(this)&&(this._getFocusItems(),v.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();v.focus(this._firstFocusItem)},_endDrag:function(){var a=t.position(this.domNode),b=c.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var b=this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==p("ie")?w:
l)(b,{handle:this.titleBar}),a.after(this._moveable,"onMoveStop",u.hitch(this,"_endDrag"),!0)):r.add(b,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":e.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:u.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!r.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,d=c.getBox(this.ownerDocument),e=this._relativePosition,g=e?null:
t.position(a);b.set(a,{left:Math.floor(d.l+(e?e.x:(d.w-g.w)/2))+"px",top:Math.floor(d.t+(e?e.y:(d.h-g.h)/2))+"px"})}},_onKey:function(a){if(a.keyCode==h.TAB){this._getFocusItems();var b=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(v.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b==this._lastFocusItem&&!a.shiftKey&&(v.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}else this.closable&&
a.keyCode==h.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return I.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),J.hide(this));var a=c.get(this.ownerDocument);this._modalconnects.push(m(a,"scroll",u.hitch(this,"resize",null)));this._modalconnects.push(m(this.domNode,"keydown",u.hitch(this,"_onKey")));b.set(this.domNode,{opacity:0,display:""});
this._set("open",!0);this._onShow();this.resize();this._position();var d;this._fadeInDeferred=new k(u.hitch(this,function(){d.stop();delete this._fadeInDeferred}));a=this._fadeInDeferred.promise;d=g.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:u.hitch(this,function(){J.show(this,this.underlayAttrs)}),onEnd:u.hitch(this,function(){this.autofocus&&J.isTop(this)&&(this._getFocusItems(),v.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();
return a},hide:function(){if(!this._alreadyInitialized||!this.open)return I.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new k(u.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(u.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=g.fadeOut({node:this.domNode,duration:this.duration,onEnd:u.hitch(this,function(){this.domNode.style.display="none";J.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();
this._scrollConnected&&(this._scrollConnected=!1);for(var c;c=this._modalconnects.pop();)c.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),e.forEach([this.domNode,this.containerNode,
this.titleBar,this.actionBarNode],function(a){a&&b.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var d=c.getBox(this.ownerDocument);d.w*=this.maxRatio;d.h*=this.maxRatio;var g=t.position(this.domNode);g.w>=d.w||g.h>=d.h?(a={w:Math.min(g.w,d.w),h:Math.min(g.h,d.h)},this._shrunk=!0):this._shrunk=!1}if(a){t.setMarginBox(this.domNode,a);d=[];this.titleBar&&d.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&d.push({domNode:this.actionBarNode,
region:"bottom"});g={domNode:this.containerNode,region:"center"};d.push(g);var l=C.marginBox2contentBox(this.domNode,a);C.layoutChildren(this.domNode,l,d);this._singleChild?(d=C.marginBox2contentBox(this.containerNode,g),this._singleChild.resize({w:d.w,h:d.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();!p("touch")&&!a&&this._position()}},_layoutChildren:function(){e.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&
this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();J.hide(this);this.inherited(arguments)}});p("dojo-bidi")&&(x=f("dijit._DialogBase",x,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var L=f("dijit.Dialog",
[G,x],{});L._DialogBase=x;var J=L._DialogLevelManager={_beginZIndex:950,show:function(a,c){F[F.length-1].focus=v.curNode;var d=F[F.length-1].dialog?F[F.length-1].zIndex+2:L._DialogLevelManager._beginZIndex;b.set(a.domNode,"zIndex",d);A.show(c,d-1);F.push({dialog:a,underlayAttrs:c,zIndex:d})},hide:function(a){if(F[F.length-1].dialog==a){F.pop();var b=F[F.length-1];1==F.length?A.hide():A.show(b.underlayAttrs,b.zIndex-1);if(a.refocus){a=b.focus;if(b.dialog&&(!a||!n.isDescendant(a,b.dialog.domNode)))b.dialog._getFocusItems(),
a=b.dialog._firstFocusItem;if(a)try{a.focus()}catch(c){}}}else b=e.indexOf(e.map(F,function(a){return a.dialog}),a),-1!=b&&F.splice(b,1)},isTop:function(a){return F[F.length-1].dialog==a}},F=L._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];v.watch("curNode",function(a,b,c){a=F[F.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==a.ownerDocument){do if(c==a.domNode||r.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});p("dijit-legacy-requires")&&s(0,function(){q(["dijit/TooltipDialog"])});
return L})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h){return e("dojo.dnd.Moveable",[n],{handle:"",delay:0,skip:!1,constructor:function(e,g){this.node=f.byId(e);g||(g={});this.handle=g.handle?f.byId(g.handle):null;this.handle||(this.handle=this.node);this.delay=0<g.delay?g.delay:0;this.skip=g.skip;this.mover=g.mover?g.mover:
d;this.events=[r(this.handle,b.press,a.hitch(this,"onMouseDown")),r(this.handle,"dragstart",a.hitch(this,"onSelectStart")),r(this.handle,"selectstart",a.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,d){return new d(b,a)},destroy:function(){q.forEach(this.events,function(a){a.remove()});this.events=this.node=this.handle=null},onMouseDown:function(d){if(!this.skip||!g.isFormElement(d)){if(this.delay)this.events.push(r(this.handle,b.move,a.hitch(this,"onMouseMove")),r(this.handle,b.release,
a.hitch(this,"onMouseUp"))),this._lastX=d.pageX,this._lastY=d.pageY;else this.onDragDetected(d);d.stopPropagation();d.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){if(!this.skip||!g.isFormElement(a))a.stopPropagation(),
a.preventDefault()},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(a){t.publish("/dnd/move/start",a);k.add(h.body(),"dojoMove");k.add(this.node,"dojoMoveItem")},onMoveStop:function(a){t.publish("/dnd/move/stop",a);k.remove(h.body(),"dojoMove");k.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var d=a.node.style;d.left=b.l+"px";d.top=b.t+"px";this.onMoved(a,b)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff",
"../_base/kernel","../_base/lang","../dom"],function(q,e,a,f){var k=a.getObject("dojo.dnd",!0);k.getCopyKeyState=function(a){return a[q("mac")?"metaKey":"ctrlKey"]};k._uniqueId=0;k.getUniqueId=function(){var a;do a=e._scopeName+"Unique"+ ++k._uniqueId;while(f.byId(a));return a};k._empty={};k.isFormElement=function(a){a=a.target;3==a.nodeType&&(a=a.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+a.tagName.toLowerCase()+" ")};return k})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u){return e("dojo.dnd.Mover",[b],{constructor:function(b,e,f){function c(a){a.preventDefault();a.stopPropagation()}this.node=n.byId(b);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;e=this.host=f;b=b.ownerDocument;this.events=[g(b,d.move,a.hitch(this,"onFirstMove")),g(b,d.move,a.hitch(this,"onMouseMove")),g(b,d.release,a.hitch(this,"onMouseUp")),g(b,"dragstart",c),g(b.body,"selectstart",c)];u.autoScrollStart(b);if(e&&e.onMoveStart)e.onMoveStart(this)},
onMouseMove:function(a){u.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){(f("webkit")&&f("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,d,c=this.host;switch(b.position){case "relative":case "absolute":d=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;
default:b.position="absolute";b=r.getMarginBox(this.node);d=k.doc.body;var e=t.getComputedStyle(d),g=r.getMarginBox(d,e),e=r.getContentBox(d,e);d=b.l-(e.l-g.l);b=b.t-(e.t-g.t)}this.marginBox.l=d-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(c&&c.onFirstMove)c.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){q.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),
function(q,e,a,f,k,n){var r={};q.setObject("dojo.dnd.autoscroll",r);r.getViewport=n.getBox;r.V_TRIGGER_AUTOSCROLL=32;r.H_TRIGGER_AUTOSCROLL=32;r.V_AUTOSCROLL_VALUE=16;r.H_AUTOSCROLL_VALUE=16;var t,b=a.doc,g=Infinity,d=Infinity;r.autoScrollStart=function(e){b=e;t=n.getBox(b);e=a.body(b).parentNode;g=Math.max(e.scrollHeight-t.h,0);d=Math.max(e.scrollWidth-t.w,0)};r.autoScroll=function(e){var f=t||n.getBox(b),m=a.body(b).parentNode,k=0,p=0;e.clientX<r.H_TRIGGER_AUTOSCROLL?k=-r.H_AUTOSCROLL_VALUE:e.clientX>
f.w-r.H_TRIGGER_AUTOSCROLL&&(k=Math.min(r.H_AUTOSCROLL_VALUE,d-m.scrollLeft));e.clientY<r.V_TRIGGER_AUTOSCROLL?p=-r.V_AUTOSCROLL_VALUE:e.clientY>f.h-r.V_TRIGGER_AUTOSCROLL&&(p=Math.min(r.V_AUTOSCROLL_VALUE,g-m.scrollTop));window.scrollBy(k,p)};r._validNodes={div:1,p:1,td:1};r._validOverflow={auto:1,scroll:1};r.autoScrollNodes=function(b){for(var d,g,s,p,c,l,n=0,v=0,t=b.target;t;){if(1==t.nodeType&&t.tagName.toLowerCase()in r._validNodes){s=k.getComputedStyle(t);p=s.overflow.toLowerCase()in r._validOverflow;
c=s.overflowX.toLowerCase()in r._validOverflow;l=s.overflowY.toLowerCase()in r._validOverflow;if(p||c||l)d=f.getContentBox(t,s),g=f.position(t,!0);if(p||c){s=Math.min(r.H_TRIGGER_AUTOSCROLL,d.w/2);c=b.pageX-g.x;if(e("webkit")||e("opera"))c+=a.body().scrollLeft;n=0;0<c&&c<d.w&&(c<s?n=-s:c>d.w-s&&(n=s),t.scrollLeft+=n)}if(p||l){p=Math.min(r.V_TRIGGER_AUTOSCROLL,d.h/2);l=b.pageY-g.y;if(e("webkit")||e("opera"))l+=a.body().scrollTop;v=0;0<l&&l<d.h&&(l<p?v=-p:l>d.h-p&&(v=p),t.scrollTop+=v)}if(n||v)return}try{t=
t.parentNode}catch(q){t=null}}r.autoScroll(b)};return r})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(q,e){var a=e.prototype.onMove;return q("dojo.dnd.TimedMoveable",e,{timeout:40,constructor:function(a,e){e||(e={});e.timeout&&("number"==typeof e.timeout&&0<=e.timeout)&&(this.timeout=e.timeout)},onMoveStop:function(f){f._timer&&(clearTimeout(f._timer),a.call(this,f,f._leftTop));e.prototype.onMoveStop.apply(this,arguments)},onMove:function(e,k){e._leftTop=
k;if(!e._timer){var n=this;e._timer=setTimeout(function(){e._timer=null;a.call(n,e,e._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(q,e,a,f,k){var n={};q.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(a){n[a]=f[a]});a.mixin(n,{defaultDuration:e.defaultDuration||200});a.mixin(k,n);return k})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h){e=e("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);q.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,n.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(c){b=b.concat(q.map(b,function(a){return a+c}),"dijit"+c)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var d="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(d);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var d=this.stateNode||this.domNode,e={};q.forEach(d.className.split(" "),function(a){e[a]=!0});"_stateClasses"in this&&q.forEach(this._stateClasses,function(a){delete e[a]});q.forEach(b,
function(a){e[a]=!0});var c=[],g;for(g in e)c.push(g);d.className=c.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,b,d){function e(c){f.toggle(a,b+"Active",c)}if(!this.disabled&&!this.readOnly)switch(d.type){case "mouseover":case "MSPointerOver":case "pointerover":f.toggle(a,b+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":f.toggle(a,b+"Hover",!1);e(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":e(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":e(!1);break;case "focus":case "focusin":f.toggle(a,b+"Focused",!0);break;case "blur":case "focusout":f.toggle(a,b+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});t(function(){function e(b,c,d){if(!d||!a.isDescendant(d,c))for(;c&&c!=d;c=c.parentNode)if(c._cssState){var g=h.getEnclosingWidget(c);g&&(c==g.domNode?g._cssMouseEvent(b):g._subnodeCssMouseEvent(c,c._cssState,b))}}var f=g.body(),k;r(f,
b.over,function(a){e(a,a.target,a.relatedTarget)});r(f,b.out,function(a){e(a,a.target,a.relatedTarget)});r(f,d.press,function(a){k=a.target;e(a,k)});r(f,d.release,function(a){e(a,k);k=null});r(f,"focusin, focusout",function(a){var b=a.target;if(b._cssState&&!b.getAttribute("widgetId")){var d=h.getEnclosingWidget(b);d&&d._subnodeCssMouseEvent(b,b._cssState,a)}})});return e})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(q,e,a,f,k,n){return e("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(a){var e=[];q.forEach(a||this.getChildren(),function(a){"value"in a?e.push(a):e=e.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return e},reset:function(){q.forEach(this._getDescendantFormWidgets(),function(a){a.reset&&a.reset()})},validate:function(){var a=!1;return q.every(q.map(this._getDescendantFormWidgets(),function(e){e._hasBeenBlurred=!0;var b=e.disabled||!e.validate||
e.validate();!b&&!a&&(n.scrollIntoView(e.containerNode||e.domNode),e.focus(),a=!0);return b}),function(a){return a})},setValues:function(e){a.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",e)},_setValueAttr:function(a){var e={};q.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(e[a.name]||(e[a.name]=[])).push(a)});for(var b in e)if(e.hasOwnProperty(b)){var g=e[b],d=f.getObject(b,!1,a);void 0!==d&&(d=[].concat(d),
"boolean"==typeof g[0].checked?q.forEach(g,function(a){a.set("value",-1!=q.indexOf(d,a._get("value")))}):g[0].multiple?g[0].set("value",d):q.forEach(g,function(a,b){a.set("value",d[b])}))}},getValues:function(){a.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var a={};q.forEach(this._getDescendantFormWidgets(),function(e){var b=e.name;if(b&&!e.disabled){var g=e.get("value");"boolean"==typeof e.checked?
/Radio/.test(e.declaredClass)?!1!==g?f.setObject(b,g,a):(g=f.getObject(b,!1,a),void 0===g&&f.setObject(b,null,a)):(e=f.getObject(b,!1,a),e||(e=[],f.setObject(b,e,a)),!1!==g&&e.push(g)):(e=f.getObject(b,!1,a),"undefined"!=typeof e?f.isArray(e)?e.push(g):f.setObject(b,[e,g],a):f.setObject(b,g,a))}});return a},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var a=q.map(this._descendants,function(a){return a.get("state")||""});return 0<=q.indexOf(a,"Error")?
"Error":0<=q.indexOf(a,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(a){this._descendants=this._getDescendantFormWidgets();q.forEach(this._descendants,function(a){a._started||a.startup()});a||this._onChildChange()},_onChildChange:function(a){(!a||"state"==a||"disabled"==a)&&this._set("state",this._getState());if(!a||"value"==a||"disabled"==a||"checked"==a)this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10)},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var a=this;this.own(k(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(e){e.target!=a.domNode&&a._onChildChange(e.type.replace("attrmodified-",""))}));this.watch("state",function(a,b,e){this.onValidStateChange(""==e)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(q,e){return q("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var a=e._getTabNavigable(this.domNode);this._firstFocusItem=a.lowest||a.first||this.closeButtonNode||this.domNode;this._lastFocusItem=a.last||a.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h){var u=q("dijit.DialogUnderlay",[t,b],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){f.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(n(this.domNode,"keydown",e.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var d=r.getBox(this.ownerDocument);b.top=d.t+"px";b.left=d.l+"px";a.width=d.w+"px";a.height=d.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new g(this.domNode);var a=r.get(this.ownerDocument);this._modalConnects=[d.on("resize",e.hitch(this,"layout")),n(a,"scroll",
e.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});u.show=function(a,b){var d=u._singleton;!d||d._destroyed?d=h._underlay=u._singleton=new u(a):a&&d.set(a);k.set(d.domNode,"zIndex",b);d.open||d.show()};u.hide=function(){var a=
u._singleton;a&&!a._destroyed&&a.hide()};return u})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(q,e,a,f,k,n,r,t){t.add("config-bgIframe",t("ie")&&!/IEMobile\/10\.0/.test(navigator.userAgent)||t("trident")&&/Windows NT 6.[01]/.test(navigator.userAgent));var b=new function(){var b=[];this.pop=function(){var d;b.length?(d=b.pop(),d.style.display=""):(9>t("ie")?(d="\x3ciframe src\x3d'"+
(a.dojoBlankHtmlUrl||q.toUrl("dojo/resources/blank.html")||'javascript:""')+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e",d=document.createElement(d)):(d=f.create("iframe"),d.src='javascript:""',d.className="dijitBackgroundIframe",d.setAttribute("role","presentation"),k.set(d,"opacity",0.1)),d.tabIndex=-1);return d};this.push=function(a){a.style.display="none";b.push(a)}};e.BackgroundIframe=function(a){if(!a.id)throw Error("no id");
if(t("config-bgIframe")){var d=this.iframe=b.pop();a.appendChild(d);7>t("ie")||t("quirks")?(this.resize(a),this._conn=r(a,"resize",n.hitch(this,"resize",a))):k.set(d,{width:"100%",height:"100%"})}};n.extend(e.BackgroundIframe,{resize:function(a){this.iframe&&k.set(this.iframe,{width:a.offsetWidth+"px",height:a.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),b.push(this.iframe),delete this.iframe)}});
return e.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented","dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(q,e,a,f,k){var n=new q,r;a(function(){var a=k.getBox();n._rlh=e(window,"resize",function(){var b=k.getBox();a.h==b.h&&a.w==b.w||(a=b,n.emit("resize"))});if(8==f("ie")){var b=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=b&&(b=screen.deviceXDPI,n.emit("resize"))},500)}f("ios")&&(e(document,"focusin",function(a){r=a.target}),e(document,"focusout",
function(a){r=null}))});n.getEffectiveBox=function(a){a=k.getBox(a);var b=r&&r.tagName&&r.tagName.toLowerCase();if(f("ios")&&r&&!r.readOnly&&("textarea"==b||"input"==b&&/^(color|email|number|password|search|tel|text|url)$/.test(r.type)))a.h*=0==orientation||180==orientation?0.66:0.4,b=r.getBoundingClientRect(),a.h=Math.max(a.h,b.top+b.height);return a};return n})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/i18n!../nls/loading dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c){return g("dijit.layout.ContentPane",[a,f,k],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:q._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var d=new c(a,b);return!d.href&&d._contentSetter&&d._contentSetter.parseDeferred&&!d._contentSetter.parseDeferred.isFulfilled()?d._contentSetter.parseDeferred.then(function(){return d}):d},create:function(a,b){if((!a||!a.template)&&b&&!("href"in a)&&!("content"in a)){b=h.byId(b);for(var c=b.ownerDocument.createDocumentFragment();b.firstChild;)c.appendChild(b.firstChild);
a=e.delegate(a,{content:c})}this.inherited(arguments,[a,b])},postMixInProperties:function(){this.inherited(arguments);var a=p.getLocalization("dijit","loading",this.lang);this.loadingMessage=n.substitute(this.loadingMessage,a);this.errorMessage=n.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&b.forEach(this._contentSetter.parseResults,
function(a){!a._started&&(!a._destroyed&&e.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},_startChildren:function(){b.forEach(this.getChildren(),function(a){!a._started&&(!a._destroyed&&e.isFunction(a.startup))&&(a.startup(),a._started=!0)});this._contentSetter&&b.forEach(this._contentSetter.parseResults,function(a){!a._started&&(!a._destroyed&&e.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},setHref:function(a){q.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new d(e.hitch(this,"cancel"));this.onLoadDeferred.then(e.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){q.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new d(e.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(e.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new d(e.hitch(this,"cancel"));this.onLoadDeferred.then(e.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
e.isObject(this.ioArgs)&&e.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||s.get)(b),d;c.then(function(b){d=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(c){a._onError("Content",c)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return d});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(b){console.error("Error "+this.widgetId+
" running custom onLoad code: "+b.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(a){console.error("Error "+this.widgetId+" running custom onUnload code: "+a.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var c=this._contentSetter;b.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});c&&(b.forEach(c.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete c.parseResults);a||m.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){this.destroyDescendants();var d=this._contentSetter;d&&d instanceof r._ContentSetter||(d=this._contentSetter=new r._ContentSetter({node:this.containerNode,_onError:e.hitch(this,this._onError),onContentError:e.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(b){console.error("Fatal "+this.id+
" could not change content due to "+b.message,b)}})}));var g=e.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),g=d.set(e.isObject(a)&&a.domNode?a.domNode:a,g),f=this;return c(g&&g.then?g:d.parseDeferred,function(){delete f._contentSetterParams;b||(f._started&&(f._startChildren(),f._scheduleLayout()),f._onLoadHandler(a))})},
_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],function(q,e,a,f){return e("dijit._Container",
null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(e,f){var r=this.containerNode;if(0<f){for(r=r.firstChild;0<f;)1==r.nodeType&&f--,r=r.nextSibling;r?f="before":(r=this.containerNode,f="last")}a.place(e.domNode,r,f);this._started&&!e._started&&e.startup()},removeChild:function(a){"number"==typeof a&&(a=this.getChildren()[a]);a&&(a=a.domNode)&&a.parentNode&&a.parentNode.removeChild(a)},hasChildren:function(){return 0<this.getChildren().length},
_getSiblingOfChild:function(a,e){f.deprecated(this.declaredClass+"::_getSiblingOfChild() is deprecated. Use _KeyNavMixin::_getNext() instead.","","2.0");var r=this.getChildren(),t=q.indexOf(r,a);return r[t+e]},getIndexOfChild:function(a){return q.indexOf(this.getChildren(),a)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(q,
e,a,f,k,n,r,t,b,g){return e("dijit.layout._ContentPaneResizeMixin",null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(b.on("resize",n.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var b=[],e=!1;r("\x3e *",this.containerNode).some(function(a){var g=
t.byNode(a);g&&g.resize?b.push(g):!/script|link|style/i.test(a.nodeName)&&a.offsetHeight&&(e=!0)});this._singleChild=1==b.length&&!e?b[0]:null;a.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,b){this._resizeCalled=!0;this._scheduleLayout(a,b)},_scheduleLayout:function(a,b){this._isShown()?this._layout(a,b):(this._needLayout=!0,this._changeSize=a,this._resultSize=b)},_layout:function(a,b){delete this._needLayout;!this._wasShown&&!1!==this.open&&this._onShow();
a&&f.setMarginBox(this.domNode,a);var e=this.containerNode;if(e===this.domNode){var m=b||{};n.mixin(m,a||{});if(!("h"in m)||!("w"in m))m=n.mixin(f.getMarginBox(e),m);this._contentBox=g.marginBox2contentBox(e,m)}else this._contentBox=f.getContentBox(e);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var a=this._contentBox||f.getContentBox(this.containerNode);this._singleChild.resize({w:a.w,h:a.h})}else for(var a=this.getChildren(),
b,e=0;b=a[e++];)b.resize&&b.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var b=this.domNode,e=this.domNode.parentNode;return"none"!=b.style.display&&"hidden"!=b.style.visibility&&!a.contains(b,"dijitHidden")&&e&&e.style&&"none"!=e.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array",
"dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(q,e,a,f,k){function n(e,b){var g=e.resize?e.resize(b):a.setMarginBox(e.domNode,b);g?k.mixin(e,g):(k.mixin(e,a.getMarginBox(e.domNode)),k.mixin(e,b))}var r={marginBox2contentBox:function(e,b){var g=f.getComputedStyle(e),d=a.getMarginExtents(e,g),h=a.getPadBorderExtents(e,g);return{l:f.toPixelValue(e,g.paddingLeft),t:f.toPixelValue(e,g.paddingTop),w:b.w-(d.w+h.w),h:b.h-(d.h+h.h)}},layoutChildren:function(a,b,g,d,f){b=
k.mixin({},b);e.add(a,"dijitLayoutContainer");g=q.filter(g,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(q.filter(g,function(a){return"center"==a.region||"client"==a.layoutAlign}));q.forEach(g,function(a){var g=a.domNode,k=a.region||a.layoutAlign;if(!k)throw Error("No region setting for "+a.id);var p=g.style;p.left=b.l+"px";p.top=b.t+"px";p.position="absolute";e.add(g,"dijitAlign"+(k.substring(0,1).toUpperCase()+k.substring(1)));g={};d&&d==a.id&&(g["top"==a.region||"bottom"==
a.region?"h":"w"]=f);"leading"==k&&(k=a.isLeftToRight()?"left":"right");"trailing"==k&&(k=a.isLeftToRight()?"right":"left");"top"==k||"bottom"==k?(g.w=b.w,n(a,g),b.h-=a.h,"top"==k?b.t+=a.h:p.top=b.t+b.h+"px"):"left"==k||"right"==k?(g.h=b.h,n(a,g),b.w-=a.w,"left"==k?b.l+=a.w:p.left=b.l+b.w+"px"):("client"==k||"center"==k)&&n(a,b)})}};k.setObject("dijit.layout.utils",r);return r})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),
function(q,e,a,f,k,n,r){var t=0,b={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"")},_emptyNode:n.empty,_setNodeContent:function(a,b){n.empty(a);if(b)if("string"==typeof b&&(b=n.toDom(b,a.ownerDocument)),!b.nodeType&&e.isArrayLike(b))for(var f=b.length,k=0;k<b.length;k=f==b.length?k+1:0)n.place(b[k],a,"last");else n.place(b,a,"last");return a},_ContentSetter:f("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,
parseContent:!1,parserScope:q._scopeName,startup:!0,constructor:function(a,b){e.mixin(this,a||{});b=this.node=k.byId(this.node||b);this.id||(this.id=["Setter",b?b.id||b.tagName:"",t++].join("_"))},set:function(a,b){void 0!==a&&(this.content=a);b&&this._mixin(b);this.onBegin();this.setContent();var e=this.onEnd();return e&&e.then?e:this.node},setContent:function(){var a=this.node;if(!a)throw Error(this.declaredClass+": setContent given no node");try{a=b._setNodeContent(a,this.content)}catch(d){var e=
this.onContentError(d);try{a.innerHTML=e}catch(f){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+f.message,f)}}this.node=a},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(a.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);n.empty(this.node)},onBegin:function(){var a=this.content;if(e.isString(a)&&
(this.cleanContent&&(a=b._secureForInnerHtml(a)),this.extractContent)){var d=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);d&&(a=d[1])}this.empty();this.content=a;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+a},onExecError:function(a){return"Error occurred executing scripts: "+a},
_mixin:function(a){var b={},e;for(e in a)e in b||(this[e]=a[e])},_parse:function(){var b=this.node;try{var d={};a.forEach(["dir","lang","textDir"],function(a){this[a]&&(d[a]=this[a])},this);var e=this;this.parseDeferred=r.parse({rootNode:b,noStart:!this.startup,inherited:d,scope:this.parserScope}).then(function(a){return e.parseResults=a},function(a){e._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(f){this._onError("Content",f,"Error parsing in _ContentSetter#"+this.id)}},
_onError:function(a,d,e){a=this["on"+a+"Error"].call(this,d);e?console.error(e,d):a&&b._setNodeContent(this.node,a,!0)}}),set:function(a,d,f){void 0==d&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),d="");return f?(new b._ContentSetter(e.mixin(f,{content:d,node:a}))).set():b._setNodeContent(a,d,!0)}};e.setObject("dojo.html",b);return b})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(q,e,a,f){return q(f.Credential,
{})})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x){var y={},B=function(a){var b=(new r(a.owningSystemUrl)).host;a=(new r(a.server)).host;var c=
/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},z=function(a,b){return!(!B(a)||!b||!f.some(b,function(b){return b.test(a.server)}))},D,E=q(w,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=a.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=[];this._getOAuthHash()},defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,
_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer)).*/ig,_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,
_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],registerServers:function(a){var b=this.serverInfos;b?(a=f.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):this.serverInfos=a;f.forEach(a,function(a){a.owningSystemUrl&&this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);
var b=u.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);p.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));p.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=f.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):this.oAuthInfos=a},registerToken:function(b){var c=this._sanitizeUrl(b.server),d=this.findServerInfo(c),e=!0,g;d||(d=new s,d.server=this._getOrigin(c),
d.tokenServiceUrl=this._getTokenSvcUrl(c),d.hasPortal=!0,this.registerServers([d]));(g=this.findCredential(c,b.userId))?(a.mixin(g,b),e=!1):(g=new D({userId:b.userId,server:d.server,token:b.token,expires:b.expires,ssl:b.ssl,scope:this._isServerRsrc(c)?"server":"portal"}),g.resources=[c],this.credentials.push(g));g.onTokenChange(!1);e||g.refreshServerTokens()},toJson:function(){return m.fixJson({serverInfos:f.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:f.map(this.oAuthInfos,function(a){return a.toJson()}),
credentials:f.map(this.credentials,function(a){return a.toJson()})})},initialize:function(b){if(b){a.isString(b)&&(b=n.fromJson(b));var c=b.serverInfos,d=b.oAuthInfos;b=b.credentials;if(c){var e=[];f.forEach(c,function(a){a.server&&a.tokenServiceUrl&&e.push(a.declaredClass?a:new s(a))});e.length&&this.registerServers(e)}if(d){var g=[];f.forEach(d,function(a){a.appId&&g.push(a.declaredClass?a:new x(a))});g.length&&this.registerOAuthInfos(g)}b&&f.forEach(b,function(a){a.userId&&(a.server&&a.token&&
a.expires&&a.expires>(new Date).getTime())&&(a=a.declaredClass?a:new D(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var b;a=this._sanitizeUrl(a);f.some(this.serverInfos,function(c){p.hasSameOrigin(c.server,a,!0)&&(b=c);return!!b});return b},findOAuthInfo:function(a){var b;a=this._sanitizeUrl(a);f.some(this.oAuthInfos,function(c){p.hasSameOrigin(c.portalUrl,a,!0)&&(b=c);return!!b});return b},findCredential:function(a,b){var c,d;a=this._sanitizeUrl(a);d=this._isServerRsrc(a)?
"server":"portal";b?f.some(this.credentials,function(e){p.hasSameOrigin(a,e.server,!0)&&(b===e.userId&&e.scope===d)&&(c=e);return!!c},this):f.some(this.credentials,function(b){p.hasSameOrigin(a,b.server,!0)&&(-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===d)&&(c=b);return!!c},this);return c},getCredential:function(b,d){var g,f,l=!0;m.isDefined(d)&&(a.isObject(d)?(g=!!d.token,f=d.error,l=!1!==d.prompt):g=d);b=this._sanitizeUrl(b);var h=new k(c._dfdCanceller),p=this._isAdminResource(b),n=g&&this._doPortalSignIn(b)?
this._getEsriAuthCookie():null;g=g?this.findCredential(b):null;if(n||g)return l=Error("You are currently signed in as: '"+(n&&n.email||g&&g.userId)+"'. You do not have access to this resource: "+b),l.code="IdentityManagerBase.1",l.httpCode=f&&f.httpCode,l.messageCode=f?f.messageCode:null,l.subcode=f?f.subcode:null,l.details=f?f.details:null,l.log=e.isDebug,h.errback(l),h;if(f=this._findCredential(b,d))return h.callback(f),h;if(f=this.findServerInfo(b))!f.hasServer&&this._isServerRsrc(b)&&(f._restInfoDfd=
this._getTokenSvcUrl(b,!0),f.hasServer=!0);else{n=this._getTokenSvcUrl(b);if(!n)return l=Error("Unknown resource - could not find token service endpoint."),l.code="IdentityManagerBase.2",l.log=e.isDebug,h.errback(l),h;f=new s;f.server=this._getOrigin(b);a.isString(n)?(f.tokenServiceUrl=n,l&&!this._findOAuthInfo(b)&&(f._selfDfd=this._getPortalSelf(n.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),b)),f.hasPortal=!0):(f._restInfoDfd=n,f.hasServer=!0);this.registerServers([f])}return this._enqueue(b,
f,d,h,p)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(b,c,d){var g,f,m,k,s,n,u=new r(window.location.href.toLowerCase()),v=this._getEsriAuthCookie(),t,w=!c;k=b.shortLivedTokenValidity;var q;c&&(q=h.id.tokenValidity||k||h.id.defaultTokenValidity,
q>k&&(q=k));d&&(g=d.isAdmin,f=d.serverUrl,m=d.token,n=d.ssl,b.customParameters=d.customParameters);if(g)k=b.adminTokenServiceUrl;else{k=b.tokenServiceUrl;s=new r(k.toLowerCase());v&&(t=(t=v.auth_tier)&&t.toLowerCase());if(("web"===t||b.webTierAuth)&&d&&d.serverUrl&&!n&&"http"===u.scheme&&(p.hasSameOrigin(u.uri,k,!0)||"https"===s.scheme&&u.host===s.host&&"7080"===u.port&&"7443"===s.port))k=k.replace(/^https:/i,"http:").replace(/:7443/i,":7080");w&&this._rePortalTokenSvc.test(b.tokenServiceUrl)&&(k=
k.replace(/\/rest/i,""))}d=l(a.mixin({url:k,content:a.mixin({request:"getToken",username:c&&c.username,password:c&&c.password,serverUrl:f,token:m,expiration:q,referer:g||this._rePortalTokenSvc.test(b.tokenServiceUrl)?window.location.host:null,client:g?"referer":null,f:"json"},b.customParameters),handleAs:"json",callbackParamName:w?"callback":void 0},d&&d.ioArgs),{usePost:!w,disableIdentityLookup:!0,useProxy:this._useProxy(b,d)});d.addCallback(function(a){if(!a||!a.token)return a=Error("Unable to generate token"),
a.code="IdentityManagerBase.3",a.log=e.isDebug,a;var d=b.server;y[d]||(y[d]={});c&&(y[d][c.username]=c.password);a.validity=q;return a});d.addErrback(function(a){});return d},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1})},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},
destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();f.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=g.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=n.fromJson(a.state),this._oAuthHash=a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),
"access_denied"===a.error&&(b=!0));if(b&&(!t("ie")||8<t("ie")))window.location.hash=""}},_findCredential:function(a,b){var c=-1,d,e,g,l,h=b&&b.token;d=b&&b.resource;var m=this._isServerRsrc(a)?"server":"portal",k=f.filter(this.credentials,function(b){return p.hasSameOrigin(b.server,a,!0)&&b.scope===m});a=d||a;if(k.length)if(1===k.length)if(d=k[0],g=(e=(l=this.findServerInfo(d.server))&&l.owningSystemUrl)&&this.findCredential(e,d.userId),c=this._getIdenticalSvcIdx(a,d),h)-1!==c&&(d.resources.splice(c,
1),this._removeResource(a,g));else return-1===c&&d.resources.push(a),this._addResource(a,g),d;else{var s,n;f.some(k,function(b){n=this._getIdenticalSvcIdx(a,b);return-1!==n?(s=b,g=(e=(l=this.findServerInfo(s.server))&&l.owningSystemUrl)&&this.findCredential(e,s.userId),c=n,!0):!1},this);if(h)s&&(s.resources.splice(c,1),this._removeResource(a,g));else if(s)return this._addResource(a,g),s}},_findOAuthInfo:function(a){var b=this.findOAuthInfo(a);b||f.some(this.oAuthInfos,function(c){this._isIdProvider(c.portalUrl,
a)&&(b=c);return!!b},this);return b},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!p.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!p.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new r(a);return a.scheme+
"://"+a.host+(m.isDefined(a.port)?":"+a.port:"")},_sanitizeUrl:function(b){b=p.fixUrl(a.trim(b));var c=(u.defaults.io.proxyUrl||"").toLowerCase(),d=c?b.toLowerCase().indexOf(c+"?"):-1;-1!==d&&(b=b.substring(d+c.length+1));return p.urlToObject(b).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,
b){var c;if(this._isRESTService(a)&&this._isRESTService(b)){var d=this._getSuffix(a).toLowerCase(),e=this._getSuffix(b).toLowerCase();c=d===e;c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,c=d.replace(c,"$1")===e.replace(c,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:!this._isServerRsrc(a)&&(!this._isServerRsrc(b)&&this._isPortalDomain(a))&&(c=!0);return c},_isPortalDomain:function(b){b=b.toLowerCase();var c=(new r(b)).authority,d=this._portalConfig,e=-1!==c.indexOf(this._agolSuffix);
!e&&d&&(e=p.hasSameOrigin(d.restBaseUrl,b,!0));if(!e){if(!this._arcgisUrl&&(d=a.getObject("esri.arcgis.utils.arcgisUrl")))this._arcgisUrl=(new r(d)).authority;this._arcgisUrl&&(e=this._arcgisUrl.toLowerCase()===c)}e||(e=f.some(this._portals,function(a){return p.hasSameOrigin(a,b,!0)}));return e=e||this._agsPortal.test(b)},_isIdProvider:function(a,b){var c=-1,d=-1;f.forEach(this._gwDomains,function(e,g){-1===c&&e.regex.test(a)&&(c=g);-1===d&&e.regex.test(b)&&(d=g)});var e=!1;if(-1<c&&-1<d)if(0===c||
4===c){if(0===d||4===d)e=!0}else if(1===c){if(1===d||2===d)e=!0}else 2===c?2===d&&(e=!0):3===c&&3===d&&(e=!0);if(!e){var g=this.findServerInfo(b),l=g&&g.owningSystemUrl;l&&(B(g)&&this._isPortalDomain(l)&&this._isIdProvider(a,l))&&(e=!0)}return e},_isPublic:function(a){a=this._sanitizeUrl(a);return f.some(this._publicUrls,function(b){return b.test(a)})},_getIdenticalSvcIdx:function(a,b){var c=-1;f.some(b.resources,function(b,d){return this._isIdenticalService(a,b)?(c=d,!0):!1},this);return c},_getSuffix:function(a){return a.replace(this._regexSDirUrl,
"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var b,c;if((b=this._isRESTService(a))||this._isAdminResource(a))return c=a.toLowerCase().indexOf(b?this._agsRest:"/admin/"),b=a.substring(0,c)+"/admin/generateToken",a=a.substring(0,c)+"/rest/info",c=l({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c.adminUrl_=b,c;if(this._isPortalDomain(a)){var d="";f.some(this._gwDomains,function(b){b.regex.test(a)&&(d=b.tokenServiceUrl);return!!d});d||f.some(this._portals,
function(b){p.hasSameOrigin(b,a,!0)&&(d=b+this._gwTokenUrl);return!!d},this);d||(c=a.toLowerCase().indexOf("/sharing"),-1!==c&&(d=a.substring(0,c)+this._gwTokenUrl));d||(d=this._getOrigin(a)+this._gwTokenUrl);d&&(b=(new r(a)).port,/^http:\/\//i.test(a)&&"7080"===b&&(d=d.replace(/:7080/i,":7443")),d=d.replace(/http:/i,"https:"));return d}if(-1!==a.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?
a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return l({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a;if(b.isSupported()){var c=this._getAllCookies("esri_auth"),d;for(d=0;d<c.length;d++){var e=n.fromJson(c[d]);if(e.portalApp){a=e;break}}}return a},
_getAllCookies:function(a){var b=[],c=document.cookie.match(RegExp("(?:^|; )"+d.escapeString(a)+"\x3d([^;]*)","g"));if(c)for(a=0;a<c.length;a++){var e=c[a],g=e.indexOf("\x3d");-1<g&&(e=e.substring(g+1),b.push(decodeURIComponent(e)))}return b},_doPortalSignIn:function(a){if(b.isSupported()){var c=this._getEsriAuthCookie(),d=this._portalConfig,e=window.location.href,g=this.findServerInfo(a);if(this.useSignInPage&&(d||this._isPortalDomain(e)||c)&&(g?g.hasPortal||g.owningSystemUrl&&this._isPortalDomain(g.owningSystemUrl):
this._isPortalDomain(a))&&(this._isIdProvider(e,a)||d&&(p.hasSameOrigin(d.restBaseUrl,a,!0)||this._isIdProvider(d.restBaseUrl,a))||p.hasSameOrigin(e,a,!0)))return!0}return!1},_checkProtocol:function(b,c,d,g){var f=!0;g=g?c.adminTokenServiceUrl:c.tokenServiceUrl;if(0===a.trim(g).toLowerCase().indexOf("https:")&&0!==window.location.href.toLowerCase().indexOf("https:")&&(!u.defaults.io.useCors||!p.canUseXhr(g)&&!p.canUseXhr(p.getProxyUrl(!0).path)))f=this._protocolFunc?!!this._protocolFunc({resourceUrl:b,
serverInfo:c}):!1,f||(b=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),b.code="IdentityManagerBase.4",b.log=e.isDebug,console.log(b.message),d(b));return f},_enqueue:function(a,b,d,e,g,f){e||(e=new k(c._dfdCanceller));e.resUrl_=a;e.sinfo_=b;e.options_=d;e.admin_=g;e.refresh_=f;this._busy?p.hasSameOrigin(a,this._busy.resUrl_,!0)?this._soReqs.push(e):this._xoReqs.push(e):this._doSignIn(e);return e},_doSignIn:function(b){this._busy=b;var c=this,d=function(a){var d=
b.options_&&b.options_.resource,e=b.resUrl_,g=b.refresh_,l=!1;-1===f.indexOf(c.credentials,a)&&(g&&-1!==f.indexOf(c.credentials,g)?(g.userId=a.userId,g.token=a.token,g.expires=a.expires,g.validity=a.validity,g.ssl=a.ssl,g.creationTime=a.creationTime,l=!0,a=g):c.credentials.push(a));a.resources||(a.resources=[]);a.resources.push(d||e);a.scope=c._isServerRsrc(e)?"server":"portal";a.onTokenChange();var d=c._soReqs,h={};c._soReqs=[];f.forEach(d,function(b){if(!this._isIdenticalService(e,b.resUrl_)){var c=
this._getSuffix(b.resUrl_);h[c]||(h[c]=!0,a.resources.push(b.resUrl_))}},c);b.callback(a);f.forEach(d,function(b){b.callback(a)});c._busy=b.resUrl_=b.sinfo_=b.refresh_=null;if(!l)c.onCredentialCreate({credential:a});c._soReqs.length&&c._doSignIn(c._soReqs.shift());c._xoReqs.length&&c._doSignIn(c._xoReqs.shift())},g=function(a){b.errback(a);c._busy=b.resUrl_=b.sinfo_=b.refresh_=null;c._soReqs.length&&c._doSignIn(c._soReqs.shift());c._xoReqs.length&&c._doSignIn(c._xoReqs.shift())},l=function(a,f,l,
h){var k=b.sinfo_,p=!b.options_||!1!==b.options_.prompt;c._doPortalSignIn(b.resUrl_)?(f=c._getEsriAuthCookie(),a=c._portalConfig,f?d(new D({userId:f.email,server:k.server,token:f.token,expires:null})):p?(p="",f=window.location.href,p=c.signInPage?c.signInPage:a?a.baseUrl+a.signin:c._isIdProvider(f,b.resUrl_)?c._getOrigin(f)+"/home/signin.html":k.tokenServiceUrl.replace(c._rePortalTokenSvc,"")+"/home/signin.html",p=p.replace(/http:/i,"https:"),a&&!1===a.useSSL&&(p=p.replace(/https:/i,"http:")),0===
f.toLowerCase().replace("https","http").indexOf(p.toLowerCase().replace("https","http"))?(k=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+b.resUrl_),k.code="IdentityManagerBase.5",k.log=e.isDebug,g(k)):c._redirectFunc?c._redirectFunc({signInPage:p,returnUrlParamName:"returnUrl",returnUrl:f,resourceUrl:b.resUrl_,serverInfo:k}):window.location=p+"?returnUrl\x3d"+window.escape(f)):(k=Error("User is not signed in."),k.code="IdentityManagerBase.6",
k.log=e.isDebug,g(k))):a?d(new D({userId:a,server:k.server,token:l,expires:m.isDefined(h)?Number(h):null,ssl:!!f})):u?(a=u._oAuthCred,a||(f=new v(u,window.localStorage),l=new v(u,window.sessionStorage),f.isValid()&&l.isValid()?f.expires>l.expires?(a=f,l.destroy()):(a=l,f.destroy()):a=f.isValid()?f:l,u._oAuthCred=a),a.isValid()?d(new D({userId:a.userId,server:k.server,token:a.token,expires:a.expires,ssl:a.ssl,_oAuthCred:a})):c._oAuthHash&&c._oAuthHash.state.portalUrl===u.portalUrl?(p=c._oAuthHash,
k=new D({userId:p.username,server:k.server,token:p.access_token,expires:(new Date).getTime()+1E3*Number(p.expires_in),ssl:"true"===p.ssl,oAuthState:p.state,_oAuthCred:a}),a.storage=p.persist?window.localStorage:window.sessionStorage,a.token=k.token,a.expires=k.expires,a.userId=k.userId,a.ssl=k.ssl,a.save(),c._oAuthHash=null,d(k)):p?b._pendingDfd=c.oAuthSignIn(b.resUrl_,k,u,b.options_).addCallbacks(d,g):(k=Error("User is not signed in."),k.code="IdentityManagerBase.6",k.log=e.isDebug,g(k))):p?c._checkProtocol(b.resUrl_,
k,g,b.admin_)&&(p=b.options_,b.admin_&&(p=p||{},p.isAdmin=!0),b._pendingDfd=c.signIn(b.resUrl_,k,p).addCallbacks(d,g)):(k=Error("User is not signed in."),k.code="IdentityManagerBase.6",k.log=e.isDebug,g(k))},h=function(){var a=b.sinfo_,e=a.owningSystemUrl,l=b.options_,h,k,p;l&&(h=l.token,k=l.error);p=c._findCredential(e,{token:h,resource:b.resUrl_});!p&&B(a)&&f.some(c.credentials,function(a){this._isIdProvider(e,a.server)&&(p=a);return!!p},c);p?(l=c.findCredential(b.resUrl_,p.userId))?d(l):z(a,c._legacyFed)?
(l=p.toJson(),l.server=a.server,l.resources=null,d(new D(l))):(b._pendingDfd=c.generateToken(c.findServerInfo(p.server),null,{serverUrl:b.resUrl_,token:p.token,ssl:p.ssl})).addCallbacks(function(c){d(new D({userId:p.userId,server:a.server,token:c.token,expires:m.isDefined(c.expires)?Number(c.expires):null,ssl:!!c.ssl,isAdmin:b.admin_,validity:c.validity}))},g):(c._busy=null,h&&(b.options_.token=null),(b._pendingDfd=c.getCredential(e.replace(/\/?$/,"/sharing"),{resource:b.resUrl_,token:h,error:k})).addCallbacks(function(a){c._enqueue(b.resUrl_,
b.sinfo_,b.options_,b,b.admin_)},function(a){g(a)}))},k=b.sinfo_.owningSystemUrl,s=this._isServerRsrc(b.resUrl_),n=b.sinfo_._restInfoDfd,u=this._findOAuthInfo(b.resUrl_);n?n.addCallbacks(function(d){var e=b.sinfo_;e.adminTokenServiceUrl=e._restInfoDfd.adminUrl_;e._restInfoDfd=null;e.tokenServiceUrl=a.getObject("authInfo.tokenServicesUrl",!1,d)||a.getObject("authInfo.tokenServiceUrl",!1,d)||a.getObject("tokenServiceUrl",!1,d);e.shortLivedTokenValidity=a.getObject("authInfo.shortLivedTokenValidity",
!1,d);e.currentVersion=d.currentVersion;e.owningTenant=d.owningTenant;if(d=e.owningSystemUrl=d.owningSystemUrl)c._portals.push(d),!e.hasPortal&&p.hasSameOrigin(d,b.resUrl_,!0)&&(u||(e._selfDfd=c._getPortalSelf(d.replace(/\/?$/,"/sharing/rest/portals/self"),b.resUrl_)),e.hasPortal=!0);s&&d?h():l()},function(){b.sinfo_._restInfoDfd=null;var a=Error("Unknown resource - could not find token service endpoint.");a.code="IdentityManagerBase.2";a.log=e.isDebug;g(a)}):s&&k?h():b.sinfo_._selfDfd?(k=function(a){b.sinfo_._selfDfd=
null;var d=a&&a.user&&a.user.username,e=a&&a.allSSL;b.sinfo_.webTierAuth=!!d;d&&c.normalizeWebTierAuth?(b.sinfo_._tokenDfd=c.generateToken(b.sinfo_,null,{ssl:e}),a=function(a){b.sinfo_._tokenDfd=null;l(d,e,a&&a.token,a&&a.expires)},b.sinfo_._tokenDfd.then(a,a)):l(d,e)},b.sinfo_._selfDfd.then(k,k)):l()}});D=q(w,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(b){a.mixin(this,b);this.resources=this.resources||[];m.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},
_oAuthCred:null,refreshToken:function(){var a=this,b=this.resources&&this.resources[0],c=h.id.findServerInfo(this.server),d=c&&c.owningSystemUrl,e=!!d&&"server"===this.scope,g=e&&z(c,h.id._legacyFed),l=e&&h.id.findServerInfo(d),k,p=(k=c.webTierAuth)&&h.id.normalizeWebTierAuth,s=y[this.server],s=s&&s[this.userId],n={username:this.userId,password:s},u;if(!k||p)if(e&&!l&&f.some(h.id.serverInfos,function(a){h.id._isIdProvider(d,a.server)&&(l=a);return!!l}),k=l&&h.id.findCredential(l.server,this.userId),
!e||k)if(g)k.refreshToken();else{if(e)u={serverUrl:b,token:k&&k.token,ssl:k&&k.ssl};else if(p)n=null,u={ssl:this.ssl};else if(s)this.isAdmin&&(u={isAdmin:!0});else{var r;b&&(b=h.id._sanitizeUrl(b),this._enqueued=1,r=h.id._enqueue(b,c,null,null,this.isAdmin,this),r.addCallback(function(){a._enqueued=0;a.refreshServerTokens()}).addErrback(function(){a._enqueued=0}));return r}return h.id.generateToken(e?l:c,e?null:n,u).addCallback(function(b){a.token=b.token;a.expires=m.isDefined(b.expires)?Number(b.expires):
null;a.creationTime=(new Date).getTime();a.validity=b.validity;a.onTokenChange();a.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&f.forEach(h.id.credentials,function(a){var b=h.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;if(a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(p.hasSameOrigin(this.server,c,!0)||h.id._isIdProvider(c,this.server)))z(b,h.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,
a.validity=this.validity,a.onTokenChange()):a.refreshToken()},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var b=this.server&&h.id.findServerInfo(this.server),c=(b=b&&b.owningSystemUrl)&&h.id.findServerInfo(b);!1!==a&&((!b||"portal"===this.scope||c&&c.webTierAuth&&!h.id.normalizeWebTierAuth)&&(m.isDefined(this.expires)||m.isDefined(this.validity)))&&this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=
this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var a=f.indexOf(h.id.credentials,this);-1<a&&h.id.credentials.splice(a,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=m.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&
(a.resources=b);return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var b=6E4*this.tokenRefreshBuffer,c=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>c&&(c=0);this._refreshTimer=setTimeout(a.hitch(this,this.refreshToken),c>b?c-b:c)}});E.Credential=D;return E})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(q,e,a,f,k){return q(null,{declaredClass:"esri.ServerInfo",constructor:function(a){e.mixin(this,
a)},toJson:function(){return k.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}})})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(q,e,a,f){return e(null,
{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(a,e){this.oAuthInfo=a;this.storage=e;this._init()},isValid:function(){var a=!1;if(this.oAuthInfo&&this.token&&this.userId){var e=(new Date).getTime();this.expires>e&&(this.expires-e)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(a=!0)}return a},save:function(){if(this.storage){var a=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){var r=a[e.authNamespace];
r||(r=a[e.authNamespace]={});r[e.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",f.stringify(a))}catch(t){console.log(t)}}}},destroy:function(){var a=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl&&this.storage){var r=a[e.authNamespace];if(r){delete r[e.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",f.stringify(a))}catch(t){console.log(t)}}}e&&(this.oAuthInfo=e._oAuthCred=null)},_init:function(){var a=
this._load(),e=this.oAuthInfo;if(e&&(e.authNamespace&&e.portalUrl)&&(a=a[e.authNamespace]))if(a=a[e.portalUrl])this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId},_load:function(){var a={};if(this.storage){var e=this.storage.getItem("esriJSAPIOAuth");if(e)try{a=f.parse(e)}catch(r){console.log(r)}}return a}})})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(q,e,a,f,k){return a(null,{declaredClass:"esri.arcgis.OAuthInfo",
constructor:function(a){f.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},a)},_oAuthCred:null,toJson:function(){return e.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,popup:this.popup,
popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})}})})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),function(q,e,a,f,k,n,r,t,b,g){f("dijit-legacy-requires")&&r(0,function(){q(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});r=e("dijit.form.Button"+(f("dojo-bidi")?
"_NoBidi":""),[t,b],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:g,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},_fillContent:function(a){if(a&&(!this.params||!("label"in this.params)))if(a=n.trim(a.innerHTML))this.label=a},_setShowLabelAttr:function(b){this.containerNode&&a.toggle(this.containerNode,"dijitDisplayNone",!b);this._set("showLabel",b)},setLabel:function(a){k.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.",
"","2.0");this.set("label",a)},_setLabelAttr:function(a){this.inherited(arguments);!this.showLabel&&!("title"in this.params)&&(this.titleNode.title=n.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});f("dojo-bidi")&&(r=e("dijit.form.Button",r,{_setLabelAttr:function(a){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));
return r})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),function(q,e,a,f,k,n,r,t){e("dijit-legacy-requires")&&f(0,function(){require(["dijit/form/_FormValueWidget"])});return q("dijit.form._FormWidget",[k,r,n,t],{setDisabled:function(b){a.deprecated("setDisabled("+b+") is deprecated. Use set('disabled',"+b+") instead.","","2.0");this.set("disabled",b)},setValue:function(b){a.deprecated("dijit.form._FormWidget:setValue("+
b+") is deprecated.  Use set('value',"+b+") instead.","","2.0");this.set("value",b)},getValue:function(){a.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!e("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),
function(q,e,a,f,k,n,r,t,b,g){return e("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(b){this._set("disabled",b);a.set(this.focusNode,"disabled",b);this.valueNode&&a.set(this.valueNode,"disabled",b);this.focusNode.setAttribute("aria-disabled",b?"true":"false");b?(this._set("hovering",!1),this._set("active",
!1),b="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",q.forEach(k.isArray(b)?b:[b],function(a){a=this[a];t("webkit")||g.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var e=this.own(r(this.focusNode,"focus",function(){f.remove();e.remove()}))[0],g=t("pointer-events")?"pointerup":
t("MSPointer")?"MSPointerUp":t("touch-events")?"touchend, mouseup":"mouseup",f=this.own(r(this.ownerDocumentBody,g,k.hitch(this,function(a){f.remove();e.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){b.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=f.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},
compare:function(a,b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){if(void 0==this._lastValueReported&&(null===b||!this._onChangeActive))this._resetValue=this._lastValueReported=a;this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);if((this.intermediateChanges||b||void 0===b)&&this._pendingOnChange)this._lastValueReported=
a,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)}))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],
function(q,e,a,f){var k=q("dijit.form._ButtonMixin"+(a("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(a){a.stopPropagation();a.preventDefault();this.disabled||this.valueNode.click(a);return!1},_onClick:function(a){if(this.disabled)return a.stopPropagation(),a.preventDefault(),!1;!1===this.onClick(a)&&a.preventDefault();var e=a.defaultPrevented;if(!e&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var k=this.domNode;k.parentNode;k=k.parentNode){var b=f.byNode(k);
if(b&&"function"==typeof b._onSubmit){b._onSubmit(a);a.preventDefault();e=!0;break}}return!e},postCreate:function(){this.inherited(arguments);e.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(a){this._set("label",a);(this.containerNode||this.focusNode).innerHTML=a}});a("dojo-bidi")&&(k=q("dijit.form._ButtonMixin",k,{_setLabelAttr:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));return k})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),
function(q,e,a,f,k,n,r){var t;return t=q("dijit.form.ValidationTextBox",k,{templateString:r,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(a,g){g!=t.prototype[a]&&(e.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+a+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",g))},_setRegExpGenAttr:function(a){this._deprecateRegExp("regExpGen",
a);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(a){this._deprecateRegExp("regExp",a)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},validator:function(a,e){return RegExp("^(?:"+this._computeRegexp(e)+")"+(this.required?"":"?")+"$").test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||void 0!==this.parse(a,e))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,
this.get("constraints"))},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(){var a="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:!this.invalidMessage?this.promptMessage:this.invalidMessage,e="$_unset_$"==this.missingMessage?this.messages.missingMessage:!this.missingMessage?a:this.missingMessage;return this.required&&this._isEmpty(this.textbox.value)?e:a},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var e=
"",d=this.disabled||this.isValid(a);d&&(this._maskValidSubsetError=!0);var f=this._isEmpty(this.textbox.value),k=!d&&a&&this._isValidSubset();this._set("state",d?"":((!this._hasBeenBlurred||a)&&f||k)&&(this._maskValidSubsetError||k&&!this._hasBeenBlurred&&a)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=a&&k,e=this.getErrorMessage(a)):"Incomplete"==this.state?(e=this.getPromptMessage(a),this._maskValidSubsetError=
!this._hasBeenBlurred||a):f&&(e=this.getPromptMessage(a));this.set("message",e);return d},displayMessage:function(a){a&&this.focused?n.show(a,this.domNode,this.tooltipPosition,!this.isLeftToRight()):n.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(b){this.constraints=a.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(a){!a.locale&&
this.lang&&(a.locale=this.lang);this._set("constraints",a);this._refreshState()},_setPatternAttr:function(a){this._set("pattern",a);this._refreshState()},_computeRegexp:function(a){var e=this.pattern;"function"==typeof e&&(e=e.call(this,a));if(e!=this._lastRegExp){var d="";this._lastRegExp=e;".*"!=e&&e.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":d+=a;break;case ")":d+="|$)";break;default:d+=
"(?:"+a+"|$)"}});try{"".search(d)}catch(f){d=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+d+")$"}return e},postMixInProperties:function(){this.inherited(arguments);this.messages=f.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",
a);this._refreshState()},_setMessageAttr:function(a){this._set("message",a);this.displayMessage(a)},reset:function(){this._maskValidSubsetError=!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){n.hide(this.domNode);this.inherited(arguments)}})})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d){t=q("dijit.form.TextBox"+(r("dojo-bidi")?"_NoBidi":""),[t,b],{templateString:g,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:r("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||
("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>r("ie")&&this.defer(function(){try{var b=a.getComputedStyle(this.domNode);if(b){var d=b.fontFamily;if(d){var e=this.domNode.getElementsByTagName("INPUT");if(e)for(b=0;b<e.length;b++)e[b].style.fontFamily=d}}}catch(g){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||
(this._attachPoints.push("_phspan"),this._phspan=e.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(n(this._phspan,"mousedown",function(a){a.preventDefault()}),n(this._phspan,"touchend, pointerup, MSPointerUp",k.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&
(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,b,d){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){f.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){f.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",
a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),r("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.inherited(arguments),this._updatePlaceHolder())}});9>r("ie")&&(t.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},d._setSelectionRange=b._setSelectionRange=function(a,
b,d){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",d-b),a.select())});r("dojo-bidi")&&(t=q("dijit.form.TextBox",t,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return t})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(q,e,a,f){return q("dijit.form._FormValueWidget",[a,f],{_layoutHackIE7:function(){if(7==
e("ie"))for(var a=this.domNode,f=a.parentNode,r=a.firstChild||a,t=r.style.filter,b=this;f&&0==f.clientHeight;)(function(){var a=b.connect(f,"onscroll",function(){b.disconnect(a);r.style.filter=(new Date).getMilliseconds();b.defer(function(){r.style.filter=t})})})(),f=f.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(q,e,a,f,k,n){return q("dijit.form._FormValueMixin",n,{readOnly:!1,
_setReadOnlyAttr:function(a){e.set(this.focusNode,"readOnly",a);this._set("readOnly",a)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(a,e){this._handleOnChange(a,e)},_handleOnChange:function(a,e){this._set("value",a);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},
"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/has dojo/keys dojo/_base/lang dojo/on ../main".split(" "),function(q,e,a,f,k,n,r,t){var b=e("dijit.form._TextBoxMixin"+(f("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(a,b,e){var f;void 0!==a&&(f=this.filter(a),"string"!=
typeof e&&(e=null!==f&&("number"!=typeof f||!isNaN(f))?this.filter(this.format(f,this.constraints)):"",0!=this.compare(f,this.filter(this.parse(e,this.constraints)))&&(e=null)));if(null!=e&&("number"!=typeof e||!isNaN(e))&&this.textbox.value!=e)this.textbox.value=e,this._set("displayedValue",this.get("displayedValue"));this.inherited(arguments,[f,b])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(a){null==a?a="":"string"!=
typeof a&&(a=String(a));this.textbox.value=a;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(a){return null==a?"":a.toString?a.toString():a},parse:function(a){return a},_refreshState:function(){},onInput:function(){},__skipInputEvent:!1,_onInput:function(a){this._processInput(a);this.intermediateChanges&&this.defer(function(){this._handleOnChange(this.get("value"),!1)})},_processInput:function(a){this._refreshState();this._set("displayedValue",
this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);this.own(r(this.textbox,"keydown, keypress, paste, cut, input, compositionend",n.hitch(this,function(a){var b;if("keydown"==a.type){b=a.keyCode;switch(b){case k.SHIFT:case k.ALT:case k.CTRL:case k.META:case k.CAPS_LOCK:case k.NUM_LOCK:case k.SCROLL_LOCK:return}if(!a.ctrlKey&&!a.metaKey&&!a.altKey){switch(b){case k.NUMPAD_0:case k.NUMPAD_1:case k.NUMPAD_2:case k.NUMPAD_3:case k.NUMPAD_4:case k.NUMPAD_5:case k.NUMPAD_6:case k.NUMPAD_7:case k.NUMPAD_8:case k.NUMPAD_9:case k.NUMPAD_MULTIPLY:case k.NUMPAD_PLUS:case k.NUMPAD_ENTER:case k.NUMPAD_MINUS:case k.NUMPAD_PERIOD:case k.NUMPAD_DIVIDE:return}if(65<=
b&&90>=b||48<=b&&57>=b||b==k.SPACE)return;b=!1;for(var e in k)if(k[e]===a.keyCode){b=!0;break}if(!b)return}}(b=32<=a.charCode?String.fromCharCode(a.charCode):a.charCode)||(b=65<=a.keyCode&&90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||a.keyCode==k.SPACE?String.fromCharCode(a.keyCode):a.keyCode);b||(b=229);if("keypress"==a.type){if("string"!=typeof b)return;if("a"<=b&&"z">=b||"A"<=b&&"Z">=b||"0"<=b&&"9">=b||" "===b)if(a.ctrlKey||a.metaKey||a.altKey)return}if("input"==a.type){if(this.__skipInputEvent){this.__skipInputEvent=
!1;return}}else this.__skipInputEvent=!0;var f={faux:!0},m;for(m in a)/^(layer[XY]|returnValue|keyLocation)$/.test(m)||(e=a[m],"function"!=typeof e&&"undefined"!=typeof e&&(f[m]=e));n.mixin(f,{charOrCode:b,_wasConsumed:!1,preventDefault:function(){f._wasConsumed=!0;a.preventDefault()},stopPropagation:function(){a.stopPropagation()}});!1===this.onInput(f)&&(f.preventDefault(),f.stopPropagation());f._wasConsumed||this.defer(function(){this._onInput(f)})})),r(this.domNode,"keypress",function(a){a.stopPropagation()}))},
_blankValue:"",filter:function(a){if(null===a)return this._blankValue;if("string"!=typeof a)return a;this.trim&&(a=n.trim(a));this.uppercase&&(a=a.toUpperCase());this.lowercase&&(a=a.toLowerCase());this.propercase&&(a=a.replace(/[^\s]+/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return a},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(a){this.disabled||(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=
this.textbox.selectionEnd},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.selectOnClick&&"mouse"==a&&(this._selectOnClickHandle=r.once(this.domNode,"mouseup, touchend",n.hitch(this,function(a){this._isTextSelected()||b.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value=
"";this.inherited(arguments)}});f("dojo-bidi")&&(b=e("dijit.form._TextBoxMixin",b,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));b._setSelectionRange=t._setSelectionRange=function(a,b,e){a.setSelectionRange&&a.setSelectionRange(b,e)};b.selectInputText=t.selectInputText=function(e,d,
f){e=a.byId(e);isNaN(d)&&(d=0);isNaN(f)&&(f=e.value?e.value.length:0);try{e.focus(),b._setSelectionRange(e,d,f)}catch(k){}};return b})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l){function w(){}
var v=e("dijit._MasterTooltip",[m,s],{duration:h.defaultDuration,templateString:c,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new p(this.domNode);this.fadeIn=a.fadeIn({node:this.domNode,duration:this.duration,onEnd:t.hitch(this,"_onShow")});this.fadeOut=a.fadeOut({node:this.domNode,duration:this.duration,onEnd:t.hitch(this,"_onHide")})},show:function(a,b,c,d,e,g,f){if(!this.aroundNode||!(this.aroundNode===b&&this.containerNode.innerHTML==a))if("playing"==this.fadeOut.status())this._onDeck=
arguments;else{this.containerNode.innerHTML=a;e&&this.set("textDir",e);this.containerNode.align=d?"right":"left";var l=u.around(this.domNode,b,c&&c.length?c:x.defaultPosition,!d,t.hitch(this,"orient")),h=l.aroundNodePos;"M"==l.corner.charAt(0)&&"M"==l.aroundCorner.charAt(0)?(this.connectorNode.style.top=h.y+(h.h-this.connectorNode.offsetHeight>>1)-l.y+"px",this.connectorNode.style.left=""):"M"==l.corner.charAt(1)&&"M"==l.aroundCorner.charAt(1)?this.connectorNode.style.left=h.x+(h.w-this.connectorNode.offsetWidth>>
1)-l.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");r.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=g||w;this.onMouseLeave=f||w}},orient:function(a,b,c,e,g){this.connectorNode.style.top="";var f=e.h;e=e.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft",
"BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+c];this.domNode.style.width="auto";var l=n.position(this.domNode);if(d("ie")||d("trident"))l.w+=2;var h=Math.min(Math.max(e,1),l.w);n.setMarginBox(this.domNode,{w:h});"B"==c.charAt(0)&&"B"==b.charAt(0)?(a=n.position(a),b=this.connectorNode.offsetHeight,a.h>f?(this.connectorNode.style.top=f-(g.h+b>>1)+"px",this.connectorNode.style.bottom=""):
(this.connectorNode.style.bottom=Math.min(Math.max(g.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,l.w-e)},_onShow:function(){d("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=w},_onHide:function(){this.domNode.style.cssText=
"";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});d("dojo-bidi")&&v.extend({_setAutoTextDir:function(a){this.applyTextDir(a);q.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});l.showTooltip=function(a,b,c,d,e,g,f){c&&(c=q.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||
a}));x._masterTT||(l._masterTT=x._masterTT=new v);return x._masterTT.show(a,b,c,d,e,g,f)};l.hideTooltip=function(a){return x._masterTT&&x._masterTT.hide(a)};var x=e("dijit.Tooltip",m,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){q.forEach(this._connections||[],function(a){q.forEach(a,function(a){a.remove()})},this);this._connectIds=q.filter(t.isArrayLike(a)?a:a?[a]:[],function(a){return f.byId(a,this.ownerDocument)},this);this._connections=
q.map(this._connectIds,function(a){a=f.byId(a,this.ownerDocument);var c=this.selector,d=c?function(a){return g.selector(c,a)}:function(a){return a},e=this;return[g(a,d(b.enter),function(){e._onHover(this)}),g(a,d("focusin"),function(){e._onHover(this)}),g(a,d(b.leave),t.hitch(e,"_onUnHover")),g(a,d("focusout"),t.hitch(e,"set","state","DORMANT"))]},this);this._set("connectId",a)},addTarget:function(a){a=a.id||a;-1==q.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=
q.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);k.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;q.forEach(t.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==
a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(x.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");
return}x.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,t.hitch(this,"set","state","SHOWING"),t.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state",
"HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");q.forEach(this._connections||[],function(a){q.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});x._MasterTooltip=v;x.show=l.showTooltip;x.hide=l.hideTooltip;x.defaultPosition=["after-centered","before-centered"];return x})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),
function(q,e,a,f,k,n,r){function t(b,d,f,u){var m=n.getEffectiveBox(b.ownerDocument);(!b.parentNode||"body"!=String(b.parentNode.tagName).toLowerCase())&&k.body(b.ownerDocument).appendChild(b);var s=null;q.some(d,function(a){var c=a.corner,d=a.pos,k=0,p={w:{L:m.l+m.w-d.x,R:d.x-m.l,M:m.w}[c.charAt(1)],h:{T:m.t+m.h-d.y,B:d.y-m.t,M:m.h}[c.charAt(0)]},n=b.style;n.left=n.right="auto";f&&(k=f(b,a.aroundCorner,c,p,u),k="undefined"==typeof k?0:k);var r=b.style,t=r.display,q=r.visibility;"none"==r.display&&
(r.visibility="hidden",r.display="");n=e.position(b);r.display=t;r.visibility=q;t={L:d.x,R:d.x-n.w,M:Math.max(m.l,Math.min(m.l+m.w,d.x+(n.w>>1))-n.w)}[c.charAt(1)];q={T:d.y,B:d.y-n.h,M:Math.max(m.t,Math.min(m.t+m.h,d.y+(n.h>>1))-n.h)}[c.charAt(0)];d=Math.max(m.l,t);r=Math.max(m.t,q);t=Math.min(m.l+m.w,t+n.w);q=Math.min(m.t+m.h,q+n.h);t-=d;q-=r;k+=n.w-t+(n.h-q);if(null==s||k<s.overflow)s={corner:c,aroundCorner:a.aroundCorner,x:d,y:r,w:t,h:q,overflow:k,spaceAvailable:p};return!k});s.overflow&&f&&f(b,
s.aroundCorner,s.corner,s.spaceAvailable,u);d=s.y;var p=s.x,c=k.body(b.ownerDocument);/relative|absolute/.test(a.get(c,"position"))&&(d-=a.get(c,"marginTop"),p-=a.get(c,"marginLeft"));c=b.style;c.top=d+"px";c.left=p+"px";c.right="auto";return s}var b={TL:"BR",TR:"BL",BL:"TR",BR:"TL"};return r.place={at:function(a,d,e,f,m){e=q.map(e,function(a){var e={corner:a,aroundCorner:b[a],pos:{x:d.x,y:d.y}};f&&(e.pos.x+="L"==a.charAt(1)?f.x:-f.x,e.pos.y+="T"==a.charAt(0)?f.y:-f.y);return e});return t(a,e,m)},
around:function(b,d,h,k,m){function s(a,b){E.push({aroundCorner:a,corner:b,pos:{x:{L:y,R:y+z,M:y+(z>>1)}[a.charAt(1)],y:{T:B,B:B+D,M:B+(D>>1)}[a.charAt(0)]}})}var p;if("string"==typeof d||"offsetWidth"in d||"ownerSVGElement"in d){if(p=e.position(d,!0),/^(above|below)/.test(h[0])){var c=e.getBorderExtents(d),l=d.firstChild?e.getBorderExtents(d.firstChild):{t:0,l:0,b:0,r:0},n=e.getBorderExtents(b),r=b.firstChild?e.getBorderExtents(b.firstChild):{t:0,l:0,b:0,r:0};p.y+=Math.min(c.t+l.t,n.t+r.t);p.h-=
Math.min(c.t+l.t,n.t+r.t)+Math.min(c.b+l.b,n.b+r.b)}}else p=d;if(d.parentNode){c="absolute"==a.getComputedStyle(d).position;for(d=d.parentNode;d&&1==d.nodeType&&"BODY"!=d.nodeName;){l=e.position(d,!0);n=a.getComputedStyle(d);/relative|absolute/.test(n.position)&&(c=!1);if(!c&&/hidden|auto|scroll/.test(n.overflow)){var r=Math.min(p.y+p.h,l.y+l.h),x=Math.min(p.x+p.w,l.x+l.w);p.x=Math.max(p.x,l.x);p.y=Math.max(p.y,l.y);p.h=r-p.y;p.w=x-p.x}"absolute"==n.position&&(c=!0);d=d.parentNode}}var y=p.x,B=p.y,
z="w"in p?p.w:p.w=p.width,D="h"in p?p.h:(f.deprecated("place.around: dijit/place.__Rectangle: { x:"+y+", y:"+B+", height:"+p.height+", width:"+z+" } has been deprecated.  Please use { x:"+y+", y:"+B+", h:"+p.height+", w:"+z+" }","","2.0"),p.h=p.height),E=[];q.forEach(h,function(a){var b=k;switch(a){case "above-centered":s("TM","BM");break;case "below-centered":s("BM","TM");break;case "after-centered":b=!b;case "before-centered":s(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":s(b?
"TL":"TR",b?"TR":"TL");s(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":s(b?"BL":"BR",b?"TL":"TR");s(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":s(b?"TL":"TR",b?"BL":"BR");s(b?"TR":"TL",b?"BR":"BL");break;default:s(a.aroundCorner,a.corner)}});b=t(b,E,m,{w:z,h:D});b.aroundNodePos=p;return b}}})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!esri/nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,b,c,f){var h=this._oAuthDfd=new t;h.resUrl_=a;h.sinfo_=b;h.oinfo_=c;var m=!f||!1!==f.oAuthPopupConfirmation;if(!c.popup||!m)return this._doOAuthSignIn(a,b,c),h;this._nls||(this._nls=d.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());c=this.oAuthDialog;m=f&&f.error;f=f&&f.token;e.hide(c.errMsg_);m&&(403==m.code&&f)&&(g.set(c.errMsg_,"innerHTML",this._nls.forbidden),e.show(c.errMsg_));g.set(c.resLink_,
{title:a,innerHTML:"("+(this.getResourceName(a)||this._nls.lblItem)+")"});g.set(c.serverLink_,{title:b.server,innerHTML:(-1!==b.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":b.server)+" "});c.show();return h},setOAuthResponseHash:function(a){var b=this._oAuthDfd;this._oAuthDfd=null;if(b&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=h.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code=
"IdentityManagerBase.2",a.log=r.isDebug,b.errback(a);else{var c=b.oinfo_._oAuthCred,d=new q({userId:a.username,server:b.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),ssl:"true"===a.ssl,_oAuthCred:c});c.storage=a.persist?window.localStorage:window.sessionStorage;c.token=d.token;c.expires=d.expires;c.userId=d.userId;c.ssl=d.ssl;c.save();b.callback(d)}},_createOAuthDialog:function(){var d=this._nls,g=a.substitute(d,this._oAuthDialogContent),g=a.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},g),c=new k({title:d.title,content:g,"class":"esriOAuthSignInDialog",style:"width: 18em;",esriIdMgr_:this,execute_:function(){var a=c.esriIdMgr_._oAuthDfd;c.hide_();c.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=c.esriIdMgr_._oAuthDfd;c.esriIdMgr_._oAuthDfd=null;c.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=r.isDebug;a.errback(b)},hide_:function(){e.hide(c.errMsg_);
c.hide();k._DialogLevelManager.hide(c)}}),d=c.domNode;c.btnSubmit_=n.byNode(b.query(".esriIdSubmit",d)[0]);c.btnCancel_=n.byNode(b.query(".esriIdCancel",d)[0]);c.resLink_=b.query(".resLink",d)[0];c.serverLink_=b.query(".serverLink",d)[0];c.errMsg_=b.query(".esriErrorMsg",d)[0];c.connect(c.btnSubmit_,"onClick",c.execute_);c.connect(c.btnCancel_,"onClick",c.onCancel);c.connect(c,"onCancel",c.cancel_);return c},_doOAuthSignIn:function(a,b,c){var d=this,e={client_id:c.appId,response_type:"token",state:m.stringify({portalUrl:c.portalUrl}),
expiration:c.expiration,locale:c.locale,redirect_uri:c.popup?f.getAbsoluteUrl(c.popupCallbackUrl):window.location.href.replace(/#.*$/,"")},g=c.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",k=g+"?"+h.objectToQuery(e);if(c.popup){var n;7===u("ie")?(n=window.open(c.popupCallbackUrl,"esriJSAPIOAuth",c.popupWindowFeatures),n.location=k):n=window.open(k,"esriJSAPIOAuth",c.popupWindowFeatures);this._oAuthIntervalId=setInterval(function(){if(n.closed){clearInterval(d._oAuthIntervalId);
var a=d._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=r.isDebug;a.errback(b)}}},500)}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:e,authorizeUrl:g,resourceUrl:a,serverInfo:b,oAuthInfo:c}):window.location=k}}})},"builder/tokenUtils":function(){define(["jimu/tokenUtils"],function(q){return q})},"builder/utils":function(){define(["dojo/request/xhr","dojo/cookie","jimu/portalUrlUtils","jimu/utils"],function(q,e,a,f){return{getAppPathById:function(a){return window.isXT?
path+"apps/"+a+"/":path+"stemapp/"},appendParamsToAppPath:function(a,e){var f=a,t;for(t in e)e.hasOwnProperty(t)&&(f=0>f.indexOf("?")?f+"?"+t+"\x3d"+e[t]:f+"\x26"+t+"\x3d"+e[t]);return f},removeActionFromUrl:function(a){return f.url.removeQueryParamFromUrl(a,"action")},checkProtocolAndUpdateSigninInfo:function(f,n){var r=n.portalUrl,t=r,b="https"===a.getProtocol(r),g=!!f.allSSL;b!==g&&g&&(t=a.setHttpsProtocol(r));n.portalUrl=t;return q("/webappbuilder/rest/signininfo/setsignininfo",{handleAs:"json",
data:n,method:"POST"}).then(function(a){a.success&&(e("wab_portalurl",t,{path:"/webappbuilder"}),e("wab_portalurl",t,{path:"/webappviewer"}),e("wab_portalurl_persistent",t,{path:"/",expires:365}));return a})}}})},"builder/PluginManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/Evented dojo/aspect dojo/promise/all jimu/utils".split(" "),function(q,e,a,f,k,n,r,t,b){var g=null,d=q(n,{constructor:function(a){this.loaded=[];a&&(this.pluginsMeta=
a)},loadPlugin:function(a){var b=new k,d;if(d=this.getPluginByName(a.name))b.resolve(d);else{if(!1===a.properties.hasClass)return d={name:a.name},this.loaded.push(d),b.resolve(d),b;this.loadPluginClass(a).then(e.hitch(this,function(d){this.loadPluginResources(a).then(e.hitch(this,function(g){try{var c=this.createPlugin(a,d,g)}catch(f){console.log("create ["+a.uri+"] error:"+f.stack),b.reject(f)}setTimeout(e.hitch(this,function(){b.resolve(c);this.emit("pluginCreated",c)}),50)}),function(a){b.reject(a)})}),
function(a){b.reject(a)})}return b},getExtensions:function(a){var b=[],d;for(d in this.pluginsMeta)for(var e=this.pluginsMeta[d],g=0;g<e.extensions.length;g++){var c=e.extensions[g];c.point===a&&b.push(c)}return b},getStemappInfo:function(a){for(var b=this.getExtensions("startup.stemapps"),d={},e=0;e<b.length;e++){var g=b[e];if(g.parameters.appType===a){var c=this.pluginsMeta[g.pluginName];d.appPath=g.parameters.appPath?c.folderUrl+g.parameters.appPath:c.folderUrl;d.appVersionManager=g.parameters.appVersionManager;
d.appType=a}}return d},loadPluginClass:function(a){var b=new k;require([a.uri],e.hitch(this,function(a){b.resolve(a)}));return b},loadPluginResources:function(a){var b=new k,d,g,f=[];d=this.loadPluginI18n(a);g=this.loadPluginStyle(a);a=this.loadPluginTemplate(a);f.push(d);f.push(a);f.push(g);t(f).then(e.hitch(this,function(a){var d={};d.i18n=a[0];d.template=a[1];d.style=a[2];b.resolve(d)}),function(a){b.reject(a)});return b},createPlugin:function(a,b,d){if(this.getPluginByName(a.name))return this.getPluginByName(a.name);
a.nls=d.i18n||{};d.template&&(a.templateString=d.template);a["class"]="builder-plugin";a.pluginsMeta=this.pluginsMeta;a.pluginManager=this;a=new b(a);r.before(a,"destroy",e.hitch(this,this._onDestroyPlugin,a));this.loaded.push(a);return a},getAllPlugins:function(){return this.loaded},destroyAllPlugins:function(){var b=a.map(this.loaded,function(a){return a.id});a.forEach(b,function(a){this.destroyPlugin(a)},this);this.loaded=[]},getPluginByName:function(b){var d;a.some(this.loaded,function(a){if(a.name===
b)return d=a,!0},this);return d},loadPluginStyle:function(a){var d="plugin/style/"+a.uri,e=new k;if(!1===a.properties.hasStyle)return e.resolve(null),e;d=this._replaceId(d);return f.byId(d)?(e.resolve("load"),e):b.loadStyleLink(d,a.amdFolder+"css/style.css")},loadPluginI18n:function(a){var b=new k;if(!1===a.properties.hasLocale)return b.resolve(null),b;require(["dojo/i18n!"+a.amdFolder+"nls/strings"],function(a){b.resolve(a)});return b},loadPluginTemplate:function(a){var b=new k;if(!1===a.properties.hasUIFile)return b.resolve(null),
b;require(["dojo/text!"+a.amdFolder+"Plugin.html"],function(a){b.resolve(a)});return b},removePluginStyle:function(a){f.destroy(this._replaceId("plugin/style/"+a.uri))},_remove:function(b){return a.some(this.loaded,function(a,d){if(a.id===b)return this.loaded.splice(d,1),!0},this)},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyPlugin:function(a){"closed"!==a.state&&this.closePlugin(a);this._removePlugin(a)},_removePlugin:function(a){if("string"===typeof a&&(a=this.getPluginById(a),
!a))return;this.removePluginStyle(a);this._remove(a.id)}});d.getInstance=function(a){null===g?g=new d(a):a&&(g.pluginsMeta=a);return g};return d})},"builder/plugins/_build-generate_plugins_module":function(){define("builder/plugins/app-actions/launch-app/_build-generate_module builder/plugins/app-actions/preview-app/_build-generate_module builder/plugins/app-actions/save-app/_build-generate_module builder/plugins/app-config/_build-generate_module builder/plugins/app-config-configpart/_build-generate_module builder/plugins/app-config-morepreview-selectionpart/_build-generate_module builder/plugins/app-list/_build-generate_module builder/plugins/attribute-config/_build-generate_module builder/plugins/creation-entry/_build-generate_module builder/plugins/header/_build-generate_module builder/plugins/map-config/_build-generate_module builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module builder/plugins/popup-actions/popup-saveas/_build-generate_module builder/plugins/startup/_build-generate_module builder/plugins/stemapps/web2d/_build-generate_module builder/plugins/theme-config/_build-generate_module builder/plugins/widget-config/_build-generate_module".split(" "),
function(){})},"builder/plugins/app-actions/launch-app/_build-generate_module":function(){define(["builder/plugins/app-actions/launch-app/Plugin","dojo/text!builder/plugins/app-actions/launch-app/Plugin.html","dojo/text!builder/plugins/app-actions/launch-app/css/style.css","dojo/i18n!builder/plugins/app-actions/launch-app/nls/strings"],function(){})},"builder/plugins/app-actions/launch-app/Plugin":function(){define(["dojo/_base/declare","builder/BasePlugin","dojo/_base/html","jimu/portalUrlUtils"],
function(q,e,a,f){return q([e],{baseClass:"plugin-app-actions-launch-app",postCreate:function(){this.inherited(arguments);var e;e=window.isXT?window.appInfo.appPath:f.getDeployContextFromLocation()+"apps/webappviewer/index.html?id\x3d"+window.appInfo.appId;e=a.create("a",{href:e,target:"_blank"},this.domNode);a.create("div",{"class":"footer-button",title:this.nls.label,innerHTML:this.nls.label},e)}})})},"builder/BasePlugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),
function(q,e,a,f,k,n){return q([k,n],{id:void 0,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",constructor:function(){this.extensions={};this.own(f.subscribe("publishData",e.hitch(this,this._onReceiveData)));this.own(f.subscribe("dataFetched",e.hitch(this,this._onReceiveData)));this.own(f.subscribe("noData",e.hitch(this,this._onNoData)))},getPluginsMetaByExtensionPoint:function(e){var f=[];a.forEach(this.extensionPoints[e].extensions,
function(a){f.push(this.pluginsMeta[a.pluginName])},this);return f},filterExtensionsByAppType:function(e,f){if(!this.extensionPoints[e].parameters||!this.extensionPoints[e].parameters.supportAppTypes)return this.extensionPoints[e].extensions;var b=[];a.forEach(this.extensionPoints[e].extensions,function(a){("all"===a.parameters.supportAppTypes||-1<a.parameters.supportAppTypes.indexOf(f))&&b.push(a)},this);return b},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},
onMaximize:function(){},onSignIn:function(a){},onSignOut:function(){},setState:function(a){this.state=a},setWindowState:function(a){this.windowState=a},resize:function(){},publishData:function(a,e){"undefined"===typeof e&&(e=!1);f.publish("publishData",this.name,this.id,a,e)},fetchData:function(e){e?f.publish("fetchData",e):0!==this.listenWidgetIds.length?a.forEach(this.listenWidgetIds,function(a){f.publish("fetchData",a)},this):f.publish("fetchData")},fetchDataByName:function(e){e=this.widgetManager.getWidgetsByName(e);
a.forEach(e,function(a){this.fetchData(a.id)},this)},_onReceiveData:function(a,e,b,g){if(e!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(e)))this.onReceiveData(a,e,b,g)},onReceiveData:function(a,e,b,g){},_onNoData:function(a,e){if(!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(e)))this.onNoData(a,e)},onNoData:function(a,e){}})})},"builder/plugins/app-actions/preview-app/_build-generate_module":function(){define(["builder/plugins/app-actions/preview-app/Plugin",
"dojo/text!builder/plugins/app-actions/preview-app/Plugin.html","dojo/text!builder/plugins/app-actions/preview-app/css/style.css","dojo/i18n!builder/plugins/app-actions/preview-app/nls/strings"],function(){})},"builder/plugins/app-actions/preview-app/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","builder/BasePlugin","dojo/_base/html","dojo/on"],function(q,e,a,f,k){return q([a],{baseClass:"plugin-app-actions-preview-app",postCreate:function(){this.own(k(this.domNode,"click",e.hitch(this,
this._onClick)))},_onClick:function(){var a=this.pluginManager.getPluginByName("app-config");"none"===f.getStyle(this.btnConfig,"display")?(a.switchToPreviewMore(),f.setStyle(this.btnPreview,"display","none"),f.setStyle(this.btnConfig,"display","inline-block")):(a.switchToPreviewConfig(),f.setStyle(this.btnPreview,"display","inline-block"),f.setStyle(this.btnConfig,"display","none"))}})})},"builder/plugins/app-actions/save-app/_build-generate_module":function(){define(["builder/plugins/app-actions/save-app/Plugin",
"dojo/text!builder/plugins/app-actions/save-app/Plugin.html","dojo/text!builder/plugins/app-actions/save-app/css/style.css","dojo/i18n!builder/plugins/app-actions/save-app/nls/strings"],function(){})},"builder/plugins/app-actions/save-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/Deferred dojo/on jimu/utils jimu/dijit/Message jimu/dijit/Popup builder/BasePlugin builder/serviceUtils jimu/portalUrlUtils builder/portalUtils".split(" "),function(q,e,
a,f,k,n,r,t,b,g,d,h,u){return q([g],{baseClass:"plugin-app-actions-save-app",lastAppConfig:null,postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);var a=h.getStandardPortalUrl(window.portalUrl);u.getPortal(a).getUser().then(e.hitch(this,function(a){this.username=a.username;this._isGuestAccessApp()&&this._blockSaveButton()}));this.own(f.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));
this.own(f.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)));this.own(f.subscribe("closeAppConfigPage",e.hitch(this,this._onLeavePage)));this.own(n(this.domNode,"click",e.hitch(this,this._onClick)))},_onClick:function(){this.saveApp()},_isGuestAccessApp:function(){return!this.username||this.username!==window.appInfo.appOwner?!0:!1},_enableSaveButton:function(){a.addClass(this.actionNode,"save-enable");a.setStyle(this.domNode,"cursor","pointer");a.setAttr(this.actionNode,"innerHTML",
this.nls.save);a.setAttr(this.actionNode,"title",this.nls.save)},_disableSaveButton:function(){a.removeClass(this.actionNode,"save-enable");a.setStyle(this.domNode,"cursor","default");a.setAttr(this.actionNode,"innerHTML",this.nls.saved);a.setAttr(this.actionNode,"title",this.nls.saved)},_blockSaveButton:function(){a.addClass(this.actionNode,"save-block");a.setStyle(this.domNode,"cursor","default")},_onAppConfigLoaded:function(a){this.lastAppConfig=e.clone(a);this._setAppConfig(a)},_onAppConfigChanged:function(a){this._setAppConfig(a)},
_setAppConfig:function(a){this.appConfig=a;this._appHasChanged()?(this._enableSaveButton(),this._enableUnloadDlg()):(this._disableSaveButton(),this._disableUnloadDlg())},_appHasChanged:function(){if(this._isGuestAccessApp())return!1;var a=e.clone(this.appConfig.getCleanConfig()),b=e.clone(this.lastAppConfig.getCleanConfig());a.theme&&(a.theme.styles&&b.theme&&b.theme.styles)&&(a.theme.styles.splice(1,a.theme.styles.length),b.theme.styles.splice(1,b.theme.styles.length));return!r.isEqual(a,b)},saveApp:function(){this._appHasChanged()&&
(a.setAttr(this.actionNode,"innerHTML",this.nls.saving),a.setAttr(this.actionNode,"title",this.nls.saving),this._saveApp().then(e.hitch(this,function(a){a.success&&(this._disableSaveButton(),this._disableUnloadDlg())}),e.hitch(this,function(){this._enableSaveButton()})))},_saveApp:function(){var a=new k,b=this.appConfig;d.saveApp(window.appInfo.appId,b.getCleanConfig()).then(e.hitch(this,function(d){d.success?(this.lastAppConfig=e.clone(b),a.resolve(d),(d=this.pluginManager.getPluginByName("app-list"))&&
window.isXT&&d.refresh()):(new t({message:this.nls.saveFailedMeg+": "+d.message}),a.reject())}),e.hitch(this,function(b){new t({message:this.nls.saveFailedMeg});console.error(b);a.reject()}));return a},_enableUnloadDlg:function(){window.onbeforeunload=e.hitch(this,function(){return this.nls.theApp+' "'+this.options.name+'" '+this.nls.unloadMessage})},_disableUnloadDlg:function(){window.onbeforeunload=null},_onLeavePage:function(a){var d=this.pluginManager.getPluginByName("header");if(this._appHasChanged())var g=
new b({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'"+this.folderUrl+"css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMegBegin+this.options.name+this.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.toHomeTitle,width:425,height:180,buttons:[{label:this.nls.save,onClick:e.hitch(this,function(){"stemapp"===window.appInfo.appId?
(new t({message:this.nls.canNotSaveMeg}),g.close()):this._saveApp().then(e.hitch(this,function(b){g.close();b.success&&(window.onbeforeunload=null,d.setAppName(""),a())}),e.hitch(this,function(a){console.error(this.nls.saveFailedMeg,a)}))})},{label:this.nls.doNotSave,onClick:e.hitch(this,function(){g.close();window.onbeforeunload=null;d.setAppName("");a()})},{label:this.nls.cancel,onClick:e.hitch(this,function(){g.close()})}]});else window.onbeforeunload=null,a()}})})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),
function(q,e,a,f,k,n){return q(n,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=a.create("div",{"class":"title"},this.domNode),this.titleLabeNode=a.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=a.create("div",
{"class":"close-btn jimu-float-trailing"},this.titleNode),this.own(k(this.closeBtnNode,"click",e.hitch(this,this.close))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:"OK",key:f.ENTER,onClick:e.hitch(this,this.close)})},_increaseZIndex:function(){a.setStyle(this.domNode,"zIndex",9999);a.setStyle(this.overlayNode,"zIndex",9998)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/sniff dojo/query dojo/dnd/move dijit/_WidgetBase".split(" "),
function(q,e,a,f,k,n,r,t,b,g){var d=0;return q(g,{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this.domNode.tabIndex=
1;this._initDomNode();this._positioning();f.place(this.domNode,this.container);this._moveToMiddle();this.own(n(window,"resize",e.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),this._moveToMiddle()):this._positioning()})));this.overlayNode=f.create("div",{"class":"popup-overlay"},this.container);this._increaseZIndex();k.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&
(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=f.create("div",{"class":"title"},this.domNode);this.titleLabeNode=f.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=f.create("div",{"class":"close-btn jimu-float-trailing"},this.titleNode);this.own(n(this.closeBtnNode,"click",e.hitch(this,this.close)))},_initDomNode:function(){this._createTitleNode();
this.contentContainerNode=f.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&f.place(this.content,this.contentContainerNode));this.buttonContainer=f.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&f.setStyle(this.buttonContainer,"display","none");for(var a=
this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var b=this.enabledButtons.length;if(0!==b){var d=f.getContentBox(this.buttonContainer),g=f.getMarginExtents(this.enabledButtons[0]),k=f.getPadBorderExtents(this.enabledButtons[0]),p=0,k=8===r("ie")?k.l+k.r:0,p=(d.w-(g.l+g.r+k)*b)/b;0<p&&(a.forEach(this.enabledButtons,e.hitch(this,function(a){f.setStyle(a,"maxWidth",p+"px")})),a.forEach(this.disabledButtons,
e.hitch(this,function(a){f.setStyle(a,"maxWidth",p+"px")})))}},_moveableNode:function(a,d){this.moveable&&(this.moveable.destroy(),this.moveable=null);var g=f.getMarginBox(this.container);g.l=g.l-a+d;g.w+=2*(a-d);this.moveable=new b.boxConstrainedMoveable(this.domNode,{box:g,handle:this.titleNode,within:!0});this.own(n(this.moveable,"Moving",e.hitch(this,this.onMoving)));this.own(n(this.moveable,"MoveStop",e.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===t("#header").length?{t:0,
l:0,w:0,h:0}:f.getMarginBox("header")},_getFooterBox:function(){return 0===t(".footer",this.container).length?{t:0,l:0,w:0,h:0}:f.getMarginBox(t(".footer",this.container)[0])},_calculatePosition:function(){var a=f.getContentBox(this.container),b=this._getHeaderBox(),d=this._getFooterBox(),d=a.h-b.h-d.h-40,e=0;e=this._fixedHeight?this.height:this.autoHeight?d-200:this.height=d>this.maxHeight?this.maxHeight:d;d=(d-e)/2+b.h+20;d=d<b.h?b.h:d;this.width=this.width||this.maxWidth;f.setStyle(this.domNode,
{left:(a.w-this.width)/2+"px",top:d+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?(f.setStyle(this.domNode,"height","auto"),f.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&f.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(f.setStyle(this.domNode,"height",this.height+"px"),f.addClass(this.contentContainerNode,"content-absolute"),f.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&f.setStyle(this.contentContainerNode,
{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=f.getMarginBox(this.domNode),b=f.getContentBox(this.container),d=this._getHeaderBox(),e=this._getFooterBox(),e=b.h-d.h-e.h-40,g=0,g=a.h||e-200,a=(e-g)/2+d.h+20,a=a<d.h?d.h:a;f.setStyle(this.domNode,{left:(b.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},_increaseZIndex:function(){f.setStyle(this.domNode,"zIndex",
d+501);f.setStyle(this.overlayNode,"zIndex",d+500);d++},onMoving:function(a){f.setStyle(a.node,"opacity",0.9)},onMoveStop:function(a){f.setStyle(a.node,"opacity",1)},close:function(){if(!(this.onClose&&!1===this.onClose())){var a=this.domNode.parentNode,b=e.clone(this.domNode);f.setStyle(this.domNode,"display","none");f.destroy(this.overlayNode);this.destroy();this.moveable.destroy();f.place(b,a);k.animateProperty({node:b,properties:{opacity:0},duration:200,onEnd:function(){f.destroy(b)}}).play()}},
addButton:function(a){this._createButton(a)},_createButton:function(a){var b=f.create("div",{"class":"jimu-popup-btn jimu-float-trailing jimu-leading-margin1",innerHTML:a.label},this.buttonContainer);this.enabledButtons.unshift(b);var d=f.create("div",{"class":"jimu-popup-btn jimu-state-disabled jimu-float-trailing jimu-leading-margin1",innerHTML:a.label,style:{display:"none"}},this.buttonContainer);this.disabledButtons.unshift(d);d="click";"ontouchend"in b&&(d="touchend");this.own(n(b,d,e.hitch(this,
function(b){if(a.onClick)a.onClick(b);else this.close()})))},enableButton:function(b){"number"===typeof b?(f.setStyle(this.enabledButtons[b],"display","inline-block"),f.setStyle(this.disabledButtons[b],"display","none")):(a.forEach(this.enabledButtons[b],e.hitch(this,function(a){f.setStyle(a,"display","inline-block")})),a.forEach(this.disabledButtons[b],e.hitch(this,function(a){f.setStyle(a,"display","none")})))},disableButton:function(b){"number"===typeof b?(f.setStyle(this.disabledButtons[b],"display",
"inline-block"),f.setStyle(this.enabledButtons[b],"display","none")):(a.forEach(this.disabledButtons,e.hitch(this,function(a){f.setStyle(a,"display","inline-block")})),a.forEach(this.enabledButtons,e.hitch(this,function(a){f.setStyle(a,"display","none")})))}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(q,e,a,f,k,n){f=q("dojo.dnd.move.constrainedMoveable",n,{constraints:function(){},within:!1,constructor:function(a,
e){e||(e={});this.constraints=e.constraints;this.within=e.within},onFirstMove:function(a){var f=this.constraintBox=this.constraints.call(this,a);f.r=f.l+f.w;f.b=f.t+f.h;this.within&&(a=e.getMarginSize(a.node),f.r-=a.w,f.b-=a.h)},onMove:function(a,e){var b=this.constraintBox,g=a.node.style;this.onMoving(a,e);e.l=e.l<b.l?b.l:b.r<e.l?b.r:e.l;e.t=e.t<b.t?b.t:b.b<e.t?b.b:e.t;g.left=e.l+"px";g.top=e.t+"px";this.onMoved(a,e)}});k=q("dojo.dnd.move.boxConstrainedMoveable",f,{box:{},constructor:function(a,
e){var b=e&&e.box;this.constraints=function(){return b}}});q=q("dojo.dnd.move.parentConstrainedMoveable",f,{area:"content",constructor:function(f,k){var b=k&&k.area;this.constraints=function(){var g=this.node.parentNode,d=a.getComputedStyle(g),f=e.getMarginBox(g,d);if("margin"==b)return f;var k=e.getMarginExtents(g,d);f.l+=k.l;f.t+=k.t;f.w-=k.w;f.h-=k.h;if("border"==b)return f;k=e.getBorderExtents(g,d);f.l+=k.l;f.t+=k.t;f.w-=k.w;f.h-=k.h;if("padding"==b)return f;k=e.getPadExtents(g,d);f.l+=k.l;f.t+=
k.t;f.w-=k.w;f.h-=k.h;return f}}});return{constrainedMoveable:f,boxConstrainedMoveable:k,parentConstrainedMoveable:q}})},"builder/serviceUtils":function(){define("dojo/_base/lang dojo/request/xhr dojo/Deferred dojo/json dojo/_base/array jimu/utils jimu/portalUrlUtils builder/portalUtils dojo/promise/all builder/tokenUtils".split(" "),function(q,e,a,f,k,n,r,t,b,g){function d(a){return e("/webappbuilder/rest/signininfo/getsignininfo",{query:{portalUrl:a},handleAs:"json"})}function h(a,b,c,d,e,g){b.title=
a.name;b.isWebTier=g;b.portalUrl=c;b.map.itemId=d;b.geometryService=e.helperServices.geometry.url;a.webmap||(b.map.mapOptions||(b.map.mapOptions={}),b.map.mapOptions.extent=e.defaultExtent);a="/proxy.js";window.isXT||(a=r.getPortalProxyUrl(b.portalUrl),a=r.removeProtocol(a));b.httpProxy={useProxy:!0,url:a}}function u(b,c){var d=new a,e={title:b.name,type:"Web Mapping Application",typeKeywords:"Web AppBuilder",text:f.stringify(c),snippet:b.description,tags:b.tags},g=r.getStandardPortalUrl(window.portalUrl);
t.getPortal(g).getUser().then(function(a){b.folderId===a.username&&(b.folderId="");a.addItem(e,b.folderId).then(function(c){c.success?(c.user=a,d.resolve(c),a.addItem({title:b.name,type:"Code Attachment",typeKeywords:"Code, Web Mapping Application, Javascript",relationshipType:"WMA2Code",originItemId:c.id,url:r.getItemUrl(r.getPortalUrlFromLocation(),c.id)+"/package"},b.folderId).then(function(a){a.success||console.error(builderNls.createCodeAttachmentError)},function(a){console.error(builderNls.createCodeAttachmentError,
a.message)})):d.resolve(c)},function(a){d.reject(a)})},function(a){d.reject(a)});return d}function m(b){var c=new a;e("stemapp/"+b+"/list.json",{handleAs:"json"}).then(function(a){return s(a,b).then(function(a){c.resolve({success:!0,manifests:a})})},function(a){c.reject({success:!1,message:a.message})});return c}function s(c,d){var g=[],f=new a;c._buildInfo&&c._buildInfo.manifestsMerged?e("stemapp/"+d+"/"+d+"-manifest-builder.json",{handleAs:"json"}).then(function(a){var l=[];k.forEach(c[d],function(b){var c;
(c="themes"===d?a["themes/"+b+"/main"]:a["widgets/"+b+"/Widget"])?l.push(c):g.push(e("stemapp/"+d+"/"+b+"/manifest.json",{handleAs:"json"}))});b(g).then(function(a){l=l.concat(a);p(l,d).then(function(){f.resolve(l)})})}):(k.forEach(c[d],function(a){g.push(e("stemapp/"+d+"/"+a+"/manifest.json",{handleAs:"json"}))}),b(g).then(function(a){p(a,d).then(function(){f.resolve(a)})}));return f}function p(d,e){var g=[],f=new a;k.forEach(d,function(a){a.category="widgets"===e?"widget":"theme";a.url="stemapp/"+
a.category+"s/"+a.name+"/";a.amdFolder=a.category+"s/"+a.name+"/";g.push(c(a))});b(g).then(function(){f.resolve()},function(a){f.reject(a)});return f}function c(a){n.addManifestProperies(a);return n.addI18NLabel(a)}var l={},w=["HTML"];l.checkAppVersion=function(b){var c=new a;e("/webappbuilder/rest/apps/checkVersion",{method:"POST",data:{appConfig:f.stringify(b)},handleAs:"json"}).then(q.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),q.hitch(this,function(a){c.reject(a)}));return c.promise};
l.importPortalApp=function(b,c){var d=new a;delete b.agolTemplateInfo;e("/webappbuilder/rest/apps/importportalapp",{method:"POST",handleAs:"json",data:{appConfig:f.stringify(b),appInfo:f.stringify(c)}}).then(q.hitch(this,function(a){a.success?d.resolve(a):d.reject(a)}),q.hitch(this,function(a){d.reject(a)}));return d.promise};l.getAppList=function(){var b=new a,c=r.getStandardPortalUrl(window.portalUrl),d;isXT?(d=t.getPortal(c),d.getUser().then(function(a){e("/webappbuilder/rest/apps/list?username\x3d"+
a.username+"\x26portalUrl\x3d"+c,{handleAs:"json"}).then(function(a){b.resolve(a)},function(a){b.reject(a)})},function(a){b.reject(a)})):(d=t.getPortal(c))?d.getUser().then(function(a){a.getItemsByKeywords("Web AppBuilder").then(function(a){var c=[];(a=a&&a.results)&&0<a.length&&(c=k.map(a,function(a){return{name:a.title,description:a.description,id:a.id}}));b.resolve(c)},function(a){console.error(a);b.reject({success:!1,message:""})})},function(a){console.error(a);b.reject({success:!1,message:""})}):
b.reject({success:!1,message:""});return b};l.getAppInfo=function(b){var c=new a;if(isXT)return-1<w.indexOf(b)?(c.resolve({id:b,appType:b}),c):e("/webappbuilder/rest/apps/"+b,{handleAs:"json"});var d=r.getStandardPortalUrl(window.portalUrl);t.getPortal(d).getItemById(b).then(function(a){c.resolve({name:a.title,description:a.description,id:a.id,owner:a.owner})});return c};l.updateApp=function(b){var c=new a,d=r.getStandardPortalUrl(window.portalUrl);isXT?t.getPortal(d).getUser().then(function(a){e("/webappbuilder/rest/apps/updateapp",
{handleAs:"json",method:"POST",data:{id:b.id,name:b.name,description:b.description,modified:a.username||"",creator:b.creator,portalUrl:d}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}):c.resolve({success:!0});return c};l.createApp=function(c){var f=new a,k,m=r.getStandardPortalUrl(window.portalUrl),p=t.getPortal(m);k=p.loadSelfInfo();var n=p.getUser(),p=null;c.webmap?(p=new a,p.resolve(c.webmap)):p=t.getDefaultWebMap(m);if(isXT){var s=d(m);k=[k,n,p,s];b(k).then(function(a){var b=
a[0],d=a[1],g=a[2];a=a[3];var l={map:{}};h(c,l,r.getStandardPortalUrl(a.info.portalUrl),g,b,a.info.isWebTier?!0:!1);e("/webappbuilder/rest/apps/createapp",{handleAs:"json",method:"POST",data:{name:c.name,description:c.description,appType:c.appType,stemappPath:c.appPath,creator:d.username||"",modified:d.username||"",extraPropertyOfAppConfig:JSON.stringify(l),portalUrl:m,fromAppId:c.fromAppId,isPredefined:c.isPredefined}}).then(function(a){f.resolve(a)},function(a){f.reject(a)})},function(a){console.error(a);
f.reject({success:!1,message:builderNls.createError})})}else n=l.getPredefinedAppConfig(c),s=g.isWebTierPortal(m),k=[k,n,p,s],b(k).then(function(a){var b=a[1];h(c,b,m,a[2],a[0],a[3]);u(c,b).then(function(a){a.success?(f.resolve({success:!0,newAppId:a.id}),setTimeout(q.hitch(this,function(){var b=r.getStandardPortalUrl(window.portalUrl),b=r.setProtocol(b,"http:");a.user.updateItem(a.id,{url:b+"/apps/webappviewer/index.html?id\x3d"+a.id}).then(function(a){a.success||console.error(builderNls.createUrlError)},
function(a){console.error(builderNls.createUrlError,a.message||"")})}),2E3)):(f.reject({success:!1,message:builderNls.createError}),console.error(builderNls.createError,builderNls.addItemUnsuccess))},function(a){f.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")})},function(a){console.error(a);f.reject({success:!1,message:builderNls.createError})});return f};l.duplicateApp=function(b,c){var d=new a,g=r.getStandardPortalUrl(window.portalUrl);if(isXT)t.getPortal(g).getUser().then(function(a){e("/webappbuilder/rest/apps/duplicateapp",
{handleAs:"json",method:"POST",data:{name:b.name,description:b.description,id:b.createFromId,is3D:b.is3D,creator:a.username||"",modified:a.username||"",portalUrl:g,stemappPath:b.appPath,appType:b.appType}}).then(function(a){d.resolve(a)},function(a){d.reject(a)})},function(a){console.error(builderNls.createError,a);d.reject({message:builderNls.createError})});else{var f=q.clone(c).getCleanConfig();delete f.agolTemplateInfo;u(b,f).then(function(a){a.success?(d.resolve({success:!0,newAppId:a.id}),a.user.updateItem(a.id,
{url:r.getDeployContextFromLocation()+"apps/webappviewer/index.html?id\x3d"+a.id}).then(function(a){},function(a){console.error(builderNls.duplicateUrlError,a.message||"")})):(d.reject({success:!1,message:builderNls.duplicateError}),console.error(builderNls.duplicateError,builderNls.addItemUnsuccess))},function(a){d.reject({success:!1,message:builderNls.duplicateError});console.error(builderNls.duplicateError,a.message||"")})}return d};l.removeApp=function(a){if(isXT)return e("/webappbuilder/rest/apps/removeapp",
{handleAs:"json",method:"POST",data:{id:a}})};l.saveApp=function(c,g){var l=new a,h=r.getStandardPortalUrl(window.portalUrl),k=t.getPortal(h),m=k.getUser(),p;isXT?(p=d(h),b({user:m,signininfo:p}).then(function(a){g.portalUrl=r.getStandardPortalUrl(a.signininfo.info.portalUrl);e("/webappbuilder/rest/apps/"+c+"/saveconfig",{data:{appConfig:f.stringify(g),modified:a.user.username,stemappPath:window.stemappInfo.appPath},method:"POST",handleAs:"json"}).then(function(a){l.resolve(a)},function(a){l.reject(a)})},
function(a){l.reject(a)})):m.then(function(a){k.getItemData(c).then(function(b){g.agolTemplateInfo=b.agolTemplateInfo;g.portalUrl=h;a.updateItem(c,{text:f.stringify(g)}).then(function(a){l.resolve({success:!0,newAppId:a.id})},function(a){l.reject({success:!1,message:a.message})})},function(a){console.error(a.message||a);l.reject({success:!1,message:a.message})})},function(a){l.reject({success:!1,message:a.message})});return l};l.getPredefinedAppConfig=function(){return e("stemapp/predefined-apps/default/config.json",
{handleAs:"json"})};l.copyThemeToApp=function(b,c,d){if(isXT)return-1<w.indexOf(b)?(b=new a,b.resolve({success:!0}),b):e("/webappbuilder/rest/apps/"+b+"/copytheme",{handleAs:"json",method:"POST",data:{themeName:c,layoutConfig:JSON.stringify(d),stemappPath:window.stemappInfo.appPath}});b=new a;b.resolve({success:!0});return b};l.copyWidgetToApp=function(b,c){var d;if(isXT)return-1<w.indexOf(b)?(d=new a,d.resolve({success:!0}),d):e.post("/webappbuilder/rest/apps/"+b+"/copywidget",{data:{widgetName:c,
stemappPath:window.stemappInfo.appPath},handleAs:"json"});d=new a;d.resolve({success:!0});return d};l.getAllThemes=function(){if(isXT)return e("/webappbuilder/rest/themes/search?q\x3d"+JSON.stringify({platform:window.stemappInfo.appType}),{handleAs:"json"});var b=new a;m("themes").then(function(a){b.resolve({success:!0,themes:a.manifests})},function(a){b.reject(a)});return b};l.searchWidgets=function(b){if(isXT)return e("/webappbuilder/rest/widgets/search?q\x3d"+JSON.stringify(b),{handleAs:"json"}).then(function(a){if(!r.isOnline(window.portalUrl)){var b=
k.filter(a.widgets,function(a){return"Analysis"===a.name?!1:!0});a.widgets=b}return a});var c=new a;m("widgets").then(function(a){var d=[];k.forEach(a.manifests,function(a){if(r.isOnline(window.portalUrl)||"Analysis"!==a.name)b["properties.inPanel"]===a.properties.inPanel&&(b.support2D===a.support2D||b.support3D===a.support3D)&&d.push(a)});c.resolve({success:!0,widgets:d})},function(a){c.reject(a)});return c};l.saveAgolTemplate=function(b,c){var d=new a,g=r.getStandardPortalUrl(window.portalUrl);
if(isXT)e("/webappbuilder/rest/apps/updateagoltemplateinapp",{handleAs:"json",method:"POST",data:{id:b.id,agolTemplateInfo:f.stringify(c)}}).then(q.hitch(this,function(a){!0===a.success?d.resolve():(console.error("The response of save agol template is 'unsuccess'!"),d.reject("The response of save agol template is 'unsuccess'!"))}),function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed!")});else{var l=t.getPortal(g);l.getUser().then(function(a){l.getItemData(b.id).then(function(e){delete e.agolTemplateJson;
e.agolTemplateInfo=c;a.updateItem(b.id,{text:f.stringify(e)}).then(function(){d.resolve()},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when updateItem!")})},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when get app's itemData!")})},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when get current user!")})}return d};return l})},"builder/portalUtils":function(){define(["jimu/portalUtils"],function(q){return q})},
"builder/plugins/app-config/_build-generate_module":function(){define(["builder/plugins/app-config/Plugin","dojo/text!builder/plugins/app-config/Plugin.html","dojo/text!builder/plugins/app-config/css/style.css"],function(){})},"builder/plugins/app-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/promise/all builder/utils jimu/utils jimu/WidgetManager jimu/dijit/ViewStack jimu/ConfigLoader esri/tasks/GeometryService esri/config builder/BasePlugin".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s){return q([s],{baseClass:"plugin-config-app",_PreviewMoreIframeSrc:"",_isPortrait:!0,_deviceInfo:null,appId:null,postCreate:function(){this.inherited(arguments);this.republishEvents=[];this.pluginsLoadDefs=[];this._bindEvent()},startup:function(){this._createOptsViewStack();this._createPreviewViewStack();this.pluginsLoadDefs.push(this._loadConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadMorePreviewOptsPlugin());this.pluginsLoadDefs.push(this._createMainAppActions());
this.pluginsLoadDefs.push(this._createPopupAppActions());this.switchToPreviewConfig();this.widgetManager=g.getInstance();this._defineSetConfigViewerTopicFunction();this._defineSetPreviewViewerTopicFunction();this._updateAppId();this.showLoadingCover()},addRepublishEvent:function(a){this.own(n.subscribe(a,e.hitch(this,function(b){this.configViewerTopic.publish("builder/"+a,b)})))},showLoadingCover:function(){f.setStyle(this.coverNode,"display","block")},hideLoadingCover:function(){f.setStyle(this.coverNode,
"display","none")},_bindEvent:function(){this.own(n.subscribe("app/preloadWidgetsLoaded",e.hitch(this,this._onPreloadWidgetsLoaded)));this.own(n.subscribe("app/mapCreatedFailed",e.hitch(this,this._onMapCreatedFailed)));this.own(k(this.btnPortrait,"click",e.hitch(this,function(){this._resizePreviewMore(!0)})));this.own(k(this.btnLandscape,"click",e.hitch(this,function(){this._resizePreviewMore(!1)})));this.own(k(document.body,"click",e.hitch(this,function(){f.setStyle(this.popupActionsMenu,"display",
"none")})));this.own(n.subscribe("iframeClick",e.hitch(this,function(){f.setStyle(this.popupActionsMenu,"display","none")})));this._bindFrameEvent()},_bindFrameEvent:function(){this.own(k(this.previewConfigFrameNode,"load",e.hitch(this,function(){window.configWindow=this.previewConfigFrameNode.contentWindow;this.own(k(this.previewConfigFrameNode.contentWindow.document.body,"click",e.hitch(this,function(a){n.publish("iframeClick",a)})))})));this.own(k(this.previewMoreFrameNode,"load",e.hitch(this,
function(){window.previewWindow=this.previewMoreFrameNode.contentWindow;this.own(k(this.previewMoreFrameNode.contentWindow.document.body,"click",e.hitch(this,function(a){n.publish("iframeClick",a)})))})))},_createOptsViewStack:function(){this.optsViewStack=new d({viewType:"dom",views:[this.configOptsPaneNode,this.morePreviewOptsPaneNode]},this.optsViewStackNode);this.optsViewStack.startup()},_createPreviewViewStack:function(){this.previewViewStack=new d({viewType:"dom",views:[this.previewConfig,this.previewMore]},
this.rightPreviewSection)},_defineSetConfigViewerTopicFunction:function(){window.setConfigViewerTopic=e.hitch(this,function(a){this.configViewerTopic=a;this.own(this.configViewerTopic.subscribe("appConfigLoaded",e.hitch(this,this.onAppConfigLoaded)));this.own(this.configViewerTopic.subscribe("appConfigChanged",e.hitch(this,this.onAppConfigChanged)));this.own(this.configViewerTopic.subscribe("mapLoaded",e.hitch(this,this.onMapLoaded)));this.own(this.configViewerTopic.subscribe("mapChanged",e.hitch(this,
this.onMapChanged)));this.own(this.configViewerTopic.subscribe("preloadWidgetsLoaded",e.hitch(this,this.onPreloadWidgetsLoaded)));this.own(this.configViewerTopic.subscribe("mapCreatedFailed",e.hitch(this,this.onMapCreatedFailed)));this._onConfigViewerLoaded()})},_defineSetPreviewViewerTopicFunction:function(){window.setPreviewViewerTopic=e.hitch(this,function(a){this.previewViewerTopic=a;a=e.clone(this.appConfig);a.mode="preview";this.previewViewerTopic.publish("builder/setAppConfig",a);this.own(this.previewViewerTopic.subscribe("mapLoaded",
e.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()})));this._onPreviewViewerLoaded()})},_loadConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("config-part",this.options.appInfo.appType),a=this.pluginsMeta[a[0].pluginName];a.options=this.options;return this.pluginManager.loadPlugin(a).then(e.hitch(this,function(a){f.place(a.domNode,this.configOptsPaneNode);a.startup();return a}))},_loadMorePreviewOptsPlugin:function(){var a=this.filterExtensionsByAppType("morepreview-selction-part",
this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(e.hitch(this,function(a){f.place(a.domNode,this.morePreviewOptsPaneNode);a.startup();return a}))},_updateAppId:function(){jimuConfig.widgetsPackage={name:"widgets",location:window.appInfo.appPath+"widgets"};jimuConfig.themesPackage={name:"themes",location:window.appInfo.appPath+"themes"};jimuConfig.configsPackage={name:"configs",location:window.appInfo.appPath+"configs"};var a=
b.urlToObject(window.location.href).query||{};delete a.id;var c=window.appInfo.appPath;window.isXT||(c=c+"index.html?id\x3d"+window.appInfo.appId);a.mode="preview";this._PreviewMoreIframeSrc=t.appendParamsToAppPath(c,a);a.mode="config";f.attr(this.previewConfigFrameNode,"src",t.appendParamsToAppPath(c,a))},_onConfigViewerLoaded:function(){r(this.pluginsLoadDefs).then(e.hitch(this,function(){window.stemappInfo.appVersionManager?require([window.appInfo.appPath+window.stemappInfo.appVersionManager],
e.hitch(this,function(a){this._loadAppConfig(a)})):this._loadAppConfig()}))},_loadAppConfig:function(a){var c=b.urlToObject(window.location.href).query||{};delete c.id;window.isXT?c.config=window.appInfo.appPath+"config.json":c.id=window.appInfo.appId;c.mode="config";h.getInstance(c,{versionManager:a?new a:null}).loadConfig().then(e.hitch(this,function(a){this.configViewerTopic.publish("builder/setAppConfig",a)}))},_onPreviewViewerLoaded:function(){},_republishBuilderEvents:function(){a.forEach(this.republishEvents,
function(a){this.own(n.subscribe(a,e.hitch(this,function(b){this.configViewerTopic.publish(a,b)})))},this)},switchToPreviewConfig:function(){this.optsViewStack.switchView(this.configOptsPaneNode);this.previewViewStack.switchView(this.previewConfig)},switchToPreviewMore:function(){this.optsViewStack.switchView(this.morePreviewOptsPaneNode);this.previewViewStack.switchView(this.previewMore);this._showPreviewMore()},previewOnDevice:function(a,b){this._deviceInfo=a;f.setStyle(this.previewMoreDes,"display",
"block");this.previewMoreDes.innerHTML=b?a.width+" x "+a.height:a.title+" "+a.width+" x "+a.height;this._resizePreviewMore(this._isPortrait)},_createMainAppActions:function(){var b=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),c=360/b.length;b.sort(function(a,b){return a.parameters.index-b.parameters.index});a.forEach(b,function(a,b){this._createMainAppActionNode(a,b,c)},this);return r([])},_createMainAppActionNode:function(a,b,d){0<b&&f.create("div",{"class":"seprate jimu-float-leading"},
this.mainActionBoxNode);var g=f.create("div",{"class":"footer-button-box jimu-float-leading"},this.mainActionBoxNode);f.setStyle(g,"width",d+"px");a=this.pluginsMeta[a.pluginName];a.options=this.options.appInfo;return this.pluginManager.loadPlugin(a).then(e.hitch(this,function(a){f.place(a.domNode,g);a.startup();return a}))},_createPopupAppActions:function(){var b=this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType);b.sort(function(a,b){return a.parameters.index-b.parameters.index});
if(0===b.length)f.setStyle(this.btnArrow,"display","none");else{f.setStyle(this.popupActionsMenu,"top",-30*b.length+"px");var c=[];a.forEach(b,function(a){c.push(this._createPopupAppActionNode(a))},this);return r(c)}},_createPopupAppActionNode:function(a){var b=a.parameters,d=f.create("div",{innerHTML:b.label},this.popupActionsMenu);return this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(e.hitch(this,function(a){this.own(k(d,"click",e.hitch(a,a[b.onClickAction])));return a}))},_onBtnArrowClick:function(a){"none"===
f.getStyle(this.popupActionsMenu,"display")?f.setStyle(this.popupActionsMenu,"display","block"):f.setStyle(this.popupActionsMenu,"display","none");a.stopPropagation()},_getGeomtryServiceByAppConfig:function(a){return new u(a.geometryService)},onAppConfigLoaded:function(a){this._setAppConfig(a);n.publish("app/appConfigLoaded",a)},onMapLoaded:function(a){n.publish("app/mapLoaded",a)},onMapChanged:function(a){n.publish("app/mapChanged",a)},onAppConfigChanged:function(a,b,d){this._setAppConfig(a);n.publish("app/appConfigChanged",
a,b,d)},onPreloadWidgetsLoaded:function(){n.publish("app/preloadWidgetsLoaded")},onMapCreatedFailed:function(){n.publish("app/mapCreatedFailed")},_setAppConfig:function(a){a=b.reCreateObject(a);m.defaults.geometryService=this._getGeomtryServiceByAppConfig(a);this.appConfig=a;window.appConfig=a},_showPreviewMore:function(){this.previewViewStack.switchView(this.previewMore);if(!this.previewMoreFrameNode.src&&this._PreviewMoreIframeSrc)this._initPreviewMoreViewerPosition(),f.attr(this.previewMoreFrameNode,
"src",this._PreviewMoreIframeSrc);else{var a=e.clone(this.appConfig);a.mode="preview";this._syncPreviewMapExtentWithConfigMapExtent();this.previewViewerTopic.publish("builder/setAppConfig",a)}},_syncPreviewMapExtentWithConfigMapExtent:function(){var a=window.configWindow&&window.configWindow._viewerMap,b=window.previewWindow&&window.previewWindow._viewerMap;a&&(b&&this.previewViewerTopic)&&this.previewViewerTopic.publish("builder/syncExtent",a)},_initPreviewMoreViewerPosition:function(){var a=f.getMarginBox(this.previewMore);
f.setStyle(this.previewMoreContainer,{width:a.w-220+"px",height:a.h-130+"px"});f.setStyle(this.previewMoreIframeSection,"marginTop","50px")},_setPreviewMoreViewerPosition:function(){var a=f.getMarginBox(this.previewMore).h,b=f.getMarginBox(this.previewMoreContainer),d=f.getStyle(this.previewMoreContainer,"paddingTop"),e=f.getStyle(this.previewMoreContainer,"paddingBottom"),a=(a-(b.h+d+e))/2;0>a&&(a=0);f.setStyle(this.previewMoreIframeSection,"marginTop",a+"px")},_resizePreviewMore:function(a){a?this._showPortrait():
this._showLandscape();setTimeout(e.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()}),500)},_showPortrait:function(){this._deviceInfo&&(this._isPortrait=!0,f.setStyle(this.previewMoreContainer,{width:this._deviceInfo.width+44+"px",height:this._deviceInfo.height+44+"px"}),f.addClass(this.btnPortrait,"selected"),f.removeClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_showLandscape:function(){this._deviceInfo&&(this._isPortrait=!1,f.setStyle(this.previewMoreContainer,
{width:this._deviceInfo.height+44+"px",height:this._deviceInfo.width+44+"px"}),f.removeClass(this.btnPortrait,"selected"),f.addClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_onPreloadWidgetsLoaded:function(){this.hideLoadingCover()},_onMapCreatedFailed:function(){this.hideLoadingCover()},_onStartChangeTheme:function(){this.showLoadingCover()}})})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/aspect dojo/json dojo/request/xhr dojo/promise/all ./utils jimu/tokenUtils ./dijit/Message".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){var s=null,p=q(r,{constructor:function(){this.loaded=[];this.missedActions=[];window.isBuilder?(n.subscribe("app/mapLoaded",e.hitch(this,this._onMapLoaded)),n.subscribe("app/mapChanged",e.hitch(this,this._onMapChanged))):(n.subscribe("mapLoaded",e.hitch(this,this._onMapLoaded)),n.subscribe("mapChanged",e.hitch(this,this._onMapChanged)));window.isBuilder?(n.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)),n.subscribe("app/appConfigChanged",
e.hitch(this,this._onAppConfigChanged))):(n.subscribe("appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)),n.subscribe("appConfigChanged",e.hitch(this,this._onAppConfigChanged)));n.subscribe("userSignIn",e.hitch(this,this._onUserSignIn));n.subscribe("userSignOut",e.hitch(this,this._onUserSignOut));n.subscribe("actionTriggered",e.hitch(this,this._onActionTriggered))},loadWidget:function(a){var b=new k,g;a=e.clone(a);a.folderUrl||h.processWidgetSetting(a);(g=this.getWidgetById(a.id))?b.resolve(g):
d([this.loadWidgetClass(a),this.loadWidgetManifest(a)]).then(e.hitch(this,function(a){var c=a[0],d=a[1];this.loadWidgetResources(d).then(e.hitch(this,function(a){try{var g=this.createWidget(d,c,a);console.log("widget ["+d.uri+"] created.")}catch(f){console.log("create ["+d.uri+"] error:"+f.stack),new m({message:"create widget error: "+d.uri}),b.reject(f)}setTimeout(e.hitch(this,function(){b.resolve(g);this.emit("widget-created",g)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)});return b},
loadWidgetClass:function(a){var b=new k;require(h.getRequireConfig(),[a.uri],e.hitch(this,function(a){b.resolve(a)}));h.checkError(a.uri,b);return b},loadWidgetResources:function(a){var b=new k,g,f,h,m=[];h=e.clone(a);a=this.tryLoadWidgetConfig(h);g=this._tryLoadResource(h,"i18n");f=this._tryLoadResource(h,"style");h=this._tryLoadResource(h,"template");m.push(a);m.push(g);m.push(h);m.push(f);d(m).then(e.hitch(this,function(a){var c={};c.config=a[0];c.i18n=a[1];c.template=a[2];c.style=a[3];b.resolve(c)}),
function(a){b.reject(a)});return b},loadWidgetManifest:function(a){var b=new k,d=a.folderUrl+"manifest.json";if(a.manifest)return b.resolve(a),b;g(d,{handleAs:"json"}).then(e.hitch(this,function(d){d.amdFolder=a.amdFolder;d.category="widget";a.label?(this._processManifest(d),h.addManifest2WidgetJson(a,d),b.resolve(a)):h.addI18NLabel(d).then(e.hitch(this,function(){this._processManifest(d);h.addManifest2WidgetJson(a,d);b.resolve(a)}))}),function(a){b.reject(a)});return b},_processManifest:function(a){h.addManifestProperies(a);
h.processManifestLabel(a,window.dojoConfig.locale)},createWidget:function(a,b,d){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);d.config&&d.i18n&&(d.config=h.replacePlaceHolder(d.config,d.i18n));a.rawConfig=a.config;a.config=d.config||{};this.appConfig.agolConfig&&this._mergeAgolConfig(a);a.nls=d.i18n||{};d.template&&(a.templateString=d.template);a["class"]="jimu-widget";a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;d={};for(var g in a)a.hasOwnProperty(g)&&
(d[g]=a[g]);d.widgetManager=this;a=new b(d);a.clazz=b;t.after(a,"startup",e.hitch(this,this._postWidgetStartup,a));t.before(a,"destroy",e.hitch(this,this._onDestroyWidget,a));this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var b=a.map(this.loaded,function(a){return a.id});a.forEach(b,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var b=new k;a=e.clone(a);a.id+="_setting";d([this.loadWidgetSettingClass(a)]).then(e.hitch(this,
function(d){var g=d[0];this.loadWidgetSettingPageResources(a).then(e.hitch(this,function(d){var f;d={nls:d.i18n,templateString:d.template,appConfig:this.appConfig,map:this.map,"class":"jimu-widget-setting"};for(var h in a)a.hasOwnProperty(h)&&(d[h]=a[h]);try{f=new g(d),t.before(f,"destroy",e.hitch(this,this._onDestroyWidgetSetting,f)),b.resolve(f)}catch(k){new m({message:"Create widget setting page error:"+a.uri}),b.reject(k)}}),function(a){console.log(a)})}),function(a){b.reject(a)});return b},loadWidgetSettingClass:function(a){var b=
new k;require(h.getRequireConfig(),[a.folderUrl+"setting/Setting.js"],e.hitch(this,function(a){b.resolve(a)}));h.checkError(a.folderUrl+"setting/Setting.js",b);return b},loadWidgetSettingPageResources:function(a){var b=new k,g,f,h=[];a=e.clone(a);g=this._tryLoadResource(a,"settingI18n");f=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");h.push(g);h.push(f);h.push(a);d(h).then(e.hitch(this,function(a){var c={};c.i18n=a[0]||{};c.template=a[1];c.style=a[2];b.resolve(c)}),
function(a){console.log(a)});return b},getWidgetById:function(b){var d;a.some(this.loaded,function(a){if(a.id===b)return d=a,!0},this);return d},getWidgetsByName:function(b){var d=[];a.some(this.loaded,function(a){a.name===b&&d.push(a)},this);return d},changeWindowStateTo:function(a,b){"normal"===b?this.normalizeWidget(a):"minimized"===b?this.minimizeWidget(a):"maximized"===b?this.maximizeWidget(a):console.log("error state: "+b)},closeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),
!a))return;if("closed"!==a.state){a.setState("closed");try{a.onClose()}catch(b){console.log(console.error("fail to close widget "+a.name+". "+b.stack))}}},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if("closed"===a.state){a.setState("opened");try{a.onOpen()}catch(b){console.log(console.error("fail to open widget "+a.name+". "+b.stack))}}},maximizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);
a.setWindowState("maximized");try{a.onMaximize()}catch(b){console.log(console.error("fail to maximize widget "+a.name+". "+b.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(b){console.log(console.error("fail to minimize widget "+a.name+". "+b.stack))}},normalizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&
this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(b){console.log(console.error("fail to normalize widget "+a.name+". "+b.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(b){console.log(console.error("fail to destroy widget "+a.name+". "+b.stack))}},tryLoadWidgetConfig:function(a){return this._tryLoadWidgetConfig(a).then(e.hitch(this,function(b){return this._upgradeWidgetConfig(a,b)}))},
_tryLoadWidgetConfig:function(a){var d=new k;if(a.config&&e.isObject(a.config))return d.resolve(a.config),d;if(a.config){if(require.cache["url:"+a.config])return d.resolve(b.parse(require.cache["url:"+a.config])),d;a=h.processUrlInAppConfig(a.config);a=a.split("/");a[a.length-1]=encodeURIComponent(a[a.length-1]);a=a.join("/");return g(a,{handleAs:"json"})}return this._tryLoadResource(a,"config")},_upgradeWidgetConfig:function(a,b){var d=new k,g=a.manifest.version,f=a.version,m;if(g===f)return d.resolve(b),
d;if(!1===a.hasVersionManager)return a.version=g,d.resolve(b),d;require(h.getRequireConfig(),[a.amdFolder+"VersionManager"],e.hitch(this,function(e){e=new e;var h=e.getVersionIndex(f),k=e.getVersionIndex(g);if(h>k)d.reject("Bad widget version number, "+a.name+","+f);else try{m=e.upgrade(b,f,g),a.version=g,d.resolve(m)}catch(p){console.log("Read widget ["+a.name+"] old config error,"+p.stack),d.resolve(b)}}));return d},loadWidgetStyle:function(a){var b="widget/style/"+a.uri,d=new k,b=this._replaceId(b);
return f.byId(b)?(d.resolve("load"),d):h.loadStyleLink(b,a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var b="widget/style/"+a.uri+"/setting",d=new k,b=this._replaceId(b);return f.byId(b)?(d.resolve("load"),d):h.loadStyleLink(b,a.settingStyleFile)},loadWidgetConfig:function(a){a=require(h.getRequireConfig()).toUrl(a.configFile);if(require.cache["url:"+a]){var d=new k;d.resolve(b.parse(require.cache["url:"+a]));return d}return g(a,{handleAs:"json"})},
loadWidgetI18n:function(a){var b=new k;require(h.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){b.resolve(a)});return b},loadWidgetSettingI18n:function(a){var b=new k;require(h.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){b.resolve(a)});return b},loadWidgetTemplate:function(a){var b=new k;require(h.getRequireConfig(),["dojo/text!"+a.templateFile],function(a){b.resolve(a)});h.checkError(a.templateFile,b);return b},loadWidgetSettingTemplate:function(a){var b=new k;require(h.getRequireConfig(),
["dojo/text!"+a.settingTemplateFile],function(a){b.resolve(a)});h.checkError(a.settingTemplateFile,b);return b},removeWidgetStyle:function(a){f.destroy(this._replaceId("widget/style/"+a.uri))},removeWidgetSettingStyle:function(a){f.destroy(this._replaceId("widget/style/"+a.uri+"/setting"))},getControllerWidgets:function(){return a.filter(this.loaded,function(a){return a.isController})},getPreloadPanelessWidgets:function(){return a.filter(this.loaded,function(a){return a.isPreload&&!a.inPanel})},_mergeAgolConfig:function(a){var b=
this.appConfig.agolConfig.values,d="widgets["+a.id+"]",e;for(e in b){var g=e.indexOf(d+"_config");0<=g&&h.setConfigByTemplate(a,e.substr(g,e.length).replace(d,"widget"),b[e])}},_onUserSignIn:function(b){a.forEach(this.loaded,function(a){a.onSignIn(b)},this)},_onUserSignOut:function(){a.forEach(this.loaded,function(a){a.onSignOut()},this)},_onAppConfigLoaded:function(a){this.appConfig=a=e.clone(a);u.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=
a},_onAppConfigChanged:function(b,d,g,f){var h=e.clone(b);this.appConfig=h;a.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(h,d,g,f),"widgetChange"===d&&this._onConfigChanged(g.id,g.config,f),a.appConfig=h)},this)},_onConfigChanged:function(a,b){var d=this.getWidgetById(a);d&&(d.onConfigChanged(b),e.mixin(d.config,b))},_onActionTriggered:function(b){if(!("map"===b.elementId||"app"===b.elementId)){var d=this.getWidgetById(b.elementId);if(d)d.onAction(b.action,b.data);else this.missedActions.push({id:b.elementId,
action:{name:b.action,data:b.data}});a.forEach(this.getControllerWidgets(),function(a){if(a.widgetIsControlled(b.elementId))a.onAction(b.action,{widgetId:b.elementId,data:b.data})},this)}},_postWidgetStartup:function(a){a.started=!0;h.setVerticalCenter(a.domNode);t.after(a,"resize",e.hitch(this,h.setVerticalCenter,a.domNode));this.openWidget(a);var b=u.getPortalCredential(this.appConfig.portalUrl);if(b)a.onSignIn(b);else a.onSignOut();this._triggerMissedAction(a)},_triggerMissedAction:function(a){this.missedActions.forEach(function(b){if(b.id===
a.id)a.onAction(b.action.name,b.action.data)})},_remove:function(b){return a.some(this.loaded,function(a,d){if(a.id===b)return this.loaded.splice(d,1),!0},this)},_tryLoadResource:function(a,b){var d,e=new k;if("config"===b)d=a.amdFolder+"config.json",a.configFile=d,d="hasConfig";else if("style"===b)d=a.amdFolder+"css/style.css",a.styleFile=d,d="hasStyle";else if("i18n"===b)d=a.amdFolder+"nls/strings.js",a.i18nFile=a.amdFolder+"nls/strings",d="hasLocale";else if("template"===b)d=a.amdFolder+"Widget.html",
a.templateFile=d,d="hasUIFile";else if("settingTemplate"===b)d=a.amdFolder+"setting/Setting.html",a.settingTemplateFile=d,d="hasSettingUIFile";else if("settingI18n"===b)d=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.amdFolder+"setting/nls/strings",d="hasSettingLocale";else if("settingStyle"===b)d=a.amdFolder+"setting/css/style.css",a.settingStyleFile=d,d="hasSettingStyle";else return e;a[d]?function(){var d;if("config"===b)d=this.loadWidgetConfig(a);else if("style"===b)d=this.loadWidgetStyle(a);
else if("i18n"===b)d=this.loadWidgetI18n(a);else if("template"===b)d=this.loadWidgetTemplate(a);else if("settingTemplate"===b)d=this.loadWidgetSettingTemplate(a);else if("settingStyle"===b)d=this.loadWidgetSettingStyle(a);else if("settingI18n"===b)d=this.loadWidgetSettingI18n(a);else return e;d.then(function(a){e.resolve(a)},function(b){new m({message:"load widget resouce error: "+a.uri});e.reject(b)})}.apply(this):e.resolve(null);return e},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,
"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);this._removeWidget(a);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.removeWidgetStyle(a);this._remove(a.id)}});p.getInstance=function(a){null===s&&(s=new p(a));return s};return p})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html",
"dojo/_base/array","dijit/_WidgetBase"],function(q,e,a,f,k){return q(k,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);f.forEach(this.views,e.hitch(this,function(e){1===e.nodeType?(a.place(e,this.domNode),a.addClass(e,"view")):e.domNode&&(a.place(e.domNode,this.domNode),a.addClass(e.domNode,"view"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},
getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var a="",e=this.getSelectedView();e&&(a=e.label);return a},getViewByLabel:function(a){for(var e=0;e<this.views.length;e++)if(a===this.views[e].label)return this.views[e];return null},addView:function(e){this.views.push(e);1===e.nodeType?(a.place(e,this.domNode),a.addClass(e,"view")):e.domNode&&(a.place(e.domNode,this.domNode),a.addClass(e.domNode,"view"))},removeView:function(e){var k=this.views.length;this.views=f.filter(this.views,
function(a){return e!==a});k!==this.views.length&&(1===e.nodeType?a.destroy(e):e.domNode&&e.destroyRecursive())},switchView:function(f){var k,q;k="number"===typeof f?this.views[f]:"string"===typeof f?this.getViewByLabel(f):f;this.views.forEach(e.hitch(this,function(b){b&&(1===b.nodeType?q=b:b.domNode&&(q=b.domNode),b===k?(a.setStyle(q,"display","block"),b.domNode&&!b._started&&(b.startup(),b._started=!0)):a.setStyle(q,"display","none"))}));this._currentView=k;this.onViewSwitch(k)},onViewSwitch:function(){}})})},
"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./portalUrlUtils esri/IdentityManager esri/config esri/urlUtils esri/geometry/Point esri/SpatialReference esri/request".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w){var v=null,x;x=q(null,{urlParams:null,appConfig:null,rawAppConfig:null,configFile:null,
_configLoaded:!1,portalSelf:null,constructor:function(a,b){this._removeHash(a);this.urlParams=a||{};this.isRunInPortal=!1;this.widgetManager=g.getInstance();e.mixin(this,b)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(e.hitch(this,function(a){var b=this.checkConfig(a);if(b)throw b;this.rawAppConfig=e.clone(a);a=this._upgradeAppConfig(a);this._processAfterTryLoad(a);this.appConfig=a;if(this.urlParams.id)return this.loadWidgetsManifest(a).then(e.hitch(this,function(){return this._upgradeAllWidgetsConfig(a)})).then(e.hitch(this,
function(){this._configLoaded=!0;a.title&&(document.title=a.title);return this.getConfig()}));h.setPortalUrl(a.portalUrl);return this._proesssWebTierAndSignin(a).then(e.hitch(this,function(){return this.urlParams.appid?this.isRunInPortal?this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(e.hitch(this,function(a){return this._processInPortalAppProtocol(a)})):this._processNotInPortalAppProtocol(a).then(e.hitch(this,function(a){return this._getAppDataFromTemplateAppId(a.portalUrl,
this.urlParams.appid).then(e.hitch(this,function(b){a._itemData=b;return a}))})):this._processNotInPortalAppProtocol(a)})).then(e.hitch(this,function(a){this._processAfterTryLoad(a);this.appConfig=a;return a.map.itemId?a:u.getDefaultWebMap(a.portalUrl).then(function(b){a.map.itemId=b;return a})})).then(e.hitch(this,function(a){return this.loadWidgetsManifest(a)})).then(e.hitch(this,function(a){return a._itemData?(a.getConfigElementById=function(b){return d.getConfigElementById(a,b)},this._mergeTemplateAppConfigToAppConfig(a._itemData,
a)):a})).then(e.hitch(this,function(){return this._upgradeAllWidgetsConfig(a)})).then(e.hitch(this,function(){this._configLoaded=!0;a.title&&(document.title=a.title);return this.getConfig()}))}))},getConfig:function(){this.appConfig.rawAppConfig=this.rawAppConfig;return this.appConfig},checkConfig:function(a){return(a=this._getRepeatedId(a))?"repeated id:"+a:null},processProxy:function(b){p.defaults.io.alwaysUseProxy=b.httpProxy&&b.httpProxy.useProxy&&b.httpProxy.alwaysUseProxy;p.defaults.io.proxyUrl=
"";p.defaults.io.proxyRules=[];b.httpProxy&&(b.httpProxy.useProxy&&b.httpProxy.url)&&(p.defaults.io.proxyUrl=b.httpProxy.url);b.httpProxy&&(b.httpProxy.useProxy&&b.httpProxy.rules)&&a.forEach(b.httpProxy.rules,function(a){c.addProxyRule(a)})},addNeedValues:function(a){this._processNoUriWidgets(a);this._addElementId(a);this._processWidgetJsons(a)},showError:function(a){document.body.innerHTML='\x3cdiv class\x3d"jimu-error-code"\x3e\x3cspan\x3e'+this.nls.errorCode+":\x3c/span\x3e\x3cspan\x3e"+a.response.status+
'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-message"\x3e\x3cspan\x3e'+this.nls.errorMessage+":\x3c/span\x3e\x3cspan\x3e"+a.message+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-detail"\x3e\x3cspan\x3e'+this.nls.errorDetail+":\x3c/span\x3e\x3cspan\x3e"+a.response.text+"\x3cspan\x3e\x3c/div\x3e"},_tryLoadConfig:function(){if(this.urlParams.config)return this.configFile=this.urlParams.config,t(this.configFile,{handleAs:"json"});if(this.urlParams.id){this.isRunInPortal=!0;var a=m.getPortalUrlFromLocation(),
b=new n;h.setPortalUrl(a);u.getPortal(a).loadSelfInfo().then(e.hitch(this,function(c){this.portalSelf=c;this._processSignIn(a).then(e.hitch(this,function(){this._getAppConfigFromAppId(a,this.urlParams.id).then(e.hitch(this,function(a){return this._processInPortalAppProtocol(a)})).then(function(a){b.resolve(a)},function(a){b.reject(a)})}))}));return b}this.configFile="config.json";return t(this.configFile,{handleAs:"json"})},_upgradeAppConfig:function(a){var b=window.wabVersion,c=a.wabVersion;if(b===
c)return a;var d=this.versionManager.getVersionIndex(c),e=this.versionManager.getVersionIndex(b);if(d>e)throw Error("Bad version number, "+c);a=this.versionManager.upgrade(a,c,b);a.wabVersion=b;a.isUpgraded=!0;return a},_upgradeAllWidgetsConfig:function(a){var b=new n,c=[];if(!a.isUpgraded)return b.resolve(a),b;delete a.isUpgraded;d.visitElement(a,e.hitch(this,function(a){if(a.uri)if(a.config){var b=this.widgetManager.tryLoadWidgetConfig(a).then(e.hitch(this,function(b){a.config=b}));c.push(b)}else a.version=
a.manifest.version}));r(c).then(e.hitch(this,function(){b.resolve(a)}),function(a){b.reject(a)});return b},_processAfterTryLoad:function(a){this._setPortalUrl(a);this._processUrlParams(a);this.addNeedValues(a);this.processProxy(a);s.tokenValidity=10080;return a},_processWidgetJsons:function(a){d.visitElement(a,function(a,c){c.isWidget&&a.uri&&b.processWidgetSetting(a)})},_processNoUriWidgets:function(a){var b=0;d.visitElement(a,function(a,c){c.isWidget&&!a.uri&&(b++,a.placeholderIndex=b)})},_addElementId:function(a){var b=
0,c;d.visitElement(a,function(a){if(a.id){var d=a.id.lastIndexOf("_");-1<d&&(c=a.id.substr(d+1),b=Math.max(b,c))}});d.visitElement(a,function(a){a.id||(b++,a.id=a.uri?a.uri+"_"+b:"_"+b)})},_setPortalUrl:function(a){a.portalUrl||(k("wab_portalurl")?a.portalUrl=k("wab_portalurl"):(this.isRunInPortal=!0,a.portalUrl=m.getPortalUrlFromLocation()))},_changePortalUrlProtocol:function(b,c){b.portalUrl=m.setProtocol(b.portalUrl,c);b.map.portalUrl&&(b.map.portalUrl=m.setProtocol(b.map.portalUrl,c));b.httpProxy&&
(b.httpProxy.url=m.setProtocol(b.httpProxy.url,c),b.httpProxy&&b.httpProxy.rules&&a.forEach(b.httpProxy.rules,e.hitch(this,function(a){a.proxyUrl=m.setProtocol(a.proxyUrl,c)})))},_processInPortalAppProtocol:function(a){var b=new n,c=u.getPortal(a.portalUrl),d=e.hitch(this,function(c){if("https:"===window.location.protocol)this._changePortalUrlProtocol(a,"https");else{if(c){window.location.href=m.setHttpsProtocol(window.location.href);b.reject();return}this._changePortalUrlProtocol(a,"http")}this._checkLocale();
b.resolve(a)});c.loadSelfInfo().then(e.hitch(this,function(b){"private"===b.access?(b=0===a.portalUrl.toLowerCase().indexOf("https://"),d(b)):d(b.allSSL)}),e.hitch(this,function(a){b.reject(a)}));return b},_processNotInPortalAppProtocol:function(a){var b=new n;a.portalUrl?u.getPortal(a.portalUrl).loadSelfInfo().then(e.hitch(this,function(c){var d="https:"===window.location.protocol;(c.allSSL||d)&&this._changePortalUrlProtocol(a,"https");0===a.portalUrl.toLowerCase().indexOf("https://")&&!d&&!h.isInConfigOrPreviewWindow()?
(window.location.href=m.setHttpsProtocol(window.location.href),b.reject()):b.resolve(a)}),e.hitch(this,function(a){b.reject(a)})):b.resolve(a);return b},_proesssWebTierAndSignin:function(a){var b=new n,c=!1,d=a.portalUrl;this._processWebTier(a).then(e.hitch(this,function(a){c=a;return u.getPortal(d).loadSelfInfo()})).then(e.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(d,c)})).then(e.hitch(this,function(){b.resolve()}),function(a){b.reject(a)});return b},_processWebTier:function(a){var b=
new n,c=a.portalUrl;a.isWebTier?h.isWebTierPortal(c).then(e.hitch(this,function(a){h.getPortalCredential(c).ssl&&"http:"===window.location.protocol&&!h.isInConfigOrPreviewWindow()?window.location.href=m.setHttpsProtocol(window.location.href):b.resolve(a)}),e.hitch(this,function(a){b.reject(a)})):b.resolve(!1);return b},_processSignIn:function(a,b){var c=new n,d=u.getPortal(a),g=m.getSharingUrl(a);this.isRunInPortal?(g=s.checkSignInStatus(g),g.promise.always(e.hitch(this,function(){c.resolve()}))):
(!h.isInBuilderWindow()&&(!h.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawAppConfig.appId&&!b)&&h.registerOAuthInfo(a,this.rawAppConfig.appId),g=s.checkSignInStatus(g),g.promise.always(e.hitch(this,function(){h.xtGetCredentialFromCookie(a);d.loadSelfInfo().then(e.hitch(this,function(a){this.portalSelf=a;this._checkLocale();c.resolve()}))})));return c},_checkLocale:function(){if(!h.isInConfigOrPreviewWindow()){var a=this.portalSelf.user&&this.portalSelf.user.culture||f.locale,
a=a.toLowerCase();b.isLocaleChanged(f.locale,a)&&(k("wab_app_locale",a),window.location.reload())}},_getAppConfigFromTemplateAppId:function(a,b){var c=new n;this._getWabAppIdAndDataFromTemplateAppId(a,b).then(e.hitch(this,function(b){var d=b.itemData;this._getAppConfigFromAppId(a,b.appId).then(function(a){a._itemData=d;c.resolve(a)})}));return c},_getAppDataFromTemplateAppId:function(a,b){return u.getPortal(a).getItemData(b)},_getWabAppIdAndDataFromTemplateAppId:function(a,b){var d=new n,g=u.getPortal(a);
g.getItemData(b).then(e.hitch(this,function(a){g.getItemById(a.source).then(e.hitch(this,function(b){b=c.urlToObject(b.url);d.resolve({appId:b.query.id,itemData:a})}))}),function(a){d.reject(a)});return d},_getAppConfigFromAppId:function(a,b){return u.getPortal(a).getItemData(b)},_mergeTemplateAppConfigToAppConfig:function(c,d){function g(b){var c=[];a.forEach(b,function(a){a&&c.push(a)},this);return c}function f(){d.widgetPool.widgets=g(d.widgetPool.widgets);h.widgets=g(h.widgets);if(d.widgetPool.groups)for(l=
0;l<d.widgetPool.groups.length;l++)d.widgetPool.groups[l].widgets=g(d.widgetPool.groups[l].widgets);if(h.groups)for(l=0;l<h.groups.length;l++)h.groups[l].widgets=g(h.groups[l].widgets)}var l,h=d.widgetOnScreen,k=d.portalUrl;d.agolConfig=c;d.map.itemId=c.values.webmap;d.map.portalUrl=k;delete d.map.mapOptions;var m=null,p=null,s;for(s in c.values)"webmap"!==s&&b.setConfigByTemplateWithId(d,s,c.values[s]),"app_title"===s&&(m=c.values[s]),"app_subtitle"===s&&(p=c.values[s]);var r=new n;!m||!p?u.getPortal(k).getItemById(c.values.webmap).then(e.hitch(this,
function(a){m||(d.title=a.title);p||(d.subtitle=a.snippet);f();r.resolve()})):(f(),r.resolve());return r},_removeHash:function(a){for(var b in a)a[b]&&(a[b]=a[b].replace("#",""))},loadWidgetsManifest:function(a){var c=[],g=new n;a._buildInfo&&a._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(e.hitch(this,function(f){d.visitElement(a,e.hitch(this,function(a){!a.widgets&&a.uri&&(f[a.uri]?(this._addNeedValuesForManifest(f[a.uri]),b.addManifest2WidgetJson(a,f[a.uri])):c.push(this.widgetManager.loadWidgetManifest(a)))}));
r(c).then(function(){g.resolve(a)})})):(d.visitElement(a,e.hitch(this,function(a){!a.widgets&&a.uri&&c.push(this.widgetManager.loadWidgetManifest(a))})),r(c).then(function(){g.resolve(a)}));setTimeout(function(){g.isResolved()||g.resolve(a)},jimuConfig.timeout);return g},_addNeedValuesForManifest:function(a){b.addManifestProperies(a);b.processManifestLabel(a,f.locale)},_loadMergedWidgetManifests:function(){return t(window.appInfo.appPath+"widgets/widgets-manifest.json",{handleAs:"json"})},_getRepeatedId:function(a){var b=
[],c;d.visitElement(a,function(a){if(0<b.indexOf(a.id))return c=a.id,!0;b.push(a.id)});return c},_processUrlParams:function(a){if(this.urlParams.itemid||this.urlParams.webmap)a.map.itemId=this.urlParams.itemid||this.urlParams.webmap;this.urlParams.mode&&(a.mode=this.urlParams.mode);a.map.mapOptions||(a.map.mapOptions={});var b;this.urlParams.extent&&(b=-1<this.urlParams.extent.indexOf(";")?";":",",b=this.urlParams.extent.split(b),4===b.length?a.map.mapOptions.extent={xmin:parseFloat(b[0]),ymin:parseFloat(b[1]),
xmax:parseFloat(b[2]),ymax:parseFloat(b[3])}:5===b.length&&(a.map.mapOptions.extent={xmin:parseFloat(b[0]),ymin:parseFloat(b[1]),xmax:parseFloat(b[2]),ymax:parseFloat(b[3]),spatialReference:{wkid:parseInt(b[4],10)}}));this.urlParams.center&&(b=-1<this.urlParams.center.indexOf(";")?";":",",b=this.urlParams.center.split(b),2===b.length?a.map.mapOptions.center=b:3===b.length&&(b=new l(parseInt(b[0],10),parseInt(b[1],10),new w(parseInt(b[2],10))),a.map.mapOptions.center=b.toJson()));this.urlParams.scale&&
(a.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)a.map.mapOptions.zoom=this.urlParams.level||this.urlParams.zoom}});x.getInstance=function(a,b){null===v?v=new x(a,b):(v.urlParams=a,v.options=b);return v};return x})},"builder/plugins/app-config-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-configpart/Plugin","dojo/text!builder/plugins/app-config-configpart/Plugin.html","dojo/text!builder/plugins/app-config-configpart/css/style.css",
"dojo/i18n!builder/plugins/app-config-configpart/nls/strings"],function(){})},"builder/plugins/app-config-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all ./TabContainer2 builder/BasePlugin".split(" "),function(q,e,a,f,k,n){return q([n],{baseClass:"plugin-appconfig-configpart",postCreate:function(){this.inherited(arguments);this.plugins=[];this.republishEvents=[]},startup:function(){this._createConfigTab();this._addRepublishEvents()},_addRepublishEvents:function(){var e=
this.pluginManager.getPluginByName("app-config");a.forEach(this.republishEvents,function(a){e.addRepublishEvent(a)},this)},_createConfigTab:function(){var n=this.filterExtensionsByAppType("config-sections",window.appInfo.appType),q=[];a.forEach(n,function(a){q.push(this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]));a=a.parameters.republishEvents.split(",");this.republishEvents=this.republishEvents.concat(a)},this);f(q).then(e.hitch(this,function(b){var e=[];a.forEach(b,function(a,b){var f=
n[b];this.plugins.push(a);e.push({title:f.parameters.label,icon:f.parameters.icon,selectedIcon:f.parameters.selectedIcon,content:a,index:f.parameters.index})},this);e.sort(function(a,b){return a.index-b.index});this.tab=new k({tabs:e,selected:e[0].title},this.tabsNode);this.tab.startup()}),e.hitch(this,function(a){console.error(a)}))},_onMapChanged:function(a){this.map=a}})})},"builder/plugins/app-config-configpart/TabContainer2":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./TabContainer2.html jimu/dijit/ViewStack".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d){return q([t,b,n],{templateString:g,_controlNodes:null,selected:"",tabs:null,"class":"jimu-tab2",postCreate:function(){this.inherited(arguments);this._controlNodes=[];this.viewStack=new d(null,this.containerNode);a.forEach(this.tabs,function(a){this._createTab(a)},this)},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},_createTab:function(a){var b=f.toDom('\x3ctd\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3cdiv class\x3d"tab-item-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"tab-item-title"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e');
f.place(b,this.tabTr);var d=r(".tab-item-div",b)[0],g=r(".tab-item-icon",b)[0],b=r(".tab-item-title",b)[0];b.innerHTML=a.title||"";f.setAttr(b,"title",a.title||"");f.setStyle(g,"backgroundImage","url("+a.icon+")");this.viewStack.viewType=a.content.domNode?"dijit":"dom";d.tabConfig=a;d.iconNode=g;a.content.label=a.title;this.viewStack.addView(a.content);this.own(k(d,"click",e.hitch(this,this.onSelect,a.title)));this._controlNodes.push(d)},onSelect:function(a){this.selectTab(a)},selectTab:function(b){a.forEach(this._controlNodes,
e.hitch(this,function(a){var d="";a.tabConfig.title===b?(f.addClass(a,"selected-tab-item-div"),d=a.tabConfig.selectedIcon):(f.removeClass(a,"selected-tab-item-div"),d=a.tabConfig.icon);f.setStyle(a.iconNode,"backgroundImage","url("+d+")")}));this.viewStack.switchView(b);this.emit("tabChanged",b)}})})},"builder/plugins/app-config-morepreview-selectionpart/_build-generate_module":function(){define(["builder/plugins/app-config-morepreview-selectionpart/Plugin","dojo/text!builder/plugins/app-config-morepreview-selectionpart/Plugin.html",
"dojo/text!builder/plugins/app-config-morepreview-selectionpart/css/style.css","dojo/i18n!builder/plugins/app-config-morepreview-selectionpart/nls/strings"],function(){})},"builder/plugins/app-config-morepreview-selectionpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/query builder/BasePlugin jimu/portalUrlUtils jimu/dijit/QRCode".split(" "),function(q,e,a,f,k,n,r,t){return q([n],{baseClass:"plugin-appconfig-morepreview-selectionpart",postCreate:function(){this.inherited(arguments);
this._bindEvents();this._appConfigPlugin=this.pluginManager.getPluginByName("app-config")},startup:function(){this.inherited(arguments);this._initPreviewItems();this._initQRCode()},_bindEvents:function(){this.own(f(this.customWidth,"blur",e.hitch(this,this._onCustomSizeChanged)));this.own(f(this.customHeight,"blur",e.hitch(this,this._onCustomSizeChanged)))},_initPreviewItems:function(){a.empty(this.previewTbody);var b=[];b.push({"class":"iPhone6",title:"iPhone6",width:375,height:667});b.push({"class":"iPhone6-plus",
title:"iPhone6 plus",width:414,height:736});b.push({"class":"iPhone5",title:"iPhone5/5C/5S",width:320,height:568});b.push({"class":"iPhone4",title:"iPhone4/4S",width:320,height:480});b.push({"class":"iPad-Air",title:"iPad Air",width:768,height:1024});b.push({"class":"iPad4",title:"iPad with Retina Display",width:768,height:1024});b.push({"class":"new-iPad",title:"The New iPad",width:768,height:1024});b.push({"class":"iPad-mini",title:"iPad Mini",width:768,height:1024});b.push({"class":"Samsung-Galaxy-S4",
title:"Samsung Galaxy S4",width:360,height:640});b.push({"class":"Samsung-Note-3",title:"Samsung Note 3",width:360,height:640});b.push({"class":"Nexus-5",title:"Nexus 5",width:360,height:598});b.push({"class":"Nexus-4",title:"Nexus 4",width:384,height:598});b.push({"class":"Nexus-7",title:"Nexus 7",width:600,height:960});b.push({"class":"htc-one",title:"HTC One",width:360,height:640});b.push({"class":"xiaomi-3",title:"Xiaomi 3",width:360,height:640});b.push({"class":"LG-G2",title:"LG G2",width:360,
height:598});var e=Math.ceil(b.length/4),d;for(d=0;d<e;d++){var f=a.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");a.place(f,this.previewTbody)}e=k("td",this.previewTbody);for(d=0;d<b.length;d++){var f=e[d],n=this._createPreviewItem(b[d]);a.place(n,f)}},_createPreviewItem:function(b){var g=a.toDom('\x3cdiv class\x3d"preview-item"\x3e\x3cdiv class\x3d"preview-item-bg"\x3e\x3cdiv class\x3d"preview-item-thumbnail"\x3e\x3c/div\x3e\x3cdiv class\x3d"preview-selected-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d"preview-item-title"\x3e\x3c/span\x3e\x3c/div\x3e');
g.args=b;var d=k(".preview-item-bg",g)[0],h=k(".preview-item-thumbnail",g)[0],n=k(".preview-item-title",g)[0];this.own(f(d,"click",e.hitch(this,this._onPreviewItemBgClick)));b["class"]&&a.addClass(h,b["class"]);n.innerHTML=b.title||"";return g},_onPreviewItemBgClick:function(b){b=b.target||b.srcElement;a.hasClass(b,"preview-item-thumbnail")&&(b=b.parentNode,k(".preview-item-bg",this.previewTbody).removeClass("selected"),a.addClass(b,"selected"),b=b.parentNode.args,this.customWidth.value=b.width,this.customHeight.value=
b.height,this._appConfigPlugin.previewOnDevice(b,!1))},_onCustomSizeChanged:function(){var a=function(a){var b=!1;!isNaN(a)&&!isNaN(parseFloat(a))&&0<parseInt(a,10)&&(b=!0);return b},e=this.customWidth.value,d=this.customHeight.value;a(e)&&a(d)&&(k(".preview-item-bg",this.previewTbody).removeClass("selected"),e=parseInt(e,10),d=parseInt(d,10),this._appConfigPlugin.previewOnDevice({width:e,height:d},!0))},_initQRCode:function(){var b="";window.isXT?b=window.location.protocol+"//"+window.location.host+
path+"apps/"+window.appInfo.appId:(b=r.getStandardPortalUrl(window.portalUrl),b=r.setProtocol(b,window.location.protocol),b=b+"/apps/webappviewer/index.html?id\x3d"+window.appInfo.appId);new t({text:b,width:75,height:75},this.qrcodeImage);a.setAttr(this.qrcodeDescription,"innerHTML",this.nls.qrcodeDesc);setTimeout(function(){k(".qrcode-image table").style("margin","0px")},100)}})})},"jimu/dijit/QRCode":function(){define(["dojo/_base/declare","dijit/_WidgetBase","libs/qrcode"],function(q,e){return q([e],
{baseClass:"jimu-qrcode",declaredClass:"jimu.dijit.QRCode",postCreate:function(){new QRCode(this.domNode,{text:this.text,width:this.width||128,height:this.height||128,colorDark:this.colorDark||" #000000",colorLight:this.colorLight||"#ffffff",correctLevel:this.correctLevel||QRCode.CorrectLevel.L})}})})},"libs/qrcode":function(){define(["dojo","dijit","dojox"],function(q,e,a){var f;(function(){function a(b){this.mode=d.MODE_8BIT_BYTE;this.data=b;this.parsedData=[];b=0;for(var c=this.data.length;b<c;b++){var e=
[],g=this.data.charCodeAt(b);65536<g?(e[0]=240|(g&1835008)>>>18,e[1]=128|(g&258048)>>>12,e[2]=128|(g&4032)>>>6,e[3]=128|g&63):2048<g?(e[0]=224|(g&61440)>>>12,e[1]=128|(g&4032)>>>6,e[2]=128|g&63):128<g?(e[0]=192|(g&1984)>>>6,e[1]=128|g&63):e[0]=g;this.parsedData.push(e)}this.parsedData=Array.prototype.concat.apply([],this.parsedData);this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(a,b){this.typeNumber=a;this.errorCorrectLevel=
b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}function r(a,b){if(void 0==a.length)throw Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function q(a,b){this.totalCount=a;this.dataCount=b}function b(){this.buffer=[];this.length=0}function g(){var a=!1,b=navigator.userAgent;/android/i.test(b)&&(a=!0,(aMat=b.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(a=parseFloat(aMat[1])));
return a}a.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;b<c;b++)a.put(this.parsedData[b],8)}};e.prototype={addData:function(b){b=new a(b);this.dataList.push(b);this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,
b){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(a,b);7<=this.typeNumber&&this.setupTypeNumber(a);null==this.dataCache&&
(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=0<=c&&6>=c&&(0==d||6==d)||0<=d&&6>=d&&(0==c||6==c)||2<=c&&4>=c&&2<=d&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=u.getLostPoint(this);if(0==c||a>d)a=d,b=
c}return b},createMovieClip:function(a,b,c){a=a.createEmptyMovieClip(b,c);this.make();for(b=0;b<this.modules.length;b++){c=1*b;for(var d=0;d<this.modules[b].length;d++){var e=1*d;this.modules[b][d]&&(a.beginFill(0,100),a.moveTo(e,c),a.lineTo(e+1,c),a.lineTo(e+1,c+1),a.lineTo(e,c+1),a.endFill())}}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(a=8;a<this.moduleCount-8;a++)null==this.modules[6][a]&&(this.modules[6][a]=
0==a%2)},setupPositionAdjustPattern:function(){for(var a=u.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var g=-2;2>=g;g++)for(var f=-2;2>=f;f++)this.modules[d+g][e+f]=-2==g||2==g||-2==f||2==f||0==g&&0==f?!0:!1}},setupTypeNumber:function(a){for(var b=u.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(c=0;18>c;c++)d=!a&&1==(b>>c&1),
this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d},setupTypeInfo:function(a,b){for(var c=u.getBCHTypeInfo(this.errorCorrectLevel<<3|b),d=0;15>d;d++){var e=!a&&1==(c>>d&1);6>d?this.modules[d][8]=e:8>d?this.modules[d+1][8]=e:this.modules[this.moduleCount-15+d][8]=e}for(d=0;15>d;d++)e=!a&&1==(c>>d&1),8>d?this.modules[8][this.moduleCount-d-1]=e:9>d?this.modules[8][15-d-1+1]=e:this.modules[8][15-d-1]=e;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-
1,e=7,g=0,f=this.moduleCount-1;0<f;f-=2)for(6==f&&f--;;){for(var h=0;2>h;h++)if(null==this.modules[d][f-h]){var k=!1;g<a.length&&(k=1==(a[g]>>>e&1));u.getMask(b,d,f-h)&&(k=!k);this.modules[d][f-h]=k;e--; -1==e&&(g++,e=7)}d+=c;if(0>d||this.moduleCount<=d){d-=c;c=-c;break}}}};e.PAD0=236;e.PAD1=17;e.createData=function(a,c,d){c=q.getRSBlocks(a,c);for(var g=new b,f=0;f<d.length;f++){var h=d[f];g.put(h.mode,4);g.put(h.getLength(),u.getLengthInBits(h.mode,a));h.write(g)}for(f=a=0;f<c.length;f++)a+=c[f].dataCount;
if(g.getLengthInBits()>8*a)throw Error("code length overflow. ("+g.getLengthInBits()+"\x3e"+8*a+")");for(g.getLengthInBits()+4<=8*a&&g.put(0,4);0!=g.getLengthInBits()%8;)g.putBit(!1);for(;!(g.getLengthInBits()>=8*a);){g.put(e.PAD0,8);if(g.getLengthInBits()>=8*a)break;g.put(e.PAD1,8)}return e.createBytes(g,c)};e.createBytes=function(a,b){for(var c=0,d=0,e=0,g=Array(b.length),f=Array(b.length),h=0;h<b.length;h++){var k=b[h].dataCount,m=b[h].totalCount-k,d=Math.max(d,k),e=Math.max(e,m);g[h]=Array(k);
for(var p=0;p<g[h].length;p++)g[h][p]=255&a.buffer[p+c];c+=k;p=u.getErrorCorrectPolynomial(m);k=(new r(g[h],p.getLength()-1)).mod(p);f[h]=Array(p.getLength()-1);for(p=0;p<f[h].length;p++)m=p+k.getLength()-f[h].length,f[h][p]=0<=m?k.get(m):0}for(p=h=0;p<b.length;p++)h+=b[p].totalCount;c=Array(h);for(p=k=0;p<d;p++)for(h=0;h<b.length;h++)p<g[h].length&&(c[k++]=g[h][p]);for(p=0;p<e;p++)for(h=0;h<b.length;h++)p<f[h].length&&(c[k++]=f[h][p]);return c};for(var d={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,
MODE_KANJI:8},h={L:1,M:0,Q:3,H:2},u={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],
[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;0<=u.getBCHDigit(b)-u.getBCHDigit(u.G15);)b^=u.G15<<u.getBCHDigit(b)-u.getBCHDigit(u.G15);return(a<<10|b)^u.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;0<=u.getBCHDigit(b)-u.getBCHDigit(u.G18);)b^=u.G18<<u.getBCHDigit(b)-u.getBCHDigit(u.G18);
return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return u.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return 0==(b+c)%2;case 1:return 0==b%2;case 2:return 0==c%3;case 3:return 0==(b+c)%3;case 4:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case 5:return 0==b*c%2+b*c%3;case 6:return 0==(b*c%2+b*c%3)%2;case 7:return 0==(b*c%3+(b+c)%2)%2;default:throw Error("bad maskPattern:"+a);}},getErrorCorrectPolynomial:function(a){for(var b=
new r([1],0),c=0;c<a;c++)b=b.multiply(new r([1,m.gexp(c)],0));return b},getLengthInBits:function(a,b){if(1<=b&&10>b)switch(a){case d.MODE_NUMBER:return 10;case d.MODE_ALPHA_NUM:return 9;case d.MODE_8BIT_BYTE:return 8;case d.MODE_KANJI:return 8;default:throw Error("mode:"+a);}else if(27>b)switch(a){case d.MODE_NUMBER:return 12;case d.MODE_ALPHA_NUM:return 11;case d.MODE_8BIT_BYTE:return 16;case d.MODE_KANJI:return 10;default:throw Error("mode:"+a);}else if(41>b)switch(a){case d.MODE_NUMBER:return 14;
case d.MODE_ALPHA_NUM:return 13;case d.MODE_8BIT_BYTE:return 16;case d.MODE_KANJI:return 12;default:throw Error("mode:"+a);}else throw Error("type:"+b);},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var g=0,f=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||b<=d+h))for(var k=-1;1>=k;k++)0>e+k||b<=e+k||0==h&&0==k||f==a.isDark(d+h,e+k)&&g++;5<g&&(c+=3+g-5)}for(d=0;d<b-1;d++)for(e=0;e<b-1;e++)if(g=0,a.isDark(d,e)&&g++,a.isDark(d+1,e)&&g++,a.isDark(d,e+1)&&g++,
a.isDark(d+1,e+1)&&g++,0==g||4==g)c+=3;for(d=0;d<b;d++)for(e=0;e<b-6;e++)a.isDark(d,e)&&(!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6))&&(c+=40);for(e=0;e<b;e++)for(d=0;d<b-6;d++)a.isDark(d,e)&&(!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e))&&(c+=40);for(e=g=0;e<b;e++)for(d=0;d<b;d++)a.isDark(d,e)&&g++;a=Math.abs(100*g/b/b-50)/5;return c+10*a}},m={glog:function(a){if(1>a)throw Error("glog("+
a+")");return m.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;256<=a;)a-=255;return m.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},s=0;8>s;s++)m.EXP_TABLE[s]=1<<s;for(s=8;256>s;s++)m.EXP_TABLE[s]=m.EXP_TABLE[s-4]^m.EXP_TABLE[s-5]^m.EXP_TABLE[s-6]^m.EXP_TABLE[s-8];for(s=0;255>s;s++)m.LOG_TABLE[m.EXP_TABLE[s]]=s;r.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=Array(this.getLength()+a.getLength()-1),c=0;c<
this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=m.gexp(m.glog(this.get(c))+m.glog(a.get(d)));return new r(b,0)},mod:function(a){if(0>this.getLength()-a.getLength())return this;for(var b=m.glog(this.get(0))-m.glog(a.get(0)),c=Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(d=0;d<a.getLength();d++)c[d]^=m.gexp(m.glog(a.get(d))+b);return(new r(c,0)).mod(a)}};q.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],
[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,
2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,
43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],
[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],
[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],
[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];q.getRSBlocks=function(a,b){var c=q.getRsBlockTable(a,b);if(void 0==c)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,e=[],g=0;g<d;g++)for(var f=c[3*g+0],h=c[3*g+1],k=c[3*g+2],m=0;m<f;m++)e.push(new q(h,k));return e};
q.getRsBlockTable=function(a,b){switch(b){case h.L:return q.RS_BLOCK_TABLE[4*(a-1)+0];case h.M:return q.RS_BLOCK_TABLE[4*(a-1)+1];case h.Q:return q.RS_BLOCK_TABLE[4*(a-1)+2];case h.H:return q.RS_BLOCK_TABLE[4*(a-1)+3]}};b.prototype={get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0);
a&&(this.buffer[b]|=128>>>this.length%8);this.length++}};var p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,
751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],s=function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){function b(a,c){var d=document.createElementNS("http://www.w3.org/2000/svg",a),e;for(e in c)c.hasOwnProperty(e)&&
d.setAttribute(e,c[e]);return d}var c=this._htOption,d=this._el,e=a.getModuleCount();this.clear();var g=b("svg",{viewBox:"0 0 "+String(e)+" "+String(e),width:"100%",height:"100%",fill:c.colorLight});g.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");d.appendChild(g);g.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(c=0;c<e;c++)for(d=0;d<e;d++)if(a.isDark(c,d)){var f=b("use",{x:String(c),y:String(d)});f.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#template");g.appendChild(f)}};a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};return a}(),c="svg"===document.documentElement.tagName.toLowerCase()?s:"undefined"==typeof CanvasRenderingContext2D?function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),g=Math.floor(b.height/d),f=['\x3ctable style\x3d"border:0;border-collapse:collapse;"\x3e'],
l=0;l<d;l++){f.push("\x3ctr\x3e");for(var h=0;h<d;h++)f.push('\x3ctd style\x3d"border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+g+"px;background-color:"+(a.isDark(l,h)?b.colorDark:b.colorLight)+';"\x3e\x3c/td\x3e');f.push("\x3c/tr\x3e")}f.push("\x3c/table\x3e");c.innerHTML=f.join("");a=c.childNodes[0];c=(b.width-a.offsetWidth)/2;b=(b.height-a.offsetHeight)/2;0<c&&0<b&&(a.style.margin=b+"px "+c+"px")};a.prototype.clear=function(){this._el.innerHTML=""};return a}():function(){function a(){this._elImage.src=
this._elCanvas.toDataURL("image/png");this._elImage.style.display="block";this._elCanvas.style.display="none"}function b(a,c){var d=this;d._fFail=c;d._fSuccess=a;if(null===d._bSupportDataURI){var e=document.createElement("img"),g=function(){d._bSupportDataURI=!1;d._fFail&&_fFail.call(d)};e.onabort=g;e.onerror=g;e.onload=function(){d._bSupportDataURI=!0;d._fSuccess&&d._fSuccess.call(d)};e.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg\x3d\x3d"}else!0===
d._bSupportDataURI&&d._fSuccess?d._fSuccess.call(d):!1===d._bSupportDataURI&&d._fFail&&d._fFail.call(d)}if(this._android&&2.1>=this._android){var c=1/window.devicePixelRatio,d=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,g,f,l,h,k,m){if("nodeName"in a&&/img/i.test(a.nodeName))for(var p=arguments.length-1;1<=p;p--)arguments[p]*=c;else"undefined"==typeof k&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);d.apply(this,arguments)}}var e=
function(a,b){this._bIsPainted=!1;this._android=g();this._htOption=b;this._elCanvas=document.createElement("canvas");this._elCanvas.width=b.width;this._elCanvas.height=b.height;a.appendChild(this._elCanvas);this._el=a;this._oContext=this._elCanvas.getContext("2d");this._bIsPainted=!1;this._elImage=document.createElement("img");this._elImage.alt="Scan me!";this._elImage.style.display="none";this._el.appendChild(this._elImage);this._bSupportDataURI=null};e.prototype.draw=function(a){var b=this._elImage,
c=this._oContext,d=this._htOption,e=a.getModuleCount(),g=d.width/e,f=d.height/e,l=Math.round(g),h=Math.round(f);b.style.display="none";this.clear();for(b=0;b<e;b++)for(var k=0;k<e;k++){var m=a.isDark(b,k),p=k*g,s=b*f;c.strokeStyle=m?d.colorDark:d.colorLight;c.lineWidth=1;c.fillStyle=m?d.colorDark:d.colorLight;c.fillRect(p,s,g,f);c.strokeRect(Math.floor(p)+0.5,Math.floor(s)+0.5,l,h);c.strokeRect(Math.ceil(p)-0.5,Math.ceil(s)-0.5,l,h)}this._bIsPainted=!0};e.prototype.makeImage=function(){this._bIsPainted&&
b.call(this,a)};e.prototype.isPainted=function(){return this._bIsPainted};e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height);this._bIsPainted=!1};e.prototype.round=function(a){return!a?a:Math.floor(1E3*a)/1E3};return e}();f=function(a,b){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:h.H};"string"===typeof b&&(b={text:b});if(b)for(var d in b)this._htOption[d]=b[d];"string"==typeof a&&(a=document.getElementById(a));
this._android=g();this._el=a;this._oQRCode=null;this._oDrawing=new c(this._el,this._htOption);this._htOption.text&&this.makeCode(this._htOption.text)};f.prototype.makeCode=function(a){var b=this._htOption.correctLevel,c=1,d;d=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");d=d.length+(d.length!=a?3:0);for(var g=0,f=p.length;g<=f;g++){var k=0;switch(b){case h.L:k=p[g][0];break;case h.M:k=p[g][1];break;case h.Q:k=p[g][2];break;case h.H:k=p[g][3]}if(d<=k)break;else c++}if(c>p.length)throw Error("Too long data");
this._oQRCode=new e(c,this._htOption.correctLevel);this._oQRCode.addData(a);this._oQRCode.make();this._el.title=a;this._oDrawing.draw(this._oQRCode);this.makeImage()};f.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()};f.prototype.clear=function(){this._oDrawing.clear()};f.CorrectLevel=h;window.QRCode=f})()})},"dojox/main":function(){define(["dojo/_base/kernel"],function(q){return q.dojox})},"builder/plugins/app-list/_build-generate_module":function(){define(["builder/plugins/app-list/Plugin",
"dojo/text!builder/plugins/app-list/Plugin.html","dojo/text!builder/plugins/app-list/css/style.css","dojo/i18n!builder/plugins/app-list/nls/strings"],function(){})},"builder/plugins/app-list/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/mouse dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/on dojo/_base/lang dojo/sniff ./AppOperMenu builder/serviceUtils dojo/topic dojo/dom-class dojo/query jimu/dijit/Message jimu/dijit/LoadingShelter jimu/dijit/ItemSelector jimu/dijit/Popup jimu/utils builder/portalUtils builder/BasePlugin esri/lang dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x){return q([v,f],{baseClass:"plugin-app-list",templateString:k,menu:void 0,label:"applist",apps:null,sortBy:"lastUpdated",_itemSelector:null,_importPopup:null,postMixInProperties:function(){this.inherited(arguments);this.nls=r.mixin(this.nls,builderNls)},constructor:function(){this.apps={}},startup:function(){this.inherited(arguments);this.refresh();e.setSelectable(this.appContent,!1);this.loading=new s({hidden:!0});this.loading.placeAt(this.domNode);
this.importing=new s({hidden:!0,loadingText:this.nls.importing});this.importing.placeAt(this.domNode);this.upgrading=new s({hidden:!0,loadingText:this.nls.upgrading});this.upgrading.placeAt(this.domNode);this.uploading=new s({hidden:!0,loadingText:this.nls.uploading});this.uploading.placeAt(this.domNode);this.own(n(window.document,"click",r.hitch(this,function(){setTimeout(r.hitch(this,function(){e.setStyle(this.actionsMenu,"display","none");window.isRTL?e.setStyle(this.actionsMenu,{left:"auto",right:0}):
e.setStyle(this.actionsMenu,{right:"auto",left:0});e.removeClass(this.actionsNode,"actions-drop-down")}),50)})));u('input[type\x3d"file"]',this.appFileInputNode.domNode).forEach(r.hitch(this,function(a){e.setAttr(a,"accept",".zip")}));this.appPortalUrlInputNode&&(this.appPortalUrlInputNode.value=window.portalUrl);this._keepFileChooserOverItem()},_keepFileChooserOverItem:function(){9>=t("ie")&&u("span.dijitUploader input:first-child",this.domNode).forEach(r.hitch(this,function(a){window.isRTL?e.setStyle(a,
{left:"33px",right:"auto"}):e.setStyle(a,"right","33px")}))},getAppList:function(){return g.getAppList()},refresh:function(a){a?(this.setApps(a),this.createAppList()):this.getAppList().then(r.hitch(this,function(a){this.setApps(a);this.createAppList()}))},setApps:function(a){this.apps=a},createAppList:function(){this.cleanAppList();var a,b=null;for(a=0;a<this.apps.length;a++)b=this.createAppNode(this.apps[a],a,b)},cleanAppList:function(){e.empty(this.listTable.firstElementChild||this.listTable.firstChild)},
createAppNode:function(c,g,f){var l,h,k,m,p,s,q,t,v,w,x;g=e.create("tr",{"class":"list-table-item list-table-item"+(g%2?" list-table-item-add ":" ")},this.listTable.firstElementChild||this.listTable.firstChild);x=e.create("td",{"class":"item-begin-td item-first-td"},g);e.create("td",{"class":"item-begin-td item-second-td"},g);h=e.create("td",{"class":"item-name-td"},g);k=e.create("div",{"class":"item-name",innerHTML:c.name,title:c.name},h);m=e.create("td",{"class":"item-desc-td"},g);p=e.create("div",
{"class":"item-desc",innerHTML:c.description,title:c.description},m);l=e.create("td",{"class":"item-time-td"},g);w=e.create("div",{"class":"item-time",innerHTML:this._getLocaleDateTime(c.lastUpdated)},l);l=e.create("td",{"class":"item-modified-td"},g);var M=e.create("div",{"class":"item-modified",innerHTML:c.modified},l);l=e.create("td",{"class":"item-creator-td"},g);e.create("div",{"class":"item-creator",innerHTML:c.creator},l);l=e.create("td",{"class":"item-loading-td",innerHTML:"\x3cdiv class\x3d'loading-div'\x3e\x3c/div\x3e"},
g);t=u(".loading-div",l)[0];e.create("img",{src:this.folderUrl+"css/images/download.gif","class":"loading-img"},t);l=e.create("td",{"class":"item-operations-td"},g);l=e.create("div",{"class":"item-operations-div"},l);e.setStyle(l,"display","none");s=e.create("div",{"class":"item-edit jimu-float-leading",title:this.nls.edit},l);e.create("div",{innerHTML:this.nls.edit,"class":"item-edit-text jimu-float-leading"},s);e.create("div",{innerHTML:'\x3ca href\x3d"stemapp/index.html?id\x3d'+c.id+'" target\x3d"_blank"\x3e'+
this.nls.launch+"\x3c/a\x3e","class":"item-preview jimu-float-leading",title:this.nls.launch},l);q=e.create("div",{"class":"item-more jimu-float-leading"},l);v=e.create("td",{"class":"item-end-td"},g);v=e.create("div",{"class":"app-menu-div"},v);t=new b({apps:this.apps,app:c,posNode:g,loadingDiv:t,appListWidget:this,nls:this.nls},v);this.own(n(g,a.enter,r.hitch(this,this._onListTableItemMouseover,g,l,f)));this.own(n(g,a.leave,r.hitch(this,this._onListTableItemMouseout,g,l,t,f)));this.own(n(g,"click",
r.hitch(this,function(a){a.stopPropagation()})));this.own(n(k,"dblclick",r.hitch(this,this._onNameDoubleClick,c,g,h,k,w,M)));this.own(n(p,"dblclick",r.hitch(this,this._onDescriptionDoubleClick,c,g,m,p,w,M)));this.own(n(s,"click",r.hitch(this,this._onAppEditClick,c)));this.own(n(q,"click",r.hitch(this,this._onAppMoreClick,c,t,q,x,g,l,f)));this.own(n(this.ownerDocument,"click",r.hitch(this,this._onAppsClick,t,g,l,x,f,q)));this.own(d.subscribe("menuAll/hide",r.hitch(this,this._onAppsClick,t,g,l,x,f,
q)));this.own(n(this.listSectionBodyContent,"scroll",r.hitch(this,this._onScroll,t,g,l,x,f,q)));return g},changeTextFieldOfNode:function(a,b,c,d,g,f,l){var k,p=r.clone(a);e.setStyle(g,"display","none");k="name"===d?e.create("input",{value:a[d],"class":"jimu-input item-input-"+d},c):e.create("textarea",{value:a[d],"class":"jimu-input item-textarea-"+d},c);k.focus();k.select();h.add(b,"list-table-item-dbclick");n(k,"blur",r.hitch(this,function(){a[d]!==k.value&&(p[d]=k.value,this.updateApp(p).then(r.hitch(this,
function(b){!0===b.success?(g.innerHTML=k.value,g.title=k.value,f.innerHTML=this._getLocaleDateTime(b.lastUpdated),l.innerHTML=b.modified,a[d]=k.value):(console.error("The response of updateApp is 'unsuccess'!"),new m({message:b.message}))}),function(a){console.error("Updates 'app name' or 'app description' failed!"+a)}));e.destroy(k);e.setStyle(g,"display","block");h.remove(b,"list-table-item-dbclick")}))},updateApp:function(a){return g.updateApp(a)},_onCreateClick:function(){var a=this.pluginManager.getExtensions("startup.creation-entry")[0],
a=this.pluginsMeta[a.pluginName];this.loading.show("");this.pluginManager.loadPlugin(a).then(r.hitch(this,function(a){a.popupDlg();this.loading.hide()}),r.hitch(this,function(){this.loading.hide()}))},_onActionsLabelClick:function(a){var b=e.getMarginBox(window.jimuConfig.layoutId),c=null;"none"===e.getStyle(this.actionsMenu,"display")?(e.setStyle(this.actionsMenu,"display","block"),c=e.position(this.actionsMenu),window.isRTL?0>c.x&&e.setStyle(this.actionsMenu,{right:"auto",left:0}):c.x+c.w>b.w&&
e.setStyle(this.actionsMenu,{left:"auto",right:0})):(e.setStyle(this.actionsMenu,"display","none"),e.position(this.actionsMenu),window.isRTL?e.setStyle(this.actionsMenu,{left:"auto",right:0}):e.setStyle(this.actionsMenu,{right:"auto",left:0}));a.stopPropagation()},_onMenuItemClick:function(a){setTimeout(r.hitch(this,function(){e.setStyle(this.actionsMenu,"display","none");e.removeClass(this.actionsNode,"actions-drop-down");a.stopPropagation()}),50)},_onAppFileUploadError:function(a){console.error(a);
new m({message:a.message||a});this._keepFileChooserOverItem();this.uploading.hide()},_onAppFileUploadComplete:function(a){a.success?(this.cleanAppList(),this.getAppList().then(r.hitch(this,function(a){this.setApps(a);this.createAppList()})),this._keepFileChooserOverItem(),this.uploading.hide()):this._onAppFileUploadError(a)},_onAppFileChange:function(){var a=this.appFileInputNode.getFileList();a&&0<a.length&&(/.+(\.zip)$/.test(a[0].name)?(this.uploading.show(),w.getPortal(window.portalUrl).getUser().then(r.hitch(this,
function(a){e.setAttr(this.appFileCreatorInputNode,"value",a.username);this.appFileInputNode.submit(this.uploadAppFileFormNode)}),function(a){console.error(a);new m({message:a.message||a});this.uploading.hide()})):new m({message:"This file type is not supported."}))},_onImportClick:function(){this._itemSelector=new p({portalUrl:window.portalUrl,itemTypes:["Web Mapping Application"],onlyShowOnlineFeaturedItems:!1,typeKeywords:["Web AppBuilder"],showOnlineItems:!1});this._importPopup=new c({titleLabel:this.nls.importApp,
content:this._itemSelector.domNode,buttons:[{label:this.nls.ok,onClick:r.hitch(this,this._onImportOkClick)},{label:this.nls.cancel,onClick:r.hitch(this,this._onImportCancelClick)}]});this._importPopup.disableButton(0);this.own(n(this._itemSelector,"item-selected",r.hitch(this,function(){this._importPopup.enableButton(0)})));this.own(n(this._itemSelector,"none-item-selected",r.hitch(this,function(){this._importPopup.disableButton(0)})));this._itemSelector.startup()},_onImportOkClick:function(){var a=
this._itemSelector.getSelectedItem();this.loading.show();w.getPortal(window.portalUrl).getUser().then(r.hitch(this,function(b){a.getItemData().then(r.hitch(this,function(c){this.loading.hide();this._importPopup.close();c=r.clone(c);this._checkAppVersion(c,{creator:b.username,name:a.title,description:a.description||"",appType:"HTML",stemappPath:this.pluginManager.getStemappInfo("HTML").appPath,portalUrl:window.portalUrl})}),r.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,
b)}))}),r.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppVersion:function(a,b){this.importing.show();g.checkAppVersion(a).then(r.hitch(this,function(c){this.importing.hide();c=c.versionInfo;"old"===c.wabVersionStatus?this._doAction("upgrade",a,b):"new"===c.wabVersionStatus?this._showNewer(b.appName,c.appVersion):"same"===c.wabVersionStatus&&this._doAction("import",a,b)}),r.hitch(this,function(b){this.importing.hide();this._checkAppInfoError(a.title,b)}))},
_checkAppInfoError:function(a,b){new m({message:x.substitute({APP_NAME:a},this.nls.checkVersionError)});console.error(b)},_showUpgrade:function(a,b,d){d="\x3cdiv style\x3d'font-size:14px;'\x3e"+x.substitute({OLD_VERSION:d.appVersion,LATEST_VERSION:d.latestVersion},this.nls.upgradeContent)+"\x3cdiv style\x3d'height:24px;'\x3e\x3c/div\x3e"+this.nls.upgradeContentFooter+"\x3c/div\x3e";var g=new c({titleLabel:this.nls.upgradeApp,content:e.toDom(d),width:640,autoHeight:!0,buttons:[{label:this.nls.upgradeBtn,
onClick:r.hitch(this,function(){g.close();this._doAction("upgrade",a,b)})},{label:this.nls.cancel,onClick:r.hitch(this,function(){g.close()})}]})},_showNewer:function(a,b){var d="\x3cdiv style\x3d'font-size:14px;'\x3e"+x.substitute({APP_NAME:a,VERSION_NUMBER:b},this.nls.importUpperVertion)+"\x3c/div\x3e";new c({titleLabel:this.nls.importApp,content:e.toDom(d),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})},_doAction:function(a,b,c){"import"===a?this.importing.show():"upgrade"===a&&this.upgrading.show();
g.importPortalApp(b,c).then(r.hitch(this,function(){this._importSuccess(c.appName)}),r.hitch(this,function(a){this.upgrading.hide();this.importing.hide();this._importError(c.appName,a)}))},_importSuccess:function(a){this.getAppList().then(r.hitch(this,function(b){this.setApps(b);this.createAppList();b="\x3cdiv style\x3d'font-size:14px;'\x3e"+x.substitute({APP_NAME:a},this.nls.importSuccess)+"\x3c/div\x3e";new c({titleLabel:this.nls.importApp,content:e.toDom(b),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})}),
r.hitch(this,function(a){console.error(a)})).always(r.hitch(this,function(){this.importing.hide();this.upgrading.hide()}))},_importError:function(a,b){var d="\x3cdiv style\x3d'font-size:14px;'\x3e"+x.substitute({APP_NAME:a},this.nls.upgradeFailure)+"\x3c/div\x3e";new c({titleLabel:this.nls.importApp,content:e.toDom(d),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]});console.error(b)},_getLocaleDateTime:function(a){return l.localizeDate(new Date(a),{fullYear:!0})},_onImportCancelClick:function(){this._importPopup.close()},
_onListTableItemMouseover:function(a,b,c){h.add(a,"list-table-item-mouseover");c&&h.add(c,"list-table-next-item-mouseover");e.setStyle(b,"display","block")},_onListTableItemMouseout:function(a,b,c,d){c.isShow||(h.remove(a,"list-table-item-mouseover"),d&&h.remove(d,"list-table-next-item-mouseover"),e.setStyle(b,"display","none"))},_onNameDoubleClick:function(a,b,c,d,e,g){r.hitch(this,this.changeTextFieldOfNode(a,b,c,"name",d,e,g))},_onDescriptionDoubleClick:function(a,b,c,d,e,g){r.hitch(this,this.changeTextFieldOfNode(a,
b,c,"description",d,e,g))},_onAppEditClick:function(a){this.pluginManager.getPluginByName("startup").switchToAppConfig(a)},_onAppMoreClick:function(a,b,c,g,f,l,k,m){b.isShow?(b.hide(),h.remove(g,"item-first-td-selected"),e.removeClass(c,"item-more-selected")):(d.publish("menuAll/hide"),b.set("app",a),b.show(),h.add(g,"item-first-td-selected"),e.addClass(c,"item-more-selected"),this._onListTableItemMouseover(f,l,k,m));m.stopPropagation()},_onAppsClick:function(a,b,c,d,g,f){a.hide();h.remove(d,"item-first-td-selected");
g&&h.remove(g,"list-table-next-item-mouseover");h.remove(b,"list-table-item-mouseover");e.removeClass(f,"item-more-selected");e.setStyle(c,"display","none")},_onScroll:function(a,b,c,d,e,g){!0===a.isShow&&this._onAppsClick(a,b,c,d,e,g)}})})},"builder/plugins/app-list/AppOperMenu":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppOperMenu.html dojo/on dojo/query dojo/dom dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/serviceUtils jimu/dijit/LoadingShelter dijit/form/TextBox dijit/form/SimpleTextarea jimu/dijit/QRCode builder/PluginManager".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l){return q([a,f],{templateString:k,baseClass:"app-menu",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",appListWidget:void 0,loadingDiv:null,_downloadUrl:null,postCreate:function(){this.inherited(arguments);this.height=e.getMarginBox(this.domNode).h;this.hide();this._downloadUrl="/webappbuilder/rest/apps/"+this.app.id+"/download";e.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(n(this.downloadLinkNode,"click",g.hitch(this,function(){this.hide()})))},
refresh:function(){var a=t.byId("list-section"),b=e.position(this.posNode),c=e.position(a),d=b.y-c.y,a=e.getStyle(a,"height"),c=c.y+a,a=this.height,b=b.y+a;e.setStyle(this.upTriangle,"display","block");e.setStyle(this.downTriangle,"display","none");b+30>c&&(d=d-a-66,e.setStyle(this.upTriangle,"display","none"),e.setStyle(this.downTriangle,"top",this.height-2+"px"),e.setStyle(this.downTriangle,"display","block"));e.setStyle(this.domNode,isRTL?{top:d+52+"px",left:"2px"}:{top:d+52+"px",right:"2px"})},
show:function(){this.refresh();e.setStyle(this.domNode,"display","block");this.isShow=!0},hide:function(){e.setStyle(this.domNode,"display","none");this.isShow=!1},_onMenuClick:function(a){a.stopPropagation()},_onCreateFromHereClick:function(){},_onCreateFromHereMouseover:function(){e.addClass(this.createFromHere,"item-mouseover")},_onCreateFromHereMouseout:function(){e.removeClass(this.createFromHere,"item-mouseover")},_onRemoveClick:function(){var a=new d({content:this.nls.confirmDeleteApp,titleLabel:this.nls.deleteAppTitle,
width:"425",autoHeight:!0,buttons:[{label:this.nls.ok,onClick:g.hitch(this,function(){var b=new m({hidden:!0});b.placeAt(this.appListWidget.domNode);b.show(this.nls.deleting);a.close();u.removeApp(this.app.id).then(g.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),a.apps!=={}&&this.appListWidget.refresh(a.apps)):console.error(this.nls.deleteFalse);b.destroy()}),function(){console.error(this.nls.deleteError);b.destroy()})})},{label:this.nls.cancel,onClick:g.hitch(this,
function(){a.close()})}]})},_onRemoveMouseover:function(){e.addClass(this.remove,"item-mouseover")},_onRemoveMouseout:function(){e.removeClass(this.remove,"item-mouseover")},_onDuplicateClick:function(){var a=new m({hidden:!0});a.placeAt(this.appListWidget.domNode);a.show(this.nls.duplicating);u.duplicateApp({name:this.app.name,description:this.app.description,is3D:this.app.is3D,createFromId:this.app.id,appType:this.app.appType,appPath:l.getInstance().getStemappInfo("HTML").appPath}).then(g.hitch(this,
function(b){a.destroy();b.success?(console.log("Duplicated app successfully, app id\x3d"+this.app.id),b.apps!=={}&&this.appListWidget.refresh(b.apps)):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError)});this.hide()},_onDuplicateMouseover:function(){e.addClass(this.duplicate,"item-mouseover")},_onDuplicateMouseout:function(){e.removeClass(this.duplicate,"item-mouseover")},_onEditClick:function(){var a=e.create("div",{"class":"edit-app-info-content"}),b;b=e.create("div",
{"class":"app-name"},a);var c=(new s({value:this.app.name,maxlength:250,required:!0,placeholder:this.nls.appName,"class":"name-text-box"})).placeAt(b);b=e.create("div",{"class":"app-description"},a);var f=(new p({value:this.app.description,rows:5,trim:!0,maxlength:250,required:!0,placeholder:this.nls.appDesc,"class":"desc-text-area"})).placeAt(b),l=new d({content:a,container:"main-page",titleLabel:this.nls.editAppInfo,width:"700",autoHeight:!0,buttons:[{label:this.nls.ok,onClick:g.hitch(this,function(){var a=
g.hitch(this,this._onEditPageOk,c.getValue(),f.getValue(),l);this.app.name!==c.getValue()||this.app.description!==f.getValue()?a():l.close()})},{label:this.nls.cancel,onClick:function(){l.close()}}]}),a=r(".line",l.domNode)[0];e.destroy(a)},_onEditPageOk:function(a,b,c){var d=g.clone(this.app);d.name=a;d.description=b;this.appListWidget.updateApp(d).then(g.hitch(this,function(d){!0===d.success?(this.app.name=a,this.app.description=b,console.log(this.nls.editAppTrue+this.app.id),this.app.lastUpdated=
d.lastUpdated,this.app.modified=d.modified,this.appListWidget.refresh(this.apps),c.close()):(console.error(this.nls.editAppFalse),new h({message:d.message}))}),function(a){console.error(this.nls.error+a)})},_onEditMouseover:function(){e.addClass(this.editAppInfo,"item-mouseover")},_onEditMouseout:function(){e.removeClass(this.editAppInfo,"item-mouseover")},_onDownloadClick:function(){},_onDownloadMouseover:function(){e.addClass(this.download,"item-mouseover")},_onDownloadMouseout:function(){e.removeClass(this.download,
"item-mouseover")},_onAgolTemplateClick:function(){var a=this.appListWidget.pluginsMeta["popup-actions.popup-agoltemplate"];a&&this.appListWidget.pluginManager.loadPlugin(a).then(g.hitch(this,function(a){a.onClickBeforeConfigPage(this.app)}))},_onAgolTemplateMouseover:function(){e.addClass(this.agolTemplate,"item-mouseover")},_onAgolTemplateMouseout:function(){e.removeClass(this.agolTemplate,"item-mouseover")},_onQRCodeClick:function(){new d({content:new c({text:"http://"+window.location.host+path+
"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,key:b.ESCAPE}]})}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(q,e,a,f,k){return q([e,a],{baseClass:"jimu-loading-shelter",declaredClass:"jimu.dijit.LoadingShelter",templateString:f,loadingText:null,hidden:!1,postMixInProperties:function(){this.nls=
window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&k.setStyle(this.domNode,"display","none");k.setStyle(this.domNode,{width:"100%",height:"100%"});this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(a){this.domNode&&this.hidden&&("string"===typeof a&&(this.textNode.innerHTML=a),k.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&
!this.hidden&&(k.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(q,e,a,f){return q("dijit.form.SimpleTextarea",f,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",postMixInProperties:function(){!this.value&&
this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);a("ie")&&this.cols&&e.add(this.textbox,"dijitTextAreaCols")},filter:function(a){a&&(a=a.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(e){if(this.maxLength){var f=parseInt(this.maxLength),r=this.textbox.value.replace(/\r/g,""),f=r.length-f;if(0<f){var q=this.textbox;if(q.selectionStart){var b=q.selectionStart,g=0;a("opera")&&(g=(this.textbox.value.substring(0,
b).match(/\r/g)||[]).length);this.textbox.value=r.substring(0,b-f-g)+r.substring(b-g);q.setSelectionRange(b-f,b-f)}else this.ownerDocument.selection&&(q.focus(),r=this.ownerDocument.selection.createRange(),r.moveStart("character",-f),r.text="",r.select())}}this.inherited(arguments)}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B){return q([a,f,k,r],{templateString:n,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=w.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";g.forEach(this.itemTypes,t.hitch(this,function(a,b){this._itemTypes+='"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";g.forEach(this.typeKeywords,t.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=c.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=p.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=p.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new y({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(s(this.tab,"tabChanged",t.hitch(this,function(a){d.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){d.setStyle(this.signinSection,"display","none");var a=m(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);l.userHaveSignInPortal(this._getPortalUrl())?a.style("display",
"block"):(a.style("display","none"),this._isPublicTabShow||d.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){p.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);p.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var a=this._getPortalUrl(),a=w.getServerByUrl(a);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var b=!1;w.isArcGIScom(a)?(b=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=a,b=this.showOnlineItems?!1:!0);b&&(this.onlinePublicRaido.disabled=!0,d.setStyle(this.onlinePublicRaido,"display","none"),d.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(b.locale&&b.locale.slice(0,2)||"en").toLowerCase(),c=g.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
t.hitch(this,function(b){return b!==a})),d="";g.forEach(c,t.hitch(this,function(a){d+=" -owner:"+a+" "}));c=" ";this.portal&&(this.portal.user&&this.portal.user.orgId)&&(c=" orgid:"+this.portal.user.orgId+" ");c=c+this._itemTypeQueryString+" AND access:public "+d+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:c});this._filterPublicPortalQuery=this._getQuery({q:c,basicQ:c});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return t.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return w.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){this.own(s(this.publicPortalItemTable,"item-dom-clicked",t.hitch(this,this._onItemDomClicked)));this.own(s(this.publicOnlineItemTable,"item-dom-clicked",t.hitch(this,this._onItemDomClicked)));this.own(s(this.organizationItemTable,"item-dom-clicked",
t.hitch(this,this._onItemDomClicked)));this.own(s(this.groupItemTable,"item-dom-clicked",t.hitch(this,this._onItemDomClicked)));this.own(s(this.mycontentItemTable,"item-dom-clicked",t.hitch(this,this._onItemDomClicked)));var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||
(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},_initPublic:function(){this.own(s(this.portalPublicRaido,"click",t.hitch(this,this._onPublicRaidoClicked)));this.own(s(this.onlinePublicRaido,"click",t.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?
(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&t.trim(a))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):
this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(s(this.groupsSelect,"change",t.hitch(this,this._onGroupsSelectChange)));var a=
w.getServerByUrl(this._getPortalUrl());w.isArcGIScom(a);l.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&t.trim(a)){if(this._allOrganizationQuery){var b=this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&t.trim(a)){if(this._allMyContentQuery){var b=
this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(a){if(a=a&&t.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},
_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();c.getPortal(a).getUser().then(t.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();
a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+
" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();d.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){d.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();d.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=
a[b];d.create("option",{value:c.id,innerHTML:c.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){d.setStyle(this.groupsSection,"display","none");d.empty(this.groupsSelect);d.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();d.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?d.setStyle(this.groupsSection,
"top","15px"):d.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)d.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{d.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});
this.groupItemTable.set("portalUrl",b);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemDomClicked:function(a){var b=d.hasClass(a,"selected");m(".item-div.selected",this.domNode).removeClass("selected");b&&d.addClass(a,"selected");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=m(".item-div.selected",this.domNode);0<b.length&&(a=t.mixin({},b[0].item));return a}})})},"jimu/dijit/Search":function(){define(["dojo/_base/declare",
"dojo/_base/html","dojo/string","dijit/_WidgetBase","dijit/_TemplatedMixin"],function(q,e,a,f,k){return q([f,k],{baseClass:"jimu-search",declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
placeholder:"",onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&e.setAttr(this.inputSearch,"placeholder",this.placeholder)},doSearch:function(){if(this.onSearch)this.onSearch(a.trim(this.inputSearch.value))},_onKeyDown:function(a){13===(void 0!==a.keyCode?a.keyCode:a.which)&&this.doSearch();a.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d){return q([t,b,n],{templateString:g,selected:"",tabs:null,average:!1,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",_currentIndex:-1,postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(b){var d=r("td",this.tabTr);a.forEach(d,e.hitch(this,function(a,d){f.removeClass(a,"selected");a.label===b?(f.addClass(a,"selected"),a.style.borderLeft=
"1px solid #ccc",a.style.borderRight="1px solid #ccc",a.style.borderTop="2px solid #15a4fa",a.style.borderBottom="0",this._currentIndex=d):(a.style.borderLeft="0",a.style.borderRight="0",a.style.borderTop="0",a.style.borderBottom="1px solid #ccc")}));this.controlNode.removeChild(this.controlTable);f.place(this.controlTable,this.controlNode);this.viewStack.switchView(b);this.emit("tabChanged",b)},addTab:function(b){if(!this.average){var d=r("td:last-child",this.tabTr);0<d.length&&f.destroy(d[0])}0<
a.filter(this.tabs,function(a){return a.title===b.title}).length?console.error("tab title conflict: "+b.title):(this.tabs.push(b),this._createTab(b),this.average||(d=f.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),f.place(d,this.tabTr)))},removeTab:function(b){var d=-1;if(a.some(this.tabs,function(a,e){if(a.title===b)return d=e,!0})){var e=this.tabs.splice(d,1)[0],g=r("td",this.tabTr),k;a.some(g,
function(a){if(a.label===b)return k=a,!0})&&f.destroy(k);this.viewStack.removeView(e.content)}},showShelter:function(){f.setStyle(this.shelter,"display","block")},hideShelter:function(){f.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new d(null,this.containerNode);a.forEach(this.tabs,function(a){this._createTab(a)},this);if(this.average)this.controlTable.style.tableLayout=
"fixed";else{var b=f.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');f.place(b,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(a){var b=f.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');b.label=a.title||"";f.place(b,this.tabTr);var d=r(".tab-item-div",b)[0];d.innerHTML=b.label;d.label=b.label;
a.content.label=b.label;this.viewStack.addView(a.content);this.own(k(b,"click",e.hitch(this,this._onSelect,a.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p){return q([e,a,f,n],{templateString:k,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||
(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=s.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){b.setStyle(this.domNode,"display","block")},hide:function(){b.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=r.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),
m.getPortal(this.portalUrl).queryItems(this.query).then(r.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),r.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=r.mixin({},a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&
(this.filteredItemShelter.show(),m.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(r.hitch(this,function(a){this.domNode&&(this.filteredItemShelter.hide(),this.filteredQuery.start=a.nextStart,this._createItems(a,this.filteredItemsTbody),0===this._getItemCount(this.filteredItemsTbody)&&(b.setStyle(this.filteredItemsTableDiv,"display","none"),b.setStyle(this.searchNoneTipSection,"display","block")))}),r.hitch(this,function(a){console.error(a);this.domNode&&(this.filteredItemShelter.hide(),
0===this._getItemCount(this.filteredItemsTbody)&&(b.setStyle(this.filteredItemsTableDiv,"display","none"),b.setStyle(this.searchNoneTipSection,"display","block")))})))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){b.empty(this.allItemTbody)},clearFilteredItemsSection:function(){b.empty(this.filteredItemsTbody)},showAllItemsSection:function(){b.setStyle(this.allItemsSection,"display","block");b.setStyle(this.filteredItemsSection,"display",
"none")},showFilterItemsSection:function(){b.setStyle(this.allItemsSection,"display","none");b.setStyle(this.filteredItemsSection,"display","block");b.setStyle(this.filteredItemsTableDiv,"display","block");b.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return u.isScrollToBottom(a)},
_createItems:function(a,e){var g=a.results,f=t.map(this.types,r.hitch(this,function(a){return a.toLowerCase()})),g=t.filter(g,r.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=t.indexOf(f,a)}));if(0!==g.length){var h,k=d("td.empty",e),m;if(0<k.length){var p=Math.min(g.length,k.length),s=g.splice(0,p);for(m=0;m<p;m++){var n=k[m];h=this._createItem(s[m]);b.place(h,n);b.removeClass(n,"empty")}}if(0!==g.length){k=Math.ceil(g.length/2);for(m=0;m<k;m++){h=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");
b.place(h,e);p=d("td",h);for(s=0;s<p.length;s++)n=p[s],(h=g[2*m+s])?(h=this._createItem(h),b.place(h,n)):b.addClass(n,"empty")}}}},_getItemCount:function(a){return d(".item-div",a).length},_createItem:function(a){var e=b.toDom('\x3cdiv class\x3d"item-div"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
e.item=a;var g=d(".item-thumbnail",e)[0],f=d(".item-name",e)[0],h=d(".item-type-owner",e)[0],k=d(".item-date",e)[0],m=d(".item-details",e)[0],p=d(".none-thumbnail-tip",e)[0];if(!a.thumbnailUrl){var s=this._defaultThumbnail[a.type];s&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+s)}a.thumbnailUrl?b.setStyle(g,"backgroundImage","url("+a.thumbnailUrl+")"):p.innerHTML=this.nls.noneThumbnail;f.innerHTML=a.title;f.title=f.innerHTML;h.innerHTML=a.type+" by "+a.owner;h.title=h.innerHTML;g=new Date;g.setTime(a.modified);
k.innerHTML=g.toLocaleString();k.title=k.innerHTML;m.innerHTML=this.nls.moreDetails;m.href=a.detailsPageUrl||"#";return e},_onItemsTableClicked:function(a){var e=a.target||a.srcElement;a=null;b.hasClass(e,"item-thumbnail")?a=e.parentNode:b.hasClass(e,"none-thumbnail-tip")&&(a=e.parentNode.parentNode);a&&(e=b.hasClass(a,"selected"),d(".item-div.selected",this.domNode).removeClass("selected"),e?b.removeClass(a,"selected"):b.addClass(a,"selected"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=
null,b=d(".item-div.selected",this.domNode);0<b.length&&(a=r.mixin({},b[0].item));return a}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(q,e,a,f){return q(e,{baseClass:"jimu-loading-indicator",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&a.set(this.domNode,{display:"none"});a.set(this.domNode,{width:"100%",height:"100%"});
var e='\x3cimg class\x3d"jimu-loading" src\x3d"'+require.toUrl("jimu")+'/images/loading.gif"\x3e';f.place(e,this.domNode)},show:function(){this.domNode&&a.set(this.domNode,"display","block")},hide:function(){this.domNode&&a.set(this.domNode,"display","none")}})})},"dojox/form/Uploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/dom-attr dojo/dom-construct dojo/dom-form dijit dijit/form/Button ./uploader/_Base ./uploader/_HTML5 ./uploader/_IFrame ./uploader/_Flash dojo/i18n!./nls/Uploader dojo/text!./resources/Uploader.html".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v){return e("dojox.form.Uploader",[s,m,p,c,l],{uploadOnSelect:!1,tabIndex:0,multiple:!1,label:w.label,url:"",name:"uploadedfile",flashFieldName:"",force:"",uploadType:"",showInput:"",focusedClass:"dijitButtonHover",_nameIndex:0,templateString:v,baseClass:"dijitUploader "+m.prototype.baseClass,postMixInProperties:function(){this._inputs=[];this._cons=[];this.force=this.force.toLowerCase();this.supports("multiple")?this.uploadType="form"===this.force?"form":
"html5":this.uploadType="flash"===this.force?"flash":"iframe";this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);r.set(this.domNode,{overflow:"hidden",position:"relative"});this._buildDisplay();g.set(this.titleNode,"tabIndex",-1)},_buildDisplay:function(){this.showInput&&(this.displayInput=d.create("input",{"class":"dijitUploadDisplayInput",tabIndex:-1,autocomplete:"off",role:"presentation"},this.containerNode,this.showInput),this._attachPoints.push("displayInput"),this.connect(this,
"onChange",function(a){for(var b=0,c,d=[];c=a[b++];)c&&c.name&&d.push(c.name);this.displayInput.value=d.join(", ")}),this.connect(this,"reset",function(){this.displayInput.value=""}))},startup:function(){this._buildInitialized||(this._buildInitialized=!0,this._getButtonStyle(this.domNode),this._setButtonStyle(),this.inherited(arguments))},onChange:function(a){},onBegin:function(a){},onProgress:function(a){},onComplete:function(a){this.reset()},onCancel:function(){},onAbort:function(){},onError:function(a){},
upload:function(a){a=a||{};a.uploadType=this.uploadType;this.inherited(arguments)},submit:function(a){a=a?a.tagName?a:this.getForm():this.getForm();a=h.toObject(a);a.uploadType=this.uploadType;this.upload(a)},reset:function(){delete this._files;this._disconnectButton();f.forEach(this._inputs,d.destroy);this._inputs=[];this._nameIndex=0;this._createInput()},getFileList:function(){var a=[];this.supports("multiple")?f.forEach(this._files,function(b,c){a.push({index:c,name:b.name,size:b.size,type:b.type})},
this):f.forEach(this._inputs,function(b,c){b.value&&a.push({index:c,name:b.value.substring(b.value.lastIndexOf("\\")+1),size:0,type:b.value.substring(b.value.lastIndexOf(".")+1)})},this);return a},_getValueAttr:function(){return this.getFileList()},_setValueAttr:function(a){console.error("Uploader value is read only")},_setDisabledAttr:function(a){this.disabled!=a&&this.inputNode&&(this.inherited(arguments),r.set(this.inputNode,"display",a?"none":""))},_getButtonStyle:function(a){this.btnSize={w:r.get(a,
"width"),h:r.get(a,"height")}},_setButtonStyle:function(){this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput()},_getFileFieldName:function(){return this.supports("multiple")&&this.multiple?this.name+"s[]":this.name+(this.multiple?this._nameIndex:"")},_createInput:function(){this._inputs.length&&(r.set(this.inputNode,{top:"500px"}),this._disconnectButton(),this._nameIndex++);var a=this._getFileFieldName();this.focusNode=this.inputNode=
d.create("input",{type:"file",name:a,"aria-labelledby":this.id+"_label"},this.domNode,"first");this.supports("multiple")&&this.multiple&&g.set(this.inputNode,"multiple",!0);this._inputs.push(this.inputNode);r.set(this.inputNode,{position:"absolute",fontSize:this.inputNodeFontSize+"em",top:"-3px",right:"-3px",opacity:0});this._connectButton()},_connectButton:function(){this._cons.push(k.connect(this.inputNode,"change",this,function(a){this._files=this.inputNode.files;this.onChange(this.getFileList(a));
!this.supports("multiple")&&this.multiple&&this._createInput()}));-1<this.tabIndex&&(this.inputNode.tabIndex=this.tabIndex,this._cons.push(k.connect(this.inputNode,"focus",this,function(){t.add(this.domNode,this.focusedClass)})),this._cons.push(k.connect(this.inputNode,"blur",this,function(){t.remove(this.domNode,this.focusedClass)})))},_disconnectButton:function(){f.forEach(this._cons,k.disconnect);this._cons.splice(0,this._cons.length)}})})},"dojox/form/uploader/_Base":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/has dojo/_base/declare dojo/_base/event dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin".split(" "),
function(q,e,a,f,k,n,r,t,b,g){k.add("FormData",function(){return!!window.FormData});k.add("xhr-sendAsBinary",function(){var a=window.XMLHttpRequest&&new window.XMLHttpRequest;return a&&!!a.sendAsBinary});k.add("file-multiple",function(){return!!{"true":1,"false":1}[f.get(document.createElement("input",{type:"file"}),"multiple")]});return n("dojox.form.uploader._Base",[t,b,g],{getForm:function(){if(!this.form)for(var a=this.domNode;a&&a.tagName&&a!==document.body;){if("form"==a.tagName.toLowerCase()){this.form=
a;break}a=a.parentNode}return this.form},getUrl:function(){this.uploadUrl&&(this.url=this.uploadUrl);if(this.url)return this.url;this.getForm()&&(this.url=this.form.action);return this.url},connectForm:function(){this.url=this.getUrl();!this._fcon&&this.getForm()&&(this._fcon=!0,this.connect(this.form,"onsubmit",function(a){console.log("SUBMIT");r.stop(a);this.submit(this.form)}))},supports:function(a){switch(a){case "multiple":if("flash"==this.force||"iframe"==this.force)break;return k("file-multiple");
case "FormData":return k(a);case "sendAsBinary":return k("xhr-sendAsBinary")}return!1},getMimeType:function(){return"application/octet-stream"},getFileType:function(a){return a.substring(a.lastIndexOf(".")+1).toUpperCase()},convertBytes:function(a){var b=Math.round(1E5*(a/1024))/1E5,e=Math.round(1E5*(a/1048576))/1E5,g=Math.round(1E5*(a/1073741824))/1E5,f=a;1<b&&(f=b.toFixed(1)+" kb");1<e&&(f=e.toFixed(1)+" mb");1<g&&(f=g.toFixed(1)+" gb");return{kb:b,mb:e,gb:g,bytes:a,value:f}}})})},"dojox/form/uploader/_HTML5":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo"],function(q,e,a,f){return q("dojox.form.uploader._HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.connectForm();this.inherited(arguments);this.uploadOnSelect&&this.connect(this,"onChange",function(a){this.upload(a[0])})},_drop:function(a){f.stopEvent(a);this._files=a.dataTransfer.files;this.onChange(this.getFileList())},upload:function(a){this.onBegin(this.getFileList());
this.uploadWithFormData(a)},addDropTarget:function(a,e){e||(this.connect(a,"dragenter",f.stopEvent),this.connect(a,"dragover",f.stopEvent),this.connect(a,"dragleave",f.stopEvent));this.connect(a,"drop","_drop")},uploadWithFormData:function(e){if(this.getUrl()){var f=new FormData,r=this._getFileFieldName();a.forEach(this._files,function(a,e){f.append(r,a)},this);if(e){e.uploadType=this.uploadType;for(var q in e)f.append(q,e[q])}this.createXhr().send(f)}else console.error("No upload url found.",this)},
_xhrProgress:function(a){if(a.lengthComputable){var e={bytesLoaded:a.loaded,bytesTotal:a.total,type:a.type,timeStamp:a.timeStamp};"load"==a.type?(e.percent="100%",e.decimal=1):(e.decimal=a.loaded/a.total,e.percent=Math.ceil(100*(a.loaded/a.total))+"%");this.onProgress(e)}},createXhr:function(){var a=new XMLHttpRequest,f;a.upload.addEventListener("progress",e.hitch(this,"_xhrProgress"),!1);a.addEventListener("load",e.hitch(this,"_xhrProgress"),!1);a.addEventListener("error",e.hitch(this,function(a){this.onError(a);
clearInterval(f)}),!1);a.addEventListener("abort",e.hitch(this,function(a){this.onAbort(a);clearInterval(f)}),!1);a.onreadystatechange=e.hitch(this,function(){if(4===a.readyState){clearInterval(f);try{this.onComplete(JSON.parse(a.responseText.replace(/^\{\}&&/,"")))}catch(e){console.error("Error parsing server result:",e),console.error(a.responseText),this.onError("Error parsing server result:",e)}}});a.open("POST",this.getUrl());a.setRequestHeader("Accept","application/json");f=setInterval(e.hitch(this,
function(){}),250);return a}})})},"dojox/form/uploader/_IFrame":function(){define("dojo/query dojo/dom-construct dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-form dojo/request/iframe".split(" "),function(q,e,a,f,k,n,r){return a("dojox.form.uploader._IFrame",[],{postMixInProperties:function(){this.inherited(arguments);"iframe"===this.uploadType&&(this.uploadType="iframe",this.upload=this.uploadIFrame)},uploadIFrame:function(a){var b={},g;this.getForm();var d=this.getUrl(),f=this;a=
a||{};a.uploadType=this.uploadType;g=e.place('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e\x3c/form\x3e',this.domNode);k.forEach(this._inputs,function(a,d){""!==a.value&&(g.appendChild(a),b[a.name]=a.value)},this);if(a)for(nm in a)void 0===b[nm]&&e.create("input",{name:nm,value:a[nm],type:"hidden"},g);r.post(d,{form:g,handleAs:"json",content:a}).then(function(a){e.destroy(g);if(a.ERROR||a.error)f.onError(a);else f.onComplete(a)},function(a){console.error("error parsing server result",
a);e.destroy(g);f.onError(a)})}})})},"dojox/form/uploader/_Flash":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/array dojox/embed/Flash".split(" "),function(q,e,a,f,k,n,r,t,b,g){return k("dojox.form.uploader._Flash",[],{swfPath:n.uploaderPath||require.toUrl("dojox/form/resources/uploader.swf"),preventCache:!0,skipServerCheck:!0,serverTimeout:2E3,isDebug:!1,devMode:!1,deferredUploading:0,
postMixInProperties:function(){"flash"===this.uploadType&&(this._files=[],this._fileMap={},this._createInput=this._createFlashUploader,this.getFileList=this.getFlashFileList,this.reset=this.flashReset,this.upload=this.uploadFlash,this.fieldname="flashUploadFiles");this.inherited(arguments)},onReady:function(a){},onLoad:function(a){},onFileChange:function(a){},onFileProgress:function(a){},getFlashFileList:function(){return this._files},flashReset:function(){this.flashMovie.reset();this._files=[];this._fileMap=
{}},uploadFlash:function(a){this.onBegin(this.getFileList());a=a||{};a.returnType="F";a.uploadType=this.uploadType;console.log("flas upload",a);this.flashMovie.doUpload(a)},_change:function(a){this._files=this._files.concat(a);b.forEach(a,function(a){a.bytesLoaded=0;a.bytesTotal=a.size;this._fileMap[a.name+"_"+a.size]=a},this);this.onChange(this._files);this.onFileChange(a)},_complete:function(a){this._getCustomEvent().type="load";this.onComplete(a)},_progress:function(a){this._fileMap[a.name+"_"+
a.bytesTotal].bytesLoaded=a.bytesLoaded;var b=this._getCustomEvent();this.onFileProgress(a);this.onProgress(b)},_error:function(a){this.onError(a)},_onFlashBlur:function(a){},_getCustomEvent:function(){var a={bytesLoaded:0,bytesTotal:0,type:"progress",timeStamp:(new Date).getTime()},b;for(b in this._fileMap)a.bytesTotal+=this._fileMap[b].bytesTotal,a.bytesLoaded+=this._fileMap[b].bytesLoaded;a.decimal=a.bytesLoaded/a.bytesTotal;a.percent=Math.ceil(100*(a.bytesLoaded/a.bytesTotal))+"%";return a},_connectFlash:function(){this._subs=
[];this._cons=[];var a=t.hitch(this,function(a,b){this._subs.push(r.subscribe(this.id+a,this,b))});a("/filesSelected","_change");a("/filesUploaded","_complete");a("/filesProgress","_progress");a("/filesError","_error");a("/filesCanceled","onCancel");a("/stageBlur","_onFlashBlur");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&f.set(this.domNode,"tabIndex",this.tabIndex)},_createFlashUploader:function(){var b=this.btnSize.w,f=this.btnSize.h;
if(b){var k=this.getUrl();if(k){if(0>k.toLowerCase().indexOf("http")&&0!=k.indexOf("/")){var m=window.location.href.split("/");m.pop();m=m.join("/")+"/";k=m+k}}else console.warn("Warning: no uploadUrl provided.");this.inputNode=a.create("div",{className:"dojoxFlashNode"},this.domNode,"first");e.set(this.inputNode,{position:"absolute",top:"-2px",width:b+"px",height:f+"px",opacity:0});b={expressInstall:!0,path:(this.swfPath.uri||this.swfPath)+(this.preventCache?"?cb_"+(new Date).getTime():""),width:b,
height:f,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName||this.name+"Flash",uploadUrl:k,uploadOnSelect:this.uploadOnSelect,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.multiple,id:this.id,isDebug:this.isDebug,noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new g(b,this.inputNode);this.flashObject.onError=
t.hitch(function(a){console.error("Flash Error: "+a)});this.flashObject.onReady=t.hitch(this,function(){this.onReady(this)});this.flashObject.onLoad=t.hitch(this,function(a){this.flashMovie=a;this.flashReady=!0;this.onLoad(this)});this._connectFlash()}else setTimeout(dojo.hitch(this,function(){this._getButtonStyle(this.domNode);this._createFlashUploader()}),200)}})})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),
function(q,e,a,f,k,n,r,t,b){function g(a){a=q.delegate(s,a);if(!("path"in a))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),null;"id"in a||(a.id=u+m++);return a}var d,h,u="dojox-embed-flash-",m=0,s={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};k("ie")?(d=function(a){a=g(a);if(!a)return null;var d,e=a.path;if(a.vars){var f=[];for(d in a.vars)f.push(encodeURIComponent(d)+
"\x3d"+encodeURIComponent(a.vars[d]));a.params.FlashVars=f.join("\x26");delete a.vars}e='\x3cobject id\x3d"'+b.escape(String(a.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+b.escape(String(a.width))+'" height\x3d"'+b.escape(String(a.height))+'"'+(a.style?' style\x3d"'+b.escape(String(a.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+b.escape(String(e))+'" /\x3e';if(a.params)for(d in a.params)e+='\x3cparam name\x3d"'+b.escape(d)+'" value\x3d"'+b.escape(String(a.params[d]))+
'" /\x3e';return{id:a.id,markup:e+"\x3c/object\x3e"}},h=function(){for(var a=10,b=null;!b&&7<a;)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a--)}catch(d){}return b?(a=b.GetVariable("$version").split(" ")[1].split(","),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}(),e.addOnWindowUnload(function(){console.warn("***************UNLOAD");var a=function(){};f("object").reverse().style("display","none").forEach(function(b){for(var d in b)if("FlashVars"!=
d&&"function"==typeof b[d])try{b[d]=a}catch(e){}})})):(d=function(a){a=g(a);if(!a)return null;var d,e=a.path;if(a.vars){var f=[];for(d in a.vars)f.push(encodeURIComponent(d)+"\x3d"+encodeURIComponent(a.vars[d]));a.params.flashVars=f.join("\x26");delete a.vars}e='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+b.escape(String(e))+'" id\x3d"'+b.escape(String(a.id))+'" width\x3d"'+b.escape(String(a.width))+'" height\x3d"'+b.escape(String(a.height))+'"'+(a.style?' style\x3d"'+b.escape(String(a.style))+
'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(a.params)for(d in a.params)e+=" "+b.escape(d)+'\x3d"'+b.escape(String(a.params[d]))+'"';return{id:a.id,markup:e+" /\x3e"}},h=function(){var a=navigator.plugins["Shockwave Flash"];return a&&a.description?(a=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,
rev:0}}());var p=function(a,b){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");this.available=h.major;this.minimumVersion=a.minimumVersion||9;this.domNode=this.movie=this.id=null;b&&(b=n.byId(b));setTimeout(q.hitch(this,function(){if(a.expressInstall||this.available&&this.available>=this.minimumVersion)if(a&&b)this.init(a,b);else this.onError("embed.Flash was not provided with the proper arguments.");
else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),100)};q.extend(p,{onReady:function(a){},onLoad:function(a){},onError:function(a){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(a,b){this.destroy();b=n.byId(b||this.domNode);if(!b)throw Error("dojox.embed.Flash: no domNode reference has been passed.");
var d=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;p.initialized&&(this.id=p.place(a,b),this.domNode=b,setTimeout(q.hitch(this,function(){this.movie=this.byId(this.id,a.doc);this.onReady(this.movie);this._poller=setInterval(q.hitch(this,function(){try{d=this.movie.PercentLoaded()}catch(a){console.warn("this.movie.PercentLoaded() failed",a,this.movie)}if(100==d)this._onload();else if(0==d&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");
}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(a){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var a=q.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),b;for(b in this)a[b]||delete this[b];this._poller?r(this,"Load",this,"_destroy"):this._destroy()}},byId:function(a,b){b=b||document;return b.embeds[a]?b.embeds[a]:b[a]?b[a]:window[a]?window[a]:document[a]?document[a]:null}});q.mixin(p,{minSupported:8,available:h.major,
supported:h.major>=h.required,minimumRequired:h.required,version:h,initialized:!1,onInitialize:function(){p.initialized=!0},__ie_markup__:function(a){return d(a)},proxy:function(b,d){a.forEach(d instanceof Array?d:[d],function(b){this[b]=q.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+b+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+a.map(arguments,function(a){return __flash__toXML(a)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,
arguments||[])})},b)}});p.place=function(a,b){var e=d(a);b=n.byId(b);b||(b=t.doc.createElement("div"),b.id=e.id+"-container",t.body().appendChild(b));return e?(b.innerHTML=e.markup,e.id):null};p.onInitialize();q.setObject("dojox.embed.Flash",p);return p})},"builder/plugins/attribute-config/_build-generate_module":function(){define(["builder/plugins/attribute-config/Plugin","dojo/text!builder/plugins/attribute-config/Plugin.html","dojo/text!builder/plugins/attribute-config/css/style.css","dojo/i18n!builder/plugins/attribute-config/nls/strings"],
function(){})},"builder/plugins/attribute-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/on dojo/query dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/dom-style dojo/_base/array builder/portalUtils builder/utils builder/BasePlugin jimu/dijit/CheckBox jimu/dijit/ImageChooser dojo/NodeList-dom".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){return q([u,r],{templateString:t,appConfig:null,selectLinkNode:null,selectProxyRuleNode:null,
initedLinks:!1,initedProxy:!1,_currentPortalUrl:null,showProxySetting:!1,showAlwaysUseProxy:!1,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(f.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)));this.own(f.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.useProxySetting=new m({label:this.nls.useProxySetting,checked:!1},this.useProxySetting);this.alwaysUseProxy=new m({label:this.nls.alwaysUseProxyLabel,
checked:!1},this.alwaysUseProxy);this._bindEvents()},startup:function(){this.inherited(arguments);this._keepOrder();a.addClass(this.imageChooser.domNode,"no-logo")},_bindEvents:function(){this.own(k(this.titleNode,"change",e.hitch(this,this.onTitleChange)));this.own(k(this.subtitleNode,"change",e.hitch(this,this.onSubtitleChange)));this.own(k(this.imageChooser,"imageChange",e.hitch(this,"onLogoChange")));this.own(k(this.useProxySetting,"click",e.hitch(this,this._onUseProxySettingChange)));this.own(k(this.alwaysUseProxy,
"click",e.hitch(this,this._onAlwaysUseProxyChange)));this.own(k(this.proxyUrlNode,"change",e.hitch(this,this._onProxyUrlChange)));this.own(k(this.proxyUrlNode,"blur",e.hitch(this,this._onProxyUrlBlur)));this.own(k(this.appIdNode,"change",e.hitch(this,this._onAppIdChange)));this.own(k(this.domNode,"click",e.hitch(this,function(){n(".header-button",this.domNode).removeClass("highlight-button");this.selectLinkNode&&(a.removeClass(this.selectLinkNode,"selected-item"),this.selectLinkNode=null);this.selectProxyRuleNode&&
(a.removeClass(this.selectProxyRuleNode,"selected-item"),this.selectProxyRuleNode=null)})))},init:function(a){this.appConfig=a||{};this.initHeader(a);this.initedLinks||(this.initLinks(a),this.initedLinks=!0);this.initedProxy||(this.initProxy(a),this.initedProxy=!0);this._currentPortalUrl!==a.portalUrl&&(this.initAppId(a),this._currentPortalUrl=a.portalUrl)},_onAppConfigLoaded:function(a){this._setAppConfig(a)},_onAppConfigChanged:function(a){this._setAppConfig(a)},_setAppConfig:function(a){this.init(a)},
initHeader:function(d){var e=d.logo;e&&(e&&(!e.startWith("/")&&!e.startWith("http")&&!e.startWith("data"))&&(e=window.isXT?h.getAppPathById(window.appInfo.appId)+e:window.appInfo.appPath+e),a.setAttr(this.logoNode,"src",e),b.set(this.noLogoNode,"display","none"),b.set(this.logoNode,"display","block"));d.title&&a.setAttr(this.titleNode,"value",d.title);d.subtitle&&a.setAttr(this.subtitleNode,"value",d.subtitle)},onLogoChange:function(d){a.setAttr(this.logoNode,"src",d);b.set(this.noLogoNode,"display",
"none");b.set(this.logoNode,"display","block");f.publish("appAttributeChanged",{logo:d})},onTitleChange:function(a){f.publish("appAttributeChanged",{title:a.target.value})},onSubtitleChange:function(a){f.publish("appAttributeChanged",{subtitle:a.target.value})},initLinks:function(b){a.empty(this.linksListNode);b.links&&b.links.forEach(e.hitch(this,function(a){this.createLinkNode(a)}))},initProxy:function(b){if(b=b.httpProxy)this.useProxySetting.setValue(b.useProxy),this.showProxySetting=!!b.useProxy,
this._onUseProxySettingChange(),this.alwaysUseProxy.setValue(b.alwaysUseProxy),this.showAlwaysUseProxy=!!b.alwaysUseProxy,this._onAlwaysUseProxyChange(),b.url&&a.setAttr(this.proxyUrlNode,"value",b.url),b.rules&&(a.empty(this.proxyRulesListNode),g.forEach(b.rules,e.hitch(this,function(a){this.createProxyRuleNode(a)})))},initAppId:function(b){d.getPortal(b.portalUrl).loadSelfInfo().then(e.hitch(this,function(d){d.supportsOAuth?(a.setStyle(this.appIdSection,"display","none"),a.setAttr(this.appIdNode,
"value",b.appId)):a.setStyle(this.appIdSection,"display","none")}),e.hitch(this,function(a){this.shelter.hide();console.error(a)}))},getLinks:function(){var a=[];n(".links-list .list-item",this.domNode).forEach(e.hitch(this,function(b){var c=n(".first input",b).attr("value")[0];b=n(".second input",b).attr("value")[0];c&&a.push({label:c,url:b})}));return a},getProxy:function(){var b=[],d=a.getAttr(this.proxyUrlNode,"value");n(".proxy-rule-list .list-item",this.domNode).forEach(e.hitch(this,function(a){var d=
n(".first input",a).attr("value")[0];a=n(".second input",a).attr("value")[0];d&&b.push({urlPrefix:d,proxyUrl:a})}));return{useProxy:this.useProxySetting.getValue(),alwaysUseProxy:this.alwaysUseProxy.getValue(),url:d,rules:b}},_bindNodeEvents:function(b,d,c,g,h,m){this.own(k(b,"click",e.hitch(this,function(c){n(".header-button",this.domNode).addClass("highlight-button");"links"===m?(this.selectLinkNode&&a.removeClass(this.selectLinkNode,"selected-item"),a.addClass(b,"selected-item"),this.selectLinkNode=
b):"proxyRules"===m&&(this.selectProxyRuleNode&&a.removeClass(this.selectProxyRuleNode,"selected-item"),a.addClass(b,"selected-item"),this.selectProxyRuleNode=b);c.stopPropagation()})));this.own(k(d,"dblclick",e.hitch(this,function(){a.setStyle(d,"display","none");a.setStyle(c,"display","block");c.focus();c.select()})));this.own(k(g,"dblclick",e.hitch(this,function(){a.setStyle(g,"display","none");a.setStyle(h,"display","block");h.focus();h.select()})));this.own(k(h,"focus",function(a){a.target.value||
(a.target.value="http://")}));this.own(k(c,"blur",e.hitch(this,function(b){a.setAttr(d,{innerHTML:b.target.value||d.innerHTML,style:{display:"block"}});a.setStyle(c,"display","none");"links"===m?f.publish("appAttributeChanged",{links:this.getLinks()}):"proxyRules"===m&&this._publishProxy()})));this.own(k(h,"blur",e.hitch(this,function(b){a.setAttr(g,{innerHTML:b.target.value||g.innerHTML,style:{display:"block"}});a.setStyle(h,"display","none");"links"===m?(b=this._formatLinkValue(b.target.value),
a.setAttr(g,"innerHTML",b),a.setAttr(h,"value",b),f.publish("appAttributeChanged",{links:this.getLinks()})):"proxyRules"===m&&this._publishProxy()})))},_formatLinkValue:function(a){var b="";return b=/^http(s?):\/\//.test(a)?a:/^\/\//.test(a)?"http:"+a:"http://"+a},_createListItem:function(b,d,c,e,g){var f=a.create("div",{"class":"list-item"}),h=a.create("div",{"class":"first jimu-float-leading"},f);c=a.create("div",{"class":"mask",innerHTML:d||c,title:c},h);var h=a.create("input",{style:{display:"none"}},
h),k=a.create("div",{"class":"second jimu-float-leading"},f);g=a.create("div",{"class":"mask",innerHTML:e||g,title:g},k);k=a.create("input",{style:{display:"none"}},k);a.setAttr(h,"value",d);a.setAttr(k,"value",e);this._bindNodeEvents(f,c,h,g,k,b);d||this.focusNewItem(f,c,h,b);return f},focusNewItem:function(b,d,c,e){"links"===e?(this.selectLinkNode&&a.removeClass(this.selectLinkNode,"selected-item"),a.addClass(b,"selected-item"),this.selectLinkNode=b):"proxyRules"===e&&(this.selectProxyRuleNode&&
a.removeClass(this.selectProxyRuleNode,"selected-item"),a.addClass(b,"selected-item"),this.selectProxyRuleNode=b);a.setStyle(d,"display","none");a.setStyle(c,"display","block");c.value=d.innerHTML;setTimeout(function(){c.focus();c.select()},0)},createLinkNode:function(b){b=this._createListItem("links",b.label,this.nls.labelPlaceholder,b.url,this.nls.urlPlaceholder);a.place(b,this.linksListNode)},createProxyRuleNode:function(b){b=this._createListItem("proxyRules",b.urlPrefix,this.nls.prefixPlaceholder,
b.proxyUrl,this.nls.proxyUrlPlaceholder);a.place(b,this.proxyRulesListNode)},_keepOrder:function(){var b=a.getMarginBox(this.headerSection),d=a.getMarginBox(this.linksSection),c=a.getMarginBox(this.appIdSection),e=a.getMarginBox(this.useProxySection),b=b.h+d.h+c.h+e.h,d=a.getMarginBox(this.domNode).h;b>d&&a.setStyle(this.domNode,"paddingRight","10px")},onAddLinkClick:function(a){a.stopPropagation();4!==n(".links-list .list-item",this.domNode).length&&(this.createLinkNode({label:"",url:""}),this._keepOrder())},
_onEditItemClick:function(b){var d=n(".first .mask",b)[0];b=n(".first input",b)[0];a.setStyle(d,"display","none");a.setStyle(b,"display","block");b.focus();b.select()},onEditLinkClick:function(){this.selectLinkNode&&this._onEditItemClick(this.selectLinkNode)},onDeleteLinkClick:function(){this.selectLinkNode&&(a.destroy(this.selectLinkNode),f.publish("appAttributeChanged",{links:this.getLinks()}))},onAddProxyRuleClick:function(a){this.createProxyRuleNode({urlPrefix:"",proxyUrl:""});this._keepOrder();
a.stopPropagation()},onEditProxyRuleClick:function(){this.selectProxyRuleNode&&this._onEditItemClick(this.selectProxyRuleNode)},onDeleteProxyRuleClick:function(){this.selectProxyRuleNode&&(a.destroy(this.selectProxyRuleNode),f.publish("appAttributeChanged",{httpProxy:this.getProxy()}))},_onUseProxySettingChange:function(){this.useProxySetting.checked?a.setStyle(this.proxySection,"display","block"):a.setStyle(this.proxySection,"display","none");this.showProxySetting!==this.useProxySetting.checked&&
(this._publishProxy(),this.showProxySetting=this.useProxySetting.checked)},_onAlwaysUseProxyChange:function(){this.showAlwaysUseProxy!==this.alwaysUseProxy.checked&&(this._publishProxy(),this.showAlwaysUseProxy=this.alwaysUseProxy.checked)},_onProxyUrlChange:function(){this._publishProxy()},_onProxyUrlBlur:function(){this.proxyUrlNode.value?a.removeClass(this.proxyUrlNode,"error-status"):a.addClass(this.proxyUrlNode,"error-status")},_onAppIdChange:function(){f.publish("appAttributeChanged",{appId:this.appIdNode.value})},
_publishProxy:function(){f.publish("appAttributeChanged",{httpProxy:this.getProxy()})}})})},"jimu/dijit/CheckBox":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","dojo/_base/html","dojo/on"],function(q,e,a,f,k){return q(e,{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,status:!0,postCreate:function(){this.checkNode=f.create("div",{"class":"checkbox jimu-float-leading"},this.domNode);this.label&&(this.labelNode=f.create("div",{"class":"label jimu-float-leading",
innerHTML:this.label},this.domNode));this.checked&&f.addClass(this.checkNode,"checked");this.own(k(this.checkNode,"click",a.hitch(this,function(){this.status&&(this.checked?this.uncheck():this.check())})));this.label&&this.own(k(this.labelNode,"click",a.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})))},setValue:function(a){this.status&&(!0===a?this.check():this.uncheck())},getValue:function(){return this.checked},setStatus:function(a){this.status=a;this.labelNode&&
(a?f.setStyle(this.labelNode,"color","#000000"):f.setStyle(this.labelNode,"color","#818181"))},check:function(){this.status&&(this.checked=!0,f.addClass(this.checkNode,"checked"),this.onStateChange())},uncheck:function(a){if(this.status&&(this.checked=!1,f.removeClass(this.checkNode,"checked"),!a))this.onStateChange()},onStateChange:function(){if(this.onChange&&a.isFunction(this.onChange))this.onChange(this.checked)}})})},"jimu/dijit/ImageChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff esri/lang ../utils jimu/tokenUtils jimu/dijit/Message".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h){function u(a,b){a=a||"";for(var c=0,d=[{test:window.File&&window.FileReader&&window.FileList&&window.Blob||!g.file.isEnabledFlash(),failure:[a+"libs/polyfills/fileAPI/FileAPI.js"],callback:function(){c++;c===d.length&&b()}}],e=0;e<d.length;e++)testLoad(d[e])}var m="unload";return q([e,a],{templateString:r,declaredClass:"jimu.dijit.ImageChooser",displayImg:null,displayCss:null,showSelfImg:!1,selfImg:null,postMixInProperties:function(){this.inherited(arguments);this.nls=
window.jimuNls.imageChooser;this.nls.readError=this.nls.readError||"Failed to read the file."},postCreate:function(){this._initial();if(!g.file.supportHTML5()&&!t("safari")&&g.file.isEnabledFlash())if("unload"===m){var a=d.isInBuilderWindow()?"stemapp/":"";window.FileAPI={debug:!1,flash:!0,staticPath:a+"libs/polyfills/fileAPI/",flashUrl:a+"libs/polyfills/fileAPI/FileAPI.flash.swf",flashImageUrl:a+"libs/polyfills/fileAPI/FileAPI.flash.image.swf"};u(a,f.hitch(this,function(){k.setStyle(this.mask,"zIndex",
1);m="loaded"}));m="loading"}else k.setStyle(this.mask,"zIndex",1)},_initial:function(){this._setupPosition();this._porcessMaskClick();this._setupFileInput();this._processTip()},_porcessMaskClick:function(){k.setStyle(this.mask,{position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:10,background:"#000",cursor:"pointer"});this.own(n(this.mask,"click",f.hitch(this,function(a){a.stopPropagation();if(t("safari")&&7>t("safari"))new h({message:this.nls.unsupportReaderAPI});else{if(!g.file.supportHTML5()){if(!g.file.isEnabledFlash()){a=
k.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,target:"_blank"});new h({message:a});return}if(!g.file.supportFileAPI()){new h({message:this.nls.unsupportReaderAPI});return}}this.fileInput.click()}})))},_processTip:function(){var a=b.substitute({width:this.goldenWidth||40,height:this.goldenHeight||40},this.nls.toolTip);k.setAttr(this.domNode,"title",a)},_setupPosition:function(){this.displayClass&&k.addClass(this.domNode,this.displayCss);k.setStyle(this.domNode,
{opacity:0,visibility:"visible","float":"left",zIndex:9999,overflow:"hidden",position:"absolute"});k.setStyle(this.fileInput,{width:"100%",height:"100%",position:"absolute",left:0,top:0,zIndex:9})},_setupFileInput:function(){var a=9>t("ie")?23552:1048576;this.own(n(this.fileInput,"change",f.hitch(this,function(b){g.file.readFile(b,"image/*",a,f.hitch(this,function(b,d,e){b?(e=this.nls[b.errCode],"exceed"===b.errCode&&(e=e.replace("1024",a/1024)),new h({message:e})):(this.onImageChange(e),this.displayImg&&
k.setAttr(this.displayImg,"src",e),this.showSelfImg&&(this.selfImg?k.setAttr(this.selfImg,"src",e):(b=k.getContentBox(this.domNode),this.selfImg=k.create("img",{src:e,style:{position:"absolute",top:0,bottom:0,left:0,right:0,width:b.w+"px",height:b.h+"px",zIndex:8}},this.domNode))))}))})))},onImageChange:function(a){this.imageData=a}})})},"builder/plugins/creation-entry/_build-generate_module":function(){define(["builder/plugins/creation-entry/Plugin","dojo/text!builder/plugins/creation-entry/Plugin.html",
"dojo/text!builder/plugins/creation-entry/css/style.css","dojo/i18n!builder/plugins/creation-entry/nls/strings"],function(){})},"builder/plugins/creation-entry/Plugin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dojo/keys builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/query dojo/on dojo/dom-style dojo/dom-class dojo/_base/lang dojo/promise/all jimu/dijit/Message jimu/dijit/Popup builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter builder/serviceUtils builder/dijit/ItemInfo".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x){return q([n,r],{templateString:t,baseClass:"plugin-creation-app",createFromId:null,appType:null,_appBuilderSettings:null,_configureSettings:null,_stemappExtensions:null,webmap:null,postMixInProperties:function(){this.inherited(arguments);this.nls=u.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments)},popupDlg:function(b,c,d){this.createFromId=c;this.appConfig=d;this._stemappExtensions=this.pluginManager.getExtensions("startup.stemapps");
this._stemappExtensions.sort(function(a,b){return a.parameters.index-b.parameters.index});c=this.pluginManager.getStemappInfo(this._stemappExtensions[0].parameters.appType);this._createAppNode(c);c=a.create("div",{"class":"app-image-div jimu-float-leading",style:"width:160px;height:120px;margin:0 10px;background-image: url("+this.folderUrl+"css/images/comingsoon.png); cursor: not-allowed"});a.place(c,this.divAppTypes);this._initDlgPage().then(u.hitch(this,function(){new p({content:this,container:"main-page",
titleLabel:b||this.nls.appCreateTitle,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,key:k.ENTER,onClick:u.hitch(this,this._onNextClick)},{label:this.nls.cancel,key:k.ESCAPE,onClick:u.hitch(this,this._onCancelClick)}]})}))},createNewApp:function(a){var b=new f;v.createApp(a).then(u.hitch(this,function(c){if(c.success){var d=u.clone(a);d.id=c.newAppId;this.pluginManager.getPluginByName("startup").switchToAppConfig(d);b.resolve();a.sharing&&a.webmap&&this._shareAppWithWebmap(c.newAppId,a.folderId,
a.webmap)}else new s({message:c.message}),b.reject()}),u.hitch(this,function(a){new s({message:a.message});b.reject(a)}));return b},_createAppNode:function(c){var d=a.create("div",{"class":"app-image-div jimu-float-leading",style:"width:160px;height:120px;margin:0 10px;"});a.place(d,this.divAppTypes);d._appPath=c.appPath;d._appType=c.appType;a.setStyle(d,"backgroundImage","url("+c.appPath+"images/icon.png)");this.own(g(d,"click",u.hitch(this,function(){if(this.selectedApp.appType!==c.appType){var a=
b(".app-image-div",this.divAppTypes);e.forEach(a,function(a){this._unselectedApp(a)},this);this._selectedApp(d);this.selectedApp=c}})))},_selectedApp:function(b){h.add(b,"app-image-div-down");a.setStyle(b,"backgroundImage","url("+b._appPath+"images/selected_icon.png)")},_unselectedApp:function(a){h.remove(a,"app-image-div-down")},_initDlgPage:function(){window.isXT?this.createFromId&&d.set(this.divAppTypes,"display","none"):d.set(this.divAppTypes,"display","none");var a=this._getInitAppInfo();a.then(u.hitch(this,
function(c){window.isXT?(c.tags=void 0,c.folderId=void 0,c.sharing=void 0):this.createFromId&&(c.sharing=void 0);this.itemInfoDijit=new x({itemInfo:c});this.itemInfoDijit.placeAt(this.itemInfoBox);var d=b(".app-image-div",this.divAppTypes);e.forEach(d,function(a){this._unselectedApp(a);c.appType===a._appType&&this._selectedApp(a)},this);this.selectedApp=c;a.resolve()}),u.hitch(this,function(){a.resolve()}));return a},_saveAs:function(a){var b=new f;v.duplicateApp(a,this.appConfig).then(u.hitch(this,
function(c){if(c.success){var d=u.clone(a);d.id=c.newAppId;d.name=c.newName;window.isXT?v.saveApp(d.id,this.appConfig.getCleanConfig()).then(u.hitch(this,function(){this.close();this.pluginManager.getPluginByName("startup").switchToAppConfig(d);b.resolve()}),u.hitch(this,function(){this.close();this.pluginManager.getPluginByName("startup").switchToAppConfig(d);b.resolve()})):(this.close(),this.pluginManager.getPluginByName("startup").switchToAppConfig(d),b.resolve())}else console.error("APP Save As failed!"),
new s({message:this.nls.saveAsFaied}),b.reject()}),u.hitch(this,function(a){console.error("APP Save As failed!"+a);new s({message:this.nls.saveAsFaied});b.reject()}));return b},_onCancelClick:function(){this.close()},_onNextClick:function(){var a=this._getAppInfo().name,b=this.pluginManager.getPluginByName("app-list");if(a){var a=this._getAppInfo(),c=new w;c.placeAt(this.popup.domNode);c.startup();this.createFromId?this._saveAs(a).then(u.hitch(this,function(){b&&window.isXT&&b.refresh();c.destroy()}),
function(){c.destroy()}):this.createNewApp(a).then(u.hitch(this,function(){b&&window.isXT&&b.refresh();this.close();c.destroy()}),function(){c.destroy()})}else new s({message:this.nls.noAppName})},close:function(){this.popup?this.popup.close():this.destroy()},_getInitAppInfo:function(){var a=new f,b=this.getDefaultAppInfo();window.isXT?this.createFromId?v.getAppInfo(this.createFromId).then(u.hitch(this,function(c){b.name=c.name+this.nls._copy;b.description=c.description;b.appType=c.appType;b.appPath=
c.stemappPath;a.resolve(b)}),u.hitch(this,function(b){console.error(this.nls.saveAsFaied,b);a.reject()})):a.resolve(b):this.createFromId?c.getPortal(l.getPortalUrlFromLocation()).getItemById(this.createFromId).then(u.hitch(this,function(c){b.name=c.title+this.nls._copy;b.tags=c.tags;b.description=c.snippet;a.resolve(b)}),u.hitch(this,function(b){console.error(this.nls.saveAsFaied,b);a.reject()})):a.resolve(b);return a},_getAppInfo:function(){if(this.itemInfoDijit){var a=this.itemInfoDijit.getProperties();
a.appType=this.selectedApp.appType;a.appPath=this.selectedApp.appPath;a.webmap=this.webmap;a.createFromId=this.createFromId;a.isPredefined=!0;return a}return this.getDefaultAppInfo()},getDefaultAppInfo:function(){var a=this.pluginManager.getStemappInfo(this._stemappExtensions[0].parameters.appType);return{name:"",description:"",tags:["AppBuilder App"],folderId:"",sharing:!1,appType:a.appType,appPath:a.appPath,webmap:null,createFromId:null,creator:null}},_shareAppWithWebmap:function(a,b,d){var e=c.getPortal(l.getPortalUrlFromLocation()),
g=new f,h=new f,k=new f,p=new f;e.getUser().then(u.hitch(this,function(a){g.resolve(a)}),u.hitch(this,function(a){new s({message:this.nls.createAppUrlError});console.error(a.message);g.reject()}));e.getItemById(d).then(u.hitch(this,function(a){h.resolve(a)}),u.hitch(this,function(a){new s({message:this.nls.createAppUrlError});console.error(a.message);h.reject(a)}));m({user:g,userItem:k}).then(u.hitch(this,function(c){var d={};switch(c.userItem.sharing.access){case "public":d.everyone=!0;d.groups=
c.userItem.sharing.groups.toString();break;case "account":case "org":d.org=!0;d.groups=c.userItem.sharing.groups.toString();break;case "shared":d.groups=c.userItem.sharing.groups.toString()}c.user.shareItem(d,a,b).then(u.hitch(this,function(a){p.resolve(a)}),u.hitch(this,function(a){new s({message:this.nls.createAppUrlError});console.error(a.message);p.reject()}))}));m({user:g,webmapItem:h}).then(u.hitch(this,function(c){if(c.webmapItem.owner===c.user.username)c.user.getItemById(d,c.webmapItem.ownerFolder).then(u.hitch(this,
function(a){k.resolve(a)}),u.hitch(this,function(a){new s({message:this.nls.createAppUrlError});console.error(a.message);k.reject(a)}));else{var e={};switch(c.webmapItem.access){case "public":e.everyone=!0;break;case "account":case "org":e.org=!0}c.user.shareItem(e,a,b).then(u.hitch(this,function(a){p.resolve(a)}),u.hitch(this,function(a){new s({message:this.nls.createAppUrlError});console.error(a.message);p.reject()}))}}))}})})},"builder/dijit/ItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/ItemInfo.html dojo/dom-style dojo/_base/lang dojo/promise/all builder/portalUtils jimu/portalUrlUtils ./Tags dijit/form/SimpleTextarea dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s){return q([f,k,n],{templateString:t,baseClass:"dijit-item-info",postMixInProperties:function(){this.inherited(arguments);this.nls=g.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.tags.nls=this.nls;this._init(this.itemInfo)},_init:function(e){this.appName.focus();void 0===e.tags&&b.set(this.tagsTr,"display","none");void 0===e.folderId&&b.set(this.folderTr,"display","none");void 0===e.sharing&&b.set(this.sharingTr,"display","none");
void 0!==e.tags||void 0!==e.folder?h.getPortal(u.getStandardPortalUrl(window.portalUrl)).getUser().then(g.hitch(this,function(b){var f=[];this.user=b;if(void 0!==e.folderId)f.push(this._initFolder(b));else{var h=new a;h.resolve();f.push(h)}void 0!==e.tags?f.push(r.byId("publish-webmap-tags").loadTags(b)):(b=new a,b.resolve(),f.push(b));d(f).then(g.hitch(this,function(){this.setProperties(e)}),g.hitch(this,function(a){this.setProperties(e);console.error(a.message||a)}))}),g.hitch(this,function(a){this.setProperties(e);
console.error(a.message||a)})):this.setProperties(e)},_initFolder:function(b){var c=new a;b.getContent().then(g.hitch(this,function(a){var d=[{label:b.username,value:""}],d=d.concat(e.map(a.folders,g.hitch(this,function(a){return{label:a.title,value:a.id}})));r.byId("publish-webmap-folder").set("options",d);r.byId("publish-webmap-folder").set("value","");c.resolve()}),function(a){console.error("get userContent error!",a.message);c.reject()});return c},setProperties:function(a){r.byId("publish-webmap-name").set("value",
a.name);r.byId("publish-webmap-tags").set("tags",a.tags||[]);r.byId("publish-webmap-summary").set("value",a.description);r.byId("publish-webmap-folder").set("value",a.folderId);r.byId("publish-webmap-sharing").set("checked",a.sharing)},getProperties:function(){return{name:r.byId("publish-webmap-name").get("value"),tags:r.byId("publish-webmap-tags").get("tags"),description:r.byId("publish-webmap-summary").get("value"),folderId:r.byId("publish-webmap-folder").get("value"),sharing:r.byId("publish-webmap-sharing").get("checked")}}})})},
"dijit/dijit":function(){define("./main ./_base dojo/parser ./_Widget ./_TemplatedMixin ./_Container ./layout/_LayoutWidget ./form/_FormWidget ./form/_FormValueWidget".split(" "),function(q){return q})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),function(q){return q._base})},"dijit/WidgetSet":function(){define(["dojo/_base/array","dojo/_base/declare",
"dojo/_base/kernel","./registry"],function(q,e,a,f){var k=e("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(a){if(this._hash[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");this._hash[a.id]=a;this.length++},remove:function(a){this._hash[a]&&(delete this._hash[a],this.length--)},forEach:function(e,f){f=f||a.global;var k=0,b;for(b in this._hash)e.call(f,this._hash[b],k++,this._hash);return this},filter:function(e,
f){f=f||a.global;var q=new k,b=0,g;for(g in this._hash){var d=this._hash[g];e.call(f,d,b++,this._hash)&&q.add(d)}return q},byId:function(a){return this._hash[a]},byClass:function(a){var e=new k,f,b;for(f in this._hash)b=this._hash[f],b.declaredClass==a&&e.add(b);return e},toArray:function(){var a=[],e;for(e in this._hash)a.push(this._hash[e]);return a},map:function(a,e){return q.map(this.toArray(),a,e)},every:function(e,f){f=f||a.global;var k=0,b;for(b in this._hash)if(!e.call(f,this._hash[b],k++,
this._hash))return!1;return!0},some:function(e,f){f=f||a.global;var k=0,b;for(b in this._hash)if(e.call(f,this._hash[b],k++,this._hash))return!0;return!1}});q.forEach("forEach filter byClass map every some".split(" "),function(a){f[a]=k.prototype[a]});return k})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),function(q,e,a,f,k,n,r,t){n.focus=function(a){if(a){var e="node"in a?a.node:a,d=a.bookmark;
a=a.openedForWindow;var f=d?d.isCollapsed:!1;if(e){var r="iframe"==e.tagName.toLowerCase()?e.contentWindow:e;if(r&&r.focus)try{r.focus()}catch(m){}n._onFocusNode(e)}if(d&&k.withGlobal(a||k.global,t.isCollapsed)&&!f){a&&a.focus();try{k.withGlobal(a||k.global,t.moveToBookmark,null,[d])}catch(s){}}}};n.watch("curNode",function(a,e,d){t._curFocus=d;t._prevFocus=e;d&&f.publish("focusNode",d)});n.watch("activeStack",function(a,e,d){t._activeStack=d});n.on("widget-blur",function(a,e){f.publish("widgetBlur",
a,e)});n.on("widget-focus",function(a,e){f.publish("widgetFocus",a,e)});a.mixin(t,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return t.getBookmark().isCollapsed},getBookmark:function(){return(k.global==window?r:new r.SelectionManager(k.global)).getBookmark()},moveToBookmark:function(a){return(k.global==window?r:new r.SelectionManager(k.global)).moveToBookmark(a)},getFocus:function(a,g){var d=!n.curNode||a&&e.isDescendant(n.curNode,a.domNode)?t._prevFocus:n.curNode;return{node:d,bookmark:d&&
d==n.curNode&&k.withGlobal(g||k.global,t.getBookmark),openedForWindow:g}},_activeStack:[],registerIframe:function(a){return n.registerIframe(a)},unregisterIframe:function(a){a&&a.remove()},registerWin:function(a,e){return n.registerWin(a,e)},unregisterWin:function(a){a&&a.remove()}});return t})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),function(q,e,a,f,k,n){var r=function(b){var g=b.document;this.getType=function(){if(g.getSelection){var a=
"text",e;try{e=b.getSelection()}catch(f){}e&&1==e.rangeCount&&(e=e.getRangeAt(0),e.startContainer==e.endContainer&&(1==e.endOffset-e.startOffset&&3!=e.startContainer.nodeType)&&(a="control"));return a}return g.selection.type.toLowerCase()};this.getSelectedText=function(){if(g.getSelection){var a=b.getSelection();return a?a.toString():""}return"control"==this.getType()?null:g.selection.createRange().text};this.getSelectedHtml=function(){if(g.getSelection){var a=b.getSelection();if(a&&a.rangeCount){var e,
f="";for(e=0;e<a.rangeCount;e++){var k=a.getRangeAt(e).cloneContents(),n=g.createElement("div");n.appendChild(k);f+=n.innerHTML}return f}return null}return"control"==this.getType()?null:g.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(g.getSelection){var a=b.getSelection();return a.anchorNode.childNodes[a.anchorOffset]}if((a=g.selection.createRange())&&a.item)return g.selection.createRange().item(0)}return null};this.getParentElement=function(){if("control"==
this.getType()){var a=this.getSelectedElement();if(a)return a.parentNode}else if(g.getSelection){if(a=g.getSelection()){for(a=a.anchorNode;a&&1!=a.nodeType;)a=a.parentNode;return a}}else return a=g.selection.createRange(),a.collapse(!0),a.parentElement();return null};this.hasAncestorElement=function(a){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(a){var b=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(b,arguments)};this.isTag=
function(a,b){if(a&&a.tagName)for(var e=a.tagName.toLowerCase(),g=0;g<b.length;g++){var f=String(b[g]).toLowerCase();if(e==f)return f}return""};this.getParentOfType=function(a,b){for(;a;){if(this.isTag(a,b).length)return a;a=a.parentNode}return null};this.collapse=function(a){if(g.getSelection){var e=b.getSelection();e.removeAllRanges?a?e.collapseToStart():e.collapseToEnd():e.collapse(a)}else e=g.selection.createRange(),e.collapse(a),e.select()};this.remove=function(){var a=g.selection;g.getSelection?
(a=b.getSelection(),a.deleteFromDocument()):"none"!=a.type.toLowerCase()&&a.clear();return a};this.selectElementChildren=function(a,h){var k;a=e.byId(a);if(g.getSelection){var m=b.getSelection();f("opera")?(k=m.rangeCount?m.getRangeAt(0):g.createRange(),k.setStart(a,0),k.setEnd(a,3==a.nodeType?a.length:a.childNodes.length),m.addRange(k)):m.selectAllChildren(a)}else if(k=a.ownerDocument.body.createTextRange(),k.moveToElementText(a),!h)try{k.select()}catch(n){}};this.selectElement=function(a,b){var n;
a=e.byId(a);if(g.getSelection){var m=g.getSelection();n=g.createRange();m.removeAllRanges&&(f("opera")&&m.getRangeAt(0)&&(n=m.getRangeAt(0)),n.selectNode(a),m.removeAllRanges(),m.addRange(n))}else try{m=a.tagName?a.tagName.toLowerCase():"",n="img"===m||"table"===m?k.body(g).createControlRange():k.body(g).createRange(),n.addElement(a),b||n.select()}catch(s){this.selectElementChildren(a,b)}};this.inSelection=function(a){if(a){var e,f;if(g.getSelection){var k=b.getSelection();k&&0<k.rangeCount&&(f=k.getRangeAt(0));
if(f&&f.compareBoundaryPoints&&g.createRange)try{if(e=g.createRange(),e.setStart(a,0),1===f.compareBoundaryPoints(f.START_TO_END,e))return!0}catch(n){}}else{f=g.selection.createRange();try{e=a.ownerDocument.body.createTextRange(),e.moveToElementText(a)}catch(p){}if(f&&e&&1===f.compareEndPoints("EndToStart",e))return!0}}return!1};this.getBookmark=function(){var a,e,f=g.selection,k=n.curNode;if(g.getSelection){if(f=b.getSelection())if(f.isCollapsed){if(a=k?k.tagName:"")if(a=a.toLowerCase(),"textarea"==
a||"input"==a&&(!k.type||"text"==k.type.toLowerCase()))return f={start:k.selectionStart,end:k.selectionEnd,node:k,pRange:!0},{isCollapsed:f.end<=f.start,mark:f};a={isCollapsed:!0};f.rangeCount&&(a.mark=f.getRangeAt(0).cloneRange())}else e=f.getRangeAt(0),a={isCollapsed:!1,mark:e.cloneRange()}}else if(f){a=k?k.tagName:"";a=a.toLowerCase();if(k&&a&&("button"==a||"textarea"==a||"input"==a)){if(f.type&&"none"==f.type.toLowerCase())return{isCollapsed:!0,mark:null};e=f.createRange();return{isCollapsed:e.text&&
e.text.length?!1:!0,mark:{range:e,pRange:!0}}}a={};try{e=f.createRange(),a.isCollapsed=!("Text"==f.type?e.htmlText.length:e.length)}catch(s){return a.isCollapsed=!0,a}if("CONTROL"==f.type.toUpperCase())if(e.length){a.mark=[];f=0;for(k=e.length;f<k;)a.mark.push(e.item(f++))}else a.isCollapsed=!0,a.mark=null;else a.mark=e.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return a};this.moveToBookmark=function(d){if(d=d.mark)if(g.getSelection){var e=b.getSelection();
e&&e.removeAllRanges?d.pRange?(e=d.node,e.selectionStart=d.start,e.selectionEnd=d.end):(e.removeAllRanges(),e.addRange(d)):console.warn("No idea how to restore selection for this browser!")}else if(g.selection&&d){var f;d.pRange?f=d.range:a.isArray(d)?(f=g.body.createControlRange(),q.forEach(d,function(a){f.addElement(a)})):(f=g.body.createTextRange(),f.moveToBookmark(d));f.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},t=new r(window);t.SelectionManager=r;return t})},
"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(q,e,a,f,k){var n={getViewport:function(){return a.getBox()}};n.placeOnScreen=f.at;n.placeOnScreenAroundElement=function(a,k,b,g){var d;if(e.isArray(b))d=b;else{d=[];for(var h in b)d.push({aroundCorner:h,corner:b[h]})}return f.around(a,k,d,!0,g)};n.placeOnScreenAroundNode=n.placeOnScreenAroundElement;n.placeOnScreenAroundRectangle=n.placeOnScreenAroundElement;n.getPopupAroundAlignment=
function(a,e){var b={};q.forEach(a,function(a){var d=e;switch(a){case "after":b[e?"BR":"BL"]=e?"BL":"BR";break;case "before":b[e?"BL":"BR"]=e?"BR":"BL";break;case "below-alt":d=!d;case "below":b[d?"BL":"BR"]=d?"TL":"TR";b[d?"BR":"BL"]=d?"TR":"TL";break;case "above-alt":d=!d;default:b[d?"TL":"TR"]=d?"BL":"BR",b[d?"TR":"TL"]=d?"BR":"BL"}});return b};e.mixin(k,n);return k})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(q,e,a){var f=
a._createWrapper;a._createWrapper=function(a){a.declaredClass||(a={_popupWrapper:a.parentNode&&q.contains(a.parentNode,"dijitPopup")?a.parentNode:null,domNode:a,destroy:function(){},ownerDocument:a.ownerDocument,ownerDocumentBody:e.body(a.ownerDocument)});return f.call(this,a)};var k=a.open;a.open=function(a){if(a.orient&&"string"!=typeof a.orient&&!("length"in a.orient)){var e=[],f;for(f in a.orient)e.push({aroundCorner:f,corner:a.orient[f]});a.orient=e}return k.call(this,a)};return a})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p){function c(){this._popupWrapper&&(n.destroy(this._popupWrapper),delete this._popupWrapper)}a=a(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,b=r.position(this._firstAroundNode,!0),c=b.x-a.x,a=b.y-a.y;if(c||a){this._firstAroundPosition=b;for(b=0;b<this._stack.length;b++){var e=this._stack[b].wrapper.style;e.top=parseFloat(e.top)+a+"px";"auto"==e.right?e.left=parseFloat(e.left)+
c+"px":e.right=parseFloat(e.right)-c+"px"}}this._aroundMoveListener=setTimeout(d.hitch(this,"_repositionAll"),c||a?10:50)}},_createWrapper:function(a){var b=a._popupWrapper,d=a.domNode;b||(b=n.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":a["aria-label"]||a.label||a.name||a.id},a.ownerDocumentBody),b.appendChild(d),d=d.style,d.display="",d.visibility="",d.position="",d.top="0px",a._popupWrapper=b,e.after(a,"destroy",c,!0),"ontouchend"in document&&h(b,"touchend",
function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}));return b},moveOffScreen:function(a){var b=this._createWrapper(a);a=r.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";t.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);t.set(b,{display:"none",height:"auto",overflow:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=
this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);return a[b]},open:function(a){for(var c=this._stack,e=a.popup,p=e.domNode,n=a.orient||["below","below-alt","above","above-alt"],q=a.parent?a.parent.isLeftToRight():r.isBodyLtr(e.ownerDocument),z=a.around,D=a.around&&a.around.id?a.around.id+"_dropdown":"popup_"+this._idGen++;c.length&&(!a.parent||!f.isDescendant(a.parent.domNode,c[c.length-1].widget.domNode));)this.close(c[c.length-1].widget);var E=this.moveOffScreen(e);e.startup&&!e._started&&
e.startup();var A,G=r.position(p);if("maxHeight"in a&&-1!=a.maxHeight)A=a.maxHeight||Infinity;else{A=s.getEffectiveBox(this.ownerDocument);var C=z?r.position(z,!1):{y:a.y-(a.padding||0),h:2*(a.padding||0)};A=Math.floor(Math.max(C.y,A.h-(C.y+C.h)))}G.h>A&&(G=t.getComputedStyle(p),t.set(E,{overflowY:"scroll",height:A+"px",border:G.borderLeftWidth+" "+G.borderLeftStyle+" "+G.borderLeftColor}),p._originalStyle=p.style.cssText,p.style.border="none");k.set(E,{id:D,style:{zIndex:this._beginZIndex+c.length},
"class":"dijitPopup "+(e.baseClass||e["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:a.parent?a.parent.id:""});0==c.length&&z&&(this._firstAroundNode=z,this._firstAroundPosition=r.position(z,!0),this._aroundMoveListener=setTimeout(d.hitch(this,"_repositionAll"),50));b("config-bgIframe")&&!e.bgIframe&&(e.bgIframe=new m(E));D=e.orient?d.hitch(e,"orient"):null;n=z?u.around(E,z,n,q,D):u.at(E,a,"R"==n?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],a.padding,D);E.style.visibility="visible";p.style.visibility=
"visible";p=[];p.push(h(E,"keydown",d.hitch(this,function(b){if(b.keyCode==g.ESCAPE&&a.onCancel)b.stopPropagation(),b.preventDefault(),a.onCancel();else if(b.keyCode==g.TAB&&(b.stopPropagation(),b.preventDefault(),(b=this.getTopPopup())&&b.onCancel))b.onCancel()})));e.onCancel&&a.onCancel&&p.push(e.on("cancel",a.onCancel));p.push(e.on(e.onExecute?"execute":"change",d.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));c.push({widget:e,wrapper:E,parent:a.parent,onExecute:a.onExecute,
onCancel:a.onCancel,onClose:a.onClose,handlers:p});if(e.onOpen)e.onOpen(n);return n},close:function(a){for(var b=this._stack;a&&q.some(b,function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),d=c.widget,e=c.onClose;d.bgIframe&&(d.bgIframe.destroy(),delete d.bgIframe);if(d.onClose)d.onClose();for(var g;g=c.handlers.pop();)g.remove();d&&d.domNode&&this.hide(d);e&&e()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=
this._aroundMoveListener=null)}});return p.popup=new a})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(q,e){e.scrollIntoView=function(a,e){q.scrollIntoView(a,e)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(q,e,a,f,k,n){var r=n.typematic=
{_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(a.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(e,b,g,d,f,k,m,n){if(f!=this._obj){this.stop();this._initialDelay=m||500;this._subsequentDelay=k||0.9;this._minDelay=
n||10;this._obj=f;this._node=g;this._count=this._currentTimeout=-1;this._callback=a.hitch(b,d);this._evt={faux:!0};for(var p in e)"layerX"!=p&&"layerY"!=p&&(b=e[p],"function"!=typeof b&&"undefined"!=typeof b&&(this._evt[p]=b));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(k,b,g,d,h,n,m){var s="keyCode"in b?"keyCode":"charCode"in b?"charCode":"charOrCode",
p=[f(k,"keyCode"in b?"keydown":"charCode"in b?"keypress":e._keypress,a.hitch(this,function(a){a[s]==b[s]&&(void 0===b.ctrlKey||b.ctrlKey==a.ctrlKey)&&(void 0===b.altKey||b.altKey==a.altKey)&&(void 0===b.metaKey||b.metaKey==(a.metaKey||!1))&&(void 0===b.shiftKey||b.shiftKey==a.shiftKey)?(a.stopPropagation(),a.preventDefault(),r.trigger(a,g,k,d,b,h,n,m)):r._obj==b&&r.stop()})),f(k,"keyup",a.hitch(this,function(){r._obj==b&&r.stop()}))];return{remove:function(){q.forEach(p,function(a){a.remove()})}}},
addMouseListener:function(e,b,g,d,h,n){var m=[f(e,"mousedown",a.hitch(this,function(a){a.preventDefault();r.trigger(a,b,e,g,e,d,h,n)})),f(e,"mouseup",a.hitch(this,function(a){this._obj&&a.preventDefault();r.stop()})),f(e,"mouseout",a.hitch(this,function(a){this._obj&&a.preventDefault();r.stop()})),f(e,"dblclick",a.hitch(this,function(f){f.preventDefault();9>k("ie")&&(r.trigger(f,b,e,g,e,d,h,n),setTimeout(a.hitch(this,r.stop),50))}))];return{remove:function(){q.forEach(m,function(a){a.remove()})}}},
addListener:function(a,b,e,d,f,k,m,n){var p=[this.addKeyListener(b,e,d,f,k,m,n),this.addMouseListener(a,d,f,k,m,n)];return{remove:function(){q.forEach(p,function(a){a.remove()})}}}};return r})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(q,e,a){e.mixin(a,{hasWaiRole:function(a,e){var n=this.getWaiRole(a);return e?-1<n.indexOf(e):0<n.length},getWaiRole:function(a){return e.trim((q.get(a,"role")||"").replace("wairole:",""))},setWaiRole:function(a,
e){q.set(a,"role",e)},removeWaiRole:function(a,k){var n=q.get(a,"role");n&&(k?(n=e.trim((" "+n+" ").replace(" "+k+" "," ")),q.set(a,"role",n)):a.removeAttribute("role"))},hasWaiState:function(a,e){return a.hasAttribute?a.hasAttribute("aria-"+e):!!a.getAttribute("aria-"+e)},getWaiState:function(a,e){return a.getAttribute("aria-"+e)||""},setWaiState:function(a,e,n){a.setAttribute("aria-"+e,n)},removeWaiState:function(a,e){a.removeAttribute("aria-"+e)}});return a})},"dijit/_base/window":function(){define(["dojo/window",
"../main"],function(q,e){e.getDocumentWindow=function(a){return q.get(a)}})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(q,e,a,f,k,n,r,t,b){return n("dijit.layout._LayoutWidget",[e,a,f],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);r.add(this.domNode,"dijitContainer")},
startup:function(){if(!this._started){this.inherited(arguments);var a=this.getParent&&this.getParent();if(!a||!a.isLayoutContainer)this.resize(),this.own(k.on("resize",q.hitch(this,"resize")))}},resize:function(a,d){var e=this.domNode;a&&t.setMarginBox(e,a);var f=d||{};q.mixin(f,a||{});if(!("h"in f)||!("w"in f))f=q.mixin(t.getMarginBox(e),f);var k=b.getComputedStyle(e),n=t.getMarginExtents(e,k),p=t.getBorderExtents(e,k),f=this._borderBox={w:f.w-(n.w+p.w),h:f.h-(n.h+p.h)},n=t.getPadExtents(e,k);this._contentBox=
{l:b.toPixelValue(e,k.paddingLeft),t:b.toPixelValue(e,k.paddingTop),w:f.w-n.w,h:f.h-n.h};this.layout()},layout:function(){},_setupChild:function(a){r.add(a.domNode,this.baseClass+"-child "+(a.baseClass?this.baseClass+"-"+a.baseClass:""))},addChild:function(a,b){this.inherited(arguments);this._started&&this._setupChild(a)},removeChild:function(a){r.remove(a.domNode,this.baseClass+"-child"+(a.baseClass?" "+this.baseClass+"-"+a.baseClass:""));this.inherited(arguments)}})})},"dijit/_Contained":function(){define(["dojo/_base/declare",
"./registry"],function(q,e){return q("dijit._Contained",null,{_getSibling:function(a){var f=this.domNode;do f=f[a+"Sibling"];while(f&&1!=f.nodeType);return f&&e.byNode(f)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var a=this.getParent();return!a||!a.getIndexOfChild?-1:a.getIndexOfChild(this)}})})},"builder/dijit/Tags":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/dom-construct dojo/store/Memory dojo/Deferred dojo/sniff dijit/_TemplatedMixin dijit/_WidgetBase dijit/form/TextBox ./AutoComplete dojo/text!./templates/Tags.html dojo/domReady!".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h){return a([b,t],{templateString:h,baseClass:"esriAGOTags",_minWidth:"auto",_maxWidth:"auto",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._isIE8=r("ie")},startup:function(){this.inherited(arguments)},loadTags:function(a){var b=new n;this._isIE8?(this._textTags||(this.tagsId="userTags-"+(new Date).getTime(),f.create("div",{id:this.tagsId},this.domNode),this._textTags=new g({placeHolder:this.nls.addTags,
trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),b.resolve()):a?a.getTags().then(e.hitch(this,function(a){this._handleTags(a);b.resolve()}),e.hitch(this,function(a){console.error("get user tags error: "+a);this._handleTags({tags:[]});b.resolve()})):(this._handleTags({tags:[]}),b.resolve());return b},_handleTags:function(a){if(a){this._autoComplete&&this._autoComplete.clearTags();var b=[];a.tags&&q.forEach(a.tags,e.hitch(this,function(a){b.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(e.hitch(this,
function(a){this._tagStore.remove(a.tag)})),q.forEach(b,e.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new k({idProperty:"tag",data:b});this._autoComplete||(a=(new Date).getTime(),this.tagsId="userTags-"+a,this.gridId="grid-"+a,this.filterId="filter-"+a,f.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new d({placeholder:this.nls.addTags,noDataMsg:this.nls.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,
maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){return q.filter(a,e.hitch(this,function(b,d){return q.indexOf(a,b)===d}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){a&&!(a instanceof Array)&&(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),
this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(q,e,a){return q("dojo.store.Memory",null,{constructor:function(a){for(var e in a)this[e]=
a[e];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:a,get:function(a){return this.data[this.index[a]]},getIdentity:function(a){return a[this.idProperty]},put:function(a,e){var n=this.data,r=this.index,q=this.idProperty,q=a[q]=e&&"id"in e?e.id:q in a?a[q]:Math.random();if(q in r){if(e&&!1===e.overwrite)throw Error("Object already exists");n[r[q]]=a}else r[q]=n.push(a)-1;return q},add:function(a,e){(e=e||{}).overwrite=!1;return this.put(a,e)},remove:function(a){var e=
this.index,n=this.data;if(a in e)return n.splice(e[a],1),this.setData(n),!0},query:function(a,k){return e(this.queryEngine(a,k)(this.data))},setData:function(a){a.items?(this.idProperty=a.identifier||this.idProperty,a=this.data=a.items):this.data=a;this.index={};for(var e=0,n=a.length;e<n;e++)this.index[a[e][this.idProperty]]=e}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(q,e,a){var f=function(k){function n(e){k[e]=function(){var b=
arguments,g=a(k,function(a){Array.prototype.unshift.call(b,a);return f(q[e].apply(q,b))});if("forEach"!==e||r)return g}}if(!k)return k;var r=!!k.then;r&&(k=e.delegate(k));n("forEach");n("filter");n("map");null==k.total&&(k.total=a(k,function(a){return a.length}));return k};e.setObject("dojo.store.util.QueryResults",f);return f})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(q){return function(e,a){function f(f){f=q.filter(f,e);var k=a&&a.sort;k&&f.sort("function"==
typeof k?k:function(a,e){for(var d,f=0;d=k[f];f++){var n=a[d.attribute],m=e[d.attribute],n=null!=n?n.valueOf():n,m=null!=m?m.valueOf():m;if(n!=m)return!!d.descending==(null==n||n>m)?-1:1}return 0});if(a&&(a.start||a.count)){var t=f.length;f=f.slice(a.start||0,(a.start||0)+(a.count||Infinity));f.total=t}return f}switch(typeof e){default:throw Error("Can not query with a "+typeof e);case "object":case "undefined":var k=e;e=function(a){for(var e in k){var f=k[e];if(f&&f.test){if(!f.test(a[e],a))return!1}else if(f!=
a[e])return!1}return!0};break;case "string":if(!this[e])throw Error("No filter function "+e+" was found in store");e=this[e];case "function":}f.matches=e;return f}})},"builder/dijit/AutoComplete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/json dojo/keys dojo/on dojo/query dojo/request dojo/string dijit/focus dijit/form/TextBox dijit/registry dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z,D){return e([y,v,x],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",constructor:function(a,b){this._attachmentNode=b;this._idProperty=a.idProperty;this._gridId=a.gridId;this._filterId=a.filterId;this._store=a.store;this._placeHolder=a.placeholder;this._noDataMsg=a.noDataMsg;this._maxWidth=a.maxWidth;this._minWidth=a.minWidth;this._matchParam=a.matchParam;this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},buildRendering:function(){this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var b=a.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>b.length)return!0;if(!a.tag)return!1;
a=(a.tag+"").toLowerCase().match(RegExp("^"+b.toLowerCase()));return null!==a&&0<a.length?!0:!1}),c=a.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>b.length?!0:!a.tag?!1:~(a.tag+"").toLowerCase().indexOf(b.toLowerCase())?!0:!1}),d=[{field:this._idProperty}],g=[{attribute:this._idProperty,ascending:!0}];this._grid=new (e([B,z,D]))({store:this._store,showHeader:!1,noDataMessage:this._noDataMsg,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,
columns:d,sort:g,renderRow:this._renderItem},this._gridId);r.add(this._gridId,"gridHeightLimiter");this._grid.query="first"===this._matchParam?b:c},postCreate:function(){var b;this._inputTextBox.watch("value",a.hitch(this,function(a,c,d){b&&(clearTimeout(b),b=null);this._grid.refresh()}));this._grid.on(".dgrid-row:click",a.hitch(this,function(a){var b="";!this._shiftKeyPressed&&!this._metaKeyPressed?(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox()):
!a.shiftKey&&(!a.metaKey&&!a.ctrlKey)&&(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())}));this._grid.on("dgrid-deselect",a.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this._grid.on("dgrid-select",a.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this.connect(this.domNode,"keydown","_keydownHandler");window.onkeydown=a.hitch(this,function(a){if(a.shiftKey||
a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.connect(document,"onkeydown",a.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0}))},_keydownHandler:function(d){var e;void 0!==c.curNode.value&&(e=c.curNode.value.length);var g=m(this._CHOICE_FOCUS,k.byId(this.id)),f=m(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id)).last();switch(d.keyCode){case h.RIGHT_ARROW:this._navigate(g,e,f,"right");this._hideGrid();break;case h.LEFT_ARROW:this._navigate(g,
e,f,"left");this._hideGrid();break;case h.DOWN_ARROW:d.preventDefault();this._unhighlightTag(g);"none"===b.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case h.UP_ARROW:break;case h.BACKSPACE:var l;if(0===e&&0===m(this._CHOICE_FOCUS_ALL).length&&void 0!==m(this._CHOICE_ALL_SELECTOR)[m(this._CHOICE_ALL_SELECTOR).length-1]&&(l=m(this._CHOICE_ALL_SELECTOR)[m(this._CHOICE_ALL_SELECTOR).length-1].title,
0<m("li",this._attachmentNode).length&&(t.destroy(f[0]),void 0!==l)))try{this._store.add({tag:l})}catch(n){}if(0<m(this._CHOICE_FOCUS_ALL).length&&(l=m(this._CHOICE_FOCUS_ALL).text(),t.destroy(g[0]),void 0!==l))try{this._store.add({tag:l})}catch(s){}this._grid.refresh();0===e&&this._hideGrid();this._removeTag(l);break;case h.CTRL:this._metaKeyPressed=!0;break;case h.META:this._metaKeyPressed=!0;break;case h.SHIFT:this._shiftKeyPressed=!0;break;case h.ENTER:if(0<e){e=c.curNode.value;e=e.split(",");
var r=[];q.forEach(e,function(a,b){-1===q.indexOf(r,a)&&r.push(p.trim(a))});q.forEach(r,a.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}))}else{for(e=0;e<this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();d.preventDefault();c.focus(k.byId(this._filterId));break;case h.TAB:if(!(c.curNode.id===this._filterId&&0===e)){if(0<e)e=c.curNode.value,
e=e.split(","),r=[],q.forEach(e,function(a,b){-1===q.indexOf(r,a)&&r.push(p.trim(a))}),q.forEach(r,a.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(e=0;e<this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();d.preventDefault();c.focus(k.byId(this._filterId))}break;case h.ESCAPE:this._hideGrid();break;default:-1<e&&("none"===b.get(k.byId(this._gridId),
"display")&&this._showGrid(),this._unhighlightTag(g)),this._metaKeyPressed=!1}},_blurHandler:function(b,c,d){if(!this.focused){if(0<this._inputTextBox.value.length){var e=[];b=this._inputTextBox.value.split(",");q.forEach(b,function(a,b){-1===q.indexOf(e,a)&&e.push(p.trim(a))});q.forEach(e,a.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}},_resetInputTextBox:function(){w.byId(this._filterId).set("value","")},
_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,b,c,d){0<a.length&&1>b?("right"===d?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=q.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==q.indexOf(this.values,
a)&&this.values.splice(q.indexOf(this.values,a),1)},_hideGrid:function(){k.byId(this._gridId)&&b.set(k.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){b.set(k.byId(this._gridId),"display","block");var a=b.get(k.byId(this._attachmentNode),"width");b.set(k.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return m(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||m(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(b){m(this._CHOICE_FOCUS,
k.byId(this.id)).removeClass("select2-search-choice-focus");var c=t.create("li",null,this._autocompleteList);r.add(c,this._CSS_STYLES.CHOICE);c=t.create("div",{title:b},c);g.set(c,this.htmlEncode(b));c=t.create("a",{href:"#"},c);r.add(c,this._CSS_STYLES.CLOSE_ICON);u(c,"click",a.hitch(this,function(a){var b=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:b})}catch(c){}this._grid.refresh();this._removeTag(b);t.destroy(a.target.parentNode.parentNode);a.preventDefault()}));
c=w.byId(this._filterId);t.place(c.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(b)},_renderItem:function(a){return t.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this.domNode=t.create("div",null,this._attachmentNode);r.add(this.domNode,this._CSS_STYLES.MULTI);b.set(this.domNode,"maxWidth",this._maxWidth);b.set(this.domNode,"minWidth",this._minWidth)},_createTagList:function(){this._autocompleteList=t.create("ul",null,this.domNode);r.add(this._autocompleteList,
this._CSS_STYLES.CHOICES)},_createInput:function(){var d=t.create("li",null,this._autocompleteList,"last");r.add(d,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new l({id:this._filterId,placeHolder:this._placeHolder,intermediateChanges:!0,trim:!0,style:{border:"none"}},d);r.add(this._inputTextBox,"inputTextBox");b.set(this._inputTextBox,"width",this._minWidth);c.watch("curNode",a.hitch(this,this._blurHandler))},_createDropDownList:function(){var a=t.create("div",{id:this._gridId},this.domNode);
r.add(a,"dropDownList");b.set(a,"width",this._minWidth)},prepopulate:function(b){q.forEach(b,a.hitch(this,function(a,b){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var b=m(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id));0<b.length&&(q.forEach(b,a.hitch(this,function(a,b){try{this._store.add({tag:m(this._CHOICE_ALL_SELECTOR,k.byId(this.id))[0].title})}catch(c){}t.destroy(a)})),this.values=[])},addStyledTags:function(a,c){r.add(k.byId(c),this._CSS_STYLES.MULTI);
var d=t.create("ul",null,k.byId(c));r.add(d,this._CSS_STYLES.CHOICES);b.set(d,"border","none");q.forEach(a,function(a,c){var e=t.create("li",null,d);b.set(e,"padding","3px 5px 3px 5px");r.add(e,"select2-search-resultSet");e=t.create("div",{title:a},e);g.set(e,a)})},htmlEncode:function(a){return!a?a:a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;")}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(q,
e,a){return q("dgrid.OnDemandGrid",[e,a],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(q,e,a,f,k,n,r){function t(a,b){b&&b.nodeType&&a.appendChild(b)}function b(a,b,e,g){if(this.formatter){g=this.formatter;var f=this.grid.formatterScope;e.innerHTML="string"===typeof g&&f?f[g](b,a):this.formatter(b,a)}else null!=b&&e.appendChild(document.createTextNode(b))}var g=8>f("ie")&&!f("quirks");
e=e("dgrid.Grid",n,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!=typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var e;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var g=a.columnId;if(g){b=g;e=a;break}a=a.parentNode}while(a&&a!=this.domNode)}if(!e&&"undefined"!=typeof b){var f=this.row(a);if(g=f&&f.element)for(var g=g.getElementsByTagName("td"),
k=0;k<g.length;k++)if(g[k].columnId==b){e=g[k];break}}if(null!=a)return{row:f||this.row(a),column:b&&this.column(b),element:e}},createRowCells:function(a,b,e,m){var n=k("table.dgrid-row-table[role\x3dpresentation]"),p=9>f("ie")||f("quirks")?k(n,"tbody"):n,c,l,q,t,x,y,B,z,D,E;e=e||this.subRows;l=0;for(q=e.length;l<q;l++){y=e[l];c=k(p,"tr");y.className&&k(c,"."+y.className);t=0;for(x=y.length;t<x;t++){B=y[t];z=B.id;D=B.field?".field-"+r.escapeCssIdentifier(B.field,"-"):"";(E="function"===typeof B.className?
B.className(m):B.className)&&(D+="."+E);D=k(a+(".dgrid-cell.dgrid-cell-padding"+(z?".dgrid-column-"+r.escapeCssIdentifier(z,"-"):"")+D.replace(/ +/g,"."))+"[role\x3d"+("th"===a?"columnheader":"gridcell")+"]");D.columnId=z;g?(z=k(D,"!dgrid-cell-padding div.dgrid-cell-padding"),D.contents=z):z=D;if(E=B.colSpan)D.colSpan=E;if(E=B.rowSpan)D.rowSpan=E;b(z,B);c.appendChild(D)}}return n},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,
b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},renderRow:function(a,e){var g=this.createRowCells("td",function(g,f){var k=a;f.get?k=f.get(a):"field"in f&&"_item"!=f.field&&(k=k[f.field]);f.renderCell?t(g,f.renderCell(a,k,g,e)):b.call(f,a,k,g,e)},e&&e.subRows,a);return k("div[role\x3drow]\x3e",g)},renderHeader:function(){var b=this,e=this.headerNode,n=e.childNodes.length;for(e.setAttribute("role","row");n--;)k(e.childNodes[n],"!");n=this.createRowCells("th",function(a,
b){var d=b.headerNode=a;g&&(a=a.parentNode);var c=b.field;c&&(a.field=c);if(b.renderHeaderCell)t(d,b.renderHeaderCell(d));else if("label"in b||b.field)d.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&(c&&"_item"!=c)&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[n.id=this.id+"-header"]=this.columns;e.appendChild(n);this._sortListener&&this._sortListener.remove();this._sortListener=a(n,"click,keydown",
function(g){if("click"==g.type||32==g.keyCode||!f("opera")&&13==g.keyCode){var k=g.target,p,c,l;do if(k.sortable){l=[{attribute:p=k.field||k.columnId,descending:(c=b._sort[0])&&c.attribute==p&&!c.descending}];p={bubbles:!0,cancelable:!0,grid:b,parentType:g.type,sort:l};a.emit(g.target,"dgrid-sort",p)&&(b._sortNode=k,b.set("sort",l));break}while((k=k.parentNode)&&k!=e)}})},resize:function(){var a=this.headerNode.firstChild,b=this.contentNode,e;this.inherited(arguments);if(!f("ie")||7<f("ie")&&!f("quirks"))if(b.style.width=
"",b&&a&&(e=a.offsetWidth)!=b.offsetWidth)b.style.width=e+"px"},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(a,b){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(a){var b=this.columns,e;for(e in b){var g=b[e];if(g.field==a)return g.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(k(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),k(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);b&&(this._sort=a);if(a[0]){var e=a[0].attribute,g=a[0].descending,e=this._sortNode||this._findSortArrowParent(e),f;delete this._sortNode;e&&(e=e.contents||e,f=this._lastSortedArrow=k("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),f.innerHTML="\x26nbsp;",e.insertBefore(f,e.firstChild),k(e,g?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+r.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+r.escapeCssIdentifier(a,
"-"),b)},_configColumns:function(a,b){var e=[],g=b instanceof Array;r.each(b,function(f,k){"string"==typeof f&&(b[k]=f={label:f});!g&&!f.field&&(f.field=k);k=f.id=f.id||(isNaN(k)?k:a+k);this._configColumn&&(this._configColumn(f,k,b,a),k=f.id);g&&(this.columns[k]=f);f.grid=this;"function"===typeof f.init&&f.init();e.push(f)},this);return g?b:e},_destroyColumns:function(){var a=this.subRows,b=a&&a.length,e,g,f,k;this.cleanup();for(e=0;e<b;e++){g=0;for(k=a[e].length;g<k;g++)f=a[e][g],"function"===typeof f.destroy&&
f.destroy()}},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},setColumns:function(a){q.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",a)},setSubRows:function(a){q.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",a)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});e.appendIfNode=t;e.defaultRenderCell=b;return e})},"put-selector/put":function(){(function(q){var e,
a=/[-+,> ]/;q([],e=function(f,k){function n(d){function e(){c&&(p&&c!=p)&&(p==d&&(k||(k=a.test(x)&&f.createDocumentFragment()))?k:p).insertBefore(c,s||null)}for(var k,m,s,p,c,l=arguments,w=l[0],v=0;v<l.length;v++){var x=l[v];if("object"==typeof x){m=!1;if(x instanceof Array){c=f.createDocumentFragment();for(var y=0;y<x.length;y++)c.appendChild(n(x[y]));x=c}if(x.nodeType)c=x,e(),p=x,s=0;else for(y in x)c[y]=x[y]}else if(m)m=!1,c.appendChild(f.createTextNode(x));else{1>v&&(d=null);m=!0;if(w=x.replace(r,
function(a,k,m,r,u,w){k&&(e(),"-"==k||"+"==k?(p=(s=c||p).parentNode,c=null,"+"==k&&(s=s.nextSibling)):("\x3c"==k?p=c=(c||p).parentNode:(","==k?p=d:c&&(p=c),c=null),s=0),c&&(p=c));if((a=!m&&r)||!c&&(m||u))"$"==a?(a=l[++v],p.appendChild(f.createTextNode(a))):(a=a||n.defaultTag,(k=g&&l[v+1]&&l[v+1].name)&&(a="\x3c"+a+' name\x3d"'+k+'"\x3e'),c=b&&~(q=a.indexOf("|"))?f.createElementNS(b[a.slice(0,q)],a.slice(q+1)):f.createElement(a));if(m)if("$"==r&&(r=l[++v]),"#"==m)c.id=r;else if(k=(a=c.className)&&
(" "+a+" ").replace(" "+r+" "," "),"."==m)c.className=a?(k+r).substring(1):r;else if("!"==x){var y;g?n("div",c,"\x3c").innerHTML="":(y=c.parentNode)&&y.removeChild(c)}else k=k.substring(1,k.length-1),k!=a&&(c.className=k);u&&("$"==w&&(w=l[++v]),"style"==u?c.style.cssText=w:(m="!"==u.charAt(0)?(u=u.substring(1))&&"removeAttribute":"setAttribute",w=""===w?u:w,b&&~(q=u.indexOf("|"))?c[m+"NS"](b[u.slice(0,q)],u.slice(q+1),w):c[m](u,w)));return""}))throw new SyntaxError("Unexpected char "+w+" in "+x);
e();p=w=c||p}}d&&k&&d.appendChild(k);return w}a=k||a;var r=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,q,b=!1;f=f||document;var g="object"==typeof f.createElement;n.addNamespace=function(a,e){f.createElementNS?(b||(b={}))[a]=e:f.namespaces.add(a,e)};n.defaultTag="div";n.forDocument=e;return n})})(function(q,e,a){a=a||e;"function"===typeof define?define([],function(){return a()}):"undefined"==typeof window?require("./node-html")(module,a):put=
a()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(q,e,a,f,k,n,r,t,b){function g(a,c){b(document.body,a,".dgrid-scrollbar-measure");var d=a["offset"+c]-a["client"+c];a.className="";document.body.removeChild(a);return d}function d(a){var c=a?"."+a.replace(l,"."):"";this._class&&(c="!"+this._class.replace(l,"!")+
c);b(this.domNode,c);this._class=a}function h(){return this._class}function u(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function m(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}t("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var s,p;k.add("dom-scrollbar-width",function(a,b,c){return g(c,"Width")});k.add("dom-scrollbar-height",function(a,b,c){return g(c,"Height")});k.add("dom-rtl-scrollbar-left",
function(a,c,d){a=b("div");b(document.body,d,".dgrid-scrollbar-measure[dir\x3drtl]");b(d,a);c=!!k("ie")||!!k("trident")||a.offsetLeft>=k("dom-scrollbar-width");d.className="";document.body.removeChild(d);b(a,"!");d.removeAttribute("dir");return c});var c=0,l=/ +/g,w=7>k("ie")&&!k("quirks")?function(){var a,b,c;if(this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a))this.resize(),this._prevWinDims=[b,a]}:function(){this._started&&this.resize()};
return e("dgrid.List",k("touch")?r:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,g){var f=
this.domNode=g||b("div"),l;a?(this.params=a,e.safeMixin(this,a),l=a["class"]||a.className||f.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=f.id=f.id||this.id||"dgrid_"+c++;null===this.useTouchScroll&&(this.useTouchScroll=!k("dom-scrollbar-width"));this.buildRendering();l&&d.call(this,l);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&
this.startup()},buildRendering:function(){var a=this.domNode,c=this.addUiClasses,d=this,e,g,l,h;h=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";b(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(c?".ui-widget":""));e=this.headerNode=b(a,"div.dgrid-header.dgrid-header-row"+(c?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(k("quirks")||8>k("ie"))&&b(a,"div.dgrid-spacer");g=this.bodyNode=b(a,"div.dgrid-scroller");
k("ff")&&(g.tabIndex=-1);this.headerScrollNode=b(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(c?".ui-widget-header":""));l=this.footerNode=b("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));b(a,l);h&&(a.className+=" dgrid-rtl"+(k("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));f(g,"scroll",function(b){d.showHeader&&(e.scrollLeft=b.scrollLeft||g.scrollLeft);b.stopPropagation();f.emit(a,"scroll",{scrollTarget:g})});this.configStructure();this.renderHeader();this.contentNode=
this.touchNode=b(this.bodyNode,"div.dgrid-content"+(c?".ui-widget-content":""));this._listeners.push(this._resizeHandle=f(window,"resize",n.throttleDelayed(w,this)))},postCreate:k("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,c=this.footerNode,d=b.offsetHeight,
e=this.showFooter?c.offsetHeight:0,g=k("quirks")||7>k("ie");this.headerScrollNode.style.height=a.style.marginTop=d+"px";a.style.marginBottom=e+"px";g&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-d-e,0)+"px",e&&(c.style.bottom="1px",setTimeout(function(){c.style.bottom=""},0)));s||(s=k("dom-scrollbar-width"),p=k("dom-scrollbar-height"),k("ie")&&(s++,p++),n.addCssRule(".dgrid-scrollbar-width","width: "+s+"px"),n.addCssRule(".dgrid-scrollbar-height","height: "+p+"px"),17!=s&&
!g&&(n.addCssRule(".dgrid-header-row","right: "+s+"px"),n.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+s+"px")));g&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){var c=n.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,b){var c=f(this.domNode,a,b);k("dom-addeventlistener")||this._listeners.push(c);return c},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=
this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();b(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";
this.scrollTo({x:0,y:0})},newRow:function(a,c,d,e,g){if(c){var f=this.insertRow(a,c,d,e,g);b(f,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){b(f,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return f}},adjustRowIndices:function(a){var c=a.rowIndex;if(-1<c){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&b(a,"."+(1==c%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==c%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=
c++);while((a=a.nextSibling)&&a.rowIndex!=c)}},renderArray:function(b,c,d){function e(){var a=arguments;if(-1<r)for(var c=0;c<a.length;c++){var f=a[c],l=p[f?0:p.length-1];if(l=l&&g(l)){var k=l[f?"previousSibling":"nextSibling"];k&&(k=h.row(k));k&&k.element!=l&&(f=f?"unshift":"push",b[f](k.data),p[f](k.element),d.count++)}}}function g(b){return!a.isDescendant(b,h.domNode)&&document.getElementById(b.id)?h.row(b.id.slice(h.id.length+5)).element:b}function f(a){u=h.insertRow(a,q,null,k++,d);u.observerIndex=
r;return u}function l(a){t=a.slice(0);(n=c?c.parentNode:h.contentNode)&&n.parentNode&&(n!==h.contentNode||a.length)?(n.insertBefore(q,c||null),(u=a[a.length-1])&&h.adjustRowIndices(u)):m[r]&&h.cleanEmptyObservers&&"undefined"!==typeof r&&(m[r].cancel(),m[r]=0,h._numObservers--);p=a;s&&(s.rows=p)}d=d||{};var h=this,k=d.start||0,m=this.observers,p,n,r;c||(this._lastCollection=b);if(b.observe&&this.shouldObserveStore){h._numObservers++;var s=b.observe(function(a,f,l){var k,m,s;-1<f&&p[f]&&(k=p.splice(f,
1)[0],k.parentNode==n&&((m=k.nextSibling)&&f!=l&&m.rowIndex--,h.removeRow(k)),d.count--,h._processScroll&&h._processScroll());if(-1<l){if(p.length)if(0===l)s=(s=p[l])&&g(s);else{if(s=p[l-1])s=g(s),s=(s.connected||s).nextSibling}else s=h._getFirstRowSibling&&h._getFirstRowSibling(n);k&&(s&&k.id===s.id)&&(s=(s.connected||s).nextSibling);s&&!s.parentNode&&(s=document.getElementById(s.id));k=c&&c.parentNode||s&&s.parentNode||h.contentNode;if(k=h.newRow(a,k,s,d.start+l,d))if(k.observerIndex=r,p.splice(l,
0,k),!m||l<f)m=k.previousSibling,m=!m||m.rowIndex+1==k.rowIndex||0==k.rowIndex?k:m;d.count++}0===f?e(1,1):f===b.length-(-1===l?0:1)&&e(0,0);f!=l&&m&&h.adjustRowIndices(m);h._onNotification(p,a,f,l)},!0);r=m.push(s)-1}var q=document.createDocumentFragment(),u,t;if(b.map){if(p=b.map(f,console.error),p.then)return b.then(function(a){b=a;return p.then(function(a){l(a);e(1,1,0,0);return t})})}else{p=[];for(var w=0,P=b.length;w<P;w++)p[w]=f(b[w])}l(p);e(1,1,0,0);return t},_onNotification:function(a,b,c,
d){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,d,e){var g=e.parentId,g=this.id+"-row-"+(g?g+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),f=document.getElementById(g),l=f&&f.previousSibling;f&&(f===c&&(c=(c.connected||c).nextSibling),this.removeRow(f));f=this.renderRow(a,e);f.className=(f.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[f.id=g]=a;b.insertBefore(f,
c||null);l&&this.adjustRowIndices(l);f.rowIndex=d;return f},renderRow:function(a,c){return b("div",""+a)},removeRow:function(a,c){a=a.element||a;delete this._rowIdToObject[a.id];c||b(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):
(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var e,g;g=e=a.element;b=b||1;do if(a=e[0>b?"previousSibling":"nextSibling"]){do if((e=a)&&-1<(e.className+" ").indexOf(c+" ")){g=e;b+=0>b?1:-1;break}while(a=(!d||!e.hidden)&&e[0>b?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(b);return g},up:function(a,b,c){a.element||
(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:k("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):m.call(this,a)}:m,getScrollPosition:k("touch")?function(){return this.useTouchScroll?this.inherited(arguments):u.call(this)}:u,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,
1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:h,_setClass:d,_getClassName:h,_setClassName:d,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,
d){var e=c[a],g=d[a];void 0===e&&(e="");void 0===g&&(g="");return e==g?0:e>g==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){q.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var c=this.headerNode;this.showHeader=a;b(c,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(c.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){q.deprecated("setShowHeader(...)",
'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;b(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(q,e){q.add("dom-contains",function(a,e,d){return!!d.contains});var a=[],f,k,n,r=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,t={defaultDelay:15,throttle:function(a,e,d){var f=!1;d=d||t.defaultDelay;return function(){f||(f=!0,a.apply(e,arguments),
setTimeout(function(){f=!1},d))}},throttleDelayed:function(a,e,d){var f=!1;d=d||t.defaultDelay;return function(){if(!f){f=!0;var k=arguments;setTimeout(function(){f=!1;a.apply(e,k)},d)}}},debounce:function(a,e,d){var f;d=d||t.defaultDelay;return function(){f&&(clearTimeout(f),f=null);var k=arguments;f=setTimeout(function(){a.apply(e,k)},d)}},each:function(a,e,d){var f,k;if(a)if("number"===typeof a.length){f=0;for(k=a.length;f<k;f++)e.call(d,a[f],f,a)}else for(f in a)e.call(d,a[f],f,a)},contains:function(a,
e){return q("dom-contains")?a.contains(e):a.compareDocumentPosition(e)&8},addCssRule:function(b,g){f||(f=e(document.getElementsByTagName("head")[0],"style"),f=f.sheet||f.styleSheet,k=f.deleteRule?"deleteRule":"removeRule",n=f.cssRules?"cssRules":"rules");var d=a.length;a[d]=(f.cssRules||f.rules).length;f.addRule?f.addRule(b,g):f.insertRule(b+"{"+g+"}",a[d]);return{get:function(b){return f[n][a[d]].style[b]},set:function(b,e){"undefined"!==typeof a[d]&&(f[n][a[d]].style[b]=e)},remove:function(){var b=
a[d],e,g;if(void 0!==b){f[k](b);a[d]=void 0;e=d+1;for(g=a.length;e<g;e++)a[e]>b&&a[e]--}}}},escapeCssIdentifier:function(a,e){return"string"===typeof a?a.replace(r,e||"\\$1"):a}};return t})},"xstyle/has-class":function(){define(["dojo/has"],function(q){var e={};return function(){for(var a,f=arguments,k=0;k<f.length;k++)if(a=f[k],!e[a]){e[a]=!0;var n=a.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),r=q(n[2]),t=-n[4];if((0<t?t<=r&&(-n[5]||t)>=r:!!r)==!n[1])document.documentElement.className+=" has-"+
a}}})},"xstyle/css":function(){define(["require"],function(q){function e(a,e,k){var n=document.documentElement;a=n.insertBefore(document.createElement(a),n.firstChild);a.id=e;e=(a.currentStyle||getComputedStyle(a,null))[k];n.removeChild(a);return e}return{load:function(a,f,k,n){function r(){var a=e("x-parse",null,"content");a&&"none"!=a?f([eval(a)],k):k()}var t=f.toUrl(a),b=f.cache["url:"+t];if(b)return b.xCss&&(b=b.cssText),q(["./util/createStyleSheet"],function(a){a(b)}),r();if("none"==e("div",
a.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return r();q(["./load-css"],function(a){a(t,r)})}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(q,e,a,f,k,n,r,t,b){return a("dgrid.OnDemandList",[q,e],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:t.defaultDelay,
keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var a=this;r(this.bodyNode,"scroll",t[this.pagingMethod](function(b){a._processScroll(b)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(a,d){function e(a){b(q,"!");if(a)throw n._refreshDeferred&&(n._refreshDeferred.reject(a),delete n._refreshDeferred),a;}var n=this,m=d&&d.container||this.contentNode,s={query:a,count:0,
options:d},p,c=this.preload,l,r={node:b(m,"div.dgrid-preload",{rowIndex:0}),count:0,query:a,next:s,options:d};r.node.style.height="0";s.node=p=b(m,"div.dgrid-preload");s.previous=r;p.rowIndex=this.minRowsPerPage;c?((s.next=c.next)&&p.offsetTop>=c.node.offsetTop?s.previous=c:(s.next=c,s.previous=c.previous),s.previous.next=s,s.next.previous=s):this.preload=s;var q=b(p,"-div.dgrid-loading");b(q,"div.dgrid-below").innerHTML=this.loadingMessage;d=f.mixin(this.get("queryOptions"),d,{start:0,count:this.minRowsPerPage},
"level"in a?{queryLevel:a.level}:null);this._trackError(function(){return l=a(d)});if("undefined"===typeof l)e();else return k.when(n.renderArray(l,p,d),function(a){return k.when("undefined"===typeof l.total?l.length:l.total,function(c){var e=a.length,g=p.parentNode,f=n.noDataNode;b(q,"!");"queryLevel"in d||(n._total=c);0===c&&g&&(f&&(b(f,"!"),delete n.noDataNode),n.noDataNode=f=b("div.dgrid-no-data"),g.insertBefore(f,n._getFirstRowSibling(g)),f.innerHTML=n.noDataMessage);for(f=g=0;f<e;f++)g+=n._calcRowHeight(a[f]);
e&&g&&(n.rowHeight=g/e);c-=e;s.count=c;p.rowIndex=e;c?p.style.height=Math.min(c*n.rowHeight,n.maxEmptySpace)+"px":(p.style.display="none",d.count++);n._previousScrollPosition&&(n.scrollTo(n._previousScrollPosition),delete n._previousScrollPosition);n._processScroll();n._refreshDeferred&&(n._refreshDeferred.resolve(l),delete n._refreshDeferred);return a},e)},e),l},refresh:function(a){var b=this,e=a&&a.keepScrollPosition,f;"undefined"===typeof e&&(e=this.keepScrollPosition);e&&(this._previousScrollPosition=
this.getScrollPosition());this.inherited(arguments);if(this.store)return e=this._refreshDeferred=new k,f=b.renderQuery(function(a){return b.store.query(b.query,a)}),"undefined"===typeof f&&e.reject(),e.then(function(a){b._refreshTimeout=setTimeout(function(){r.emit(b.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:b,results:a});b._refreshTimeout=null},0);delete b._refreshDeferred;return a},function(a){delete b._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);
this._processScroll()},_getFirstRowSibling:function(a){return a.lastChild},_calcRowHeight:function(a){var b=a.nextSibling;return b&&!/\bdgrid-preload\b/.test(b.className)?b.offsetTop-a.offsetTop:a.offsetHeight},lastScrollTop:0,_processScroll:function(a){function d(a,c,d,g){var f=m.farOffRemoval,l=a.node;if(c>2*f){for(var k,p=l[d],n=0,s=0,r=[];k=p;){var q=m._calcRowHeight(k);if(n+q+f>c||0>p.className.indexOf("dgrid-row")&&0>p.className.indexOf("dgrid-loading"))break;p=k[d];n+=q;s+=k.count||1;m.removeRow(k,
!0);r.push(k)}a.count+=s;g?(l.rowIndex-=s,e(a)):l.style.height=l.offsetHeight+n+"px";var u=b("div",r);setTimeout(function(){b(u,"!")},1)}}function e(a,b){a.node.style.height=Math.min(a.count*m.rowHeight,b?Infinity:m.maxEmptySpace)+"px"}function n(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);return a}var m=this,s=m.bodyNode;a=a&&a.scrollTop||this.getScrollPosition().y;var s=s.offsetHeight+a,p,c,l=m.preload,r=m.lastScrollTop,q=m.bufferRows*m.rowHeight,t=q-m.rowHeight,y,B,z,D=!0;for(m.lastScrollTop=
a;l&&!l.node.offsetWidth;)l=l.previous;for(;l&&l!=p;){p=m.preload;m.preload=l;c=l.node;var E=c.offsetTop;if(s+1+t<E)l=n(l,D=!1);else if(a-1-t>E+c.offsetHeight)l=n(l,D=!0);else{var A=((c.rowIndex?a-q:s)-E)/m.rowHeight,E=(s-a+2*q)/m.rowHeight,G=Math.max(Math.min((a-r)*m.rowHeight,m.maxRowsPerPage/2),m.maxRowsPerPage/-2),E=E+Math.min(Math.abs(G),10);0==c.rowIndex&&(A-=E);A=Math.max(A,0);10>A&&(0<A&&E+A<m.maxRowsPerPage)&&(E+=Math.max(0,A),A=0);E=Math.min(Math.max(E,m.minRowsPerPage),m.maxRowsPerPage,
l.count);if(0==E)l=n(l,D);else{var E=Math.ceil(E),A=Math.min(Math.floor(A),l.count-E),C=f.mixin(m.get("queryOptions"),l.options);l.count-=E;var H=c,I,L=m.queryRowsOverlap;if(G=(0<c.rowIndex||c.offsetTop>a)&&l){var J=l.previous;J&&(d(J,a-(J.node.offsetTop+J.node.offsetHeight),"nextSibling"),0<A&&J.node==c.previousSibling?(A=Math.min(l.count,A),l.previous.count+=A,e(l.previous,!0),c.rowIndex+=A,L=0):E+=A,l.count-=A);C.start=c.rowIndex-L;C.count=Math.min(E+L,m.maxRowsPerPage);c.rowIndex=C.start+C.count}else l.next&&
(d(l.next,l.next.node.offsetTop-s,"previousSibling",!0),H=c.nextSibling,H==l.next.node?(l.next.count+=l.count-A,l.next.node.rowIndex=A+E,e(l.next),l.count=A,L=0):I=!0),C.start=l.count,C.count=Math.min(E+L,m.maxRowsPerPage);I&&(H&&H.offsetWidth)&&(I=H.offsetTop);e(l);"level"in l.query&&(C.queryLevel=l.query.level);if("queryLevel"in C||!(C.start>m._total||0>C.count)){c=b(H,"-div.dgrid-loading[style\x3dheight:"+E*m.rowHeight+"px]");b(c,"div.dgrid-"+(G?"below":"above")).innerHTML=m.loadingMessage;c.count=
E;var F=l.query(C);if(void 0===m._trackError(function(){return F})){b(c,"!");return}(function(a,c,d,g){z=k.when(m.renderArray(g,a,C),function(f){B=g;H=a.nextSibling;b(a,"!");if(d&&H&&H.offsetWidth){var l=m.getScrollPosition();m.scrollTo({x:l.x,y:l.y+H.offsetTop-d,preserveMomentum:!0})}k.when(g.total||g.length,function(a){"queryLevel"in C||(m._total=a);c&&(c.count=a-c.node.rowIndex,0===c.count&&C.count++,e(c))});m._processScroll();return f},function(c){b(a,"!");throw c;})}).call(this,c,G,I,F);l=l.previous}}}}if(z&&
(y=this._refreshDeferred))delete this._refreshDeferred,k.when(z,function(){y.resolve(B)})},removeRow:function(a,b){if(a){var e=a.previousSibling,f=a.nextSibling,e=e&&(null!=e.observerIndex?e.observerIndex:e.previousObserverIndex),k=f&&(null!=f.observerIndex?f.observerIndex:f.nextObserverIndex),f=a.observerIndex;a.observerIndex=void 0;b&&(a.nextObserverIndex=k,a.previousObserverIndex=e);if(this.cleanEmptyObservers&&(-1<f&&f!==e&&f!==k)&&(e=this.observers,k=e[f])){if(!b)for(var s=k.rows,p=0;p<s.length;p++)if(s[p]!=
a&&n.isDescendant(s[p],this.domNode))return this.inherited(arguments);k.cancel();this._numObservers--;e[f]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),function(q,e,a,f,k,n,r){function t(a){return a}function b(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;a.grid=this;k.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,
bubbles:!0})&&console.error(a)}return e("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};n.before(this,"configStructure",a.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&
this._notifyHandle.remove()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_updateNotifyHandle:function(b){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);b&&("function"===typeof b.notify&&this.shouldObserveStore)&&(this._notifyHandle=n.after(b,"notify",a.hitch(this,"_onNotify"),!0),b=this.get("sort"),(!b||!b.length)&&console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},
_setStore:function(a,b,e){this._updateNotifyHandle(a);this.store=a;this.dirty={};this.set("query",b,e)},_setQuery:function(a,b){var e=b&&b.sort;this.query=void 0!==a?a:this.query;this.queryOptions=b||this.queryOptions;this._started&&(e?this.set("sort",e):this.refresh())},setStore:function(a,b,e){q.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",a,b,e)},setQuery:function(a,b){q.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",
a,b)},_getQueryOptions:function(){var b=a.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)b.sort=this._sort;return b},_getQuery:function(){var b=this.query;return"object"==typeof b&&null!=b?a.delegate(b,{}):b},_setSort:function(a,b){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(a,b){this.inherited(arguments);a&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var a=this.inherited(arguments);
this.store||(this.noDataNode=r(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return a},renderArray:function(){var a=this,b=this.inherited(arguments);this.store||f.when(b,function(b){b.length&&a.noDataNode&&r(a.noDataNode,"!")});return b},insertRow:function(b,d,e,f,k){var n=this.store,p=this.dirty,n=n&&n.getIdentity(b),c;n in p&&!(n in this._updating)&&(c=p[n]);c&&(b=a.delegate(b,c));return this.inherited(arguments)},updateDirty:function(a,b,e){var f=this.dirty,
k=f[a];k||(k=f[a]={});k[b]=e},setDirty:function(a,b,e){q.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(a,b,e)},save:function(){function a(c,g){return function(a){var l=b._columnsWithSet,m=b._updating,p,n;if("function"===typeof a.set)a.set(g);else for(p in g)a[p]=g[p];for(p in l)n=l[p].set(a),void 0!==n&&(a[p]=n);m[c]=!0;return f.when(e.put(a),function(){delete k[c];delete m[c]})}}var b=this,e=this.store,k=this.dirty,m=new f,n=m.promise,p=function(a){var c;return b.getBeforePut||
!(c=b.row(a).data)?function(){return e.get(a)}:function(){return c}},c;for(c in k)var l=a(c,k[c]),n=n.then(p(c)).then(l);m.resolve();return n},revert:function(){this.dirty={};this.refresh()},_trackError:function(e){var d;"string"==typeof e&&(e=a.hitch(this,e));try{d=e()}catch(h){b.call(this,h)}return f.when(d,t,a.hitch(this,b))},newRow:function(){var a=this.inherited(arguments);this.noDataNode&&(r(this.noDataNode,"!"),delete this.noDataNode);return a},removeRow:function(a,b){var e={element:a};!b&&
(this.noDataMessage&&this.up(e).element===a&&this.down(e).element===a)&&(this.noDataNode=r(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),function(q,e,a,f,k,n,r,t,b){function g(a,b){for(var d=a.unselectable=b?"on":
"",e=a.getElementsByTagName("*"),f=e.length;--f;)"INPUT"===e[f].tagName||"TEXTAREA"===e[f].tagName||(e[f].unselectable=d)}function d(a,b){var d=a.bodyNode,e=b?"text":21>k("ff")?"-moz-none":"none";u&&"msUserSelect"!==u?d.style[u]=e:k("dom-selectstart")?!b&&!a._selectstartHandle?a._selectstartHandle=f(d,"selectstart",function(a){var b=a.target&&a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):b&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):(g(d,
!b),!b&&!a._unselectableHandle?a._unselectableHandle=n.after(a,"renderRow",function(a){g(a,!0);return a}):b&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle))}k.add("dom-comparedocumentposition",function(a,b,d){return!!d.compareDocumentPosition});k.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});k.add("css-user-select",function(a,b,d){a=d.style;b=["Khtml","O","ms","Moz","Webkit"];d=b.length;var e="userSelect";do if("undefined"!==
typeof a[e])return e;while(d--&&(e=b[d]+"UserSelect"));return!1});k.add("dom-selectstart","undefined"!==typeof document.onselectstart);var h=k("mac")?"metaKey":"ctrlKey",u=k("css-user-select"),m=(r=k("pointer"))&&"MS"===r.slice(0,2),s=r?r+(m?"Down":"down"):"mousedown",p=r?r+(m?"Up":"up"):"mouseup";return e("dgrid.Selection",null,{selectionDelegate:".dgrid-row",selectionEvents:s+","+p+",dgrid-cellfocusin",selectionTouchEvents:k("touch")?t.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},
selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},
_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){q.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?d(this,a):d(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,
b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&!("dgrid-cellfocusin"===a.type&&"mousedown"===a.parentType||a.type===p&&b!=this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===s&&this.isSelected(b))this._waitForMouseUp=b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,b){var d=a.keyCode?a.ctrlKey:a[h];this._lastSelected===
b?this.select(b,null,!d||!this.isSelected(b)):(this.clearSelection(),this.select(b),this._lastSelected=b)},_multipleSelectionHandler:function(a,b){var d=this._lastSelected,e=a.keyCode?a.ctrlKey:a[h],f;a.shiftKey||(f=e?null:!0,d=null);this.select(b,d,f);d||(this._lastSelected=b)},_extendedSelectionHandler:function(a,b){(2===a.button?!this.isSelected(b):!(a.keyCode?a.ctrlKey:a[h]))&&this.clearSelection(null,!0);this._multipleSelectionHandler(a,b)},_toggleSelectionHandler:function(a,b){this.select(b,
null,null)},_initSelectionEvents:function(){var a=this,b=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};k("touch")&&!k("pointer")&&this.selectionTouchEvents?(f(b,t.selector(d,this.selectionTouchEvents),function(b){a._handleSelect(b,this);a._ignoreMouseSelect=this}),f(b,f.selector(d,this.selectionEvents),function(b){a._ignoreMouseSelect!==this?a._handleSelect(b,this):b.type===p&&(a._ignoreMouseSelect=null)})):f(b,f.selector(d,this.selectionEvents),function(b){a._handleSelect(b,
this)});this.addKeyHandler&&this.addKeyHandler(32,function(b){a._handleSelect(b,b.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[h]&&(65==b.keyCode&&!/\bdgrid-input\b/.test(b.target.className))&&(b.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&n.after(this,"_setStore",function(){a._updateDeselectionAspect()});this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(c,d,e){c=d||c&&c[b.idProperty||"id"];if(null!=c&&(d=(c=
b.row(c))&&b.selection[c.id]))b[e](c,null,d)}var b=this,d=this.store,e,f;this._removeDeselectSignals&&this._removeDeselectSignals();d&&d.notify?(e=n.before(d,"notify",function(b,d){b||a(b,d,"deselect")}),f=n.after(d,"notify",function(b,d){a(b,d,"select")},!0),this._removeDeselectSignals=function(){e.remove();f.remove()}):(e=n.before(this,"removeRow",function(a,b){var c;b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=function(){e.remove()})},allowSelect:function(a){return!0},
_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],d=this._selectionTriggerEvent,e;e={bubbles:!0,grid:this};d&&(e.parentType=d.type);e[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];f.emit(this.contentNode,"dgrid-"+a,e)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},_select:function(a,d,e){var f,g,h;"undefined"===typeof e&&(e=!0);a.element||(a=this.row(a));if(!1===e||this.allowSelect(a))if(f=
this.selection,g=!!f[a.id],null===e&&(e=!g),h=a.element,!e&&!this.allSelected?delete this.selection[a.id]:f[a.id]=e,h&&(e?b(h,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):b(h,"!dgrid-selected!ui-state-active")),e!==g&&h&&this._selectionEventQueues[(e?"":"de")+"select"].push(a),d)if(d.element||(d=this.row(d)),d){if(d=d.element){f=this._determineSelectionDirection(h,d);f||(d=document.getElementById(d.id),f=this._determineSelectionDirection(h,d));for(;a.element!=d&&(a=this[f](a));)this._select(a,
null,e)}}else this._lastSelected=h,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:k("dom-comparedocumentposition")?function(a,b){var d=b.compareDocumentPosition(a);return d&1?!1:2===d?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>
a.sourceIndex?"down":"up"},select:function(a,b,d){this._select(a,b,d);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var d in this.selection)a!==d&&this._select(d,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===
typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var b=this,d=this.inherited(arguments);a.when(d,function(a){var d=b.selection,e,f,g;for(e=0;e<a.length;e++)f=b.row(a[e]),(g=f.id in d?d[f.id]:b.allSelected)&&b._select(f,null,g);b._fireSelectionEvents()});
return d}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(q,e,a,f,k,n,r,t){function b(a){a.preventDefault()}var g={checkbox:1,radio:1,button:1},d=/\bdgrid-cell\b/,h=/\bdgrid-row\b/,u=q("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=f.mixin({},u.defaultKeyMap));
this.headerKeyMap||(this.headerKeyMap=f.mixin({},u.defaultHeaderKeyMap))},postCreate:function(){function b(a){var c=a.target;return c.type&&(!g[c.type]||32==a.keyCode)}function c(g){function l(){f._focusedHeaderNode&&(f._focusedHeaderNode.tabIndex=-1);if(f.showHeader){if(k)for(var a=0,b,c=f.headerNode.getElementsByTagName("th");b=c[a];++a){if(m.test(b.className)){f._focusedHeaderNode=n=b;break}}else f._focusedHeaderNode=n=f.headerNode;n&&(n.tabIndex=f.tabIndex)}}var k=f.cellNavigation,m=k?d:h,p=g===
f.headerNode,n=g;p?(l(),e.after(f,"renderHeader",l,!0)):e.after(f,"renderArray",function(a){return t.when(a,function(a){var b=f._focusedNode||n;if(m.test(b.className)&&r.contains(g,b))return a;for(var c=0,d=g.getElementsByTagName("*"),e;e=d[c];++c)if(m.test(e.className)){b=f._focusedNode=e;break}b.tabIndex=f.tabIndex;return a})});f._listeners.push(a(g,"mousedown",function(a){b(a)||f._focusOnNode(a.target,p,a)}));f._listeners.push(a(g,"keydown",function(a){if(!a.metaKey&&!a.altKey){var c=f[p?"headerKeyMap":
"keyMap"][a.keyCode];c&&!b(a)&&c.call(f,a)}}))}this.inherited(arguments);var f=this;this.tabableHeader&&(c(this.headerNode),a(this.headerNode,"dgrid-cellfocusin",function(){f.scrollTo({x:this.scrollLeft})}));c(this.contentNode);this._debouncedEnsureRowScroll=r.debounce(this._ensureRowScroll,this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);var b=this,c=document.activeElement===this._focusedNode,d=this[this.cellNavigation?"cell":"row"](this._focusedNode),e=d.row||
d,f;a=a.element||a;if(a===e.element){f=this.down(e,!0);if(!f||f.element===a)f=this.up(e,!0);this._removedFocus={active:c,rowId:e.id,columnId:d.column&&d.column.id,siblingId:!f||f.element===a?void 0:f.id};setTimeout(function(){b._removedFocus&&b._restoreFocus(e.id)},0);this._focusedNode=null}this.inherited(arguments)},insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=this._removedFocus,
c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(n(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return e.after(this[c?"headerKeyMap":
"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(b,c,e){var g="_focused"+(c?"Header":"")+"Node",l=this[g],m=this.cellNavigation?"cell":"row",p=this[m](b),s,r,q,u,t;if(b=p&&p.element){if(this.cellNavigation){s=b.getElementsByTagName("input");t=0;for(q=s.length;t<q;t++)if(r=
s[t],(-1!=r.tabIndex||"_dgridLastValue"in r)&&!r.disabled){8>k("ie")&&(r.style.position="relative");r.focus();8>k("ie")&&(r.style.position="");u=!0;break}}null!==e&&(e=f.mixin({grid:this},e),e.type&&(e.parentType=e.type),e.bubbles||(e.bubbles=!0));l&&(n(l,"!dgrid-focus[!tabIndex]"),8>k("ie")&&(l.style.position=""),e&&(e[m]=this[m](l),a.emit(l,"dgrid-cellfocusout",e)));l=this[g]=b;e&&(e[m]=p);g=this.cellNavigation?d:h;!u&&g.test(b.className)&&(8>k("ie")&&(b.style.position="relative"),b.tabIndex=this.tabIndex,
b.focus());n(b,".dgrid-focus");e&&a.emit(l,"dgrid-cellfocusin",e);this.cellNavigation&&((this.columnSets||1<this.subRows.length)&&!c)&&this._debouncedEnsureRowScroll(p.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?this._focusOnNode(a,!1):this.contentNode.focus()}}),m=u.moveFocusVertical=function(a,b){var c=this.cellNavigation,d=this[c?"cell":"row"](a),d=c&&d.column.id,e=this.down(this._focusedNode,b,!0);c&&(e=this.cell(e,
d));this._focusOnNode(e,!1,a);a.preventDefault()};q=u.moveFocusUp=function(a){m.call(this,a,-1)};var s=u.moveFocusDown=function(a){m.call(this,a,1)},p=u.moveFocusPageUp=function(a){m.call(this,a,-this.pageSkip)},c=u.moveFocusPageDown=function(a){m.call(this,a,this.pageSkip)},l=u.moveFocusHorizontal=function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},w=u.moveFocusLeft=function(a){l.call(this,a,-1)},
v=u.moveFocusRight=function(a){l.call(this,a,1)},x=u.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},y=u.moveHeaderFocusHome=function(a){x.call(this,a,!0)},B=u.moveFocusEnd=function(a,b){var c=this,d=this.cellNavigation,g=this.contentNode,l=g.scrollTop+(b?0:g.scrollHeight),g=g[b?"firstChild":"lastChild"],h=-1<g.className.indexOf("dgrid-preload"),m=h?g[(b?"next":"previous")+"Sibling"]:
g,p=m.offsetTop+(b?0:m.offsetHeight),n;if(h){for(;m&&0>m.className.indexOf("dgrid-row");)m=m[(b?"next":"previous")+"Sibling"];if(!m)return}!h||1>g.offsetHeight?(d&&(m=this.cell(m,this.cell(a).column.id)),this._focusOnNode(m,!1,a)):(k("dom-addeventlistener")||(a=f.mixin({},a)),n=e.after(this,"renderArray",function(e){n.remove();return t.when(e,function(e){e=e[b?0:e.length-1];d&&(e=c.cell(e,c.cell(a).column.id));c._focusOnNode(e,!1,a)})}));l===p&&a.preventDefault()},z=u.moveFocusHome=function(a){B.call(this,
a,!0)};u.defaultKeyMap={32:b,33:p,34:c,35:B,36:z,37:w,38:q,39:v,40:s};u.defaultHeaderKeyMap={32:b,35:x,36:y,37:w,39:v};return u})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(q,e,a,f,k){function n(a){for(;a.childNodes[0]&&1==a.childNodes[0].nodeType;)a=a.childNodes[0];return a}function r(a,e){"string"==typeof a?(a=f.toDom(a,e&&e.ownerDocument),11==a.nodeType&&(a=a.childNodes[0])):1==a.nodeType&&a.parentNode&&
(a=a.cloneNode(!1));return a}var t=q.NodeList;e.extend(t,{_placeMultiple:function(a,e){for(var d="string"==typeof a||a.nodeType?q(a):a,h=[],k=0;k<d.length;k++)for(var m=d[k],n=this.length,p=n-1,c;c=this[p];p--)0<k&&(c=this._cloneNode(c),h.unshift(c)),p==n-1?f.place(c,m,e):m.parentNode.insertBefore(c,m),m=c;h.length&&(h.unshift(0),h.unshift(this.length-1),Array.prototype.splice.apply(this,h));return this},innerHTML:function(a){return arguments.length?this.addContent(a,"only"):this[0].innerHTML},text:function(a){if(arguments.length){for(var e=
0,d;d=this[e];e++)1==d.nodeType&&k.set(d,"textContent",a);return this}for(var f="",e=0;d=this[e];e++)f+=k.get(d,"textContent");return f},val:function(b){if(arguments.length){for(var f=e.isArray(b),d=0,h;h=this[d];d++){var k=h.nodeName.toUpperCase(),m=h.type,n=f?b[d]:b;if("SELECT"==k){k=h.options;for(m=0;m<k.length;m++){var p=k[m];p.selected=h.multiple?-1!=a.indexOf(b,p.value):p.value==n}}else"checkbox"==m||"radio"==m?h.checked=h.value==n:h.value=n}return this}if((h=this[0])&&1==h.nodeType){b=h.value||
"";if("SELECT"==h.nodeName.toUpperCase()&&h.multiple){b=[];k=h.options;for(m=0;m<k.length;m++)p=k[m],p.selected&&b.push(p.value);b.length||(b=null)}return b}},append:function(a){return this.addContent(a,"last")},appendTo:function(a){return this._placeMultiple(a,"last")},prepend:function(a){return this.addContent(a,"first")},prependTo:function(a){return this._placeMultiple(a,"first")},after:function(a){return this.addContent(a,"after")},insertAfter:function(a){return this._placeMultiple(a,"after")},
before:function(a){return this.addContent(a,"before")},insertBefore:function(a){return this._placeMultiple(a,"before")},remove:t.prototype.orphan,wrap:function(a){if(this[0]){a=r(a,this[0]);for(var e=0,d;d=this[e];e++){var f=this._cloneNode(a);d.parentNode&&d.parentNode.replaceChild(f,d);n(f).appendChild(d)}}return this},wrapAll:function(a){if(this[0]){a=r(a,this[0]);this[0].parentNode.replaceChild(a,this[0]);a=n(a);for(var e=0,d;d=this[e];e++)a.appendChild(d)}return this},wrapInner:function(a){if(this[0]){a=
r(a,this[0]);for(var f=0;f<this.length;f++){var d=this._cloneNode(a);this._wrap(e._toArray(this[f].childNodes),null,this._NodeListCtor).wrapAll(d)}}return this},replaceWith:function(a){a=this._normalize(a,this[0]);for(var e=0,d;d=this[e];e++)this._place(a,d,"before",0<e),d.parentNode.removeChild(d);return this},replaceAll:function(a){a=q(a);for(var e=this._normalize(this,this[0]),d=0,f;f=a[d];d++)this._place(e,f,"before",0<d),f.parentNode.removeChild(f);return this},clone:function(){for(var a=[],
e=0;e<this.length;e++)a.push(this._cloneNode(this[e]));return this._wrap(a,this,this._NodeListCtor)}});t.prototype.html||(t.prototype.html=t.prototype.innerHTML);return t})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w){function v(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(t.hitch(this,a,b))}}var x=e("dijit.form._SelectMenu",u,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(b(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
t.isArray(b)&&(b=b[b.length-1]);b&&q.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});k=e("dijit.form.Select"+(g("dojo-bidi")?"_NoBidi":""),[d,h,c],{baseClass:"dijitSelect dijitValidationTextBox",templateString:w,_buttonInputDisabled:g("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new x({id:this.id+"_menu",parentWidget:this});f.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(!a.value&&!a.label)return new s({ownerDocument:this.ownerDocument});var b=t.hitch(this,"_setValueAttr",a);a=new m({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,
"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return!this.dropDown?[]:this.dropDown.getChildren()},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},focusChild:function(a){a&&
this.set("value",a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=l.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{q.forEach(this._getChildren(),
function(a){a.destroyRecursive()});var b=new m({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(b){this.inherited(arguments);a.set(this.valueNode,"value",this.get("value"));this._refreshState()},
_setNameAttr:"valueNode",_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?p.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):p.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);p.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=n.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(b(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[r.LEFT_ARROW];delete a[r.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
f.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);p.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){p.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
g("dojo-bidi")&&(k=e("dijit.form.Select",k,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));k._Menu=x;k.prototype._onContainerKeydown=v("_onContainerKeydown");k.prototype._onContainerKeypress=v("_onContainerKeypress");return k})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u){return k("dijit.form._FormSelectWidget",u,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var d=this.options||[];if(null==a)return d;if(b.isArray(a))return q.map(a,"return this.getOptions(item);",this);b.isString(a)&&(a={value:a});b.isObject(a)&&(q.some(d,function(b,c){for(var d in a)if(!(d in b)||b[d]!=a[d])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<d.length?d[a]:null},addOption:function(a){q.forEach(b.isArray(a)?a:[a],function(a){a&&b.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(b.isArray(a)?
a:[a]);q.forEach(a,function(a){a&&(this.options=q.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){q.forEach(b.isArray(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,d){t.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,d)},_deprecatedSetStore:function(g,k,p){var c=this.store;p=p||{};if(c!==g){for(var l;l=this._notifyConnections.pop();)l.remove();g.get||(b.mixin(g,{_oldAPI:!0,get:function(a){var b=new e;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,c){var d=new e(function(){f.abort&&f.abort()});d.total=new e;var f=this.fetch(b.mixin({query:a,onBegin:function(a){d.total.resolve(a)},
onComplete:function(a){d.resolve(a)},onError:function(a){d.reject(a)}},c));return new h(d)}}),g.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[a.after(g,"onNew",b.hitch(this,"_onNewItem"),!0),a.after(g,"onDelete",b.hitch(this,"_onDeleteItem"),!0),a.after(g,"onSet",b.hitch(this,"_onSetItem"),!0)]));this._set("store",g)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);p.query&&this._set("query",p.query);p.queryOptions&&this._set("queryOptions",p.queryOptions);g&&g.query&&(this._loadingStore=!0,this.onLoadDeferred=new e,this._queryRes=g.query(this.query,this.queryOptions),d(this._queryRes,b.hitch(this,function(a){if(this.sortByLabel&&!p.sort&&a.length)if(g.getValue)a.sort(f.createSortFunction([{attribute:g.getLabelAttributes(a[0])[0]}],g));else{var c=this.labelAttr;a.sort(function(a,b){return a[c]>b[c]?1:b[c]>
a[c]?-1:0})}p.onFetch&&(a=p.onFetch.call(this,a,p));q.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(b.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:k);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)}));return c},_setValueAttr:function(a,d){this._onChangeActive||(d=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=b.isArray(a)?q.map(a,function(a){return b.isObject(a)?a:{value:a}}):b.isObject(a)?[a]:[{value:a}];a=q.filter(this.getOptions(a),function(a){return a&&a.value});var e=this.getOptions()||[];if(!this.multiple&&(!a[0]||!a[0].value)&&e.length)a[0]=e[0];q.forEach(e,
function(b){b.selected=q.some(a,function(a){return a.value===b.value})});e=q.map(a,function(a){return a.value});if(!("undefined"==typeof e||"undefined"==typeof e[0])){var c=q.map(a,function(a){return a.label});this._setDisplay(this.multiple?c:c[0]);this.inherited(arguments,[this.multiple?e:e[0],d]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=q.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?a:a[0]},
_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(q.forEach(this._getChildren(),function(a){a.destroyRecursive()}),q.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;q.forEach(this._getChildren(),function(d){var c=q.some(a,function(a){return d.option&&
a===d.option.value});c&&!b.multiple&&(b.focusedChild=d);r.toggle(d.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),c);d.domNode.setAttribute("aria-selected",c?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=q.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?q.map(q.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){(!b||!b.parent)&&this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,d=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:d?b.getIdentity(a):null,label:d,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);n.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?g("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+t._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);a.after(this,"onChange",b.hitch(this,"_updateSelection"));var d=this.store;if(d&&(d.getIdentity||d.getFeatures()["dojo.data.api.Identity"]))this.store=null,this._deprecatedSetStore(d,this._oValue,
{query:this.query,queryOptions:this.queryOptions});this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(q){var e={};q.setObject("dojo.data.util.sorter",e);e.basicComparator=function(a,e){var k=-1;null===a&&(a=void 0);null===e&&(e=void 0);if(a==e)k=0;else if(a>e||null==a)k=1;return k};e.createSortFunction=function(a,f){function k(a,b,d,e){return function(c,f){var g=e.getValue(c,a),h=e.getValue(f,
a);return b*d(g,h)}}for(var n=[],r,q=f.comparatorMap,b=e.basicComparator,g=0;g<a.length;g++){r=a[g];var d=r.attribute;if(d){r=r.descending?-1:1;var h=b;q&&("string"!==typeof d&&"toString"in d&&(d=d.toString()),h=q[d]||b);n.push(k(d,r,h,f))}}return function(a,b){for(var d=0;d<n.length;){var e=n[d++](a,b);if(0!==e)return e}return 0}};return e})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p){return q("dijit._HasDropDown",p,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(a){!this.disabled&&!this.readOnly&&("MSPointerDown"!=a.type&&"pointerdown"!=a.type&&a.preventDefault(),this.own(d.once(this.ownerDocument,h.release,g.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},
_onDropDownMouseUp:function(a){var b=this.dropDown,d=!1;if(a&&this._opened){var e=n.position(this._buttonNode,!0);if(!(a.pageX>=e.x&&a.pageX<=e.x+e.w)||!(a.pageY>=e.y&&a.pageY<=e.y+e.h)){for(e=a.target;e&&!d;)k.contains(e,"dijitPopup")?d=!0:e=e.parentNode;if(d){e=a.target;if(b.onItemClick){for(var f;e&&!(f=u.byNode(e));)e=e.parentNode;if(f&&f.onClick&&f.getParent)f.getParent().onItemClick(f,a)}return}}}if(this._opened){if(b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering))this._focusDropDownTimer=
this.defer(function(){b.focus();delete this._focusDropDownTimer})}else this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",
left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";k.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.own(d(this._buttonNode,h.press,g.hitch(this,"_onDropDownMouseDown")),d(this._buttonNode,"click",g.hitch(this,"_onDropDownClick")),d(a,"keydown",g.hitch(this,"_onKey")),d(a,"keyup",g.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);
this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var d=this.dropDown,e=a.target;if(d&&(this._opened&&d.handleKey)&&!1===d.handleKey(a))a.stopPropagation(),a.preventDefault();else if(d&&this._opened&&a.keyCode==b.ESCAPE)this.closeDropDown(),a.stopPropagation(),a.preventDefault();else if(!this._opened&&(a.keyCode==b.DOWN_ARROW||(a.keyCode==b.ENTER||a.keyCode==b.SPACE&&(!this._searchTimer||
a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(e.tagName||"").toLowerCase()||e.type&&"text"!==e.type.toLowerCase())))this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault()}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(g.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=
new e,b=g.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){!this.disabled&&!this.readOnly&&(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,b=a.domNode,d=this._aroundNode||this.domNode,e=this,h=s.open({parent:this,popup:a,around:d,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){e.closeDropDown(!0)},onCancel:function(){e.closeDropDown(!0)},
onClose:function(){f.set(e._popupStateNode,"popupActive",!1);k.remove(e._popupStateNode,"dijitHasDropDownOpen");e._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&d.offsetWidth>a._popupWrapper.offsetWidth){var d=d.offsetWidth-a._popupWrapper.offsetWidth,m={w:a.domNode.offsetWidth+d};g.isFunction(a.resize)?a.resize(m):n.setMarginBox(b,m);"R"==h.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-d+"px")}f.set(this._popupStateNode,"popupActive","true");k.add(this._popupStateNode,
"dijitHasDropDownOpen");this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"!==b.getAttribute("role")&&!b.getAttribute("aria-labelledby")&&b.setAttribute("aria-labelledby",this.id);return h},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),
s.close(this.dropDown),this._opened=!1)}})})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(q,e,a,f){return q("dijit.DropDownMenu",f,{templateString:a,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(a){this._moveToPopup(a);a.stopPropagation();a.preventDefault()},_onLeftArrow:function(a){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();
else this.onCancel(!1);else a.stopPropagation(),a.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s){return e("dijit._MenuBase",[h,s,m,u],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),
this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){k.toggle(this.domNode,"dijitMenuActive",a);k.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(a){var b=d.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:
n.hitch(this,"childSelector");this.own(t(this.containerNode,t.selector(b,r.enter),function(){a.onItemHover(d.byNode(this))}),t(this.containerNode,t.selector(b,r.leave),function(){a.onItemUnhover(d.byNode(this))}),t(this.containerNode,t.selector(b,g),function(b){a.onItemClick(d.byNode(this),b);b.stopPropagation()}),t(this.containerNode,t.selector(b,"focusin"),function(){a._onItemFocus(d.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,d,e){this.inherited(arguments);if(a&&(-1==
e||a.popup&&1==e))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},
onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==
a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&
(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var d=/^key/.test(b._origType||b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,d)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,
b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var d=a.popup;d.parentMenu=this;this.own(this._mouseoverHandle=t.once(d.domNode,"mouseover",n.hitch(this,"_onPopupHover")));var e=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&e.focusChild(a);e._cleanUp()},onExecute:n.hitch(this,"_cleanUp",!0),onClose:function(){e._mouseoverHandle&&(e._mouseoverHandle.remove(),
delete e._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(f.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&
this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),function(q,
e,a,f,k,n,r,t,b,g){return e("dijit._KeyNavContainer",[b,g,t],{connectKeyNavHandlers:function(a,b){var e=this._keyNavCodes={},f=n.hitch(this,"focusPrev"),g=n.hitch(this,"focusNext");q.forEach(a,function(a){e[a]=f});q.forEach(b,function(a){e[a]=g});e[k.HOME]=n.hitch(this,"focusFirstChild");e[k.END]=n.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){f.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);q.forEach(this.getChildren(),
n.hitch(this,"_startupChild"))},addChild:function(a,b){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=
r.byNode(a))&&a.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(q,e,a,f,k,n,r,t){return e("dijit._KeyNavMixin",t,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);a.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var b=this._keyNavCodes={};b[f.HOME]=k.hitch(this,"focusFirstChild");b[f.END]=k.hitch(this,
"focusLastChild");b[this.isLeftToRight()?f.LEFT_ARROW:f.RIGHT_ARROW]=k.hitch(this,"_onLeftArrow");b[this.isLeftToRight()?f.RIGHT_ARROW:f.LEFT_ARROW]=k.hitch(this,"_onRightArrow");b[f.UP_ARROW]=k.hitch(this,"_onUpArrow");b[f.DOWN_ARROW]=k.hitch(this,"_onDownArrow")}var e=this,b="string"==typeof this.childSelector?this.childSelector:k.hitch(this,"childSelector");this.own(n(this.domNode,"keypress",k.hitch(this,"_onContainerKeypress")),n(this.domNode,"keydown",k.hitch(this,"_onContainerKeydown")),n(this.domNode,
"focus",k.hitch(this,"_onContainerFocus")),n(this.containerNode,n.selector(b,"focusin"),function(a){e._onChildFocus(r.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,e){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),a.set("tabIndex",this.tabIndex),a.focus(e?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){a.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(b){a.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,e,d,f){a&&this.focusChild(a)},_keyboardSearchCompare:function(a,e){var d=a.domNode,d=(a.label||(d.focusNode?
d.focusNode.label:"")||d.innerText||d.textContent||"").replace(/^\s+/,"").substr(0,e.length).toLowerCase();return e.length&&d==e?-1:0},_isFormElement:function(a){return"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(a){if(!this._isFormElement(document.activeElement)){var e=this._keyNavCodes[a.keyCode];e?(e(a,this.focusedChild),a.stopPropagation(),a.preventDefault(),this._searchString=""):a.keyCode==f.SPACE&&(this._searchTimer&&
!a.ctrlKey&&!a.altKey&&!a.metaKey)&&(a.stopImmediatePropagation(),a.preventDefault(),this._keyboardSearch(a," "))}},_onContainerKeypress:function(a){if(!this._isFormElement(document.activeElement)&&!(a.charCode<=f.SPACE||a.ctrlKey||a.altKey||a.metaKey))a.preventDefault(),a.stopPropagation(),this._keyboardSearch(a,String.fromCharCode(a.charCode).toLowerCase())},_keyboardSearch:function(a,e){var d=null,f,n=0;k.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=e;
var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;f=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var b=this.focusedChild||null;if(1==a||!b)if(b=this._getNextFocusableChild(b,1),!b)return;a=b;do{var k=this._keyboardSearchCompare(b,f);k&&0==n++&&(d=b);if(-1==k){n=-1;break}b=this._getNextFocusableChild(b,1)}while(b!=a)})();this.onKeyboardSearch(d,a,f,n)},_onChildBlur:function(){},
_getNextFocusableChild:function(a,e){var d=a;do{if(a)a=this._getNext(a,e);else if(a=this[0<e?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=d&&a.isFocusable())return a}while(a!=d);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(a,e){if(a)for(a=a.domNode;a;)if((a=a[0>e?"previousSibling":"nextSibling"])&&"getAttribute"in a){var d=r.byNode(a);if(d)return d}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h){r=q("dijit.MenuItem"+(n("dojo-bidi")?"_NoBidi":""),[t,b,g,d],{templateString:h,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var b="",d;d=a.search(/{\S}/);if(0<=d){var b=a.charAt(d+1),e=a.substr(0,d);a=a.substr(d+3);d=e+b+a;a=e+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else d=a;this.domNode.setAttribute("aria-label",d+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){a&&!("label"in this.params)&&this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);a.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&a.set(this.accelKeyNode,"id",this.id+"_accel");e.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==n("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(a){}},_setSelected:function(a){f.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){k.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){k.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(b){this.accelKeyNode&&(this.accelKeyNode.style.display=
b?"":"none",this.accelKeyNode.innerHTML=b,a.set(this.containerNode,"colSpan",b?"1":"2"));this._set("accelKey",b)}});n("dojo-bidi")&&(r=q("dijit.MenuItem",r,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return r})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(q,e,a,f,k,n){return q("dijit.MenuSeparator",
[a,f,k],{templateString:n,buildRendering:function(){this.inherited(arguments);e.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(q,e,a,f,k,n,r,t,b){f("dijit-legacy-requires")&&n(0,function(){q(["dijit/form/RadioButton"])});return e("dijit.form.CheckBox",
[r,t],{templateString:b,baseClass:"dijitCheckBox",_setValueAttr:function(a,b){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&this.set("checked",a,b)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&k("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},
_onBlur:function(){this.id&&k("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(q,e,a,f){return q("dijit.form.ToggleButton",[a,f],{baseClass:"dijitToggleButton",setChecked:function(a){e.deprecated("setChecked("+a+") is deprecated. Use set('checked',"+a+") instead.","","2.0");this.set("checked",a)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare",
"dojo/dom-attr"],function(q,e){return q("dijit.form._ToggleButtonMixin",null,{checked:!1,_aria_attr:"aria-pressed",_onClick:function(a){var e=this.checked;this._set("checked",!e);var k=this.inherited(arguments);this.set("checked",k?this.checked:e);return k},_setCheckedAttr:function(a,f){this._set("checked",a);var k=this.focusNode||this.domNode;this._created&&e.get(k,"checked")!=!!a&&e.set(k,"checked",!!a);k.setAttribute(this._aria_attr,String(a));this._handleOnChange(a,f)},postCreate:function(){this.inherited(arguments);
var a=this.focusNode||this.domNode;this.checked&&a.setAttribute("checked","checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(q,e){return q("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(a){this._set("readOnly",
a);e.set(this.focusNode,"readOnly",a)},_setLabelAttr:void 0,_getSubmitValue:function(a){return null==a||""===a?"on":a},_setValueAttr:function(a){a=this._getSubmitValue(a);this._set("value",a);e.set(this.focusNode,"value",a)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));e.set(this.focusNode,"value",this.value)},_onClick:function(a){return this.readOnly?(a.stopPropagation(),a.preventDefault(),!1):this.inherited(arguments)}})})},"builder/plugins/header/_build-generate_module":function(){define(["builder/plugins/header/Plugin",
"dojo/text!builder/plugins/header/Plugin.html","dojo/text!builder/plugins/header/css/style.css","dojo/i18n!builder/plugins/header/nls/strings"],function(){})},"builder/plugins/header/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/request dojo/request/script builder/portalUtils jimu/portalUrlUtils builder/tokenUtils jimu/utils builder/BasePlugin".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u){return q([u],{baseClass:"plugin-header",
postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this._isWebTier(window.portalUrl)&&(f.destroy(this.signOutItem),this.signOutItem=null);this.own(n.subscribe("disableWebTierUserSignOut"),e.hitch(this,function(){f.destroy(this.signOutItem);this.signOutItem=null}));window.isXT?(f.destroy(this.homeSection),f.setStyle(this.logoTitle,"cursor","pointer"),this._bindXtEvents()):(f.addClass(this.homeLabel,"dropdown"),this._bindIntegratedEvents(window.portalUrl));var a=
b.getPortal(window.portalUrl);a.haveSignIn()&&a.getUser().then(e.hitch(this,function(a){if(a=a&&(a.firstName||a.username))this.userNameNode.innerHTML=a}),e.hitch(this,function(a){console.error(a)}))},_isWebTier:function(b){var f=esri.id.findServerInfo(b);return f&&f.webTierAuth?!0:d.webTierPortalUrls&&0<d.webTierPortalUrls.length?a.some(d.webTierPortalUrls,e.hitch(this,function(a){g.isSamePortalUrl(b,a)})):!1},_bindXtEvents:function(){this.own(k(document.body,"click",e.hitch(this,function(a){a=a.target||
a.srcElement;a!==this.userSection&&!f.isDescendant(a,this.userSection)&&f.setStyle(this.userMenu,"display","none")})));this.own(n.subscribe("iframeClick",e.hitch(this,function(){f.setStyle(this.userMenu,"display","none")})));this.own(n.subscribe("userSignOut",e.hitch(this,function(){this.userNameNode.innerHTML=""})));this.own(n.subscribe("userSignIn",e.hitch(this,function(a){this.userNameNode.innerHTML=a.userId||""})));this.logoTitle.title=this.nls.backToHomePage||"";this.own(k(this.logoTitle,"click",
e.hitch(this,function(){this.pluginManager.getPluginByName("startup").switchToAppList()})));this.own(k(this.profileItem,"click",e.hitch(this,function(){var a=e.hitch(this,function(){window.location.href=g.getHomeUserUrl(window.portalUrl)});this._isInConfig()?n.publish("closeAppConfigPage",a):a()})));this.helpItem.href="help";this.signOutItem&&this.own(k(this.signOutItem,"click",e.hitch(this,function(){var a=e.hitch(this,function(){this.userNameNode.innerHTML="";d.signOutAll();var a=g.getOAuth2SignOutUrl(window.portalUrl),
a=g.setHttpsProtocol(a),b=function(){var a=h.getLocationUrlWithoutHashAndQueryParams(),a=h.url.addQueryParamToUrl(a,"action","setportalurl");window.location.href=a};this._getSigninInfo(window.portalUrl).then(function(c){if(c.portalUrl&&c.supportsOAuth)try{t.get(a).always(function(){b()})}catch(d){console.error(d),b()}else b()},function(){b()})});this._isInConfig()?n.publish("closeAppConfigPage",a):a()})))},_getSigninInfo:function(a){return r("/webappbuilder/rest/signininfo/getsignininfo",{handleAs:"json",
query:"portalUrl\x3d"+a,method:"GET"})},_bindIntegratedEvents:function(a){this.own(k(document.body,"click",e.hitch(this,function(a){a=a.target||a.srcElement;a!==this.homeLabel&&f.setStyle(this.homeMenu,"display","none");a!==this.userSection&&!f.isDescendant(a,this.userSection)&&f.setStyle(this.userMenu,"display","none")})));this.own(n.subscribe("iframeClick",e.hitch(this,function(){f.setStyle(this.homeMenu,"display","none");f.setStyle(this.userMenu,"display","none")})));this.own(k(this.homeLabel,
"click",e.hitch(this,function(){"none"===f.getStyle(this.homeMenu,"display")?f.setStyle(this.homeMenu,"display","block"):f.setStyle(this.homeMenu,"display","none")})));this.own(k(this.homeItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=g.getHomeIndexUrl(a)})})));this.own(k(this.galleryItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=g.getHomeGalleryUrl(a)})})));this.own(k(this.mapItem,"click",e.hitch(this,
function(){window.appConfig&&window.appConfig.map&&n.publish("closeAppConfigPage",function(){window.location.href=g.getHomeMapViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl,window.appConfig.map.itemId)})})));this.own(k(this.groupsItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=g.getHomeGroupsUrl(a)})})));this.own(k(this.contentItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=
g.getHomeMyContentUrl(a)})})));this.own(k(this.organizationItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=g.getHomeMyOrganizationUrl(a)})})));this.own(k(this.profileItem,"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){window.location.href=g.getHomeUserUrl(a)})})));0<=a.indexOf(".arcgis.com")?this.helpItem.href="http://doc.arcgis.com/en/web-appbuilder/":this.helpItem.href=g.getPortalHelpUrl(a);this.signOutItem&&this.own(k(this.signOutItem,
"click",e.hitch(this,function(){n.publish("closeAppConfigPage",function(){d.signOutAll();window.location.href=g.getPortalSignInUrlFromLocation()})})))},setAppName:function(a){this.appName.innerHTML=a||""},getAppName:function(){return this.appName.innerHTML||""},_isInConfig:function(){return"appconfig"===this.pluginManager.getPluginByName("startup").getCurrentView().label},_onUserSectionClicked:function(a){a=a.target||a.srcElement;var b=!0;if(f.isDescendant(a,this.userInfoDom)||a===this.userInfoDom)"none"===
f.getStyle(this.userMenu,"display")&&(b=!1);b?f.setStyle(this.userMenu,"display","none"):f.setStyle(this.userMenu,"display","block")}})})},"builder/plugins/map-config/_build-generate_module":function(){define(["builder/plugins/map-config/Plugin","dojo/text!builder/plugins/map-config/Plugin.html","dojo/text!builder/plugins/map-config/css/style.css","dojo/i18n!builder/plugins/map-config/nls/strings"],function(){})},"builder/plugins/map-config/Plugin":function(){define("dojo/_base/declare dojo/topic dojo/text!./Plugin.html dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/keys builder/BasePlugin builder/portalUtils jimu/portalUrlUtils jimu/dijit/Message jimu/utils jimu/dijit/Popup ./MapSelector ./CustomizeScale".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p){return q([b],{templateString:a,baseClass:"map-config",appConfig:null,map:null,item:null,widgetsConfigCache:null,postMixInProperties:function(){var a=f.clone(window.builderNls);this.nls=f.mixin(a,this.nls);this.nls.scaleDisabledTip2=this.nls.scaleDisabledTip.replace("${scaleTitle}",'"'+this.nls.scaleTitle+'"')},postCreate:function(){this.inherited(arguments);this._init()},startup:function(){this.inherited(arguments);this.appConfigPlugin=this.pluginManager.getPluginByName("app-config")},
destroy:function(){this.appConfigPlugin=null;this.inherited(arguments)},_init:function(){this.widgetsConfigCache={};this.own(e.subscribe("app/appConfigChanged",f.hitch(this,this.setAppConfig)));this.own(e.subscribe("app/appConfigLoaded",f.hitch(this,this.setAppConfig)));this.own(e.subscribe("app/mapLoaded",f.hitch(this,function(a){this._setMap(a)})));this.own(e.subscribe("app/mapChanged",f.hitch(this,function(a){this._setMap(a)})))},_setInitialExtent:function(){try{e.publish("mapOptionsChanged",{extent:this.map.extent.toJson()})}catch(a){console.error(a)}},
_blinkMapContainer:function(){var a=0,b=setInterval(f.hitch(this,function(){n.toggleClass(this.map.container,"toggle-map-border");a++;6===a&&clearInterval(b)}),200)},_useCurrentMapExtent:function(){this.map&&(this._setInitialExtent(),this._blinkMapContainer())},_useDefaultMapExtent:function(a){u.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.appConfig&&this.appConfig.geometryService).then(f.hitch(this,function(){this._setInitialExtent();a&&this._blinkMapContainer()}),f.hitch(this,
function(a){"string"===typeof a&&new h({message:a});console.error(a)}))},_showMapSelector:function(){if(this.item)var a=new s({nls:this.nls,type:this.item.type}),b=new m({width:1024,titleLabel:this.nls.selectWebMap,content:a,container:"main-page",onClose:f.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(b){console.error(b)}a=null;return!0}),buttons:[{label:this.nls.ok,key:t.ENTER,onClick:f.hitch(this,function(){var d=a.getSelectedMapItem();this._selectItem(d,b)})},{label:this.nls.cancel,
key:t.ESCAPE,onClick:f.hitch(this,function(){b.close()})}]})},_selectItem:function(a,b){if(a)if(this._hasSameWebMap(this.appConfig,{map:{portalUrl:a.portalUrl,itemId:a.id}}))b.close();else{var d=this.appConfig,d=this._getHttpWebMapItemUrl(d.map.portalUrl||d.portalUrl,d.map.itemId);this.widgetsConfigCache[d]||(this.widgetsConfigCache[d]={});var g=this.widgetsConfigCache[d],h=f.clone(this.appConfig);h.map.portalUrl=a.portalUrl;h.map.itemId=a.id;var p=this._tryResetWidgetsConfigWhenMapSwitched(h);if(0<
p.length){var d=k.map(p,f.hitch(this,function(a){return a.label})),q=n.toDom("\x3cdiv style\x3d'font-size:14px;line-height:22px;'\x3e\x3cdiv\x3e"+this.nls.mapSwitchConfimationTip+"\x3c/div\x3e\x3cdiv style\x3d'margin-top:25px;margin-bottom:20px;color:#596679;'\x3e"+this.nls.theseWidgetsAre+":\x3c/div\x3e\x3cul class\x3d'reset-widget-list' style\x3d'color:#596679;'\x3e\x3c/ul\x3e\x3cdiv style\x3d'margin-top:25px;'\x3e"+this.nls.sureToSwitch+"\x3c/div\x3e\x3c/div\x3e"),s=r(".reset-widget-list",q)[0];
k.forEach(d,f.hitch(this,function(a,b){var c=n.create("li",{innerHTML:a},s);0!==b&&(c.style.marginTop="8px")}));var t=new m({content:q,titleLabel:this.nls.mapSwitchConfimation,autoHeight:!0,width:640,buttons:[{label:this.nls.ok,onClick:f.hitch(this,function(){b.close();t.close();this.appConfigPlugin.showLoadingCover();e.publish("setAppConfig",h);k.forEach(p,f.hitch(this,function(a){g[a.id]=a.config}))})},{label:this.nls.cancel,onClick:f.hitch(this,function(){t.close()})}]})}else b.close(),this.appConfigPlugin.showLoadingCover(),
e.publish("mapChanged",{portalUrl:a.portalUrl,itemId:a.id})}},_hasSameWebMap:function(a,b){var e=a&&a.map,f=e&&e.itemId,g=b&&b.map,h=g&&g.itemId;return(e=d.isSamePortalUrl(e&&e.portalUrl,g&&g.portalUrl))&&f===h},_setMap:function(a){this.map=a;this._checkCustomScaleAvailablity()},setAppConfig:function(a){if(this.appConfig){var b=this._hasSameWebMap(this.appConfig,a);this.appConfig=a;b||this._requestCurrentItem()}else this.appConfig=a,this._requestCurrentItem()},_getHttpWebMapItemUrl:function(a,b){var e=
d.getItemUrl(a,b);return e=d.setHttpProtocol(e)},_tryResetWidgetsConfigWhenMapSwitched:function(a){var b=[],d=this._getHttpWebMapItemUrl(a.map.portalUrl||a.portalUrl,a.map.itemId);this.widgetsConfigCache[d]||(this.widgetsConfigCache[d]={});var e=this.widgetsConfigCache[d];a.visitElement(f.hitch(this,function(a){if(!a.widgets&&a.uri&&!1===a.keepConfigAfterMapSwithched){var c=a.config,d=e&&e[a.id];d?a.config=d:delete a.config;if(c||d)a=f.clone(a),a.config=c,b.push(a)}}));return b},_requestCurrentItem:function(){var a=
this.appConfig&&this.appConfig.map&&this.appConfig.map.itemId;if(a){var a={q:"id:"+a,num:1,f:"json"},b=g.getPortal(this.appConfig.map&&this.appConfig.map.portalUrl);b&&b.queryItems(a).then(f.hitch(this,function(a){this.domNode&&(a=a.results,0<a.length&&this._showSelectedWebMap(a[0]))}),f.hitch(this,function(a){console.debug("query item from portal failed",a)}))}},_tryLocaleDate:function(a){var b=u.localizeDate(a,{selector:"date"});b||(b=a.toLocaleDateString());return b},_showSelectedWebMap:function(a){this.item=
a;var b=a.type.toLowerCase();n.empty(this.thumbnailContainer);n.removeClass(this.webItemIcon,"webmap");n.removeClass(this.webItemIcon,"webscene");this.webItemType.innerHTML=a.type;var d=n.create("div",{"class":"thumbnail"},this.thumbnailContainer);a.thumbnailUrl?n.setStyle(d,"backgroundImage","url("+a.thumbnailUrl+")"):"web map"===b?n.addClass(d,"default-webmap"):"web scene"===b&&n.addClass(d,"default-webscene");"web map"===b?n.addClass(this.webItemIcon,"webmap"):"web scene"===b&&n.addClass(this.webItemIcon,
"webscene");this.snippet.innerHTML=a.snippet||"";this.lastModified.innerHTML=this._tryLocaleDate(new Date(a.modified));this.lastModified.title=this.lastModified.innerHTML;this.webMapDetails.href=a.detailsPageUrl;b=a.owner||"";this.ownerName.innerHTML=b;this.ownerName.title=b;this.ownerName.href=a.ownerPageUrl||"";this.mapTitle.innerHTML=a.title},_checkCustomScaleAvailablity:function(){this._isBasemapLayerSupportLods()?(n.removeClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=""):(n.addClass(this.btnScale,
"jimu-state-disabled"),this.btnScale.title=this.nls.scaleDisabledTip2)},_isBasemapLayerSupportLods:function(){var a=!1;if(this.map){var b=this.map.layerIds;b&&0<b.length&&(a=(a=this.map.getLayer(b[0]))&&a.tileInfo&&a.tileInfo.lods)}return a},_onBtnScaleClicked:function(){if(this._isBasemapLayerSupportLods())var a=new p({nls:this.nls,map:this.map}),b=new m({width:640,height:590,titleLabel:this.nls.scaleTitle,content:a,container:"main-page",onClose:f.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(b){console.error(b)}a=
null;return!0}),buttons:[{label:this.nls.ok,onClick:f.hitch(this,function(){var d=a.getLodsFromListNode(),g=a.getLodsFromMap();b.close();var h=!1,h=d.length===g.length?k.every(d,f.hitch(this,function(a,b){var c=g[b],d=a.scale===c.scale,e=a.resolution===c.resolution;return a.level===c.level&&d&&e})):!1;h||(this.appConfigPlugin.showLoadingCover(),e.publish("mapOptionsChanged",{lods:d}))})},{label:this.nls.cancel,onClick:f.hitch(this,function(){b.close()})}]})}})})},"dojo/_base/query":function(){define(["../query",
"./NodeList"],function(q){return q})},"builder/plugins/map-config/MapSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapSelector.html dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on jimu/utils jimu/dijit/TabContainer3 jimu/portalUrlUtils jimu/dijit/Search builder/portalUtils ./MapTable".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l){return q([a,f,k],{templateString:n,
baseClass:"map-selector",tab:null,isPublicTabShow:!1,nls:null,type:"",_user:null,_group:null,_webMapQueryString:"",_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_signIn:!1,portal:null,postCreate:function(){this.inherited(arguments);this._webMapQueryString=" "+u.getItemQueryStringByTypes([this.type])+
" ";this.portal=c.getPortal(this._getPortalUrl());this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initMapTables();this._initPrivate();this._initPublic();this._bindMapTableEvents();this._updateUIbySignIn()},startup:function(){this.tab._started||(this.tab.startup(),this.tab._started=!0)},_initTabs:function(){var a={title:this.nls.myContent,content:this.mycontentTabNode},b={title:this.nls.myOrganization,content:this.organizationTabNode},c={title:this.nls.myGroup,content:this.groupTabNode},
d={title:this.nls.publicMap,content:this.publicTabNode};this.isPublicTabShow=!1;this.tab=new m({tabs:[a,b,c,d]},this.tabNode);this.own(h(this.tab,"tabChanged",t.hitch(this,function(a){g.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this.isPublicTabShow=!1,this._updateUIbySignIn(),this.portal.getUser().then(t.hitch(this,function(b){a===this.nls.myContent?this._searchMyContent(b):a===this.nls.myOrganization?this._searchOrganization(b):a===this.nls.myGroup&&this._searchGroups(b)}))):
(this.isPublicTabShow=!0,this._searchPublic())})))},_bindMapTableEvents:function(){this.own(h(this.mycontentMapTable,"select",t.hitch(this,this._onMapSelected)));this.own(h(this.organizationMapTable,"select",t.hitch(this,this._onMapSelected)));this.own(h(this.groupMapTable,"select",t.hitch(this,this._onMapSelected)));this.own(h(this.publicPortalMapTable,"select",t.hitch(this,this._onMapSelected)));this.own(h(this.publicOnlineMapTable,"select",t.hitch(this,this._onMapSelected)))},_onMapSelected:function(a){if(a=
a&&a.selectedNode)this.mycontentMapTable.unselect(),this.organizationMapTable.unselect(),this.groupMapTable.unselect(),this.publicPortalMapTable.unselect(),this.publicOnlineMapTable.unselect(),g.addClass(a,"selected")},_updateUIbySignIn:function(){g.setStyle(this.signinSection,"display","none");var a=d(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);this.portal.haveSignIn()?a.style("display","block"):(a.style("display","none"),this.isPublicTabShow||
g.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){u.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalNameLabel);u.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlineNameLabel);var a=this._getPortalUrl(),a=s.getServerByUrl(a);s.isArcGIScom(a)?(this.portalPublicRaido.disabled=!0,this.onlinePublicRaido.checked=!0,g.setStyle(this.portalPublicRaido,"display","none"),g.setStyle(this.portalNameLabel,"display","none")):(this.portalPublicRaido.disabled=
!1,this.portalPublicRaido.checked=!0,this.portalNameLabel.innerHTML=a)},_initSearchQuery:function(){var a="esri_"+(r.locale&&r.locale.slice(0,2)||"en").toLowerCase(),c=b.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),t.hitch(this,function(b){return b!==a})),d="";b.forEach(c,t.hitch(this,function(a){d+=" -owner:"+
a+" "}));c=" ";this.portal.user&&this.portal.user.orgId&&(c=" orgid:"+this.portal.user.orgId+" ");c=c+this._webMapQueryString+" AND access:public "+d;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:c});this._filterPublicPortalQuery=this._getQuery({q:c,basicQ:c});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:'(group:"c755678be14e4a0984af36a15f5b643e" OR group:"b8787a74b4d74f7fb9b8fac918735153") '+this._webMapQueryString+" AND access:public"});
this._filterPublicOnlineQuery=this._getQuery({q:this._webMapQueryString+" AND access:public"});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return t.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return s.getStandardPortalUrl(window.portalUrl)},_initMapTables:function(){var a=
this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalMapTable.set("portalUrl",a),this.publicPortalMapTable.set("filteredQuery",this._filterPublicPortalQuery));this.publicOnlineMapTable.set("portalUrl",window.location.protocol+"//www.arcgis.com");this.publicOnlineMapTable.set("filteredQuery",this._filterPublicOnlineQuery)},_initPublic:function(){this.own(h(this.portalPublicRaido,"click",t.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this.own(h(this.onlinePublicRaido,
"click",t.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalMapTable.show(),this.publicOnlineMapTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalMapTable.hide(),this.publicOnlineMapTable.show())},_onPublicSearch:function(a){(a=a&&t.trim(a))?(this.publicPortalMapTable.showFilterMapsSection(),this.publicOnlineMapTable.showFilterMapsSection(),
this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalMapTable.searchFilteredMaps(this._filterPublicPortalQuery)):this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+this._webMapQueryString+" AND access:public",this._filterPublicOnlineQuery.start=1,this.publicOnlineMapTable.searchFilteredMaps(this._filterPublicOnlineQuery))):(this.publicPortalMapTable.showAllMapsSection(),this.publicOnlineMapTable.showAllMapsSection())},
_searchPublic:function(){this.tab.getSelectedTitle()===this.nls.publicMap&&(this.publicTabNode.isSearched||this._searchPublicByRadio())},_searchPublicByRadio:function(){this.portalPublicRaido.checked?this.publicPortalMapTable.isSearched||(this.publicPortalMapTable.searchAllMaps(this._allPublicPortalQuery),this.publicPortalMapTable.isSearched=!0):this.publicOnlineMapTable.isSearched||(this.publicOnlineMapTable.searchAllMaps(this._allPublicOnlineQuery),this.publicOnlineMapTable.isSearched=!0)},_initPrivate:function(){this._resetPortalMaps();
this.own(e.subscribe("userSignIn",t.hitch(this,this._onSignIn)));this.own(e.subscribe("userSignOut",t.hitch(this,this._onSignOut)));this.own(h(this.groupsSelect,"change",t.hitch(this,this._onGroupsSelectChange)));var a=s.getServerByUrl(this._getPortalUrl());s.isArcGIScom(a);this.portal.haveSignIn()&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&t.trim(a)){if(this._allOrganizationQuery){var b=this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=
1,this.organizationMapTable.searchFilteredMaps(this._filterOrganizationQuery))}}else this.organizationMapTable.showAllMapsSection()},_onMyContentSearch:function(a){if(a=a&&t.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentMapTable.searchFilteredMaps(this._filterMyContentQuery))}}else this.mycontentMapTable.showAllMapsSection()},_onGroupSearch:function(a){if(a=a&&t.trim(a)){if(this._allGroupQuery){var b=
this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupMapTable.searchFilteredMaps(this._filterGroupQuery))}}else this.groupMapTable.showAllMapsSection()},_onSignIn:function(){this._updateUIbySignIn();this._signIn||(this._signIn=!0,this.portal.getUser().then(t.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))})))},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();
this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationMapTable.clear();this.mycontentMapTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){if(this.tab.getSelectedTitle()===this.nls.myOrganization&&!this.organizationTabNode.isSearched){this.organizationMapTable.clear();a=" orgid:"+a.orgId+" AND "+this._webMapQueryString+" AND (access:org OR access:public) ";var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=
this._getQuery({q:a});this.organizationMapTable.set("portalUrl",b);this.organizationMapTable.searchAllMaps(this._allOrganizationQuery);this.organizationTabNode.isSearched=!0}},_searchMyContent:function(a){if(this.tab.getSelectedTitle()===this.nls.myContent&&!this.mycontentTabNode.isSearched){this.mycontentMapTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._webMapQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentMapTable.set("portalUrl",
b);this.mycontentMapTable.searchAllMaps(this._allMyContentQuery);this.mycontentTabNode.isSearched=!0}},_searchGroups:function(a){if(this.tab.getSelectedTitle()===this.nls.myGroup&&!this.groupTabNode.isSearched){this._resetGroupsSection();g.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){g.setStyle(this.groupSearch.domNode,"display","block");this.groupMapTable.show();g.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=a[b];g.create("option",{value:c.id,innerHTML:c.title},
this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length);this.groupTabNode.isSearched=!0}},_resetGroupsSection:function(){g.setStyle(this.groupsSection,"display","none");g.empty(this.groupsSelect);g.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupMapTable.clear();g.setStyle(this.groupSearch.domNode,"display","none");this.groupMapTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?g.setStyle(this.groupsSection,
"top","15px"):g.setStyle(this.groupsSection,"top","70px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupMapTable.clear();if("nodata"===a)g.setStyle(this.groupSearch,"display","none"),this.groupMapTable.hide();else{g.setStyle(this.groupSearch,"display","block");this.groupMapTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._webMapQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupMapTable.set("portalUrl",
b);this.groupMapTable.searchAllMaps(this._allGroupQuery)}},getSelectedMapItem:function(){var a=null,b=d(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})})},"builder/plugins/map-config/MapTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c){return q([e,a,f,n],{templateString:k,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=c},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=s.getStandardPortalUrl(this.portalUrl));this.own(h(this.allMapsTableDiv,"scroll",r.hitch(this,this._onAllMapsSectionScroll)));this.own(h(this.filteredMapsTableDiv,
"scroll",r.hitch(this,this._onFilteredMapsSectionScroll)));this.showAllMapsSection();this.searchAllMaps()},show:function(){b.setStyle(this.domNode,"display","block")},hide:function(){b.setStyle(this.domNode,"display","none")},searchAllMaps:function(a){this.showAllMapsSection();a&&(this.query=r.mixin({},a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),m.getPortal(this.portalUrl).queryItems(this.query).then(r.hitch(this,function(a){this.domNode&&
(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),r.hitch(this,function(a){console.error(a);this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this.showFilterMapsSection();a&&(this.filteredQuery=r.mixin({},a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),m.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(r.hitch(this,
function(a){this.domNode&&(this.filteredMapsShelter.hide(),this.filteredQuery.start=a.nextStart,this._createMapItems(a,this.filteredMapsTbody),0===this._getWebMapCount(this.filteredMapsTbody)&&(b.setStyle(this.filteredMapsTableDiv,"display","none"),b.setStyle(this.searchNoneTipSection,"display","block")))}),r.hitch(this,function(a){console.error(a);this.domNode&&(this.filteredMapsShelter.hide(),0===this._getWebMapCount(this.filteredMapsTbody)&&(b.setStyle(this.filteredMapsTableDiv,"display","none"),
b.setStyle(this.searchNoneTipSection,"display","block")))})))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},clearAllMapsSection:function(){b.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){b.empty(this.filteredMapsTbody)},showAllMapsSection:function(){b.setStyle(this.allMapsSection,"display","block");b.setStyle(this.filteredMapsSection,"display","none")},showFilterMapsSection:function(){b.setStyle(this.allMapsSection,"display","none");b.setStyle(this.filteredMapsSection,
"display","block");b.setStyle(this.filteredMapsTableDiv,"display","block");b.setStyle(this.searchNoneTipSection,"display","none")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return u.isScrollToBottom(a)},_createMapItems:function(a,c){var e=t.filter(a.results,r.hitch(this,function(a){return a.type.toLowerCase()===
this.type.toLowerCase()}));if(0!==e.length){var f={},g,h=d("td.empty",c),k;if(0<h.length){var m=Math.min(e.length,h.length),p=e.splice(0,m);for(k=0;k<m;k++){var n=h[k];g=this._createMapItem(p[k]);f[g.item.id]=g;b.place(g,n);b.removeClass(n,"empty")}}if(0!==e.length){h=Math.ceil(e.length/5);for(k=0;k<h;k++){g=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");b.place(g,c);m=d("td",g);for(p=0;p<m.length;p++)n=m[p],
(g=e[5*k+p])?(g=this._createMapItem(g),f[g.item.id]=g,b.place(g,n)):b.addClass(n,"empty")}if(!this.getSelectedMapItem()&&(this.appConfig&&this.appConfig.map.itemId)&&(g=f[this.appConfig.itemId]))e=d(".map-item-bg",g),b.addClass(e,"selected")}}},_getWebMapCount:function(a){return d(".map-item-div",a).length},_createMapItem:function(a){var c=b.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
e=d(".map-item-bg",c)[0],f=d(".map-item-thumbnail",c)[0],g=d(".map-item-title",c)[0],k=d(".map-item-detail-icon",c)[0];d(".none-thumbnail-tip",c);k.href=a.detailsPageUrl;k.title=this.nls.viewItemDetails||"";c.item=a;k=a.thumbnailUrl||u.getDefaultWebMapThumbnail();b.setStyle(f,"backgroundImage","url("+k+")");this.own(h(e,"click",r.hitch(this,this._onMapItemBgClick)));g.innerHTML=a.title;g.title=a.title;return c},unselect:function(){d(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=
a.target||a.srcElement;var c=null;b.hasClass(a,"map-item-thumbnail")?c=a.parentNode:b.hasClass(a,"none-thumbnail-tip")&&(c=a.parentNode.parentNode);c&&b.hasClass(c,"map-item-bg")&&(this.unselect(),b.addClass(c,"selected"),this.emit("select",{mapTable:this,selectedNode:c}))},getSelectedMapItem:function(){var a=null,b=d(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})})},"builder/plugins/map-config/CustomizeScale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomizeScale.html dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/dijit/Message dijit/form/NumberTextBox".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d){return q([e,a,f],{templateString:k,baseClass:"mapconfig-customize-scale",map:null,postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){var a=this.getLodsFromMap();this._resetLodListByLods(a)},getLodsFromMap:function(){var a=[];this.map._params&&this.map._params.lods&&(a=t.map(this.map._params.lods,r.hitch(this,function(a){return a.toJson()})));return a},_getLodsFromBasemapLayer:function(){var a=[],b=this.map.getLayer(this.map.layerIds[0]);
b&&(b.tileInfo&&b.tileInfo.lods)&&(a=t.map(b.tileInfo.lods,r.hitch(this,function(a){return{level:a.level,resolution:a.resolution,scale:a.scale}})));return a},getLodsFromListNode:function(){for(var a=this._getLodItems(),b=[],d=null,e=0;e<a.length;e++)d=a[e].lod,b.push({level:d.level,scale:d.scale,resolution:d.resolution});return b},_resetLodListByLods:function(a){b.empty(this.listNode);t.forEach(a,r.hitch(this,function(a){a=this._createLodItem(a);b.place(a,this.listNode)}))},_createLodItem:function(a){var d=
b.create("div",{innerHTML:g.localizeNumber(a.scale),"class":"lod-item"});d.lod=a;return d},_getLodItems:function(){return n(".lod-item",this.listNode)},_getSelectedLodItem:function(){var a=null,b=n(".selected",this.listNode);0<b.length&&(a=b[0]);return a},_selectLodItem:function(a){this._removeSelectedClass();b.addClass(a,"selected");b.addClass(this.btnDelete,"enabled-operation");a.previousSibling||b.setStyle(a,"borderTop","0")},_removeSelectedClass:function(){n(".lod-item",this.listNode).removeClass("selected");
b.removeClass(this.btnDelete,"enabled-operation")},_onLodListClicked:function(a){a=a.target||a.srcElement;b.hasClass(a,"lod-item")&&this._selectLodItem(a)},_onBtnAddClicked:function(){if(this.scaleNumberBox.validate()){var a=this.scaleNumberBox.get("value");this.scaleNumberBox.set("displayedValue","");var d=this._getLodItems();if(0!==d.length&&!t.some(d,r.hitch(this,function(b){return b.lod.scale===a}))){var e=d.length-1,f=d[0].lod,g=d[e].lod,c=null,c={level:null,resolution:f.resolution/f.scale*a,
scale:a};if(c.scale>f.scale)c.level=f.level-1,c=this._createLodItem(c),b.place(c,this.listNode,"first");else if(c.scale<g.scale)c.level=g.level+1,c=this._createLodItem(c),b.place(c,this.listNode);else for(var l=null,f=null,g=e;1<=g;g--)if(l=d[g],f=d[g-1],c.scale>l.lod.scale&&c.scale<f.lod.scale){c.level=l.lod.level;c=this._createLodItem(c);b.place(c,f,"after");for(c=g;c<=e;c++)d[c].lod.level+=1;break}}}},_onBtnDeleteClicked:function(){var a=this._getSelectedLodItem();if(a)if(1===this.getLodsFromListNode().length)new d({message:this.nls.atLeastOneScale});
else{var e=a;if(!a.previousSibling)for(;a.nextSibling;)a=a.nextSibling,a.lod.level-=1;b.destroy(e);this._removeSelectedClass()}},_onBtnResetClicked:function(){this._removeSelectedClass();var a=this._getLodsFromBasemapLayer();this._resetLodListByLods(a)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(q,e,a,f,k,n){var r=function(b){b=b||{};var e=a.getLocalization("dojo.cldr","number",a.normalizeLocale(b.locale)),
d=b.pattern?b.pattern:e[(b.type||"decimal")+"Format"];b="number"==typeof b.places?b.places:"string"===typeof b.places&&0<b.places.length?b.places.replace(/.*,/,""):-1!=d.indexOf(".")?d.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:e.decimal,places:b}},t=q("dijit.form.NumberTextBoxMixin",null,{pattern:function(a){return"("+(this.focused&&this.editOptions?this._regExpGenerator(e.delegate(a,this.editOptions))+"|":"")+this._regExpGenerator(a)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:k.format,
_regExpGenerator:k.regexp,_decimalInfo:r(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(a){var e="number"==typeof a.places?a.places:0;e&&e++;"number"!=typeof a.max&&(a.max=9*Math.pow(10,15-e));"number"!=typeof a.min&&(a.min=-9*Math.pow(10,15-e));this.inherited(arguments,[a]);this.focusNode&&(this.focusNode.value&&!isNaN(this.value))&&this.set("value",this.value);this._decimalInfo=r(a)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var a=
this.get("value");"number"==typeof a&&!isNaN(a)&&(a=this.format(a,this.constraints),void 0!==a&&(this.textbox.value=a));this.inherited(arguments)}},format:function(a,f){var d=String(a);if("number"!=typeof a)return d;if(isNaN(a))return"";if(!("rangeCheck"in this&&this.rangeCheck(a,f))&&!1!==f.exponent&&/\de[-+]?\d/i.test(d))return d;this.editOptions&&this.focused&&(f=e.mixin({},f,this.editOptions));return this._formatter(a,f)},_parser:k.parse,parse:function(a,f){var d=this._parser(a,e.mixin({},f,this.editOptions&&
this.focused?this.editOptions:{}));this.editOptions&&(this.focused&&isNaN(d))&&(d=this._parser(a,f));return d},_getDisplayedValueAttr:function(){var a=this.inherited(arguments);return isNaN(a)?this.textbox.value:a},filter:function(a){if(null==a||"string"==typeof a&&""==a)return NaN;"number"==typeof a&&(!isNaN(a)&&0!=a)&&(a=k.round(a,this._decimalInfo.places));return this.inherited(arguments,[a])},serialize:function(a,e){return"number"!=typeof a||isNaN(a)?"":this.inherited(arguments)},_setBlurValue:function(){var a=
e.hitch(e.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(a,!0)},_setValueAttr:function(a,e,d){if(void 0!==a&&void 0===d)if(d=String(a),"number"==typeof a)if(isNaN(a))d="";else{if("rangeCheck"in this&&this.rangeCheck(a,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(d))d=void 0}else a?a=void 0:(d="",a=NaN);this.inherited(arguments,[a,e,d])},_getValueAttr:function(){var a=this.inherited(arguments);if(isNaN(a)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&
/\de[-+]?\d/i.test(this.textbox.value)&&RegExp("^"+k._realNumberRegexp(e.delegate(this.constraints))+"$").test(this.textbox.value))return a=Number(this.textbox.value),isNaN(a)?void 0:a}else return a},isValid:function(a){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var e=this.get("value");return!isNaN(e)&&this.rangeCheck(e,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var a=
"number"==typeof this.constraints.min,e="number"==typeof this.constraints.max,d=this.get("value");if(isNaN(d)||!a&&!e)return this.inherited(arguments);var h=d|0,k=0>d,m=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),n=(this.maxLength||20)-this.textbox.value.length,p=m?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",h=m?h+"."+p:h+"",n=f.rep("9",n),m=d;k?m=Number(h+n):d=Number(h+n);return!(a&&d<this.constraints.min||e&&m>this.constraints.max)}});q=q("dijit.form.NumberTextBox",
[n,t],{baseClass:"dijitTextBox dijitNumberTextBox"});q.Mixin=t;return q})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(q,e,a){return q("dijit.form.RangeBoundTextBox",a,{rangeMessage:"",rangeCheck:function(a,e){return("min"in e?0<=this.compare(a,e.min):!0)&&("max"in e?0>=this.compare(a,e.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var a=
this.get("value");if(null==a)return!1;var e=!1;"min"in this.constraints&&(e=this.constraints.min,e=0>this.compare(a,"number"==typeof e&&0<=e&&0!=a?0:e));!e&&"max"in this.constraints&&(e=this.constraints.max,e=0<this.compare(a,"number"!=typeof e||0<e?e:0));return e},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(a){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(a))},getErrorMessage:function(a){var e=
this.get("value");return null!=e&&""!==e&&("number"!=typeof e||!isNaN(e))&&!this.isInRange(a)?this.rangeMessage:this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=e.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(q,e,a,f){return q("dijit.form.MappedTextBox",
f,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(a){return a.toString?a.toString():""},toString:function(){var a=this.filter(this.get("value"));return null!=a?"string"==typeof a?a:this.serialize(a,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=a.place("\x3cinput type\x3d'hidden'"+(this.name&&
!e("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-agoltemplate/Plugin","dojo/text!builder/plugins/popup-actions/popup-agoltemplate/css/style.css","dojo/i18n!builder/plugins/popup-actions/popup-agoltemplate/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-agoltemplate/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/promise/all dojo/Deferred builder/BasePlugin builder/serviceUtils builder/portalUtils builder/utils jimu/portalUrlUtils jimu/ConfigManager jimu/dijit/LoadingShelter jimu/dijit/Popup ./AGOLTemplate/AGOLTemplate ./AGOLTemplate/utils".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){return q([k],{baseClass:"plugin-app-actions-popup",postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);var a=this.pluginManager.getPluginByName("startup");this.shelter=(new d({hidden:!0})).placeAt(a.domNode)},onClick:function(){var d=new f,g=window.appInfo.appId;this.shelter.show();window.isXT?n.getAppInfo(g).then(e.hitch(this,function(a){d.resolve(a)}),function(){d.reject()}):
r.getPortal(b.getPortalUrlFromLocation()).getItemData(g).then(e.hitch(this,function(a){a=a.agolTemplateInfo;!a&&window.appConfig.agolTemplateJson&&(a={itemId:null,json:window.appConfig.agolTemplateJson});a={id:g,name:this.pluginManager.getPluginByName("header").getAppName(),agolTemplateInfo:a};d.resolve(a)}),function(){d.reject()});var c=this.pluginManager.getExtensions("startup.creation-entry")[0],c=this.pluginManager.loadPlugin(this.pluginsMeta[c.pluginName]),l=m.loadAllWidgetConfigs(e.clone(window.appConfig));
a({app:d,creationPlugin:c,appConfig:l}).then(e.hitch(this,function(a){var b=a.app,c=a.creationPlugin;a=a.appConfig;var d=a.getCleanConfig(),d=e.clone(d);delete d.agolTemplateJson;d.visitElement=a.visitElement;d.visitElement(function(a){!a.widgets&&(a.uri&&void 0===a.visible)&&(a.visible=!0)});delete d.visitElement;delete d._buildInfo;d.getConfigElementById=a.getConfigElementById;this.nls.templateTitle=c.nls.templateTitle;this.nls.explain1=c.nls.explain1;b=new u({appConfig:d,fullAppConfig:a,app:b,
plugin:this});this.popupDlg(b);this.shelter.hide()}),function(){this.shelter.hide()})},onClickBeforeConfigPage:function(b){jimuConfig.widgetsPackage={name:"widgets",location:"/webappbuilder/apps/"+b.id+"/widgets"};jimuConfig.themesPackage={name:"themes",location:"/webappbuilder/apps/"+b.id+"/themes"};jimuConfig.configsPackage={name:"configs",location:"/webappbuilder/apps/"+b.id+"/configs"};window.appInfo={appType:b.appType,appPath:t.getAppPathById(b.id),appId:b.id+"",appOwner:b.creator};this.shelter.show();
var d=g.getInstance({config:"/webappbuilder/apps/"+b.id+"/config.json"});d.loadConfig().then(e.hitch(this,function(c){c=d.getConfig(c);c=m.loadAllWidgetConfigs(c);var f=this.pluginManager.getExtensions("startup.creation-entry")[0],f=this.pluginManager.loadPlugin(this.pluginsMeta[f.pluginName]);a({appConfig:c,creationPlugin:f}).then(e.hitch(this,function(a){var c=a.appConfig,d=c.getCleanConfig(),d=e.clone(d);delete d.agolTemplateJson;d.visitElement=c.visitElement;d.visitElement(function(a){!a.widgets&&
(a.uri&&void 0===a.visible)&&(a.visible=!0)});delete d.visitElement;this.nls.templateTitle=a.creationPlugin.nls.templateTitle;this.nls.explain1=a.creationPlugin.nls.explain1;a=new u({appConfig:d,fullAppConfig:c,app:b,plugin:this});this.popupDlg(a);this.shelter.hide()}),function(){this.shelter.hide()})}),function(){this.shelter.hide()})},popupDlg:function(a){new h({content:a,container:"main-page",titleLabel:this.nls.title,width:1040,height:625,buttons:[{label:this.nls.download,onClick:e.hitch(a,a._onExportClick)},
{label:this.nls.saved,onClick:e.hitch(a,a._onSaveClick)},{label:this.nls.cancel,onClick:e.hitch(a,a._onCancelClick)}]});a.startup()}})})},"jimu/ConfigManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Deferred ./utils ./WidgetManager ./shared/AppVersionManager ./shared/utils ./ConfigLoader ./tokenUtils esri/config esri/tasks/GeometryService".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u){function m(a){var d=e.clone(a),f=n.widgetProperties;delete d.mode;
b.visitElement(d,function(a,b){a.widgets?(delete a.isPreload,delete a.gid,"jimu.js/images/group_icon.png"===a.icon&&delete a.icon,delete a.openType,b.isOnScreen&&a.panel&&n.isEqual(a.panel,d.widgetOnScreen.panel)&&delete a.panel):(a.icon&&a.icon===a.amdFolder+"images/icon.png"&&delete a.icon,delete a.panel,delete a.folderUrl,delete a.amdFolder,delete a.thumbnail,delete a.configFile,delete a.gid,delete a.isPreload,f.forEach(function(b){delete a[b]}),a.visible&&delete a.visible,delete a.manifest)});
delete d.rawAppConfig;delete d._ssl;delete d.getConfigElementById;delete d.processNoUriWidgets;delete d.addElementId;delete d.getCleanConfig;delete d.visitElement;delete d.agolConfig;delete d._itemData;delete d.oldWabVersion;return d}var s=null,p;p=q(null,{urlParams:null,appConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(a){this.urlParams=a||{};this.listenBuilderEvents();this.isRunInPortal=!1;this.versionManager=new t;this.widgetManager=r.getInstance();this.configLoader=
g.getInstance(this.urlParams,{versionManager:this.versionManager});"config"===this.urlParams.mode&&(window.parent.setConfigViewerTopic&&e.isFunction(window.parent.setConfigViewerTopic))&&window.parent.setConfigViewerTopic(f);"preview"===this.urlParams.mode&&(window.parent.setPreviewViewerTopic&&e.isFunction(window.parent.setPreviewViewerTopic))&&window.parent.setPreviewViewerTopic(f)},listenBuilderEvents:function(){f.subscribe("builder/widgetChanged",e.hitch(this,this._onWidgetChanged));f.subscribe("builder/groupChanged",
e.hitch(this,this._onGroupChanged));f.subscribe("builder/widgetPoolChanged",e.hitch(this,this._onWidgetPoolChanged));f.subscribe("builder/mapChanged",e.hitch(this,this._onMapChanged));f.subscribe("builder/mapOptionsChanged",e.hitch(this,this._onMapOptionsChanged));f.subscribe("builder/appAttributeChanged",e.hitch(this,this._onAppAttributeChanged));f.subscribe("builder/setAppConfig",e.hitch(this,this._onAppConfigSet));f.subscribe("builder/themeChanged",e.hitch(this,this._onThemeChanged));f.subscribe("builder/layoutChanged",
e.hitch(this,this._onLayoutChanged));f.subscribe("builder/styleChanged",e.hitch(this,this._onStyleChanged));f.subscribe("builder/syncExtent",e.hitch(this,this._onSyncExtent))},loadConfig:function(){if(!("preview"===this.urlParams.mode||"config"===this.urlParams.mode))return this.configLoader.loadConfig().then(e.hitch(this,function(a){this.portalSelf=this.configLoader.portalSelf;this.appConfig=this._addDefaultValues(a);console.timeEnd("Load Config");f.publish("appConfigLoaded",this.getConfig());return this.getConfig()}),
function(a){console.error(a)})},getConfig:function(){var a=e.clone(this.appConfig);a.getConfigElementById=function(a){return b.getConfigElementById(this,a)};a.getCleanConfig=function(){return m(this)};a.visitElement=function(a){b.visitElement(this,a)};return a},_onWidgetChanged:function(a){var d=n.reCreateObject(a);a=b.getConfigElementById(this.appConfig,a.id);for(var e in d)a[e]=d[e];this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);f.publish("appConfigChanged",
this.getConfig(),"widgetChange",d)},_onGroupChanged:function(a){var d=n.reCreateObject(a);a=b.getConfigElementById(this.appConfig,a.id);for(var e in d)a[e]=d[e];this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);f.publish("appConfigChanged",this.getConfig(),"groupChange",d)},_onWidgetPoolChanged:function(a){a=n.reCreateObject(a);this.appConfig.widgetPool.widgets=a.widgets;this.appConfig.widgetPool.groups=a.groups;this.configLoader.addNeedValues(this.appConfig);
this._addDefaultValues(this.appConfig);f.publish("appConfigChanged",this.getConfig(),"widgetPoolChange",a)},_onAppAttributeChanged:function(a){a=n.reCreateObject(a);e.mixin(this.appConfig,a);this.configLoader.processProxy(this.appConfig);this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);f.publish("appConfigChanged",this.getConfig(),"attributeChange",a)},_onMapChanged:function(a){a=n.reCreateObject(a);a.itemId&&a.itemId!==this.appConfig.map.itemId&&this.appConfig.map.mapOptions&&
(delete this.appConfig.map.mapOptions.extent,delete this.appConfig.map.mapOptions.lods,delete this.appConfig.map.mapOptions.center,delete this.appConfig.map.mapOptions.scale,delete this.appConfig.map.mapOptions.zoom);e.mixin(this.appConfig.map,a);this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);f.publish("appConfigChanged",this.getConfig(),"mapChange",a)},_onMapOptionsChanged:function(a){a=n.reCreateObject(a);this.appConfig.map.mapOptions||(this.appConfig.map.mapOptions=
{});e.mixin(this.appConfig.map.mapOptions,a);f.publish("appConfigChanged",this.getConfig(),"mapOptionsChange",a)},_onThemeChanged:function(a){this._getAppConfigFromTheme(a).then(e.hitch(this,function(b){this.appConfig=b;f.publish("appConfigChanged",this.getConfig(),"themeChange",a.getName())}))},_onLayoutChanged:function(b){var d=b.layoutConfig,e=d.widgetOnScreen,g=this.appConfig.widgetOnScreen;e&&(e.panel&&e.panel.uri&&(g.panel.uri=e.panel.uri),a.forEach(e.widgets,function(a,b){g.widgets[b]&&a&&
(a.position&&(g.widgets[b].position=a.position),a.positionRelativeTo&&(g.widgets[b].positionRelativeTo=a.positionRelativeTo),g.widgets[b].panel={uri:g.panel.uri,position:g.widgets[b].position,positionRelativeTo:g.widgets[b].positionRelativeTo})},this),a.forEach(e.groups,function(a,b){g.groups[b]&&(a&&a.panel)&&(g.groups[b].panel=a.panel)},this));d.map&&(this.appConfig.map.position=d.map.position);d.widgetPool&&(d.widgetPool.panel&&(this.appConfig.widgetPool.panel=d.widgetPool.panel),a.forEach(d.widgetPool.groups,
function(a,b){this.appConfig.widgetPool.groups[b]&&(a&&a.panel)&&(this.appConfig.widgetPool.groups[b].panel=a.panel)},this));f.publish("appConfigChanged",this.getConfig(),"layoutChange",b.name)},_onStyleChanged:function(a){this.appConfig.theme.styles=this._genStyles(this.appConfig.theme.styles,a.name);f.publish("appConfigChanged",this.getConfig(),"styleChange",a.name)},_onSyncExtent:function(a){f.publish("syncExtent",a)},_genStyles:function(b,d){var e=[];e.push(d);a.forEach(b,function(a){0>e.indexOf(a)&&
e.push(a)});return e},_getAppConfigFromTheme:function(b){var d=new k,f,g=[],g=this.getConfig().getCleanConfig();g.mode=this.urlParams.mode;a.forEach(g.widgetPool.groups,function(a){delete a.panel},this);if(b.appConfig)f=e.clone(b.appConfig),f.map=g.map,f.map.position=b.appConfig.map.position,g.widgetPool.widgets&&(f.widgetPool.widgets=g.widgetPool.widgets),g.widgetPool.groups&&(f.widgetPool.groups=g.widgetPool.groups),g.links&&(f.links=g.links);else{var h=b.getCurrentLayout(),m=b.getCurrentStyle();
f=e.clone(g);f.widgetOnScreen=h.layoutConfig.widgetOnScreen;h.layoutConfig.widgetPool&&h.layoutConfig.widgetPool.panel&&(f.widgetPool.panel=h.layoutConfig.widgetPool.panel);h.layoutConfig.map&&h.layoutConfig.map.position&&(f.map.position=h.layoutConfig.map.position);g=this._genStyles(a.map(b.getStyles(),function(a){return a.name}),m.name);f.theme={name:b.getName(),styles:g,version:b.getVersion()}}this.configLoader.addNeedValues(f);this._addDefaultValues(f);this.configLoader.loadWidgetsManifest(f).then(function(){d.resolve(f)});
return d},_onAppConfigSet:function(a){a=n.reCreateObject(a);this.configLoader.processProxy(a);this.configLoader.addNeedValues(a);this._addDefaultValues(a);d.setPortalUrl(a.portalUrl);this.appConfig?(a.map.itemId&&a.map.itemId!==this.appConfig.map.itemId&&a.map.mapOptions&&delete a.map.mapOptions.extent,this.appConfig=a,f.publish("appConfigChanged",this.getConfig(),"resetConfig",a)):(this.appConfig=a,f.publish("appConfigLoaded",this.getConfig()))},_addDefaultValues:function(a){this._addDefaultPortalUrl(a);
this._addDefaultGeometryService(a);this._addDefaultStyle(a);this._addDefaultMap(a);this._addDefaultVisible(a);"undefined"===typeof a.widgetOnScreen&&(a.widgetOnScreen={});"undefined"===typeof a.widgetPool&&(a.widgetPool={});this._addDefaultPanelAndPosition(a);this._addDefaultOfWidgetGroup(a);(a.widgetPool.widgets&&0<a.widgetPool.widgets.length&&void 0===a.widgetPool.widgets[0].index||a.widgetPool.groups&&0<a.widgetPool.groups.length&&void 0===a.widgetPool.groups[0].index)&&this._addIndexForWidgetPool(a);
return a},_addDefaultPortalUrl:function(a){"undefined"===typeof a.portalUrl&&(a.portalUrl="http://www.arcgis.com/");a.portalUrl&&"/"!==a.portalUrl.substr(a.portalUrl.length-1)&&(a.portalUrl+="/")},_addDefaultGeometryService:function(a){var b=a&&a.geometryService,b=b&&"string"===typeof b&&e.trim(b)?e.trim(b):this.portalSelf.helperServices.geometry.url;a.geometryService=b;h.defaults.geometryService=new u(a.geometryService)},_addDefaultStyle:function(a){if(a.theme&&(!a.theme.styles||0===a.theme.styles.length))a.theme.styles=
["default"]},_addDefaultMap:function(a){a.map.id="map";"undefined"===typeof a.map["3D"]&&"undefined"===typeof a.map["2D"]&&(a.map["2D"]=!0);"undefined"===typeof a.map.position&&(a.map.position={left:0,right:0,top:0,bottom:0});"undefined"===typeof a.map.portalUrl&&(a.map.portalUrl=a.portalUrl)},_addDefaultVisible:function(a){b.visitElement(a,function(a){void 0===a.visible&&(a.visible=!0)})},_addDefaultPanelAndPosition:function(a){var b,d,f=a.widgetOnScreen,g=a.widgetPool;"undefined"===typeof f.panel||
"undefined"===typeof f.panel.uri?f.panel={uri:"jimu/PreloadWidgetIconPanel",positionRelativeTo:"map"}:"undefined"===typeof f.panel.positionRelativeTo&&(f.panel.positionRelativeTo="map");"undefined"===typeof g.panel||"undefined"===typeof g.panel.uri?g.panel={uri:"jimu/PreloadWidgetIconPanel",positionRelativeTo:"map"}:"undefined"===typeof g.panel.positionRelativeTo&&(g.panel.positionRelativeTo="map");if(f.widgets)for(b=0;b<f.widgets.length;b++)f.widgets[b].position||(f.widgets[b].position={left:0,top:0}),
f.widgets[b].positionRelativeTo||(f.widgets[b].positionRelativeTo="map"),f.widgets[b].panel||(f.widgets[b].panel=e.clone(f.panel),f.widgets[b].panel.position=f.widgets[b].position,f.widgets[b].panel.positionRelativeTo=f.widgets[b].positionRelativeTo);if(f.groups)for(b=0;b<f.groups.length;b++){f.groups[b].position||(f.groups[b].position={left:0,top:0});f.groups[b].panel||(f.groups[b].panel=f.panel);for(d=0;d<f.groups[b].widgets.length;d++)f.groups[b].widgets[d].panel=f.groups[b].panel}if(g){if(g.groups)for(b=
0;b<g.groups.length;b++){g.groups[b].panel?g.groups[b].panel.positionRelativeTo||(g.groups[b].panel.positionRelativeTo="map"):g.groups[b].panel=g.panel;for(d=0;d<g.groups[b].widgets.length;d++)g.groups[b].widgets[d].panel=g.groups[b].panel}if(g.widgets)for(b=0;b<g.widgets.length;b++)g.widgets[b].panel||(g.widgets[b].panel=a.widgetPool.panel)}},_addDefaultOfWidgetGroup:function(a){b.visitElement(a,e.hitch(this,function(a,b){a.isPreload=b.isOnScreen;a.widgets?(a.gid=a.id,1===a.widgets.length?(a.label||
(a.label=a.widgets[0].label?a.widgets[0].label:"Group"),a.icon||(a.icon=a.widgets[0].uri?this._getDefaultIconFromUri(a.widgets[0].uri):"jimu.js/images/group_icon.png")):(a.icon=a.icon?a.icon:"jimu.js/images/group_icon.png",a.label=a.label?a.label:"Group_"+b.index)):(a.gid=b.groupId,a.uri&&n.processWidgetSetting(a))}))},_getDefaultIconFromUri:function(a){a=a.split("/");a.pop();return a.join("/")+"/images/icon.png"},_addIndexForWidgetPool:function(a){var b=0,d,e;if(a.widgetPool.widgets)for(d=0;d<a.widgetPool.widgets.length;d++)a.widgetPool.widgets[d].index=
b,b++;if(a.widgetPool.groups)for(d=0;d<a.widgetPool.groups.length;d++){a.widgetPool.groups[d].index=b;b++;for(e=0;e<a.widgetPool.groups[d].widgets.length;e++)a.widgetPool.groups[d].widgets[e].index=e}}});p.getInstance=function(a){null===s?s=new p(a):s.urlParams=a;window.getAppConfig=e.hitch(s,s.getConfig);return s};return p})},"jimu/shared/AppVersionManager":function(){define(["./BaseVersionManager"],function(q){function e(){this.versions=[{version:"1.0",description:"The version embedded in portal 10.3 final.",
upgrader:function(a){return a},compatible:!0},{version:"1.1",description:"The version embedded in online3.6, and used in developer edition 1.0.",upgrader:function(a){a.widgetOnScreen&&(a.widgetOnScreen.panel&&"themes/FoldableTheme/panels/TitlePanel/Panel"===a.widgetOnScreen.panel.uri)&&(a.widgetOnScreen.panel.uri="jimu/PreloadWidgetIconPanel");return a},compatible:!0},{version:"1.2",description:"The version embedded in online3.7.",upgrader:function(a){var e=0;if(a.widgetOnScreen&&a.widgetOnScreen.widgets){for(var k=
!1,e=0;e<a.widgetOnScreen.widgets.length;e++)"widgets/Splash/Widget"===a.widgetOnScreen.widgets[e].uri&&(k=!0);k||a.widgetOnScreen.widgets.push({uri:"widgets/Splash/Widget",visible:!1,positionRelativeTo:"browser",version:"1.2"});k=!1;for(e=0;e<a.widgetOnScreen.widgets.length;e++)"widgets/TimeSlider/Widget"===a.widgetOnScreen.widgets[e].uri&&(k=!0);k||a.widgetOnScreen.widgets.push({uri:"widgets/TimeSlider/Widget",visible:!1,position:{bottom:55,left:7},version:"1.2"});k=!1;for(e=0;e<a.widgetOnScreen.widgets.length;e++)"widgets/Swipe/Widget"===
a.widgetOnScreen.widgets[e].uri&&(k=!0);k||a.widgetOnScreen.widgets.push({uri:"widgets/Swipe/Widget",visible:!1,position:{top:145,left:7},version:"1.2"})}return a},compatible:!0}];this.isCompatible=function(a,e){for(var k=this.getVersionIndex(a),n=this.getVersionIndex(e),k=k+1;k<=n;k++)if(!1===this.versions[k].compatible)return!1;return!0}}e.prototype=new q;return e.prototype.constructor=e})},"jimu/shared/BaseVersionManager":function(){define(function(){return function(){this.versions=[];this.upgrade=
function(q,e,a){e=this.getVersionIndex(e);a=this.getVersionIndex(a);if(e>=a)throw Error("New version should higher than old version.");for(e+=1;e<=a;e++)this.versions[e].upgrader&&(q=this.versions[e].upgrader(q));return q};this.getVersionIndex=function(q){q=this.fixVersion(q);var e,a;for(a=0;a<this.versions.length;a++)this.versions[a].version===q&&(e=a);null===q&&(e=-1);void 0===e&&(e=-1);return e};this.fixVersion=function(q){return!q?null:q}}})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/AGOLTemplate":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/AGOLTemplate.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dijit/form/Select ./ConfigNode ./CategoryManager ./ShowJsonCodePage ./Export builder/serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/dijit/Popup jimu/portalUrlUtils builder/portalUtils jimu/dijit/LoadingShelter ./ExportMessage".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z,D,E,A,G,C,H){return q([f,k],{templateString:n,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,postMixInProperties:function(){this.nls=b.mixin({},builderNls);this.nls=b.mixin(this.nls,this.plugin.nls);this.imageFolder=this.plugin.folderUrl+"/css/images/";this.arrowImgSrc=isRTL?this.imageFolder+"v_left.png":this.imageFolder+"v_right.png"},postCreate:function(){this.inherited(arguments)},startup:function(){t.setSelectable(this.contentPart,
!1);this.showJsonWidget=new v({},this.showJsonContentDiv);this.configTree=new l(this.appConfig,null,"app","",0);this.categoryManager=new w(this.configTree,this.appConfig,this.app.agolTemplateInfo);this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this.initWork()},drawTree:function(a,b){var c,d;c=this.drawDomNode(a,b);if(0!==a.childs.length)for(d=0;d<a.childs.length;d++)this.drawTree(a.childs[d],c)},drawDomNode:function(c,e){var f,h,l,k,m,n;n=this.categoryManager.getCategoryByField(c.absolutePath);
f=g.create("div",{"class":"tree-node-div",idAttr:c.id},e);c.traversal(b.hitch(this,function(a){if(this.categoryManager.getCategoryByField(a.absolutePath))return!0}))||d.set(f,"display","none");"leaf"===c.nodeType&&!n&&d.set(f,"color","#cccccc");"leaf"!==c.nodeType&&(l=g.create("div",{"class":"show-subnode-div jimu-float-leading"},f),k=g.create("img",{"class":"show-subnode-img",src:this.arrowImgSrc,alt:"img"},l));g.create("span",{"class":"line-label-span jimu-float-leading",innerHTML:c.label?c.label:
c.keyString},f);n&&"leaf"===c.nodeType&&(m=g.create("div",{"class":"to-right-div jimu-float-trailing"},f),g.create("img",{"class":"to-right-img",src:this.imageFolder+"add_field.png",alt:"img"},m),this.own(r(m,"click",b.hitch(this,function(a){d.set(m,"display","none");this._onToRightDiv(c,"add",f);a.stopPropagation();this._checkTemplateStatus()}))),-1!==n.findFieldFromDisplay(c.absolutePath)&&d.set(m,"display","none"));h=12*c.level;"leaf"===c.nodeType?isRTL?d.set(f,"paddingRight",h+17+"px"):d.set(f,
"paddingLeft",h+17+"px"):isRTL?d.set(f,"paddingRight",h+"px"):d.set(f,"paddingLeft",h+"px");h=g.create("div",{"class":"tree-node-subdiv"},e);d.set(h,"display","none");"leaf"!==c.nodeType?(d.set(f,"cursor","pointer"),this.own(r(f,"click",b.hitch(this,function(a,b,c){"none"===d.get(b,"display")?(d.set(b,"display","block"),u.set(c,"src",this.imageFolder+"v.png")):(d.set(b,"display","none"),u.set(c,"src",this.arrowImgSrc));-1!==a.absolutePath.search(/widgets\[[0-9]+\]_config$/)&&!a.jsonObject&&this.addWidgetConfigToConfigTree(a.absolutePath)},
c,h,k)))):n&&(d.set(f,"cursor","pointer"),this.own(r(f,"click",b.hitch(this,function(a,b){this._onToRightDiv(a,"notAdd",f);b.stopPropagation()},c))));c.lineDomNode=f;c.subLineDomNode=h;c.showSubDivDomNode=l;c.toRightDiv=m;0===c.level&&(a.setStyle(f,"display","none"),a.setStyle(h,"display","block"));return h},drawCategoryPart:function(){e.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(a){var c,f,h,l,k,m,n;c=g.create("div",{"class":"category-div",
categoryDiv:a.name},this.categoryPart);l=g.create("div",{"class":"category-head-div",categoryHeadDiv:a.name},c);k=g.create("div",{"class":"category-fold-div jimu-float-leading"},l);n=g.create("img",{"class":"category-fold-img",src:this.arrowImgSrc,alt:"img"},k);g.create("div",{"class":"category-title-div jimu-float-leading",innerHTML:a.title},l);f=g.create("div",{"class":"category-oper-div jimu-float-trailing"},l);k=g.create("div",{"class":"category-oper-item-div category-moveup-div jimu-float-leading",
innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);m=g.create("div",{"class":"category-oper-item-div category-movedown-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);f=g.create("div",{"class":"category-oper-item-div category-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);h=g.create("div",{"class":"fields-div",
fieldsDiv:a.name},c);this.own(r(k,"click",b.hitch(this,function(b){this.categoryManager.moveup(a)&&(g.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(r(m,"click",b.hitch(this,function(b){this.categoryManager.movedown(a)&&(g.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(r(f,"click",b.hitch(this,
function(b){this.categoryManager.removeCategoryFromDisplay(a);g.destroy(c);e.forEach(a.displayFields,function(a){var b=this.configTree.findNode(a.fieldPath);b&&(b.setTemplateField(a.fieldJson),b.toRightDiv&&d.set(b.toRightDiv,"display","block"))},this);a.displayFields=[];b.stopPropagation();this._checkTemplateStatus()})));this.own(r(l,"click",b.hitch(this,function(){"block"===d.get(h,"display")?(d.set(h,"display","none"),u.set(n,"src",this.arrowImgSrc)):(d.set(h,"display","block"),u.set(n,"src",this.imageFolder+
"v.png"));this._changeHeighlightCategoryHead(a.name)})));this.drawFields(a,c,h);d.set(h,"display","none")},drawFields:function(a,b,c){e.forEach(a.displayFields,function(d){this.drawField(a,b,c,d)},this)},addWidgetConfigToConfigTree:function(a){var c=new p,d=a.search(/widgets\[[0-9]+\]/),e=a.slice(d,a.length).indexOf("]"),d=a.slice(0,d+e+1);a=d+"_config";var d=this.configTree.findNode(d),f=this.configTree.findNode(a);a=this.fullAppConfig.getConfigElementById(d.jsonObject.id);z.getInstance().tryLoadWidgetConfig(a).then(b.hitch(this,
function(a){if(a){var b;f.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(b in a)a.hasOwnProperty(b)&&(b=f.addChild(a[b],b,f.absolutePath,f.level),this.drawTree(b,f.subLineDomNode))}c.resolve()}));return c},drawField:function(f,h,k,m){var n,p,q,s,t,v,w,x;this.configTree.findNode(m.fieldPath);x=l.getDefaultTemplateField(m.fieldPath,m.fieldJson.type,m.fieldJson.label);for(n in m.fieldJson)m.fieldJson.hasOwnProperty(n)&&(x[n]=m.fieldJson[n]);n=g.create("div",{"class":"field-div",
fieldDiv:m.fieldPath},k);this.own(r(n,"click",b.hitch(this,function(c,e){function f(){g=this.configTree.findNode(m);h=a.position(this.treePart).y;l=a.position(g.lineDomNode).y;k=l-h;(0>k||k>d.get(this.categoryPart,"height"))&&g.lineDomNode.scrollIntoView(!1);this._changeHeighlightFieldDomNode(m);this._changeHeighlightTreeDomNode(g.lineDomNode);this._changeHeighlightCategoryHead(e.name)}var g,h,l,k,m=c.fieldPath;if(g=this.configTree.findNode(m)){for(;g;)d.set(g.subLineDomNode,"display","block"),g=
g.parentNode;b.hitch(this,f)()}else this.addWidgetConfigToConfigTree(m).then(b.hitch(this,function(){for(g=this.configTree.findNode(m);g;)d.set(g.subLineDomNode,"display","block"),g=g.parentNode;b.hitch(this,f)()}))},m,f)));f=g.create("div",{"class":"field-head-div"},n);g.create("span",{"class":"field-head-title-div",innerHTML:b.hitch(this,function(a){var c="",d=a.split("_"),f=b.clone(d);e.forEach(d,function(a,b){var c,e="";if(-1!==a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(c=
0;c<=b;c++)e+=d[c]+"_";c=this.configTree.findNode(e.slice(0,-1));f[b]=c.label}},this);for(a=1;a<f.length;a++)c+=f[a]+"_";return c.slice(0,-1)})(m.fieldPath)},f);q=g.create("div",{"class":"field-fold-div jimu-float-leading"},f);s=g.create("img",{"class":"field-fold-img",src:this.arrowImgSrc,alt:"img"},q);q=g.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);v=g.create("div",
{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);t=g.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);var y=g.create("div",{"class":"field-fixed-content-div",style:"display:none;"},n);g.create("span",{"class":"field-label-span",innerHTML:this.nls.fieldLabel},
y);p=g.create("input",{"class":"jimu-input field-label-input",type:"text",value:x.label},y);this.own(r(p,"change",b.hitch(this,function(a,b){this._onFieldChange(a,{key:"label",value:b.value})},m.fieldPath,p)));g.create("span",{"class":"field-type-span",innerHTML:this.nls.fieldType},y);p=(new c({name:"selectFieldType","class":"field-type-select",options:[{label:"string",value:"string"},{label:"boolean",value:"boolean"},{label:"number",value:"number"},{label:"options",value:"options"}],value:x.type})).placeAt(y);
w=g.create("div",{"class":"field-content-div",style:"display:none;"},n);this.drawFieldContent(m.fieldPath,x,w,p.getValue());this.own(r(p,"change",b.hitch(this,function(a,b,c,e){this.drawFieldContent(a,b,c,e);this._onFieldChange(a,{key:"type",value:e});d.set(c,"display","block")},m.fieldPath,x,w)));this.own(r(f,"click",b.hitch(this,function(){"block"===d.get(w,"display")?(d.set(w,"display","none"),d.set(y,"display","none"),u.set(s,"src",this.arrowImgSrc)):(d.set(w,"display","block"),d.set(y,"display",
"block"),u.set(s,"src",this.imageFolder+"v.png"))})));this.own(r(q,"click",b.hitch(this,function(a,c,e,f){var h=a.fieldPath,l=this.configTree.findNode(h);l?(l.setTemplateField(a.fieldJson),l.toRightDiv&&d.set(l.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(h).then(b.hitch(this,function(){var b=this.configTree.findNode(h);a.fieldJson&&b.setTemplateField(a.fieldJson)}));l=this.categoryManager.getCategoryByField(h);l.removeFieldFromDisplay(h);g.destroy(c);l.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(l),
g.destroy(e));f.stopPropagation();this._checkTemplateStatus()},m,n,h)));this.own(r(t,"click",b.hitch(this,function(a,b,c){var d=this.categoryManager.getCategoryByField(a);d.moveup(a)&&(g.empty(b),this.drawFields(d,h,b),this._changeHeighlightFieldDomNode(a));c.stopPropagation();this._checkTemplateStatus()},m.fieldPath,k)));this.own(r(v,"click",b.hitch(this,function(a,b,c){var d=this.categoryManager.getCategoryByField(a);d.movedown(a)&&(g.empty(b),this.drawFields(d,h,b),this._changeHeighlightFieldDomNode(a));
c.stopPropagation();this._checkTemplateStatus()},m.fieldPath,k)))},drawFieldContent:function(a,d,f,h){var l,k,m,n;g.empty(f);g.create("span",{"class":"field-tooltip-span",innerHTML:this.nls.tooltip},f);l=g.create("input",{"class":"jimu-input field-tooltip-input",type:"text",value:d.tooltip},f);this.own(r(l,"change",b.hitch(this,function(a,b){this._onFieldChange(a,{key:"tooltip",value:b.value})},a,l)));g.create("br",{},f);"string"===h?(g.create("span",{"class":"field-string-ph-span",innerHTML:this.nls.placeholder},
f),h=g.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:d.placeHolder},f),this.own(r(h,"change",b.hitch(this,function(a,b){this._onFieldChange(a,{key:"placeHolder",value:b.value})},a,h))),h=g.create("div",{"class":"field-text-type-div"},f),g.create("span",{"class":"field-text-type-span",innerHTML:this.nls.textBoxType},h),d=(new c({name:"stringOptions","class":"field-string-options",options:[{label:"richtext",value:"richtext"},{label:"textarea",value:"textarea"},{label:"textbox",
value:"textbox"}],value:d.stringFieldOption})).placeAt(h),this.own(r(d,"change",b.hitch(this,function(a,b){this._onFieldChange(a,{key:"stringFieldOption",value:b})},a)))):"number"===h?(g.create("span",{"class":"field-num-min-span",innerHTML:this.nls.minvalue},f),k=g.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:d.constraints.min},f),g.create("br",{},f),g.create("span",{"class":"field-num-max-span",innerHTML:this.nls.maxvalue},f),m=g.create("input",{"class":"jimu-input field-num-input field-num-max-input",
type:"text",value:d.constraints.max},f),g.create("br",{},f),g.create("span",{"class":"field-num-places-span",innerHTML:this.nls.places},f),n=g.create("input",{"class":"jimu-input field-num-input field-num-places-input",type:"text",value:d.constraints.places},f),this.own(r(k,"change",b.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,max:m.value,places:n.value}})},a))),this.own(r(m,"change",b.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,
max:m.value,places:n.value}})},a))),this.own(r(n,"change",b.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,max:m.value,places:n.value}})},a)))):"options"===h&&(h=g.create("div",{"class":"field-options-add-div"},f),l=g.create("div",{"class":"field-options-add-content"},h),g.create("div",{"class":"field-options-add-img-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},l),g.create("div",{"class":"field-options-add-text-div jimu-float-leading",
innerHTML:this.nls.addNewOption},l),e.forEach(d.options,function(b){this._onFieldOptionsAdd(a,f,b.label,b.value)},this),this.own(r(h,"click",b.hitch(this,this._onFieldOptionsAdd,a,f,"",""))))},_changeHeighlightFieldDomNode:function(a){s(".field-div",this.categoryPart).removeClass("field-heighlight-div");h.add(s('div[fieldDiv\x3d"'+a+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(a){this.heighlightTreeDomNode&&h.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");
h.add(a,"tree-node-heighlight-div");this.heighlightTreeDomNode=a},_changeHeighlightCategoryHead:function(b){s(".category-head-div",this.categoryPart).removeClass("category-head-div-selected");b=s("div[categoryHeadDiv\x3d'"+b+"']",this.categoryPart)[0];a.addClass(b,"category-head-div-selected")},_onToRightDiv:function(b,c,e){var f,g,h=this.categoryManager.getCategoryByField(b.absolutePath);f=this.categoryManager.findDisplayCategory(h.name);g={fieldPath:b.absolutePath,fieldJson:b.getTemplateField()};
if(-1===f){if("add"!==c)return;this.categoryManager.addCategoryToDisplay(h);h.addFieldToDisplay(g);this.drawCategory(h);f=s("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0]}else if(-1===h.findFieldFromDisplay(b.absolutePath)){if("add"!==c)return;h.addFieldToDisplay(g);c=s("div[categoryDiv\x3d'"+h.name+"']",this.categoryPart)[0];f=s("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0];this.drawField(h,c,f,g)}else f=s("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0];d.set(f,"display",
"block");g=s('div[fieldDiv\x3d"'+b.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(h.name);this._changeHeighlightFieldDomNode(b.absolutePath);this._changeHeighlightTreeDomNode(e);b=a.position(this.categoryPart).y;b=a.position(g).y-b;(0>b||b>d.get(this.categoryPart,"height"))&&g.scrollIntoView(!1)},_onFieldChange:function(a,b){var c=this.configTree.findNode(a),d=this.categoryManager.getCategoryByField(a).getDisplayField(a);d.fieldJson[b.key]=b.value;c.templateField=d.fieldJson;
this._checkTemplateStatus()},_onFieldOptionsAdd:function(a,c,d,e){var f=g.create("div",{"class":"field-options-div"},c);g.create("div",{"class":"field-options-label-div jimu-float-leading",innerHTML:this.nls.label},f);d=g.create("input",{"class":"jimu-input field-options-label-input jimu-float-leading",type:"text",value:d},f);this.own(r(d,"change",b.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(c)})},a)));g.create("div",{"class":"field-options-value-div jimu-float-leading",
innerHTML:this.nls.value},f);e=g.create("input",{"class":"jimu-input field-options-value-input jimu-float-leading",type:"text",value:e},f);this.own(r(e,"change",b.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(c)})},a)));e=g.create("div",{"class":"field-options-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"delete_search.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);this.own(r(e,"click",b.hitch(this,function(a){g.destroy(f);this._onFieldChange(a,
{key:"options",value:this._getFieldOptions(c)})},a)))},_getFieldOptions:function(a){var c=[];s(".field-options-div",a).forEach(b.hitch(this,function(a){c.push({label:s(".field-options-label-input",a).attr("value")[0],value:s(".field-options-value-input",a).attr("value")[0]})}));return c},_onReviewJsonDivClick:function(){var a=this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(a);u.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead2);d.set(this.showJsonDiv,"display","block");
d.set(this.reviewJsonDiv,"display","none");d.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){u.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);d.set(this.reviewJsonDiv,"display","block");d.set(this.reviewJsonBackDiv,"display","none");d.set(this.showJsonDiv,"display","none")},_saveAgolTemplate:function(a){var c=new p,d=m.stringify(this.categoryManager.getTemplateJson("fullJson")),e={itemId:a?a:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:
null,json:d};y.saveAgolTemplate(this.app,e).then(b.hitch(this,function(){this.app.agolTemplateInfo=e;this.lastTemplateJson=this.categoryManager.getTemplateJson();c.resolve()}),function(a){new D({message:a});c.reject()});return c},_onDownloadNodeClick:function(){},_onExportClick:function(){var a=m.stringify(this.categoryManager.getTemplateJson());this.app.agolTemplateInfo&&this.app.agolTemplateInfo.itemId?this._updateAgolTemplate(a):this._exportAgolTemplate(a)},_updateAgolTemplate:function(a){var c=
new p,d=!B.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson());this.loading.show(this.nls.updating);d?this._saveAgolTemplate().then(b.hitch(this,function(){this._disablePopupButton(1,this.nls.saved);c.resolve()})):c.resolve();c.then(b.hitch(this,function(){G.getPortal(window.portalUrl).getUser().then(b.hitch(this,function(c){c.updateItem(this.app.agolTemplateInfo.itemId,{text:a}).then(b.hitch(this,function(){this.loading.hide();H._exportedMessage({itemId:this.app.agolTemplateInfo.itemId,
message:this.nls.exportSuccessfulUpdate},this.nls.exportMessageTitleUpdate,this.nls)}),b.hitch(this,function(a){this.loading.hide();console.error(a.message||a);H._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed7},this.nls.exportMessageTitleUpdate,this.nls)}))}),b.hitch(this,function(a){this.loading.hide();console.error(a.message||a);H._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed6},this.nls.exportMessageTitleUpdate,this.nls)}))}))},_exportAgolTemplate:function(a){var c=
"";window.isXT?c="http://"+window.location.host+path+"apps/"+this.app.id:(c=A.getStandardPortalUrl(window.portalUrl),c=A.setProtocol(c,"http:"),c=c+"/apps/webappviewer/index.html?id\x3d"+this.app.id);(new x({_templateUrl:c,_temlateJson:a,pluginManager:this.plugin.pluginManager,nls:this.nls,_afterAddItemOfExportCallback:b.hitch(this,this._afterAddItemOfExportCallback)})).startup()},_afterAddItemOfExportCallback:function(c){this._saveAgolTemplate(c).then(b.hitch(this,function(){this._disablePopupButton(1,
this.nls.saved);a.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.update)}))},_onSaveClick:function(){a.setAttr(this.popup.enabledButtons[1],"innerHTML",this.nls.saving);this._saveAgolTemplate().then(b.hitch(this,function(){this._disablePopupButton(1,this.nls.saved)}))},_onCancelClick:function(){if(B.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson()))this._closePopup(),this.destroyRecursive();else var a=new E({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image jimu-float-leading'src\x3d'"+
this.imageFolder+"alert.png' style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMeg+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:b.hitch(this,function(){this._saveAgolTemplate().then(b.hitch(this,function(){a.close();this._closePopup();this.destroyRecursive()}))})},{label:this.nls.doNotSave,onClick:b.hitch(this,function(){a.close();
this._closePopup();this.destroyRecursive()})},{label:this.nls.cancel,onClick:b.hitch(this,function(){a.close()})}]})},_closePopup:function(){this.popup&&(this.popup.closeTemplate=!0,this.popup.close())},_checkTemplateStatus:function(){B.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson())||this._enablePopupButton(1,this.nls.save)},_disablePopupButton:function(b,c){this.popup.disableButton(b);a.setAttr(this.popup.disabledButtons[b],"innerHTML",c)},_enablePopupButton:function(b,c){this.popup.enableButton(b);
a.setAttr(this.popup.enabledButtons[b],"innerHTML",c)},_initPopup:function(){this.app.agolTemplateInfo&&this.app.agolTemplateInfo.itemId&&G.getPortal(window.portalUrl).getItemById(this.app.agolTemplateInfo.itemId).then(b.hitch(this,function(){a.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.update)}),b.hitch(this,function(){this.app.agolTemplateInfo.itemId=null;a.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.download)}));this.popup.disableButton(1);this.popup.onClose=b.hitch(this,
function(){if(this.popup.closeTemplate)return!0;this._onCancelClick();return!1})},initWork:function(){this.lastTemplateJson=this.categoryManager.getTemplateJson();this._initPopup();this.loading=new C({hidden:!0});this.loading.placeAt(this.popup.domNode);this.loading.startup()}})})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/ConfigNode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(q,e,a){var f={},k=q([],{id:null,parentNode:null,keyString:null,
absolutePath:null,childs:null,nodeType:null,templateField:null,jsonObject:null,level:null,label:null,isVisible:!1,constructor:function(a,f,k,b,g){var d;this.parentNode=f;this.keyString=k;this.childs=[];this.absolutePath=""===b?k:b+"_"+k;this.jsonObject=a;this.level=g;this.initId();this.initLabel();this.initTemplateField(a);if("object"!==typeof a||null===a)this.nodeType="leaf";else if(e.isArrayLike(a)){this.nodeType="array";for(f=0;f<a.length;f++)this.addChild(a[f],this.keyString+"["+f+"]",b,g)}else for(d in this.nodeType=
"normal",a)a.hasOwnProperty(d)&&"function"!==typeof a[d]&&this.addChild(a[d],d,this.absolutePath,g)},initId:function(){var a,f;a=this.absolutePath.search(/_widgets\[[0-9]+\]/);f=this.absolutePath.search(/_groups\[[0-9]+\]/);-1!==a||-1!==f?-1!==this.absolutePath.search(/_widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/_groups\[[0-9]+\]$/)?this.id=this.parentNode.id+"["+this.jsonObject.id+"]":e.isArrayLike(this.parentNode.jsonObject)?this.id=this.parentNode.parentNode.id+"_"+this.keyString:this.id=
this.parentNode.id+"_"+this.keyString:this.id=this.absolutePath},initLabel:function(){this.label=this.keyString;if(-1!==this.absolutePath.search(/widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/groups\[[0-9]+\]$/))this.label=this.jsonObject.label},initTemplateField:function(a){this.templateField=k.getDefaultTemplateField(this.absolutePath,typeof a,this.label);k.setDefaultValue(this.absolutePath,a,this.id)},getTemplateFieldDefaultValue:function(){return this.templateField.defaultValue},getTemplateField:function(){var a=
{type:this.templateField.type,fieldName:this.id,label:this.templateField.label,tooltip:this.templateField.tooltip};"leaf"!==this.nodeType&&(a.fieldName+="--");switch(a.type){case "string":a.stringFieldOption=this.templateField.stringFieldOption;a.placeHolder=this.templateField.placeHolder;break;case "number":a.constraints=this.templateField.constraints;break;case "options":a.options=this.templateField.options}a.id=this.id;a.fieldPath=this.absolutePath;return a},setTemplateField:function(a){this.templateField.type=
a.type;this.templateField.label=a.label;this.templateField.tooltip=a.tooltip;"leaf"!==this.nodeType&&(this.templateField.fieldName=this.templateField.fieldName.slice(0,this.templateField.fieldName.length-2));switch(this.templateField.type){case "string":this.templateField.stringFieldOption=a.stringFieldOption;this.templateField.placeHolder=a.placeHolder;break;case "number":this.templateField.constraints=a.constraints;break;case "options":this.templateField.options=a.options}return a},addChild:function(a,
e,f,b){a=new k(a,this,e,f,b+1);this.childs.push(a);return a},isLeaf:function(){var a=!1;this.childs&&0<this.childs.length&&(a=!0);return a},findNode:function(a){var e=[],f,b,g;a.split("_").forEach(function(a){var b=a.search(/\[[0-9]+\]/);-1!==b&&e.push(a.slice(0,b));e.push(a)});b=this;if(b.keyString!==e[0])return null;for(a=1;a<e.length;a++){g=b.childs.length;for(f=0;f<g;f++)if(b.childs[f].keyString===e[a]){b=b.childs[f];break}if(f===g)return null}return b},setVisible:function(){for(var a=this;a;)a.isVisible=
!0,a=a.parentNode},findNodeById:function(a){var e=null;this.traversal(function(f){if(f.id===a)return e=f,!0});return e},traversal:function(a){if(a(this))return!0;for(var e=0;e<this.childs.length;e++)if(this.childs[e].traversal(a))return!0},deserialize:function(e){e&&a.forEach(e.configurationSettings,function(e){a.forEach(e.fields,function(a){this.findNode(a.fieldName).setTemplateField(a)},this)},this)}});k.getDefaultValue=function(a){return f[a]};k.setDefaultValue=function(a,e,k){var b=null,b=e;"app_portalUrl"===
a||"app_map_itemId"===a?b=null:"app_title"===a?b="":"app_subtitle"===a?b="":"object"===typeof e&&(b=!1);f[k]=b};k.defaultValueExisted=function(a){return void 0===f[a]?!1:!0};k.getDefaultTemplateField=function(a,e,f){a="string";switch(e){case "number":a="number";break;case "boolean":a="boolean";break;case "object":a="boolean",f="disable"}return{type:a,label:f,tooltip:"",stringFieldOption:"textbox",placeHolder:f,constraints:{min:0,max:100,places:0},options:[{label:"label1",value:"value1"},{label:"label2",
value:"value2"}]}};return k})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/CategoryManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/json ./ConfigNode ./Category".split(" "),function(q,e,a,f,k,n){return q([],{categorys:null,displayCategorys:null,constructor:function(a,e,b){b=b&&b.json?b.json:null;this.categorys=[];this.displayCategorys=[];this.initCategorys(e,a);this.deserialize(b,a)},initCategorys:function(e,f){var b=new n(f,"Attribute","Attribute",
["app_title","app_subtitle","app_logo","app_links"],[],["app_title","app_subtitle"]);this.categorys.push(b);a.forEach(e.widgetOnScreen.widgets,function(a,b){var e="ScreenWidget_"+a.id,k="app_widgetOnScreen_widgets["+b+"]",k=[k+"_label",k+"_visible",k+"_config"],m=[];a.uri&&this.categorys.push(new n(f,e,a.label+" widget",k,m))},this);a.forEach(e.widgetOnScreen.groups,function(b,d){var e="ScreenWidgetGroup_"+b.id,k="app_widgetOnScreen_groups["+d+"]",m=[k+"_label",k+"_visible"];a.forEach(b.widgets,function(a,
b){m.push(k+"_widgets["+b+"]_label");m.push(k+"_widgets["+b+"]_visible");m.push(k+"_widgets["+b+"]_config")});this.categorys.push(new n(f,e,b.label,m,[]))},this);a.forEach(e.widgetPool.widgets,function(a,b){var e="widgetPoolWidget_"+a.id,k="app_widgetPool_widgets["+b+"]",k=[k+"_label",k+"_visible",k+"_config"],m=[];a.uri&&this.categorys.push(new n(f,e,a.label+" widget",k,m))},this);a.forEach(e.widgetPool.groups,function(b,d){var e="widgetPoolGroup_"+b.id,k="app_widgetPool_groups["+d+"]",m=[k+"_label",
k+"_visible"];a.forEach(b.widgets,function(a,b){m.push(k+"_widgets["+b+"]_label");m.push(k+"_widgets["+b+"]_visible");m.push(k+"_widgets["+b+"]_config")});this.categorys.push(new n(f,e,b.label,m,[]))},this);this.displayCategorys.push(b)},getCategoryByName:function(a){return this.categorys[this.findCategory(a)]},getCategoryByField:function(a){var e;for(e=0;e<this.categorys.length;e++)if(this.categorys[e].hasField(a))return this.categorys[e];return null},findCategory:function(a){return this._find(a,
this.categorys)},findDisplayCategory:function(a){return this._find(a,this.displayCategorys)},_find:function(a,e){var b;for(b=0;b<e.length&&e[b].name!==a;b++);return b===e.length?-1:b},addCategoryToDisplay:function(a){-1===this.findDisplayCategory(a.name)&&this.displayCategorys.push(a)},removeCategoryFromDisplay:function(a){a=this.findDisplayCategory(a.name);0<=a&&this.displayCategorys.splice(a,1)},moveup:function(a){var e;a=this.findDisplayCategory(a.name);return 0<a?(e=this.displayCategorys[a],this.displayCategorys[a]=
this.displayCategorys[a-1],this.displayCategorys[a-1]=e,!0):!1},movedown:function(a){var e;a=this.findDisplayCategory(a.name);return 0<=a&&a<this.displayCategorys.length-1?(e=this.displayCategorys[a],this.displayCategorys[a]=this.displayCategorys[a+1],this.displayCategorys[a+1]=e,!0):!1},getTemplateJson:function(f){var n={configurationSettings:[],values:{}};a.forEach(this.displayCategorys,function(b,g){var d={category:b.title,fields:[]};"fullJson"===f&&(d.categoryName=b.name);a.forEach(b.displayFields,
function(a,b){var g=e.clone(a.fieldJson);if(!f||"fullJson"!==f)delete g.id,delete g.fieldPath;d.fields[b]=g;n.values[g.fieldName]=k.getDefaultValue(a.fieldJson.fieldName)},this);n.configurationSettings[g]=d},this);return n},deserialize:function(e,n){if(e){a.forEach(this.displayCategorys,function(a){a.displayFields=[]});this.displayCategorys=[];e=f.parse(e);a.forEach(e.configurationSettings,function(a){var b=this.getCategoryByName(a.categoryName),e=0;b&&(e=b.deserialize(a.fields,n),0<e&&this.displayCategorys.push(b))},
this);var b,g=e.values;for(b in g)g.hasOwnProperty(b)&&("function"!==typeof g[b]&&!k.defaultValueExisted(b))&&k.setDefaultValue(null,g[b],b)}}})})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/Category":function(){define(["dojo/_base/declare","dojo/_base/array"],function(q,e){return q([],{name:null,title:null,includeFields:null,excludeFields:null,displayFields:null,constructor:function(a,f,k,n,r,q){this.name=f;this.title=k;this.includeFields=n;this.excludeFields=r;this.displayFields=
[];e.forEach(q,function(b){var e=a.findNode(b);e&&this.displayFields.push({fieldPath:b,fieldJson:e.getTemplateField()})},this)},hasField:function(a){var e=!1,k;for(k=0;k<this.includeFields.length;k++)if(0===a.indexOf(this.includeFields[k])){e=!0;break}for(k=0;k<this.excludeFields.length;k++)if(0===a.indexOf(this.excludeFields[k])){e=!1;break}return e},getDisplayField:function(a){a=this.findFieldFromDisplay(a);return-1!==a?this.displayFields[a]:null},findFieldFromDisplay:function(a){var e;for(e=0;e<
this.displayFields.length;e++)if(this.displayFields[e].fieldPath===a)return e;return-1},addFieldToDisplay:function(a){var e;e=this.findFieldFromDisplay(a.fieldPath);-1===e?this.displayFields.push({fieldPath:a.fieldPath,fieldJson:a.fieldJson}):this.displayFields[e].fieldJson=a.fieldJson},removeFieldFromDisplay:function(a){var e;e=this.findFieldFromDisplay(a);0<=e&&this.displayFields.splice(e,1);return a},moveup:function(a){var e;a=this.findFieldFromDisplay(a);return 0<a?(e=this.displayFields[a],this.displayFields[a]=
this.displayFields[a-1],this.displayFields[a-1]=e,!0):!1},movedown:function(a){var e;a=this.findFieldFromDisplay(a);return 0<=a&&a<this.displayFields.length-1?(e=this.displayFields[a],this.displayFields[a]=this.displayFields[a+1],this.displayFields[a+1]=e,!0):!1},displayIsEmpty:function(){return 0===this.displayFields.length},deserialize:function(a,f){this.displayFields=[];e.forEach(a,function(a){var e;if(e=f.findNodeById(a.id))e=e.absolutePath+"",a.fieldPath=e,this.displayFields.push({fieldPath:e,
fieldJson:a})},this);return this.displayFields.length}})})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/ShowJsonCodePage":function(){define(["dojo/_base/declare","dijit/_WidgetBase"],function(q,e){return q([e],{baseClass:"show-json-code-div",postCreate:function(){this.inherited(arguments);this.jsonEditor=ace.edit(this.domNode);this.jsonEditor.setTheme("ace/theme/textmate");this.jsonEditor.setHighlightActiveLine(!0);this.jsonEditor.setValue(JSON.stringify(this.json,null,2));this.jsonEditor.getSession().setMode("ace/mode/json")},
setJSON:function(a){this.json=a;this.jsonEditor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.jsonEditor.getValue())},setConfig:function(a){return this.setJSON(a)},getConfig:function(){return this.getJSON()}})})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/Export":function(){define("dojo/_base/declare dojo/_base/lang dijit/dijit dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Export.html dojo/Deferred dojo/promise/all dojo/dom-style dojo/dom-attr jimu/dijit/Message jimu/dijit/LoadingShelter builder/portalUtils ./ExportMessage jimu/dijit/Popup builder/dijit/ItemInfo".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p){return q([f,k],{templateString:n,baseClass:"export-agoltemplate",_templateUrl:null,_temlateJson:null,pluginManager:null,_afterAddItemOfExportCallback:null,startup:function(){this.popupDlg()},popupDlg:function(a){this._initDlgPage();this.popup=new s({content:this,container:"main-page",titleLabel:this.nls.title2,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:e.hitch(this,this._onNextClick)},{label:this.nls.cancel,onClick:e.hitch(this,this._onCancelClick)}]})},
_initDlgPage:function(){window.isXT&&(g.set(this.explain1,"innerHTML",this.nls.explain1),b.set(this.explain1,"display","block"));this.itemInfoDijit=new p({itemInfo:this.getDefaultAppInfo()});this.itemInfoDijit.placeAt(this.itemInfoBox)},getDefaultAppInfo:function(){return{name:"",description:this.nls.templateDefaultSnippet,tags:["template"],folderId:"",sharing:void 0}},_onNextClick:function(){var a=this.itemInfoDijit.getProperties();if(a.name&&a.tags){var b=new h;b.placeAt(this.popup.domNode);b.startup();
this.exportTemplate(a,this._templateUrl,this._temlateJson,this._afterAddItemOfExportCallback).then(e.hitch(this,function(a){this.close();b.destroy();m._exportedMessage(a,this.nls.exportMessageTitle,this.nls)}),e.hitch(this,function(a){this.close();b.destroy();m._exportedMessage(a,this.nls.exportMessageTitle,this.nls)}))}else new d({message:this.nls.noTitleMessage})},_onCancelClick:function(){this.close()},close:function(){this.popup.close()},exportTemplate:function(a,b,d,f){var g=new r,h=new r,k=
new r,m=new r,p="http://"+window.location.host+window.location.pathname,n=p.indexOf("index.html");-1!==n&&(p=p.slice(0,n));p+="builder/plugins/popup-actions/popup-agoltemplate/css/images/templateThumbnail.jpg";u.getPortal(window.portalUrl).getUser().then(function(a){h.resolve(a)},function(a){h.reject(a);console.error(a.message||a);g.reject({itemId:null,message:this.nls.exportTemplateFailed5})});h.then(e.hitch(this,function(e){var h={title:a.name,snippet:a.description,tags:a.tags,url:b,thumbnailurl:p,
type:"Web Mapping Application",typeKeywords:"Configurable, JavaScript",text:d};a.folderId===e.username&&(a.folderId="");e.addItem(h,a.folderId).then(function(a){a.success?(k.resolve(a),f(a.id)):(console.error(a.message||""),k.reject(this.nls.exportTemplateFailed1))},function(a){k.reject(a);console.error(a.message||a);g.reject({itemId:null,message:this.nls.exportTemplateFailed1})})}));u.getTemplatesGroup(window.portalUrl).then(e.hitch(this,function(a){m.resolve(a)}),function(a){m.reject(a);console.error(a.message||
a);g.reject({itemId:null,message:this.nls.exportTemplateFailed2})});t({user:h,itemRes:k,templateGroup:m}).then(e.hitch(this,function(b){b.user.shareItem({groups:b.templateGroup.id},b.itemRes.id,a.folderId).then(e.hitch(this,function(a){-1===a.notSharedWith.indexOf(b.templateGroup.id)?g.resolve({itemId:b.itemRes.id,message:this.nls.exportSuccessful}):g.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed3,type:"no_permission_to_share"})}),function(a){console.error(a.message||a);g.reject({itemId:b.itemRes.id,
message:this.nls.exportTemplateFailed4})})}));return g}})})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/ExportMessage":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ExportMessage.html jimu/portalUrlUtils jimu/dijit/Popup".split(" "),function(q,e,a,f,k,n,r){var t=q([a,f],{baseClass:"agol-template-export-message",templateString:k,constructor:function(){},postCreate:function(){this.inherited(arguments);"no_permission_to_share"===
this.exportedInfo.type?(e.setAttr(this.word1,"innerHTML",this.nls.exportTemplateFailed31),this.exportedInfo.itemUrl&&(e.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl21),e.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl)),e.setAttr(this.word2,"innerHTML",this.nls.exportTemplateFailed32)):(this.exportedInfo.message&&e.setAttr(this.resMessage,"innerHTML",this.exportedInfo.message),this.exportedInfo.itemUrl&&(e.setAttr(this.word1,"innerHTML",this.nls.descriptionTemplateUrl1),
e.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl2),e.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl),e.setAttr(this.word2,"innerHTML",this.nls.descriptionTemplateUrl3)))}});t._exportedMessage=function(a,e,d){a.itemId&&(a.itemUrl=n.getItemDetailsPageUrl(window.portalUrl,a.itemId));a=new t({exportedInfo:a,nls:d});new r({content:a,titleLabel:e,width:"600",autoHeight:!0,buttons:[{label:d.ok}]})};return t})},"builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/utils":function(){define("dojo/_base/lang dojo/Deferred jimu/utils jimu/dijit/Message jimu/WidgetManager dojo/promise/all dojo/json builder/serviceUtils".split(" "),
function(q,e,a,f,k,n,r,t){return{loadAllWidgetConfigs:function(a){var f=new e,d=[];a.visitElement(function(a){if(a.uri){var b=k.getInstance().tryLoadWidgetConfig(a).then(function(b){b&&(a.config=b)});d.push(b)}});n(d).then(function(){f.resolve(a)},function(a){f.reject(a)});return f},saveAgolTemplate:function(a,g,d){var h=new e,k={itemId:d?d:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:null,json:g};t.saveAgolTemplate(this.app,k).then(q.hitch(this,function(){this.app.agolTemplateInfo=
k;this.lastTemplateJson=this.categoryManager.getTemplateJson();h.resolve()}),function(a){new f({message:a});h.reject()});return h}}})},"builder/plugins/popup-actions/popup-saveas/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-saveas/Plugin","dojo/text!builder/plugins/popup-actions/popup-saveas/Plugin.html","dojo/i18n!builder/plugins/popup-actions/popup-saveas/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-saveas/Plugin":function(){define(["dojo/_base/declare",
"dojo/_base/lang","builder/BasePlugin","jimu/dijit/Message"],function(q,e,a,f){return q([a],{baseClass:"plugin-app-actions-popup",onClick:function(){if("stemapp"===window.appInfo.appId)new f({message:this.nls.canNotSaveMeg});else{var a=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(e.hitch(this,function(a){a.popupDlg(this.nls.saveAsTitle,window.appInfo.appId,window.appConfig)}))}}})})},"builder/plugins/startup/_build-generate_module":function(){define(["builder/plugins/startup/Plugin",
"dojo/text!builder/plugins/startup/Plugin.html","dojo/text!builder/plugins/startup/css/style.css"],function(){})},"builder/plugins/startup/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/serviceUtils builder/utils jimu/dijit/ViewStack jimu/utils".split(" "),function(q,e,a,f,k,n,r,t,b){return q([k],{baseClass:"plugin-startup",constructor:function(){this.appTypes=["HTML"]},postCreate:function(){this.main=new t({viewType:"dijit",views:[]},
this.viewStackNode)},startup:function(){this.main.startup();this._loadHeaderPlugin().then(e.hitch(this,function(){this._afterHeaderLoaded()}))},getCurrentView:function(){return this.main.getSelectedView()},switchToAppList:function(){var a=e.hitch(this,function(){if(window.history&&window.history.pushState){this._switchToAppList();var a=b.url.removeQueryParamFromUrl(window.location.href,"id");window.history.pushState({path:a},"",a)}else window.location.href="index.html"});"appconfig"===this.main.getSelectedLabel()&&
f.publish("closeAppConfigPage",a)},switchToAppConfig:function(a){if(window.history&&window.history.pushState){var d=window.location.href,d=b.url.removeQueryParamFromUrl(d,"title"),d=b.url.removeQueryParamFromUrl(d,"tags"),d=b.url.removeQueryParamFromUrl(d,"summary"),d=b.url.removeQueryParamFromUrl(d,"folder"),d=b.url.removeQueryParamFromUrl(d,"sharewithwebmap"),d=b.url.removeQueryParamFromUrl(d,"webmap"),d=b.url.addQueryParamToUrl(d,"id",a.id);window.history.pushState({path:d},"",d)}this._switchToApp(a)},
_afterHeaderLoaded:function(){var a;window.isXT?queryObject.id?(a={id:queryObject.id.replace("#","")},this._switchToApp(a)):this._switchToAppList():queryObject.id?(a={id:queryObject.id.replace("#","")},this._switchToApp(a)):queryObject.title?(a={name:queryObject.title},queryObject.tags&&(a.tags=queryObject.tags),queryObject.summary&&(a.description=queryObject.summary),queryObject.folder&&(a.folderId=queryObject.folder),queryObject.sharewithwebmap&&(a.sharing="true"===queryObject.sharewithwebmap),
queryObject.webmap&&(a.webmap=queryObject.webmap),this._createApp(a)):window.location.href=window.portalUrl},_switchToApp:function(a){var b=this.main.getViewByLabel("appconfig");b&&this.main.removeView(b);"stemapp"===a.id&&(a.id="HTML");n.getAppInfo(a.id).then(e.hitch(this,function(b){var d;d=window.isXT?b.appType:"HTML";b.appType=d;var f=this.pluginManager.getStemappInfo(b.appType),k;k=-1<this.appTypes.indexOf(a.id)?f.appPath:r.getAppPathById(b.id);window.stemappInfo=f;window.appInfo={appType:d,
appPath:k,appId:b.id+"",appOwner:b.creator||b.owner};d=this.filterExtensionsByAppType("app-config",d);0===d.length?console.error("Do not find app-config extension."):1<d.length?console.error("Find more than one app-config extension."):(d=this.pluginsMeta[d[0].pluginName],d.options={appInfo:b},this.pluginManager.loadPlugin(d).then(e.hitch(this,function(a){a.label="appconfig";this.main.addView(a);this.main.switchView("appconfig")})),this._showAppName(b))}))},_showAppName:function(a){"stemapp"===a.id?
this.header.setAppName("stemapp"):this.header.setAppName(a.name)},_hideAppName:function(){this.header.setAppName("")},_createApp:function(a){var b=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[b.pluginName]).then(e.hitch(this,function(b){b.createNewApp(a)}))},_switchToAppList:function(){if(this.main.getViewByLabel("applist"))this.main.switchView("applist");else{var a=this.getPluginsMetaByExtensionPoint("app-list")[0];this.pluginManager.loadPlugin(a).then(e.hitch(this,
function(a){a.label="applist";this.main.addView(a);this.main.switchView("applist")}))}this._hideAppName()},_loadHeaderPlugin:function(){var b=this.getPluginsMetaByExtensionPoint("header")[0];return this.pluginManager.loadPlugin(b).then(e.hitch(this,function(b){a.place(b.domNode,this.headerNode);b.startup();return this.header=b}))}})})},"builder/plugins/stemapps/web2d/_build-generate_module":function(){define([],function(){})},"builder/plugins/theme-config/_build-generate_module":function(){define(["builder/plugins/theme-config/Plugin",
"dojo/text!builder/plugins/theme-config/Plugin.html","dojo/text!builder/plugins/theme-config/css/style.css","dojo/i18n!builder/plugins/theme-config/nls/strings"],function(){})},"builder/plugins/theme-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/on dojo/dom dojo/cookie dojo/text!./Plugin.html dojo/dom-construct dojo/dom-style dojo/_base/array dojo/Deferred jimu/dijit/Message jimu/dijit/CheckBox ./ThemeManager builder/serviceUtils builder/BasePlugin".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c){return q([c],{baseClass:"plugin-theme-config",templateString:t,themeLoadDef:void 0,_themePageDef:void 0,constructor:function(){this._themePageDef=new h},postMixInProperties:function(){this.inherited(arguments);this.nls=e.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.own(f.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigLoaded)));this.own(f.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)))},
startup:function(){this.inherited(arguments);this.themeManager=new s;this.themeLoadDef=this.themeManager.loadThemes();this.themeLoadDef.then(e.hitch(this,function(a){this.initThemePage(a);this._themePageDef.resolve()}))},initThemePage:function(c){var f,g,h,m,p,n;d.forEach(c,function(c){p=a.create("div",{"class":"catalog-theme-content-div jimu-float-leading"},this.themeList);f=a.create("div",{"class":"catalog-theme-div"},p);a.create("div",{"class":"catalog-theme-name-div",innerHTML:c.getLabel(),title:c.getLabel()},
p);n=a.create("div",{"class":"catalog-theme-img-div"},f);b.create("img",{src:c.getIcon(),"class":"catalog-theme-img"},n);g=b.create("div",{"class":"theme-cl-selected-div"},f);b.create("img",{"class":"theme-cl-selected-img",src:this.folderUrl+"css/images/check.png"},g);k(f,"click",e.hitch(this,this._onStartChangeTheme,c.getName()));h=b.create("div",{"class":""},this.styleList);this.initStyle(c,h);m=b.create("div",{"class":""},this.layoutList);this.initLayout(c,m);c.domNodes.theme=f;c.domNodes.themeSL=
g;c.domNodes.styleList=h;c.domNodes.layoutList=m},this)},initStyle:function(c,f){var h,m,p,n;h=b.create("div",{"class":"style-section"},f);b.create("div",{innerHTML:this.nls.styleTitle,"class":"style-text"},h);n=b.create("div",{"class":"style-color-content"},h);d.forEach(c.getStyles(),function(a){m=b.create("div",{"class":"style-div jimu-float-leading"},n);g.set(m,"backgroundColor",a.styleColor);a.domNode=m;k(m,"click",e.hitch(this,this._onStyleChanged,a.name));p=b.create("div",{"class":"style-selected-div"},
m);b.create("img",{"class":"style-selected-img",src:this.folderUrl+"css/images/check.png"},p);a.selectedNode=p},this);a.setStyle(f,"display","none")},initLayout:function(c,e){var f;f=b.create("div",{"class":"layout-section",id:c.getName()+"-layout-section"},e);b.create("div",{innerHTML:this.nls.layoutTitle,"class":"layout-text"},f);d.forEach(c.getLayouts(),function(a){this._drawLayout(c,a,f)},this);a.setStyle(e,"display","none")},_drawLayout:function(a,c,d){var f;c.domClass||(c.domClass=" ");d=b.create("div",
{"class":"layout-out-div jimu-float-leading "},d);f=b.create("div",{"class":"layout-box-div "},d);d=b.create("div",{"class":"layout-div "+c.domClass,title:c.label},f);a=isRTL?c.RTLIcon?a.getUrl()+c.RTLIcon:this.folderUrl+"css/images/current_layout.png":c.icon?a.getUrl()+c.icon:this.folderUrl+"css/images/current_layout.png";b.create("img",{"class":"layout-image",src:a},d);c.domNode=d;c.boxDomNode=f;k(d,"click",e.hitch(this,this._onLayoutChanged,c.name));a=b.create("div",{"class":"layout-selected-div"},
d);b.create("img",{"class":"layout-selected-img",src:this.folderUrl+"css/images/check.png"},a);c.selectedNode=a},_onStyleChanged:function(a){this.changeStyle(a,null,!0)},_onLayoutChanged:function(a){this.changeLayout(a,null,!0)},_onStartChangeTheme:function(a){if(this.themeManager.currentThemeName!==a)if(r("disable_theme_switch_Message"))this.changeTheme(a,!0);else{var b=new u({message:"\x3cdiv\x3e"+this.nls.themeChangeMessage+"\x3c/div\x3e",width:500,buttons:[{label:this.nls.ok,onClick:e.hitch(this,
function(){c.checked&&r("disable_theme_switch_Message",!0);b.close();this.changeTheme(a,!0)})},{label:this.nls.cancel}]}),c=new m({label:this.nls.disableThemeSwitchMessage,"class":"jimu-float-leading",style:{marginTop:"10px"}});c.placeAt(b.contentContainerNode)}},changeStyle:function(b,c,d){c||(c=this.themeManager.getCurrentTheme());c.currentStyleName!==b&&(c.currentStyleName&&a.removeClass(c.getCurrentStyle().domNode,"style-selected"),c.changeCurrentStyle(b),a.addClass(c.getCurrentStyle().domNode,
"style-selected"),d&&f.publish("styleChanged",e.clone(c.getCurrentStyle())))},changeLayout:function(b,c,d){c||(c=this.themeManager.getCurrentTheme());c.currentLayoutName!==b&&(c.currentLayoutName&&(a.removeClass(c.getCurrentLayout().domNode,"layout-selected"),a.removeClass(c.getCurrentLayout().boxDomNode,"layout-box-selected")),c.changeCurrentLayout(b),a.addClass(c.getCurrentLayout().domNode,"layout-selected"),a.addClass(c.getCurrentLayout().boxDomNode,"layout-box-selected"),d&&f.publish("layoutChanged",
e.clone(c.getCurrentLayout())))},_copyThemeFromRepo:function(a){var b=new h,c=this.themeManager.getThemeByName(a);c.loadLayouts().then(e.hitch(this,function(){var d=c.getLayoutByName("default");p.copyThemeToApp(window.appInfo.appId,a,c.appConfig?c.appConfig.getCleanConfig():d.layoutConfig).then(e.hitch(this,function(a){a.success?b.resolve():(b.reject(),console.error("change theme error, response of 'copytheme' unsuccess"))}),function(a){b.reject(a);console.error("change theme error"+a)})}));return b},
changeTheme:function(b,c){var d=new h;this.themeManager.currentThemeName!==b?(c&&this.pluginManager.getPluginByName("app-config")._onStartChangeTheme(),this._copyThemeFromRepo(b).then(e.hitch(this,function(){this.themeManager.currentThemeName&&(a.removeClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected"),a.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","none"),a.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","none"));
this.themeManager.changeCurrentTheme(b);c&&f.publish("themeChanged",e.clone(this.themeManager.getCurrentTheme()));a.addClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected");a.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","block");a.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","block");d.resolve()}))):d.resolve();return d},_onAppConfigLoaded:function(a){this._setAppConfig(a,!0)},_onAppConfigChanged:function(a){this._setAppConfig(a,
!1)},_setAppConfig:function(b,c){var f,g;this._themePageDef.then(e.hitch(this,function(){c?(d.forEach(this.themeManager.themes,function(a){this.changeStyle("default",a,!1);this.changeLayout("default",a,!1);a.clear()},this),this.changeTheme(b.theme.name,!1).then(e.hitch(this,function(){b.theme.styles&&b.theme.styles[0]&&this.changeStyle(b.theme.styles[0],this.themeManager.getCurrentTheme(),!1);f=n.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");g=this.themeManager.getCurrentTheme().getLayoutByAppConfig(b.getCleanConfig());
g||(g=this.themeManager.getCurrentTheme().addLayout("appLayout",b.getCleanConfig(),"app-layout",this.nls.appLayout),this._drawLayout(this.themeManager.getCurrentTheme(),g,f));this.changeLayout(g.name,this.themeManager.getCurrentTheme(),!1);this.themeManager.getCurrentTheme().setAppConfig(b);a.setStyle(this.themeList,"display","block")}))):this.themeManager.getCurrentTheme()&&this.themeManager.getCurrentTheme().setAppConfig(b)}))}})})},"builder/plugins/theme-config/ThemeManager":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./Theme builder/serviceUtils jimu/utils".split(" "),
function(q,e,a,f,k,n,r){return q(null,{themes:void 0,constructor:function(){this.currentThemeName=null;this.themes=[]},loadThemes:function(){var q=new f;n.getAllThemes().then(a.hitch(this,function(a){a.success?(a.themes=a.themes.sort(function(a,b){return a.name>b.name}),e.forEach(a.themes,function(a){r.processManifestLabel(a,dojoConfig.locale);this.themes.push(new k(a))},this),q.resolve(this.themes)):(console.error("Gets themes failed! The response of getThemes is 'unsuccess'!"),q.reject(this.themes))}),
function(a){console.error("Gets themes failed!"+a);q.reject(this.themes)});return q},changeCurrentTheme:function(a){this.currentThemeName=a},getCurrentTheme:function(){return this.getThemeByName(this.currentThemeName)},getThemeByName:function(a){for(var b=0;b<this.themes.length;b++)if(a===this.themes[b].getName())return this.themes[b]}})})},"builder/plugins/theme-config/Theme":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/request jimu/utils".split(" "),
function(q,e,a,f,k,n,r,t){return q(null,{appConfig:void 0,currentStyleName:void 0,currentLayoutName:void 0,_manifest:void 0,constructor:function(a){this._manifest=a;this.domNodes={}},clear:function(){var b;this.appConfig=null;for(b=0;b<this._manifest.layouts.length;b++)if("appLayout"===this._manifest.layouts[b].name){this._manifest.layouts[b].domNode&&a.destroy(this._manifest.layouts[b].domNode);this._manifest.layouts.splice(b,1);break}},loadLayouts:function(){var a=new k,g=[],d=f.filter(this._manifest.layouts,
function(a){return"appLayout"!==a.name});f.forEach(d,function(a){g.push(r(this._manifest.url+a.uri,{handleAs:"json"}))},this);n(g).then(e.hitch(this,function(e){f.forEach(d,function(a,b){a.layoutConfig=e[b]},this);a.resolve()}),function(){a.reject()});return a},setAppConfig:function(a){this.appConfig=a},getName:function(){return this._manifest.name},getVersion:function(){return this._manifest.version},getLabel:function(){return this._manifest.label},getIcon:function(){return this._manifest.icon},
getLayouts:function(){return this._manifest.layouts},getStyles:function(){return this._manifest.styles},getUrl:function(){return this._manifest.url},getCurrentStyle:function(){return this.getStyleByName(this.currentStyleName)},getCurrentLayout:function(){return this.getLayoutByName(this.currentLayoutName)},changeCurrentStyle:function(a){this.currentStyleName=a},changeCurrentLayout:function(a){this.currentLayoutName=a},addLayout:function(a,e,d,f){var k,m=this.getLayouts();for(k=0;k<m.length;k++)if(m[k].name===
a)return null;a={description:"this is current app layout",name:a,label:f,layoutConfig:e,domClass:d};this._manifest.layouts.push(a);return a},getStyleByName:function(a){var e,d=null;for(e=0;e<this._manifest.styles.length;e++)if(this._manifest.styles[e].name===a){d=this._manifest.styles[e];break}return d},getLayoutByName:function(a){var e,d=null;for(e=0;e<this._manifest.layouts.length;e++)if(this._manifest.layouts[e].name===a){d=this._manifest.layouts[e];break}return d},getLayoutByAppConfig:function(a){var e,
d=null;for(e=0;e<this._manifest.layouts.length;e++)if(this.isAppUseLayout(a,this._manifest.layouts[e].layoutConfig)){d=this._manifest.layouts[e];break}return d},isAppUseLayout:function(a,f){var d=e.clone(a),h=e.clone(f);d.map||(d.map={});h.map||(h.map=d.map);d.map.position||(d.map.position={left:0,top:0});h.map.position||(h.map.position=d.map.position);if(!t.isEqual(d.map.position,h.map.position))return!1;d.widgetOnScreen||(d.widgetOnScreen={});h.widgetOnScreen||(h.widgetOnScreen={});d.widgetOnScreen.widgets||
(d.widgetOnScreen.widgets=[]);h.widgetOnScreen.widgets||(h.widgetOnScreen.widgets=[]);d.widgetOnScreen.groups||(d.widgetOnScreen.groups=[]);h.widgetOnScreen.groups||(h.widgetOnScreen.groups=[]);var k,m;k=d.widgetOnScreen.widgets.length<h.widgetOnScreen.widgets.length?d.widgetOnScreen.widgets.length:h.widgetOnScreen.widgets.length;for(m=0;m<k;m++){d.widgetOnScreen.widgets[m].positionRelativeTo||(d.widgetOnScreen.widgets[m].positionRelativeTo="map");h.widgetOnScreen.widgets[m].positionRelativeTo||(h.widgetOnScreen.widgets[m].positionRelativeTo=
d.widgetOnScreen.widgets[m].positionRelativeTo);if(d.widgetOnScreen.widgets[m].positionRelativeTo!==h.widgetOnScreen.widgets[m].positionRelativeTo)return!1;d.widgetOnScreen.widgets[m].position||(d.widgetOnScreen.widgets[m].position={left:0,top:0});h.widgetOnScreen.widgets[m].position||(h.widgetOnScreen.widgets[m].position=d.widgetOnScreen.widgets[m].position);if(!t.isEqual(d.widgetOnScreen.widgets[m].position,h.widgetOnScreen.widgets[m].position))return!1}k=d.widgetOnScreen.groups.length<h.widgetOnScreen.groups.length?
d.widgetOnScreen.groups.length:h.widgetOnScreen.groups.length;for(m=0;m<k;m++){d.widgetOnScreen.groups[m].panel||(d.widgetOnScreen.groups[m].panel={});h.widgetOnScreen.groups[m].panel||(h.widgetOnScreen.groups[m].panel=d.widgetOnScreen.groups[m].panel);d.widgetOnScreen.groups[m].panel.positionRelativeTo||(d.widgetOnScreen.groups[m].panel.positionRelativeTo="map");h.widgetOnScreen.groups[m].panel.positionRelativeTo||(h.widgetOnScreen.groups[m].panel.positionRelativeTo=h.widgetOnScreen.groups[m].panel.positionRelativeTo);
if(d.widgetOnScreen.groups[m].panel.positionRelativeTo!==h.widgetOnScreen.groups[m].panel.positionRelativeTo)return!1;d.widgetOnScreen.groups[m].panel.position||(d.widgetOnScreen.groups[m].panel.position={left:0,top:0});h.widgetOnScreen.groups[m].panel.position||(h.widgetOnScreen.groups[m].panel.position=d.widgetOnScreen.groups[m].panel.position);if(!t.isEqual(d.widgetOnScreen.groups[m].panel.position,h.widgetOnScreen.groups[m].panel.position))return!1}return!0},getLayoutFromConfig:function(a){var g=
{};a=e.clone(a);a.widgetOnScreen&&(g.widgetOnScreen={},a.widgetOnScreen.widgets&&(g.widgetOnScreen.widgets=[],f.forEach(a.widgetOnScreen.widgets,function(a,b){g.widgetOnScreen.widgets[b]={position:a.position?a.position:{left:0,top:0}}})),a.widgetOnScreen.groups&&(g.widgetOnScreen.groups=[],f.forEach(a.widgetOnScreen.groups,function(a,b){g.widgetOnScreen.groups[b]={position:a.position?a.position:{left:0,top:0}}})));a.map&&(g.map={position:a.map.position});return g}})})},"builder/plugins/widget-config/_build-generate_module":function(){define(["builder/plugins/widget-config/Plugin",
"dojo/text!builder/plugins/widget-config/Plugin.html","dojo/text!builder/plugins/widget-config/css/style.css","dojo/i18n!builder/plugins/widget-config/nls/strings"],function(){})},"builder/plugins/widget-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dijit/_WidgetBase ./WidgetsList ./MoveableNode ./WidgetSettingPage ./GroupSettingPage ./WidgetChoosePage jimu/utils jimu/PoolControllerMixin jimu/dijit/ViewStack jimu/dijit/Popup builder/BasePlugin".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c){return q([c],{baseClass:"plugin-widget-config app-widgets",postMixInProperties:function(){this.nls=e.mixin(this.nls,window.builderNls)},postCreate:function(){this.inherited(arguments);this.widgetOnScreen=new t({name:"widgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.noncontrollerPreloadWidgetsNode);this.poolWidgets=new t({name:"poolWidgets",nls:this.nls,folderUrl:this.folderUrl},this.poolWidgetsListNode);this.viewStack=new s({viewType:"dom",views:[this.preloadWidgetsNode,
this.poolWidgetsNode]});this.viewStack.placeAt(this.domNode);this.poolControllerClass=q([r,m]);this.own(k.subscribe("editWidget",e.hitch(this,this._onEditWidget)));this.own(k.subscribe("chooseWidget",e.hitch(this,this._onChooseWidget)));this.own(k.subscribe("editGroup",e.hitch(this,this._onEditGroup)));this.own(k.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)));this.own(k.subscribe("app/appConfigLoaded",e.hitch(this,this._onAppConfigChanged)))},startup:function(){this.inherited(arguments);
this.viewStack.startup();this.widgetOnScreen.startup();this.poolWidgets.opened=!1;this.widgetOnScreen.opened=!0},destroy:function(){this.widgetOnScreen.destroy();this.poolWidgets.destroy();this.poolWidgets=this.widgetOnScreen=null;f.forEach(this.controllers,function(a){a.destroy()});this.controllers=[];this.inherited(arguments)},_onAppConfigChanged:function(b){b=u.reCreateObject(b);this.appConfig&&u.isEqual(this.appConfig.widgetOnScreen,b.widgetOnScreen)&&u.isEqual(this.appConfig.widgetPool,b.widgetPool)?
this.appConfig=b:(this.appConfig=b,this._createControllerWidgetNodes(),a.setStyle(this.noncontrollerPreloadWidgetsNode,{top:this.controllerWidgetsHeight+20+"px"}),this.widgetOnScreen.setSettings(this._getNonControllerPreloadWidgets()),this.widgetOnScreen.setAppConfig(this.appConfig),this.poolWidgets._started&&(0<this.controllers.length?this._initWidgetPool(this.controllers[0]):(this._initWidgetPool(null),this.viewStack.switchView(this.preloadWidgetsNode))),this.widgetChoosePage&&this.widgetChoosePage.setAppConfig(b),
this.widgetSettingPage&&this.widgetSettingPage.setAppConfig(b))},_getNonControllerPreloadWidgets:function(){var a=[];this.appConfig.visitElement(function(b,c){!b.isController&&c.isOnScreen&&a.push(b)});return a},_createControllerWidgetNodes:function(){f.forEach(this.controllers,function(b){a.destroy(b.node);b.destroy()},this);this.controllers=[];f.forEach(this.appConfig.widgetOnScreen.widgets,function(a){a.isController&&this._createControllerWidgetNode(a)},this);this.controllerWidgetsHeight=118*this.controllers.length;
a.setStyle(this.controllerWidgetsNode,{height:this.controllerWidgetsHeight+"px"})},_createControllerWidgetNode:function(c){var d=a.create("div",{"class":"controller-widget"},this.controllerWidgetsNode),f={};window.isRTL?f.right="30px":f.left="30px";f=new b({type:"widget",w:74,h:118,setting:c,listName:"controllerWidgets",style:f,nls:this.nls});a.place(f.domNode,d);f.startup();f=a.create("div",{"class":"action-node"},d);a.create("div",{"class":"action-text jimu-float-leading jimu-leading-margin1",title:this.nls.setControlledWidgets,
innerHTML:this.nls.setControlledWidgets},f);a.create("div",{"class":"action-arrow jimu-float-trailing jimu-trailing-margin2"},f);c=new this.poolControllerClass(c);c.appConfig=this.appConfig;c.node=d;this.controllers.push(c);this.own(n(f,"click",e.hitch(this,this._openWidgetPool,c)))},_openWidgetPool:function(a){!1!==a.visible&&(this.currentController=a,this.viewStack.switchView(this.poolWidgetsNode),this.poolWidgets.controller=a,this.poolWidgets.opened=!0,this.widgetOnScreen.opened=!1,this.controllerLabelNode.innerHTML=
a.label,this._initWidgetPool(a),this.poolWidgets._started||this.poolWidgets.startup())},_initWidgetPool:function(a){this.poolWidgets.setSettings(a?a.getAllConfigs():[]);this.poolWidgets.setAppConfig(this.appConfig)},_onBackWidgetsClick:function(){this._createControllerWidgetNodes();this.viewStack.switchView(this.preloadWidgetsNode);this.poolWidgets.opened=!1;this.widgetOnScreen.opened=!0},_onEditWidget:function(b){this.widgetSettingPage=new g({appConfig:this.appConfig,nls:this.nls},this.widgetSettingPageNode);
this.widgetSettingPage.setting=e.clone(b);b=new p({titleLabel:this.nls.configLabel+" "+b.label,content:this.widgetSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:e.hitch(this.widgetSettingPage,this.widgetSettingPage.onOk)},{label:this.nls.cancel,onClick:e.hitch(this.widgetSettingPage,this.widgetSettingPage.onCancel)}],onClose:e.hitch(this.widgetSettingPage,this.widgetSettingPage.onClose)});a.addClass(b.domNode,"widget-setting-popup");this.widgetSettingPage.startup()},_onChooseWidget:function(a,
b){this.widgetChoosePage=new h({appConfig:this.appConfig,nls:this.nls},this.widgetChoosePageNode);this.widgetChoosePage.fromNode=a;this.widgetChoosePage.fromList=b;new p({titleLabel:this.nls.chooseWidget,content:this.widgetChoosePage,container:"main-page",buttons:[{label:this.nls.ok,onClick:e.hitch(this.widgetChoosePage,this.widgetChoosePage.onOk)},{label:this.nls.cancel}]});this.widgetChoosePage.startup()},_onEditGroup:function(a,b){this.groupSettingPage=new d({setting:e.clone(b),nls:this.nls});
new p({titleLabel:b.label,content:this.groupSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:e.hitch(this.groupSettingPage,this.groupSettingPage.onOk)},{label:this.nls.cancel}]});this.groupSettingPage.startup()},_getPopupSize:function(){var b=a.getContentBox("main-page"),c={};1024>=b.w?(c.width=b.w-20,c.height=b.h-20):(c.width=1024,c.height=768);return c}})})},"builder/plugins/widget-config/WidgetsList":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/aspect dojo/on dojo/query dojo/NodeList-dom dijit/_WidgetBase ./MoveableNode ./LinkList".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h){function u(a){var b={};isFinite(a.l)&&(b.left=a.l+"px");isFinite(a.t)&&(b.top=a.t+"px");isFinite(a.w)&&(b.width=a.w+"px");isFinite(a.h)&&(b.height=a.h+"px");return b}var m,s=q([g],{postCreate:function(){this.inherited(arguments);this.domNode=a.create("div",{"class":"node-margin"});this.type="addBtn"===this.node.type?"addMargin":"margin"}});return q([g],{postCreate:function(){this.nodeList=new h({name:this.name});this.own(k.subscribe("widgetChoosePageOk",e.hitch(this,
this._onWidgetChoosePageOk)));this.own(k.subscribe("widgetSettingPageOk",e.hitch(this,this._onWidgetSettingPageOk)))},startup:function(){this.inherited(arguments);var b=a.getContentBox(this.domNode);this.position=a.position(this.domNode);m=Math.floor(b.w/89);this.settings&&this.initNodes()},setSettings:function(a){this.settings=a;this.initNodes()},setAppConfig:function(a){this.appConfig=a},addWidget:function(a){a=this.createMoveableNode("widget",a);this.nodeList.insertNode(a);this.placeNodes()},createMoveableNode:function(b,
c){var f=a.getContentBox(this.domNode);f.h=Infinity;var g=new d({type:b,w:74,h:118,setting:c,listName:this.name,parentBox:f,nls:this.nls,folderUrl:this.folderUrl});a.place(g.domNode,this.domNode);g.startup();this.bindMoveEvent(g);"group"===b&&(n.after(g,"openGroup",e.hitch(this,this.openGroup,g)),n.after(g,"closeGroup",e.hitch(this,this.closeGroup,g)));g.on("removeNode",e.hitch(this,function(){"poolWidgets"===this.name?(g.gnode?(this.nodeList.removeNode(g),this._reopenGroup()):this.nodeList.removeNode(g),
this.placeNodes(),this.publishPoolChangeEvent()):k.publish("widgetChanged",g.setting)}));this.createMarginNode(g);this.own(r(g.domNode,"click",e.hitch(this,function(){("addBtn"===b||"widget"===b&&!c.uri)&&k.publish("chooseWidget",g,this.name)})));return g},openGroup:function(a){var b,d,f,g,h,k,n;this.openedGNode&&this.openedGNode!==a&&this.openedGNode.closeGroup(this.openedGNode);b=a.setting.widgets;h=this.getNodePosition(this.nodeList.getNodeIndex(a)).r;k=Math.ceil(b.length/m);d=h*m+1;f=this.nodeList.getNodeByIndex(d);
for(g=this.nodeList.getCount()+1;g<d;g++)n=this.createMoveableNode("empty"),n.gnode=a,this.nodeList.insertNode(n,f);this.openedGNode=a;this.openedGNode.panelRow=h+1;this.createGroupPanel(h+1,k);b.forEach(e.hitch(this,function(b){b=this.createMoveableNode("widget",b);b.gnode=a;this.nodeList.insertNode(b,f)}));b=m*k-b.length;for(g=0;g<b;g++)n=this.createMoveableNode("empty"),n.gnode=a,this.nodeList.insertNode(n,f);this.placeNodes()},createGroupPanel:function(b,c){this.groupPanel=a.create("div",{"class":"widget-group-panel",
style:u({l:5,t:118*(b-1)-10,h:118*c+0*(c-1),w:89*m-15+20})},this.domNode);a.create("div",{"class":"group-triangle",style:{left:89*((this.openedGNode.pos.c-1)%m)+37+"px"}},this.groupPanel);this.groupPanel.type="panel"},closeGroup:function(b){var c=[];b.setting.widgets=[];this.nodeList.visitNodes(e.hitch(this,function(a){a.gnode===b&&("empty"!==a.type&&b.setting.widgets.push(a.setting),c.push(a))}));c.forEach(e.hitch(this,function(a){this.nodeList.removeNode(a)}));0===b.setting.widgets.length?this.nodeList.removeNode(b):
b.updateSmallWidgets();this.placeNodes();a.destroy(this.groupPanel);this.openedGNode=null},initNodes:function(){this.destroyShadowNode();var a=this.settings,a="widgetOnScreen"===this.name?a.sort(firstBy(function(a,b){return a.inPanel!==b.inPanel?a.inPanel-b.inPanel:0}).thenBy(function(a,b){return a.uri&&!b.uri?-1:!a.uri&&b.uri?1:0}).thenBy(function(a,b){return a.uri&&b.uri?a.label.localeCompare(b.label):!a.uri&&!b.uri?a.placeholderIndex-b.placeholderIndex:0})):a.sort(function(a,b){return a.index-
b.index}),b;this.openedGNode&&(b=this.openedGNode.label,this.closeGroup(this.openedGNode));this.nodeList.destroyAllNodes();"poolWidgets"===this.name&&(this.addBtn=this.createMoveableNode("addBtn"),this.nodeList.insertNode(this.addBtn));a.forEach(e.hitch(this,function(a){var b;a.widgets?0<a.widgets.length?b=this.createMoveableNode("group",a):console.log("empty group"):b=this.createMoveableNode("widget",a);b&&this.nodeList.insertNode(b)}));this.nodeList.insertNode(this.createMoveableNode("empty"));
this.placeNodes();if(b&&(a=this.nodeList.getNodeByLabel(b)))this.openGroup(a),a.status="open"},_removeActive:function(){t(".node-margin-active",this.domNode).removeClass("node-margin-active");t(".empty-node-active",this.domNode).removeClass("empty-node-active");t(".node-active",this.domNode).removeClass("node-active")},bindMoveEvent:function(b){"addBtn"!==b.type&&b.dnd&&(n.after(b.dnd,"onMove",e.hitch(this,function(c,d,e){c=this.getMousePosition(e);this.mouseNode=this.getNodeByMousePosition(b,c);
this._removeActive();this.mouseNode&&"margin"===this.mouseNode.type?a.addClass(this.mouseNode.domNode,"node-margin-active"):this.mouseNode&&"empty"===this.mouseNode.type?a.addClass(this.mouseNode.domNode,"empty-node-active"):this.mouseNode&&("group"===this.mouseNode.type||"widget"===this.mouseNode.type)&&a.addClass(this.mouseNode.domNode,"node-active")}),!0),n.after(b.dnd,"onMoveStart",e.hitch(this,function(){this.destroyShadowNode();this.createShadowNode(b);a.setStyle(b.boxNode,"cursor","move")}),
!0),n.after(b.dnd,"onMoveStop",e.hitch(this,this._onMoveStop,b),!0))},_onMoveStop:function(b){var c=!1;a.setStyle(b.boxNode,"cursor","pointer");this.mouseNode&&(b===this.mouseNode?console.log("move to the same node"):"margin"===this.mouseNode.type?(this.moveNodeToMargin(b,this.mouseNode),c=!0):"empty"===this.mouseNode.type?this.mouseNode.gnode&&"group"===b.type?console.log("not allow move group to opened group, revert"):(this.moveNodeToEmpty(b,this.mouseNode),c=!0):"group"===this.mouseNode.type?"group"===
b.type?console.log("not allow move group to closed group, revert"):"open"===this.mouseNode.status?console.log("please put widget into the opened group panel"):b.gnode&&b.gnode===this.mouseNode?console.log("the moving widget is already in the group"):(this.moveWidgetToGroup(b,this.mouseNode),c=!0):"widget"===this.mouseNode.type&&("group"===b.type?console.log("not allow move group to widget, revert"):b.gnode||this.mouseNode.gnode?console.log("can not nest group"):(this.moveWidgetToWidget(b,this.mouseNode),
c=!0)),this._reopenGroup());this.destroyShadowNode();c&&this.publishPoolChangeEvent();this.placeNodes()},_reopenGroup:function(){if(this.openedGNode){var a=this.openedGNode;this.closeGroup(a);this.nodeList.isExist(a)&&this.openGroup(a)}},getNodePosition:function(a){var b={},d;d=Math.ceil(a/m);a%=m;0===a&&(a=m);b.t=118*(d-1);b.l=89*(a-1)+15;b.w=74;b.h=118;b.r=d;b.c=a;return b},getMarginNodePosition:function(a){var b={};a=a.pos;b.l=a.l-7.5-2.5;b.t=a.t;b.w=5;b.h=118;return b},createMarginNode:function(b){var c=
new s({label:b.label,node:b});a.place(c.domNode,this.domNode);return b.margin=c},getMousePosition:function(a){return{x:a.pageX-this.position.x,y:a.pageY-this.position.y+this.domNode.scrollTop}},moveNodeToMargin:function(a,b){var d=this.getNodeByMarginNode(b);console.log("moveNodeToMargin");t(".node-margin-active",this.domNode).removeClass("node-margin-active");d.gnode&&!a.gnode?a.gnode=d.gnode:!d.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,d)},moveNodeToEmpty:function(a,b){t(".empty-node-active",
this.domNode).removeClass("empty-node-active");b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},getNodeByMarginNode:function(a){var b;this.nodeList.visitNodes(function(d){d.margin===a&&(b=d)});return b},placeNodes:function(){var b,c;this.nodeList.visitNodes(e.hitch(this,function(d,e){b=this.getNodePosition(e);d.pos=b;a.setStyle(d.domNode,u(b));c=this.getMarginNodePosition(d);d.margin.pos=c;a.setStyle(d.margin.domNode,u(c))}));this.nodeList.printNodeList()},
moveWidgetToGroup:function(a,b){b.addWidget(a);this.nodeList.removeNode(a)},moveWidgetToWidget:function(a,b){var d;d=this.createMoveableNode("group",{label:this._getGroupLabel(),widgets:[a.setting,b.setting]});this.nodeList.insertNode(d,b);this.nodeList.removeNode(a);this.nodeList.removeNode(b)},createShadowNode:function(b){this.shadowNode=a.create("div",{"class":"node-shadow",style:u(a.getMarginBox(b.domNode))},this.domNode)},destroyShadowNode:function(){this.shadowNode&&a.destroy(this.shadowNode)},
getNodeByMousePosition:function(a,b){var d;this.nodeList.visitNodes(function(e){if("addBtn"!==e.type){if(b.x>e.pos.l+10&&(b.x<e.pos.l+e.pos.w-10&&b.y>e.pos.t+10&&b.y<e.pos.t+e.pos.h-10)&&e!==a)return d=e,!0;if(b.x>e.margin.pos.l&&(b.x<e.margin.pos.l+e.margin.pos.w&&b.y>e.margin.pos.t&&b.y<e.margin.pos.t+e.margin.pos.h)&&e.margin!==a)return d=e.margin,!0}});return d},_getGroupLabel:function(){var a=-1;this.appConfig.visitElement(e.hitch(this,function(b){if(b.widgets)if(b.label===this.nls.newGroup)a=
0;else if(b.label.startWith(this.nls.newGroup)){var d=b.label.lastIndexOf("_");-1<d&&(b=parseInt(b.label.substr(d+1,b.label.length),10),a=Math.max(a,b))}}));return-1===a?this.nls.newGroup:this.nls.newGroup+"_"+(a+1)},_onWidgetChoosePageOk:function(a,b){if(b.listName===this.name)if(1===a.length){var d;"addBtn"===b.type?d=a[0]:(d=e.clone(b.setting),e.mixin(d,a[0]));k.publish("editWidget",d)}else"addBtn"===b.type&&(f.forEach(a,function(a){this.addWidget(a)},this),this.publishPoolChangeEvent())},_onWidgetSettingPageOk:function(a){this.opened&&
(a.id?k.publish("widgetChanged",a):"poolWidgets"===this.name&&(this.addWidget(a),this.publishPoolChangeEvent()))},publishPoolChangeEvent:function(){var a=[],b=[];this.nodeList.visitNodes(function(d,e){"widget"===d.type&&!d.gnode?(d.setting.index=e,b.push(d.setting)):"group"===d.type&&(d.setting.index=e,a.push(d.setting))});k.publish("widgetPoolChanged",{widgets:b,groups:a})}})})},"builder/plugins/widget-config/MoveableNode":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Evented dojo/aspect dojo/mouse dojo/topic dojo/query ./Mover dojo/dnd/move dijit/_WidgetBase jimu/dijit/Message jimu/utils dojo/NodeList-dom dojo/NodeList-manipulate".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m){return q([h,k],{type:"",label:"",isMoving:!1,isMouseDown:!1,postCreate:function(){this.inherited(arguments);"addBtn"===this.type?(this.label="addBtn",this.createAddBtn()):"empty"===this.type?(this.label="empty",this.createEmptyNode()):("widget"===this.type?this.createWidgetNode():this.createGroupNode(),"poolWidgets"===this.listName&&(this.dnd=new d.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:g}),this.bindMoveEvent()));
e.addClass(this.domNode,"moveable");e.setStyle(this.domNode,{width:this.w+"px",height:this.h+"px"})},bindMoveEvent:function(){n.after(this.dnd,"onMoveStart",a.hitch(this,function(){this.isMoving=!0}),!0);n.after(this.dnd,"onMoveStop",a.hitch(this,function(){this.isMoving=!1}),!0)},_createWidgetIconNode:function(){var a=m.processUrlInAppConfig(this.setting.icon);this.iconNode=e.create("img",{"class":"icon",src:a,style:{width:"40px",height:"40px",margin:(this.w-40)/2+"px"}},this.boxNode)},_createPlaceholderNode:function(){this.placeholderNode=
e.create("div",{"class":"placehoder",style:{width:"40px",height:"40px",margin:(this.w-40)/2+"px"}},this.boxNode);e.create("div",{"class":"placehoder-inner",innerHTML:this.setting.placeholderIndex,style:{width:"24px",height:"24px",lineHeight:"24px",borderRadius:"12px",margin:"7px"}},this.placeholderNode)},createWidgetNode:function(){e.addClass(this.domNode,"widget-node");this.boxNode=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.setting.uri?this._createWidgetIconNode():
this._createPlaceholderNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=e.create("div",{"class":"label",innerHTML:this.label,title:this.label},this.domNode);!1===this.setting.visible&&e.addClass(this.domNode,"hide");this.own(f(this.boxNode,r.enter,a.hitch(this,function(){t.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.setting.uri&&(this.editNode&&
(e.destroy(this.editNode),this.editNode=null),this.dropNode&&(e.destroy(this.dropNode),this.dropNode=null),this.switchNode&&(e.destroy(this.switchNode),this.switchNode=null),this.editNode=this._createEditNode(),this.own(f(this.editNode,"click",a.hitch(this,function(a){a.stopPropagation();t.publish("editWidget",this.setting)}))),!1===this.setting.inPanel?(this.switchNode=this._createSwitchNode(),this.own(f(this.switchNode,"click",a.hitch(this,function(b){b.stopPropagation();b=a.clone(this.setting);
!1===b.visible?(b.visible=!0,e.removeClass(this.domNode,"hide")):(b.visible=!1,e.addClass(this.domNode,"hide"));t.publish("widgetChanged",b)})))):(this.dropNode=this._createDropNode(),this.own(f(this.dropNode,"click",a.hitch(this,function(b){b.stopPropagation();var d=new u({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){"poolWidgets"===this.listName?console.log("list name poolWidgets"):(this.setting.uri="",this.setting.label=this.nls.defaultWidgetLabel,
this.setting.name=void 0,this.setting.placeholderIndex="?",this.setting.config=void 0,this.label=this.nls.defaultWidgetLabel,this.labelNode.innerHTML=this.label,e.destroy(this.iconNode),this._createPlaceholderNode());this.emit("removeNode");d.close()})},{label:this.nls.cancel}]})})))))})));this.own(f(this.boxNode,r.leave,a.hitch(this,function(){t.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&e.destroy(this.editNode);this.dropNode&&e.destroy(this.dropNode);
this.switchNode&&e.destroy(this.switchNode)})))},createGroupNode:function(){e.addClass(this.domNode,"group-node");this.boxNode=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.label=this.setting.label?this.setting.label:"Group";this.name=this.setting.name?this.setting.name:"Group";this.labelNode=e.create("div",{"class":"label",innerHTML:this.setting.label,title:this.setting.label},this.domNode);this._createSmallWidgets();this.own(f(this.boxNode,r.enter,
a.hitch(this,function(){t.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();this.own(f(this.editNode,"click",a.hitch(this,function(a){a.stopPropagation();t.publish("editGroup",this,this.setting)})));this.own(f(this.editNode,"mousedown",function(a){a.stopPropagation()}));this.own(f(this.editNode,"mouseup",function(a){a.stopPropagation()}));"poolWidgets"===this.listName&&(this.dropNode=this._createDropNode(),this.own(f(this.dropNode,"click",
a.hitch(this,function(b){var d=new u({message:this.nls.dropGroupMessage,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){this.emit("removeNode");d.close()})},{label:this.nls.cancel}]});b.stopPropagation()}))),this.own(f(this.dropNode,"mousedown",function(a){a.stopPropagation()})),this.own(f(this.dropNode,"mouseup",function(a){a.stopPropagation()})))})));this.own(f(this.boxNode,r.leave,a.hitch(this,function(){t.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});
this.editNode&&e.destroy(this.editNode);this.dropNode&&e.destroy(this.dropNode)})));this.own(f(this.boxNode,"click",a.hitch(this,function(a){a.preventDefault();a.stopPropagation();"open"===this.status?this.closeGroup():this.openGroup()})))},closeGroup:function(){this.status="close"},openGroup:function(){this.status="open"},createAddBtn:function(){e.addClass(this.domNode,"add-widget-node");var a=e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);e.create("img",
{src:this.folderUrl+"css/images/add_widget.png"},a);e.create("div",{"class":"label",title:this.nls.addWidget,innerHTML:this.nls.addWidget},a)},createEmptyNode:function(){e.addClass(this.domNode,"empty-node");e.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode)},_createEditNode:function(){var a={bottom:"4px",width:"25px",height:"25px"};a[window.isRTL?"left":"right"]="4px";return e.create("div",{"class":"edit-btn",style:a,title:this.nls.configureWidget},this.boxNode)},
_createDropNode:function(){var a={top:"3px",width:"10px",height:"10px"};a[window.isRTL?"left":"right"]="3px";return e.create("div",{"class":"drop-btn",style:a,title:this.nls.removeWidget},this.boxNode)},_createSwitchNode:function(){var a=e.hasClass(this.domNode,"hide")?this.nls.showWidget:this.nls.hideWidget,b={top:"3px",width:"15px",height:"10px"};b[window.isRTL?"left":"right"]="3px";return e.create("div",{"class":"switch-btn",style:b,title:a},this.boxNode)},_createSmallWidgets:function(){b(".small",
this.boxNode).remove();var d=[],e=!1;4<this.setting.widgets.length?(d=this.setting.widgets.slice(0,3),e=!0):(d=this.setting.widgets,e=!1);d.forEach(a.hitch(this,function(a){this._createSmallWidget(a)}));e&&this._createSmallMore()},_createSmallWidget:function(a){var b;b=e.create("div",{"class":"small small-widget","data-wid":a.id,style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);var c=a.icon;if(a.icon.startWith("widgets")||a.icon.startWith("configs")||
a.icon.startWith("themes"))c=require(m.getRequireConfig()).toUrl(a.icon);e.create("img",{src:c,style:{width:"20px",height:"20px"}},b);return b},_createSmallMore:function(){var a;a=e.create("div",{"class":"small small-more",style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);e.create("img",{src:"builder/images/more_widget.png",style:{width:"20px"}},a);return a},addWidget:function(a){"group"!==this.type?console.log("can not add widget to widget"):
(this.setting.widgets.push(a.setting),this._createSmallWidgets())},updateSmallWidgets:function(){this._createSmallWidgets()},destroy:function(){this.margin&&this.margin.destroy();this.inherited(arguments)}})})},"builder/plugins/widget-config/Mover":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/sniff dojo/_base/window dojo/dom dojo/dom-geometry dojo/dom-style dojo/Evented dojo/on dojo/touch dojo/dnd/common dojo/dnd/autoscroll".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,
h,u){f.add("ie11",function(){var a=-1,b="",d=null;"Microsoft Internet Explorer"===navigator.appName?(b=navigator.userAgent,d=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==d.exec(b)&&(a=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(b=navigator.userAgent,d=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!==d.exec(b)&&(a=parseFloat(RegExp.$1)));return a});return e("dojo.dnd.Mover",[b],{constructor:function(b,e,f){function c(a){a.preventDefault();a.stopPropagation()}this.node=n.byId(b);this.marginBox={l:e.pageX,
t:e.pageY};this.mouseButton=e.button;e=this.host=f;b=b.ownerDocument;this.events=[g(b,d.move,a.hitch(this,"onFirstMove")),g(b,d.move,a.hitch(this,"onMouseMove")),g(b,d.release,a.hitch(this,"onMouseUp")),g(b,"dragstart",c),g(b.body,"selectstart",c)];u.autoScrollStart(b);if(e&&e.onMoveStart)e.onMoveStart(this)},onMouseMove:function(a){u.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){var b=f("webkit")&&
f("mac")&&2===this.mouseButton,d=(f("ie")||f("ie11"))&&-1===this.mouseButton;(b||d?0===a.button:this.mouseButton===a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,d,c=this.host;switch(b.position){case "relative":case "absolute":d=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=r.getMarginBox(this.node);d=k.doc.body;var e=t.getComputedStyle(d),f=r.getMarginBox(d,e),e=r.getContentBox(d,
e);d=b.l-(e.l-f.l);b=b.t-(e.t-f.t)}this.marginBox.l=d-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(c&&c.onFirstMove)c.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){q.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"builder/plugins/widget-config/LinkList":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/_base/array"],function(q){return q(null,{headNode:null,
currentNode:null,constructor:function(e){this.name=e.name},visitNodes:function(e){for(var a=this.headNode,f=1;a;)e(a,f),f++,a=a.next},destroyAllNodes:function(){for(var e=this.headNode,a;e;)a=e.next,e.destroy(),e=a;this.headNode=null},getCount:function(){var e=0;this.visitNodes(function(a,f){e=f});return e},isExist:function(e){var a=!1;this.visitNodes(function(f){f===e&&(a=!0)});return a},printNodeList:function(){this.visitNodes(function(e){})},getPreNode:function(e){var a;this.visitNodes(function(f){f.next===
e&&(a=f)});return a},getNodeByIndex:function(e){var a;this.visitNodes(function(f,k){k===e&&(a=f)});return a},getNodeByLabel:function(e){var a;this.visitNodes(function(f){f.label===e&&(a=f)});return a},getNodeIndex:function(e){var a;this.visitNodes(function(f,k){f===e&&(a=k)});return a},removeNode:function(e){var a;(a=this.getPreNode(e))?a.next=e.next:this.headNode=e.next;e.destroy()},removeNodeByIndex:function(e){this.removeNode(this.getNodeByIndex(e))},insertNode:function(e,a){var f,k;f="number"===
typeof a?this.getNodeByIndex(a):a;(k=this.getPreNode(f))?k.next=e:this.headNode=e;e.next=f},moveNode:function(e,a){var f=this.getPreNode(e),k=this.getPreNode(a);e!==a&&e!==k&&(f?f.next=e.next:this.headNode=e.next,e.next=a,k?k.next=e:this.headNode=e)}})})},"builder/plugins/widget-config/WidgetSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/config dojo/Deferred dojo/request dojo/topic dojo/aspect dojo/on dojo/mouse dojo/query dojo/string dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./WidgetSettingPage.html ./WidgetDefaultSettingPage jimu/utils jimu/WidgetManager jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/ImageChooser jimu/dijit/LoadingIndicator jimu/dijit/Message dijit/form/CheckBox".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w,v,x,y,B,z,D,E,A){var G={overview:"widget-overview.htm",attributetable:"widget-attribute-table.htm",basemapgallery:"widget-basemap.htm",bookmark:"widget-bookmark.htm",chart:"widget-chart.htm",headercontroller:"widget-header-controller-and-sidebar-controller.htm",sidebarcontroller:"widget-header-controller-and-sidebar-controller.htm",coordinate:"widget-coordinates.htm",directions:"widget-directions.htm",draw:"widget-draw.htm",edit:"widget-edit.htm",geocoder:"widget-geocoder.htm",
geoprocessing:"widget-geoprocessing.htm",homebutton:"widget-home-button.htm",layerlist:"widget-layer-list.htm",legend:"widget-legend.htm",measurement:"widget-measurement.htm",mylocation:"widget-my-location.htm",overviewmap:"widget-overview-map.htm",print:"widget-print.htm",query:"widget-query.htm",scalebar:"widget-scalebar.htm",splash:"widget-splash.htm",about:"widget-about.htm",analysis:"widget-analysis.htm",swipe:"widget-swipe.htm",timeslider:"widget-time-slider.htm"},C={overview:"#",attributetable:"120000943",
basemapgallery:"120000944",bookmark:"120000945",chart:"120000946",headercontroller:"120000963",sidebarcontroller:"120000963",coordinate:"120000947",directions:"120000948",draw:"120000949",edit:"120000950",geocoder:"120000951",geoprocessing:"120000952",homebutton:"120000953",layerlist:"120000954",legend:"120000955",measurement:"120000956",mylocation:"120000957",overviewmap:"120000958",print:"120000959",query:"120000960",scalebar:"120000961",splash:"120000964",about:"120000999",analysis:"120001019",
swipe:"120001020",timeslider:"120001021"},H={overview:"#",attributetable:"120000943",basemapgallery:"120000944",bookmark:"120000945",chart:"120000946",headercontroller:"120000963",sidebarcontroller:"120000963",coordinate:"120000947",directions:"120000948",draw:"120000949",edit:"120000950",geocoder:"120000951",geoprocessing:"120000952",homebutton:"120000953",layerlist:"120000954",legend:"120000955",measurement:"120000956",mylocation:"120000957",overviewmap:"120000958",print:"120000959",query:"120000960",
scalebar:"120000961",splash:"120000964",about:"120000999",analysis:"120001019",swipe:"120001020",timeslider:"120001021"};return q([s,p,c],{templateString:l,startup:function(){this.inherited(arguments);this.own(g(window,"resize",e.hitch(this,this.resize)));this.init()},init:function(){this.loading=new D;this.loading.placeAt(this.widgetSettingNode);this.initCommonAttr();this.initWidgetAttr();this.resize()},resize:function(){var b=a.getContentBox(this.domNode);a.setStyle(this.widgetSettingNode,{height:b.h-
90+"px"})},onCancel:function(){this.onClose();this.popup.close()},onOk:function(){var a=this._checkLabelExist();if(a)return new E({message:a}),!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=this.labelNode.get("value");if(this.settingDijit){a=this.settingDijit.getConfig(!0);if(!1===a)return!1;this.setting.config=a}t.publish("widgetSettingPageOk",this.setting);this.onClose();this.popup.close()},_checkLabelExist:function(){var a=0,b=this.labelNode.get("value");
if(""===u.trim(b))return this.nls.labelRequired;this.appConfig.visitElement(e.hitch(this,function(c){this.setting.id!==c.id&&c.label===b&&a++}));return 0<a?this.nls.labelExists:""},onClose:function(){this.settingViewStack?(this.settingDijitUI.destroy(),this.settingDijitJSON.destroy(),this.settingViewStack.destroy()):this.settingDijit&&this.settingDijit.destroy()},_getHelpLink:function(a){var b=new n;a=a.toLowerCase();if(window.isXT)r("/webappbuilder/help/exists",{handleAs:"json"}).then(e.hitch(this,
function(c){!c||!c.exists?b.resolve("#"):r("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(e.hitch(this,function(c){var d="#";c&&(c.m&&c.m[H[a]])&&(d="/webappbuilder/help/"+c.m[H[a]]);b.resolve(d)}),e.hitch(this,function(a){console.warn(a);b.resolve("#")}))}),function(a){console.error(a);b.resolve("#")});else{var c=y.getPortalUrlFromLocation();if(-1<c.indexOf("arcgis.com")){var d="#";G&&G[a]&&(d="http://doc.arcgis.com/en/web-appbuilder/create-apps/"+G[a]);b.resolve(d)}else r(c+"portalhelp/en/website/help/cxhelp.js",
{handleAs:"json"}).then(e.hitch(this,function(d){var e="#";d&&(d.m&&d.m[C[a]])&&(e=c+"portalhelp/en/website/help/"+d.m[C[a]]);b.resolve(e)}),e.hitch(this,function(a){console.warn(a);b.resolve("#")}))}return b},initCommonAttr:function(){var b=v.processUrlInAppConfig(this.setting.icon);a.setAttr(this.iconNode,"src",b);this.labelNode.set("value",this.setting.label);this._getHelpLink(this.setting.name).then(e.hitch(this,function(b){"#"!==b&&(a.setStyle(this.helpNode,"display","inline-block"),a.setAttr(this.helpNode,
"href",b))}));this.setting.inPanel?(this.imageChooser=new z({goldenWidth:24,goldenHeight:24},this.imageChooser),(b=a.getMarginBox(this.changeNode))&&0<b.w&&a.setStyle(this.imageChooser.domNode,"width",b.w+"px"),this.own(g(this.imageChooser,"imageChange",e.hitch(this,function(a){this.iconNode.src=a;this.setting.icon=a})))):a.addClass(this.changeNode,"disable-change-icon")},initWidgetAttr:function(){!1===this.setting.hasConfig?this.widgetSettingNode.innerHTML='\x3cdiv class\x3d"noconfig-info"\x3e'+
this.nls.noConfig+"\x3c/div\x3e":x.getInstance().tryLoadWidgetConfig(this.setting).then(e.hitch(this,function(b){this.setting.config=b;this.setting.hasSettingPage?x.getInstance().loadWidgetSettingPage(this.setting).then(e.hitch(this,function(b){this.widgetSettingNode?(this.settingDijit=b,a.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy()):b.destroy()})):this.widgetSettingNode&&(this.settingDijit=new w({config:this.setting.config}),a.place(this.settingDijit.domNode,
this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy())}))},setAppConfig:function(a){this.appConfig=a}})})},"builder/plugins/widget-config/WidgetDefaultSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dijit/_WidgetBase ./JSONEditor".split(" "),function(q,e,a,f,k,n){return q([k],{baseClass:"widget-default-setting",postCreate:function(){this.inherited(arguments);this.jsonEditor=new n({json:this.config});this.jsonEditor.placeAt(this.domNode);this.own(a(this.domNode,
"keydown",e.hitch(this,"_onEnterPress")))},_onEnterPress:function(a){(void 0!==a.keyCode?a.keyCode:a.which)===f.ENTER&&a.stopPropagation()},setConfig:function(a){return this.jsonEditor.setJSON(a)},getConfig:function(){return this.jsonEditor.getJSON()}})})},"builder/plugins/widget-config/JSONEditor":function(){define(["dojo/_base/declare","dijit/_WidgetBase"],function(q,e){return q([e],{baseClass:"json-editor",postCreate:function(){this.inherited(arguments);this.editor=ace.edit(this.domNode);this.editor.setTheme("ace/theme/textmate");
this.editor.setHighlightActiveLine(!0);this.editor.setValue(JSON.stringify(this.json,null,2));this.editor.getSession().setMode("ace/mode/json")},setJSON:function(a){this.json=a;this.editor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.editor.getValue())}})})},"builder/plugins/widget-config/GroupSettingPage":function(){define("dojo/_base/declare dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./GroupSettingPage.html".split(" "),function(q,
e,a,f,k,n){return q([f,k],{templateString:n,baseClass:"group-setting-page",startup:function(){this.labelNode.value=this.setting.label},onOk:function(){this.setting.label=e.get(this.labelNode,"value");a.publish("groupChanged",this.setting);this.popup.close()},onCancel:function(){}})})},"builder/plugins/widget-config/WidgetChoosePage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dojo/Deferred dojo/promise/all dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./WidgetChoosePage.html jimu/dijit/Search jimu/WidgetManager jimu/dijit/LoadingShelter jimu/dijit/Message jimu/utils builder/serviceUtils".split(" "),
function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w){return q([d,h],{templateString:u,postMixInProperties:function(){this.widgetManager=s.getInstance()},startup:function(){this.inherited(arguments);this.searchDijit=new m({placeholder:this.nls.widgetName,onSearch:e.hitch(this,this.searchWidget),searchWhenInput:!0},this.searchInputNode);this._getWidgets();this.own(n(window,"resize",e.hitch(this,this.resize)));setTimeout(e.hitch(this,function(){this.resize()}),100);this.loading=new p({hidden:!0});this.loading.placeAt(this.domNode);
this.loading.startup()},searchWidget:function(a){var b;b=""===a?this.allWidgets:f.filter(this.allWidgets,function(b){if(-1<b.label.toUpperCase().indexOf(a.toUpperCase()))return!0});this._createWidgetNodes(b)},resize:function(){var b=a.getContentBox(this.domNode).h-50-10,c=b-60;a.setStyle(this.searchSectionNode,{height:b+"px"});a.setStyle(this.widgetListNode,{height:c+"px"})},setAppConfig:function(a){this.appConfig=a},_getWidgets:function(){var a={};this.appConfig.map["2D"]&&(a.support2D=!0);this.appConfig.map["3D"]&&
(a.support3D=!0);this.appConfig.map["2D"]&&this.appConfig.map["3D"]&&(a.support2D=!0,a.support3D=!0);a["properties.inPanel"]=!0;a.platform=window.stemappInfo.appType;w.searchWidgets(a).then(e.hitch(this,function(a){a.success?(this.allWidgets=a.widgets,this._createWidgetNodes(this.allWidgets)):console.log(a.message)}))},_createWidgetNodes:function(b){a.empty(this.widgetListNode);f.forEach(b,function(a){l.processManifestLabel(a,dojoConfig.locale);this._createWidgetNode(a)},this)},_createWidgetNode:function(b){var c,
d;c=a.create("div",{"class":"widget-node"},this.widgetListNode);d=a.create("div",{"class":"box"},c);a.create("div",{"class":"box-border"},c);a.create("img",{"class":"icon",src:b.icon},d);a.create("div",{"class":"label",innerHTML:b.label,title:b.label},c);c.setting={name:b.name,label:b.label,version:b.version};l.addManifestProperies(b);l.addManifest2WidgetJson(c.setting,b);c.setting.icon="widgets/"+b.name+"/images/icon.png";c.setting.uri="widgets/"+b.name+"/Widget";l.processWidgetSetting(c.setting);
c.box=d;this.own(n(c,"click",e.hitch(this,this._onWidgetClick,c)));return c},_onWidgetClick:function(c){"addBtn"===this.fromNode.type?a.hasClass(c,"jimu-state-selected")?a.removeClass(c,"jimu-state-selected"):a.addClass(c,"jimu-state-selected"):(b(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),a.addClass(c,"jimu-state-selected"))},onOk:function(){var a=b(".jimu-state-selected",this.domNode);if(0===a.length)new c({message:this.nls.emptyMessage});else{this.loading.show();var d=
f.map(a,function(a){return e.clone(a.setting)}),g=[];f.forEach(d,function(a){g.push(this._copyWidget(a))},this);t(g).then(e.hitch(this,function(a){var b;for(b=0;b<a.length;b++)if(!a[b].success){new c({message:a[b].message});this.loading.hide();return}this.loading.hide();k.publish("widgetChoosePageOk",d,this.fromNode);this.popup.close()}))}},_copyWidget:function(a){var b=0,c,d=[];this.appConfig.visitElement(e.hitch(this,function(c){c.name===a.name&&b++;d.push(c.label)}));if(0===b)a.label=a.label,c=
w.copyWidgetToApp(window.appInfo.appId,a.name);else if(0<b){c=new r;for(var f=a.label+"_"+(b+1);-1<d.indexOf(f);)b++,f=a.label+"_"+(b+1);a.label=f;c.resolve({success:!0})}return c}})})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(q,e,a){return q(null,{constructor:function(){this.panelManager=a.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups=
"all")},getOpenedIds:function(){},setOpenedIds:function(a){},getConfigById:function(a){for(var e=this.getAllConfigs(),n=0;n<e.length;n++)if(e[n].id===a)return e[n]},getAllConfigs:function(){var a=[],a=a.concat(this.getWidgetConfigs(),this.getGroupConfigs()),a=e.filter(a,function(a){return a.visible});return a.sort(function(a,e){return a.index-e.index})},isControlled:function(a){return e.some(this.getAllConfigs(),function(e){return e.id===a})},widgetIsControlled:function(a){return e.some(this.getAllConfigs(),
function(k){return k.id===a?!0:e.some(k.widgets,function(e){return e.id===a})})},getGroupConfigs:function(){var a=[];if(!this.appConfig.widgetPool)return a;this.appConfig.widgetPool.groups&&e.forEach(this.appConfig.widgetPool.groups,function(e){this.controlledGroups&&(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(e.label)&&a.push(e):"all"===this.controlledGroups&&a.push(e))},this);return a},getWidgetConfigs:function(){var a=[];if(!this.appConfig.widgetPool)return a;this.appConfig.widgetPool.widgets&&
e.forEach(this.appConfig.widgetPool.widgets,function(e){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(e.label)&&a.push(e):"all"===this.controlledWidgets&&a.push(e))},this);return a}})})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/on dojo/aspect require ./utils ./WidgetManager".split(" "),function(q,e,a,f,k,n,r,t,b,g,d){var h,u=null;h=q(null,{constructor:function(){this.panels=
[];this.widgetManager=d.getInstance();r(window,"resize",e.hitch(this,this.onWindowResize))},showPanel:function(a){var d=new n;b([a.panel.uri],e.hitch(this,function(b){var c=a.id+"_panel",h=this.getPanelById(c);if(h)"closed"===h.state&&this.openPanel(h,a.panel.position);else{var k;k="map"===a.panel.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;var n={label:a.label,config:a,uri:a.panel.uri,position:a.panel.position,positionRelativeTo:a.panel.positionRelativeTo,map:this.map,widgetManager:this.widgetManager,
panelManager:this,containerId:k,id:c,gid:a.gid};e.mixin(n,a.panel.options);try{h=new b(n),console.log("panel ["+c+"] created.")}catch(q){console.log("create panel error: "+q+", panelId: "+c);d.reject(q);return}f.setStyle(h.domNode,"opacity",0);t.before(h,"destroy",e.hitch(this,this.onDestroyPanel,h));f.place(h.domNode,k);try{h.startup()}catch(r){console.log(console.error("fail to startup panel "+h.id+". "+r.stack));d.reject(r);return}this.openPanel(h);g.setVerticalCenter(h.domNode);this.panels.push(h)}d.resolve(h)}));
return d},setMap:function(a){this.map=a;r(this.map,"resize",e.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a.gid&&this.panels[b].id!==a.id&&this.closePanel(this.panels[b],!1)},openPanel:function(a){var b=new n;if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if("opened"===a.state)b.resolve();else{try{this.closeOtherPanelsInTheSameGroup(a),f.setStyle(a.domNode,"display","block"),k.animateProperty({node:a.domNode,
properties:{opacity:1},duration:200,onEnd:e.hitch(this,function(){a.setState("opened");a.onOpen();b.resolve()})}).play()}catch(d){console.log(console.error("fail to open panel "+a.id+". "+d.stack))}return b}},closePanel:function(a,b){var d=new n;if("string"===typeof a&&(a=this.getPanelById(a),!a))return d.resolve(),d;void 0===b&&(b=!0);if("closed"===a.state)return d.resolve(),d;try{b?k.animateProperty({node:a.domNode,properties:{opacity:0},duration:200,onEnd:function(){a.setState("closed");a.onClose();
f.setStyle(a.domNode,"display","none");d.resolve()}}).play():(a.setState("closed"),a.onClose(),f.setStyle(a.domNode,"display","none"),d.resolve())}catch(c){console.log(console.error("fail to close panel "+a.id+". "+c.stack))}return d},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(b){console.log(console.error("fail to minimize panel "+a.id+". "+b.stack))}},maximizePanel:function(a){if("string"===
typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(b){console.log(console.error("fail to maximize panel "+a.id+". "+b.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(b){console.log(console.error("fail to noralize panel "+a.id+". "+b.stack))}},changeWindowStateTo:function(a,b){if("string"===
typeof a&&(a=this.getPanelById(a),!a))return;"normal"===b?this.normalizePanel(a):"minimized"===b?this.minimizePanel(a):"maximized"===b?this.maximizePanel(a):console.log("error state: "+b)},getPanelById:function(a){for(var b=0;b<this.panels.length;b++)if(this.panels[b].id===a)return this.panels[b]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].positionRelativeTo&&this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==
this.panels[a].state&&"map"===this.panels[a].positionRelativeTo&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);try{a.destroy()}catch(b){console.log(console.error("fail to destroy panel "+a.id+". "+b.stack))}}},onDestroyPanel:function(a){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);console.log("destroy panel "+a.id)},destroyAllPanels:function(){var b=
a.map(this.panels,function(a){return a.id});a.forEach(b,function(a){this.destroyPanel(a)},this);this.panels=[]},reloadWidgetInPanel:function(a){this.panels.forEach(function(b){b.reloadWidget(a)},this)},_removePanel:function(a){a=this.panels.indexOf(a);-1<a&&this.panels.splice(a,1)}});h.getInstance=function(){null===u&&(u=new h);return u};return h})},"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" role\x3d"presentation" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/plugins.json":'{\n  "app-actions.launch-app": {\n    "name": "app-actions.launch-app",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.launch-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.preview-app": {\n    "name": "app-actions.preview-app",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 2\n        },\n        "pluginName": "app-actions.preview-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.save-app": {\n    "name": "app-actions.save-app",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 3\n        },\n        "pluginName": "app-actions.save-app"\n      },\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "label": "${label}",\n          "supportAppTypes": "all",\n          "onClickAction": "_onClick",\n          "index": 1\n        },\n        "pluginName": "app-actions.save-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config": {\n    "name": "app-config",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-part": {\n        "description": "The config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-part",\n        "name": "config-part",\n        "extensions": [\n          {\n            "point": "app-config.config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-configpart"\n          }\n        ]\n      },\n      "morepreview-selction-part": {\n        "description": "The more preview selection part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.morepreview-selction-part",\n        "name": "morepreview-selction-part",\n        "extensions": [\n          {\n            "point": "app-config.morepreview-selction-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-morepreview-selectionpart"\n          }\n        ]\n      },\n      "main-app-actions": {\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.main-app-actions",\n        "name": "main-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.launch-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 2\n            },\n            "pluginName": "app-actions.preview-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 3\n            },\n            "pluginName": "app-actions.save-app"\n          }\n        ]\n      },\n      "popup-app-actions": {\n        "parameters": {\n          "label": {\n            "type": "string",\n            "name": "label"\n          },\n          "onClickAction": {\n            "type": "function",\n            "name": "onClickAction"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.popup-app-actions",\n        "name": "popup-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "label": "${label}",\n              "supportAppTypes": "all",\n              "onClickAction": "_onClick",\n              "index": 1\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "label": "${exportTitle}",\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 3\n            },\n            "pluginName": "popup-actions.popup-agoltemplate"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "label": "${label}",\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 2\n            },\n            "pluginName": "popup-actions.popup-saveas"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "startup.app-config",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config"\n      }\n    ],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-configpart": {\n    "name": "app-config-configpart",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-sections": {\n        "description": "The config page for section of full config",\n        "parameters": {\n          "label": {\n            "type": "string",\n            "required": true,\n            "name": "label"\n          },\n          "icon": {\n            "type": "url",\n            "required": true,\n            "name": "icon"\n          },\n          "selectedIcon": {\n            "type": "url",\n            "required": true,\n            "name": "selectedIcon"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "republishEvents": {\n            "type": "string",\n            "required": true,\n            "description": "The events that change app config. These events will be pushed to preview window",\n            "name": "republishEvents"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config-configpart.config-sections",\n        "name": "config-sections",\n        "extensions": [\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.png",\n              "selectedIcon": "images/selected_icon.png",\n              "republishEvents": "appAttributeChanged",\n              "index": 4\n            },\n            "pluginName": "attribute-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.png",\n              "selectedIcon": "images/selected_icon.png",\n              "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged",\n              "index": 2\n            },\n            "pluginName": "map-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.png",\n              "selectedIcon": "images/selected_icon.png",\n              "republishEvents": "themeChanged,styleChanged,layoutChanged",\n              "index": 1\n            },\n            "pluginName": "theme-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.png",\n              "selectedIcon": "images/selected_icon.png",\n              "republishEvents": "widgetChanged,widgetPoolChanged,actionTriggered,groupChanged",\n              "index": 3\n            },\n            "pluginName": "widget-config"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "app-config.config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-morepreview-selectionpart": {\n    "name": "app-config-morepreview-selectionpart",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.morepreview-selction-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-morepreview-selectionpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-list": {\n    "name": "app-list",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "startup.app-list",\n        "description": "",\n        "pluginName": "app-list"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "attribute-config": {\n    "name": "attribute-config",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.png",\n          "selectedIcon": "images/selected_icon.png",\n          "republishEvents": "appAttributeChanged",\n          "index": 4\n        },\n        "pluginName": "attribute-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "creation-entry": {\n    "name": "creation-entry",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.creation-entry",\n        "description": "",\n        "pluginName": "creation-entry"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "header": {\n    "name": "header",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.header",\n        "description": "",\n        "pluginName": "header"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "map-config": {\n    "name": "map-config",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.png",\n          "selectedIcon": "images/selected_icon.png",\n          "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged",\n          "index": 2\n        },\n        "pluginName": "map-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "popup-actions.popup-agoltemplate": {\n    "name": "popup-actions.popup-agoltemplate",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "label": "${exportTitle}",\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 3\n        },\n        "pluginName": "popup-actions.popup-agoltemplate"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-saveas": {\n    "name": "popup-actions.popup-saveas",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "label": "${label}",\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 2\n        },\n        "pluginName": "popup-actions.popup-saveas"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "startup": {\n    "name": "startup",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "app-list": {\n        "description": "the app list page.",\n        "id": "startup.app-list",\n        "name": "app-list",\n        "extensions": [\n          {\n            "point": "startup.app-list",\n            "description": "",\n            "pluginName": "app-list"\n          }\n        ]\n      },\n      "header": {\n        "description": "the header.",\n        "id": "startup.header",\n        "name": "header",\n        "extensions": [\n          {\n            "point": "startup.header",\n            "description": "",\n            "pluginName": "header"\n          }\n        ]\n      },\n      "app-config": {\n        "description": "the app config page.",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "startup.app-config",\n        "name": "app-config",\n        "extensions": [\n          {\n            "point": "startup.app-config",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config"\n          }\n        ]\n      },\n      "creation-entry": {\n        "description": "The create new entry point.",\n        "id": "startup.creation-entry",\n        "name": "creation-entry",\n        "extensions": [\n          {\n            "point": "startup.creation-entry",\n            "description": "",\n            "pluginName": "creation-entry"\n          }\n        ]\n      },\n      "stemapps": {\n        "description": "the stemapp.",\n        "parameters": {\n          "appType": {\n            "type": "string",\n            "required": true,\n            "name": "appType"\n          },\n          "appPath": {\n            "type": "string",\n            "description": "By default, it\'s plugin\'s folder path",\n            "name": "appPath"\n          },\n          "appVersionManager": {\n            "type": "string",\n            "description": "path relative to app path. required if app config is old.",\n            "name": "appVersionManager"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "startup.stemapps",\n        "name": "stemapps",\n        "extensions": [\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML",\n              "appPath": "../../../../stemapp/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 1\n            },\n            "pluginName": "stemapps.web2d"\n          }\n        ]\n      }\n    },\n    "extensions": [],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web2d": {\n    "name": "stemapps.web2d",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML",\n          "appPath": "../../../../stemapp/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 1\n        },\n        "pluginName": "stemapps.web2d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "theme-config": {\n    "name": "theme-config",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.png",\n          "selectedIcon": "images/selected_icon.png",\n          "republishEvents": "themeChanged,styleChanged,layoutChanged",\n          "index": 1\n        },\n        "pluginName": "theme-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "widget-config": {\n    "name": "widget-config",\n    "type": "plugin",\n    "version": "1.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.png",\n          "selectedIcon": "images/selected_icon.png",\n          "republishEvents": "widgetChanged,widgetPoolChanged,actionTriggered,groupChanged",\n          "index": 3\n        },\n        "pluginName": "widget-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  }\n}\n',
"url:builder/plugins/app-actions/launch-app/Plugin.html":"\x3cdiv\x3e\r\n\x3c/div\x3e","url:builder/plugins/app-actions/launch-app/css/style.css":".plugin-app-actions-launch-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-launch-app .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-launch-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-launch-app a{color: inherit; display: block; text-decoration: none;}.plugin-app-actions-launch-app:hover .footer-button{color:#15a4fa; background-image: url(images/hover_icon.png);}",
"url:builder/plugins/app-actions/preview-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button  preview-button" data-dojo-attach-point\x3d"btnPreview" title\x3d${nls.previewMore}\x3e${nls.previewMore}\x3c/div\x3e\r\n  \x3cdiv class\x3d"footer-button  config-button" style\x3d"display:none" data-dojo-attach-point\x3d"btnConfig" title\x3d${nls.back2Configure}\x3e${nls.back2Configure}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/preview-app/css/style.css":".plugin-app-actions-preview-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-preview-app .footer-button{background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-preview-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-preview-app:hover .footer-button {color:#15a4fa;}.plugin-app-actions-preview-app .footer-button.preview-button{background-image: url(images/icon.png);}.plugin-app-actions-preview-app:hover .footer-button.preview-button{background-image: url(images/hover_icon.png);}.plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure01.png);}.jimu-rtl .plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure03.png);}.plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure02.png);}.jimu-rtl .plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure04.png);}",
"url:builder/plugins/app-actions/save-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button" title\x3d${nls.label} data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/save-app/css/style.css":".plugin-app-actions-save-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-save-app .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-save-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-save-app:hover .footer-button{color:#15a4fa; background-image: url(images/hover_icon.png);}.plugin-app-actions-save-app .footer-button.save-enable{background-image:url(images/hover_icon.png); background-repeat: no-repeat; color: #15a4fa;}.plugin-app-actions-save-app .footer-button.save-block{color: #d2dae2; background-image: url(images/block_icon.png);}",
"url:builder/plugins/app-config/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"left-pane" data-dojo-attach-point\x3d"leftPaneNode"\x3e\r\n    \x3cdiv class\x3d"opts-viewstack" data-dojo-attach-point\x3d"optsViewStackNode"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"configOptsPaneNode"\x3e\r\n      \r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"morePreviewOptsPaneNode"\x3e\r\n      \r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"actions-pane" data-dojo-attach-point\x3d"actionsPaneNode"\x3e\r\n      \x3cdiv class\x3d"main-action-box" data-dojo-attach-point\x3d"mainActionBoxNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"footer-button-arrow jimu-float-leading" data-dojo-attach-point\x3d"btnArrow" data-dojo-attach-event\x3d"onclick: _onBtnArrowClick"\x3e\r\n        \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"popupActionsMenu"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"loading-cover" data-dojo-attach-point\x3d"coverNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"right-preview-section" data-dojo-attach-point\x3d"rightPreviewSection"\x3e\r\n    \x3cdiv class\x3d"preview-config" data-dojo-attach-point\x3d"previewConfig"\x3e\r\n      \x3ciframe name\x3d"previewConfigFrame" data-dojo-attach-point\x3d"previewConfigFrameNode" style\x3d"border:none"\x3e\x3c/iframe\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"preview-more" data-dojo-attach-point\x3d"previewMore"\x3e\r\n      \x3cdiv class\x3d"preview-more-iframe-section" data-dojo-attach-point\x3d"previewMoreIframeSection"\x3e\r\n        \x3cdiv class\x3d"preview-more-iframe-container" data-dojo-attach-point\x3d"previewMoreContainer"\x3e\r\n          \x3ciframe name\x3d"previewMoreFrame" data-dojo-attach-point\x3d"previewMoreFrameNode" style\x3d"border-color:#cad1d9;"\x3e\x3c/iframe\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"description" data-dojo-attach-point\x3d"previewMoreDes"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e    \r\n      \x3cdiv class\x3d"screen-switch-section"\x3e\r\n        \x3cdiv class\x3d"portrait jimu-float-leading selected" data-dojo-attach-point\x3d"btnPortrait"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"landscape jimu-float-trailing" data-dojo-attach-point\x3d"btnLandscape"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/css/style.css":".plugin-config-app .left-pane{font-size: 20px; width: 400px; height: 100%; position: relative; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-app .left-pane .opts-viewstack{position: absolute; left: 0; right: 0; top: 0; bottom: 50px;}.plugin-config-app .right-preview-section{position: absolute; left: 400px; top: 0; right: 0; height: 100%;}.plugin-config-app .right-preview-section .preview-viewstack{width:100%; height:100%;}.plugin-config-app .preview-config,.plugin-config-app .preview-more{width:100%; height:100%;}.plugin-config-app .preview-config iframe{width: 100%; height: 100%;}.plugin-config-app .preview-more{position:relative; background-color:#f3f3f3; overflow:auto;}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container{margin-left:auto; margin-right:auto; background:#eaecee; padding:20px; border:2px solid #666; -webkit-border-radius:15px; -moz-border-radius:15px; -o-border-radius:15px; -ms-border-radius:15px; border-radius:15px; -webkit-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -moz-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -o-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -ms-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9);}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container iframe{width:100%; height:100%;}.plugin-config-app .preview-more .description{display:none; text-align:center; font-size:15px; margin-top:20px;}.plugin-config-app .preview-more .screen-switch-section{position:absolute; right:12px; top:12px; height:38px;}.jimu-rtl .plugin-config-app .preview-more .screen-switch-section{right: auto; left: 12px;}.plugin-config-app .preview-more .screen-switch-section div{width:38px; height:100%; background-repeat:no-repeat; background-position:center center; cursor:pointer; background-color:#FFFFFF;}.plugin-config-app .preview-more .screen-switch-section div.selected{background-color:#F7F8F8;}.plugin-config-app .preview-more .screen-switch-section .portrait{border-top-left-radius:3px; border-bottom-left-radius:3px; background-image:url(images/portrait.png);}.plugin-config-app .preview-more .screen-switch-section .landscape{border-top-right-radius:3px; border-bottom-right-radius:3px; background-image:url(images/landscape.png);}.plugin-config-app .preview-more .screen-switch-section .portrait.selected{background-image:url(images/portrait_selected.png);}.plugin-config-app .preview-more .screen-switch-section .landscape.selected{background-image:url(images/landscape_selected.png);}.jimu-rtl .plugin-config-app .right-preview-section{left: 0; right: 400px;}.plugin-config-app .actions-pane{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color:#F3F3F3; font-size:14px;}.plugin-config-app .actions-pane .footer-button-box{height: 47px;}.plugin-config-app .actions-pane .seprate{width:1px; height: 35px; background-image:url(images/seprate.png); background-position: 0 20px; background-repeat:no-repeat;}.plugin-config-app .actions-pane .footer-button-arrow{width: 39px; height: 100%; background-image: url(images/arrow.png); background-position: 17px 25px; background-repeat: no-repeat; position: absolute; left: 360px; cursor: pointer; z-index: 10;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow{right: 360px; left: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu{display: none; position: absolute; right: 1px; box-shadow: 0 0 4px #646464;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow .foot-menu{left: 1px; right: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div{display: block; height: 30px; line-height: 30px; padding-left: 25px; padding-right: 25px; cursor: pointer; white-space: nowrap; font-size: 14px; background-color: #fafafc; text-decoration: none; color: #4d4d4d;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div:hover{background-color: #edf2f5; color: #15a4fa;}.plugin-config-app .loading-cover{position: absolute; z-index: 999; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.3);}",
"url:builder/plugins/app-config-configpart/TabContainer2.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable class\x3d"control-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-viewstack2" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section" data-dojo-attach-point\x3d"configSection"\x3e\r\n    \x3cdiv class\x3d"tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-configpart/css/style.css":".plugin-appconfig-configpart{font-size: 20px; width: 400px; height: 100%; position: relative; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-appconfig-configpart .config-section{width:100%; height:100%;}.jimu-tab2 .control-table{width: 100%; table-layout: fixed; background: #518dca; border-collapse: collapse; font-size: 12px; text-align: center; color: #fff;}.jimu-tab2 .control-table td{padding: 5px 2px 0;}.jimu-tab2 .tab-item-div{position: relative; width: 100%; height: 69px; cursor: pointer;}.jimu-tab2 .selected-tab-item-div{background-image: url(images/select.png); background-size: 92px 69px; background-origin: content-box; background-repeat: no-repeat; color: #518dca;}.jimu-tab2 .tab-item-icon{display: inline-block; margin-left: auto; margin-right: auto; margin-top: 10px; margin-bottom: 6px; width: 24px; height: 21px; background-repeat: no-repeat; background-position: center center;}.jimu-tab2 .tab-item-title{width: 99%; margin: auto; white-space: pre-line; overflow: hidden; text-overflow: ellipsis; height: 28px;}.jimu-tab2 .jimu-viewstack2{background-color:#fff; position:absolute; left:0; right:0; top:74px; bottom:0; height:auto;}",
"url:builder/plugins/app-config-morepreview-selectionpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preview-section" data-dojo-attach-point\x3d"previewSection"\x3e\r\n    \x3cdiv class\x3d"preview-header"\x3e\r\n      \x3cdiv class\x3d"header-item size-section"\x3e\r\n        \x3ctable class\x3d"size-table"\x3e\r\n          \x3ccolgroup\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"20px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n          \x3c/colgroup\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"width-tip jimu-ellipsis" title\x3d"${nls.width}"\x3e${nls.width}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"1024" data-dojo-attach-point\x3d"customWidth" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"height-tip jimu-ellipsis" title\x3d"${nls.height}"\x3e${nls.height}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"768"  data-dojo-attach-point\x3d"customHeight" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-body"\x3e\r\n      \x3cdiv class\x3d"preview-items-section"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"previewTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"preview-qrcode-section" \x3e\r\n        \x3cdiv class\x3d"qrcode-image jimu-float-leading" data-dojo-attach-point\x3d"qrcodeImage"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"qrcode-description jimu-float-leading" data-dojo-attach-point\x3d"qrcodeDescription"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-morepreview-selectionpart/css/style.css":".left-pane .plugin-appconfig-morepreview-selectionpart .preview-section{position:relative; width:100%; height:100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header{position: relative; width: 100%; height: 52px; background-color: #518dca;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .header-item{position:absolute; top: 0; margin: auto; bottom:0;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .size-section{width:100%; height: 32px; color:#444444;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table td *{height: 32px; line-height: 32px; text-align: center; font-size: 14px; color: #fff;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .width-tip{width: 100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div{width: 110px; overflow: hidden;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div input{width: 54px; color: #444444; border-style: none;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .pixel{width: 32px; text-align: center; margin: 0; color: white; background-color: #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body{position:absolute; width:100%; top: 52px; bottom:0; background-color: white;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .operation-tip{font-size:14px; margin-left:22px; margin-top:28px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{position:absolute; left:0; right:0; top:0; bottom:120px; overflow-x:hidden; overflow-y:auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section{position: absolute; left: 2px; right: 2px; bottom: 0; height: 116px; border-top: 1px solid; border-color: #e3ecf2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-image{margin: 20px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-description{width: 277px; height: 100%; padding-top: 25px; color: #596679; font-size: 14px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section table{width:370px; table-layout:fixed; margin-left: auto; margin-right: auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td{vertical-align:top; padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item{margin-left: auto; margin-right: auto; width:74px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg{position:relative; width:100%; height:74px; background-color:#fafafc; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; cursor:pointer; border:1px solid #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected{border:3px solid #1ca2fa;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-selected-icon{display:none; position:absolute; left:41px; top:42px; width:30px; height:26px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/check.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6{background-image: url(images/preview/iPhone6.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6-plus{background-image: url(images/preview/iPhone6_Plus.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone5{background-image:url(images/preview/iPhone5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone4{background-image:url(images/preview/iPhone4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-Air{background-image: url(images/preview/iPad_Air.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad4{background-image: url(images/preview/iPad4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .new-iPad{background-image:url(images/preview/iPad3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-mini{background-image:url(images/preview/iPad-Mini.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Galaxy-S4{background-image: url(images/preview/Samsung_Galaxy_S4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Note-3{background-image: url(images/preview/Samsung_Note_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-5{background-image: url(images/preview/Nexus_5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-4{background-image: url(images/preview/Nexus_4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-7{background-image: url(images/preview/Nexus_7.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .htc-one{background-image: url(images/preview/HTC_One.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .xiaomi-3{background-image: url(images/preview/Xiaomi_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .LG-G2{background-image: url(images/preview/LG_G2.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected .preview-selected-icon{display:none; left:38px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-title{display:inline-block; width:100%; text-align:center; color:#7989a0; font-size:12px; margin-top:10px; line-height: 13px;}",
"url:builder/plugins/app-list/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"head-section"\x3e\r\n        \x3cdiv class\x3d"textPart1 jimu-float-leading"\x3e${nls.welcomeMessage}\x3c/div\x3e\r\n        \x3cdiv class\x3d"textPart2 jimu-float-leading"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"actions jimu-float-trailing" data-dojo-attach-point\x3d"actionsNode"\x3e\r\n          \x3cspan class\x3d"actions-label jimu-ellipsis" title\x3d"${nls.actionsLabel}" data-dojo-attach-event\x3d"onclick:_onActionsLabelClick"\x3e${nls.actionsLabel}\x3c/span\x3e\r\n          \x3cdiv class\x3d"actions-menu" data-dojo-attach-point\x3d"actionsMenu"\x3e\r\n            \x3cdiv class\x3d"actions-menu-item item-import" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n              \x3cdiv class\x3d"import-button jimu-ellipsis" title\x3d"${nls.importAction}" data-dojo-attach-event\x3d"onclick:_onImportClick"\x3e${nls.importAction}\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"actions-menu-item item-upload" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n              \x3cdiv class\x3d"upload-button-div"\x3e\r\n                \x3cdiv class\x3d"upload-button jimu-ellipsis" title\x3d"${nls.uploadAction}"\x3e${nls.uploadAction}\x3c/div\x3e\r\n                \x3cform enctype\x3d"multipart/form-data" encoding\x3d"multipart/form-data" title\x3d"${nls.uploadAction}" method\x3d"post" action\x3d"/webappbuilder/rest/apps/upload" data-dojo-attach-point\x3d"uploadAppFileFormNode"\x3e\r\n                  \x3cinput class\x3d"file-input" title\x3d"${nls.uploadAction}" name\x3d"app" type\x3d"file" data-dojo-attach-point\x3d"appFileInputNode" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-attach-event\x3d"onChange:_onAppFileChange,onError:_onAppFileUploadError,onComplete:_onAppFileUploadComplete" accept\x3d".zip" style\x3d"width:100%;height:100%;"\x3e\r\n                  \x3cinput name\x3d"creator" type\x3d"text" value\x3d"1234" style\x3d"display:none;" data-dojo-attach-point\x3d"appFileCreatorInputNode"\x3e\r\n                  \x3cinput name\x3d"portalUrl" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"appPortalUrlInputNode"\x3e\r\n                \x3c/form\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"create-button-div jimu-float-trailing"\x3e\r\n          \x3cinput class\x3d"create-button jimu-ellipsis" type\x3d"button" title\x3d"${nls.appCreate}" value\x3d"${nls.appCreate}" data-dojo-attach-event\x3d"onclick:_onCreateClick"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3ctable class\x3d"list-section-head"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr class\x3d"head-content"\x3e\r\n            \x3cth class\x3d"name"\x3e${nls.appName}\x3c/th\x3e\r\n            \x3cth class\x3d"desc"\x3e${nls.appDesc}\x3c/th\x3e\r\n            \x3cth class\x3d"time"\x3e${nls.appTime}\x3c/th\x3e\r\n            \x3cth class\x3d"modified"\x3e${nls.appModified}\x3c/th\x3e\r\n            \x3cth class\x3d"creator"\x3e${nls.appCreator}\x3c/th\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:builder/plugins/app-list/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-cf" data-dojo-attach-point\x3d"createFromHere" data-dojo-attach-event\x3d"onclick:_onCreateFromHereClick,onmouseover:_onCreateFromHereMouseover,onmouseout:_onCreateFromHereMouseout"\x3e${nls.createFromHere}\x3c/div--\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" style\x3d"border-top-left-radius:5px;border-top-right-radius:5px;"data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item itme-remove" style\x3d"" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n\r\n  \x3c!--div class\x3d"item itme-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"loadingImg"/\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e${nls.loading}...\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/ItemSelector.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\t\t\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS.com\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/form/resources/Uploader.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e \r\n\t\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1" data-dojo-attach-point\x3d"valueNode" /\x3e\r\n\x3c/span\x3e\r\n',
"url:builder/plugins/app-list/css/style.css":'body{background-color: white;}#main-view-stack{position: absolute; top: 40px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #E3ECF2;}.plugin-app-list{position: relative; overflow: hidden;}.plugin-app-list .app-content{position: relative; max-width: 1180px; min-width: 1024px; margin: 50px auto; height: 100%;}.plugin-app-list .head-section {display: inline-block; width: 100%; padding-bottom: 30px;}.plugin-app-list .head-section .textPart1{margin-top: 15px; color: #6f7a8b; font-size: 18px;}.plugin-app-list .head-section .textPart2{margin-top: 20px; margin-left: 3px; color: #002157; font-size: 14px;}.jimu-rtl .plugin-app-list .head-section .textPart2{margin-right: 3px;}.plugin-app-list .head-section .create-button-div{height: 50px; position: relative; left: -16px; display: inline-block; padding-top: 8px;}.jimu-rtl .plugin-app-list .head-section .create-button-div{right: -16px;}.plugin-app-list .head-section .create-button{width: 140px; height: 33px; background-color: #518dca; border: 1px solid #348599; color: #ffffff; font-size: 15px; font-weight: bold; border-radius: 4px; cursor: pointer; box-shadow: 0px 1px 2px #a0acbf;}.plugin-app-list .head-section .actions{margin-right:2px; position: relative; display: inline-block; margin-top: 8px; background: #fff; border-radius: 4px; box-shadow: 0px 1px 2px #a0acbf;}.jimu-rtl .plugin-app-list .head-section .actions{margin-left:2px;}.plugin-app-list .head-section .actions-label{display: inline-block; width: 90px; margin: 0 15px; padding-right: 8px; background: url(images/v.png) right no-repeat; color: #596679; line-height: 33px; font-size: 15px; font-weight: bold; text-align: center; cursor: pointer;}.jimu-rtl .plugin-app-list .head-section .actions-label{padding-left: 8px; padding-right: 0; background-position: left center;}.plugin-app-list .head-section .actions-menu {display: none; position: absolute; top: 35px; left: 0; z-index: 9999; background: #fff; box-shadow: 0 0 4px #646464;}.jimu-rtl .plugin-app-list .head-section .actions-menu{left: auto; right: 0;}.plugin-app-list .head-section .actions-menu-item{position: relative; width: 250px; height: 30px; overflow: hidden; cursor: pointer; white-space: nowrap; padding: 0 25px; background-color: #fafafc; color: #7989a0; font-size: 14px;}.plugin-app-list .head-section .actions-menu-item .upload-button,.plugin-app-list .head-section .actions-menu-item .import-button {line-height: 30px; padding-left: 18px; background-repeat: no-repeat; background-position: left center;}.jimu-rtl .plugin-app-list .head-section .item-import .import-button,.jimu-rtl .plugin-app-list .head-section .item-upload .upload-button{padding-right: 18px; padding-left: 0; background-position: right center;}.plugin-app-list .head-section .item-import .import-button{background-image: url(images/clouda.png);}.plugin-app-list .head-section .item-import:hover .import-button{background-image: url(images/cloudb.png);}.plugin-app-list .head-section .item-upload .upload-button{background-image: url(images/computera.png);}.plugin-app-list .head-section .item-upload:hover .upload-button{background-image: url(images/computerb.png);}.plugin-app-list .head-section .actions-menu-item:hover{background: #edf2f5; color: #15a4fa;}.plugin-app-list .head-section .upload-button-div form{position:absolute; top:0; bottom:0; width:100%; opacity:0; overflow: hidden; width: 200px; filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.plugin-app-list .head-section .upload-button-div form span.dijitButtonNode{filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";} .plugin-app-list .app-content .list-section{position: absolute; top: 78px; bottom: 150px; width: 100%;} .plugin-app-list .app-content .list-section-head {table-layout: fixed; border-spacing: 0px; background-color: #6f7e95; width: 100%; height: 49px; border-top-left-radius: 4px; border-top-right-radius: 4px; box-shadow: 1px 1px 2px #a0acbf;}.plugin-app-list .app-content .list-section .head-content {}.plugin-app-list .app-content .list-section .head-content .name{width: 270px; color: #ffffff; font-size: 14px; border: 0px solid; padding-left: 25px;}.jimu-rtl .plugin-app-list .app-content .list-section .head-content .name{padding-right: 25px;}.plugin-app-list .app-content .list-section .head-content .desc{width: 300px; color: #ffffff; font-size: 14px; border: 0px solid;}.plugin-app-list .app-content .list-section .head-content .time{color: #ffffff; font-size: 14px; border: 0px solid; width: 150px;}.plugin-app-list .app-content .list-section .head-content .modified{color: #ffffff; font-size: 14px; border: 0px solid; width: 100px; display: none;}.plugin-app-list .app-content .list-section .head-content .creator{color: #ffffff; font-size: 14px; border: 0px solid;} .plugin-app-list .app-content .list-section-body{position: absolute; top: 127px; bottom: 150px; width: 100%; overflow: hidden;}.plugin-app-list .app-content .list-section-body-content{max-height: 100%; border: 1px solid #a0acbf; box-shadow: 1px 1px 2px #a0acbf; overflow: auto; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;}.plugin-app-list .app-content .list-table{table-layout: fixed; border-spacing: 0px; width: 100%;}.plugin-app-list .app-content .list-table-item{height: 40px; background-color: #fafafa;}.plugin-app-list .app-content .list-table-item-add{}.plugin-app-list .app-content .list-table-item-mouseover{background-color: #e3ecf2;}.plugin-app-list .app-content .list-table-next-item-mouseover td{border-bottom: 2px solid #e3ecf2;}.plugin-app-list .app-content .list-table-item-dbclick{background-color: #fffce4;}.plugin-app-list .app-content .list-table-item .item-first-td{width: 4px; vertical-align: top;}.plugin-app-list .app-content .list-table-item .item-second-td{width: 16px; vertical-align: top;}.plugin-app-list .app-content .list-table-item .item-first-td-selected {background-color: #15a4fa;}.plugin-app-list .app-content .list-table-item .item-end-td{width: 4px;}.plugin-app-list .app-content .list-table-item .item-name-td{width: 250px; vertical-align: top; border-bottom: 2px solid #e3ecf2;}.plugin-app-list .app-content .list-table-item .item-name{overflow: hidden; color: #596679; font-size: 14px; border: 0px solid; width: 230px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.plugin-app-list .app-content .list-table-item .item-input-name{width: 230px; height: 30px; margin-left: 10px; margin-top: 5px; border: 1px solid #999999; background-color: #ffffff}.plugin-app-list .app-content .list-table-item .item-desc-td{width:300px; border-bottom: 2px solid #e3ecf2;}.plugin-app-list .app-content .list-table-item .item-desc{overflow: hidden; color: #596979; font-size: 14px; border: 0px solid; margin-right: 5px; width: 270px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: pre; word-wrap: break-word; word-break: break-word;}.plugin-app-list .app-content .list-table-item .item-textarea-description{width: 285px; height: 82px; border: 1px solid #999999; resize: none; margin-top: 7px; margin-bottom: 7px;}.plugin-app-list .app-content .list-table-item .item-time-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 150px;}.plugin-app-list .app-content .list-table-item .item-time{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px; height: 40px;}.plugin-app-list .app-content .list-table-item .item-modified-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 100px; display: none;}.plugin-app-list .app-content .list-table-item .item-modified{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.plugin-app-list .app-content .list-table-item .item-creator-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 83px;}.plugin-app-list .app-content .list-table-item .item-creator{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.plugin-app-list .app-content .list-table-item .item-loading-td{width: 14px; max-width: 14px; border-bottom: 2px solid #e3ecf2;}.plugin-app-list .app-content .list-table-item .item-loading-td .loading-div{display: none; width: 14px;}.plugin-app-list .app-content .list-table-item .item-operations-td{vertical-align: top; border-bottom: 2px solid #e3ecf2;}.plugin-app-list .app-content .list-table-item .item-operations-div{border: 0px solid; width: 190px; margin: 0px 0px 0px auto; color: #A0acbf; font-size: 14px;}.jimu-rtl .plugin-app-list .app-content .list-table-item .item-operations-div{margin: 0px auto 0px 0px;}.plugin-app-list .app-content .list-table-item .item-edit{border: 0px solid; margin-right: 5px; cursor: pointer; height: 40px; width: 65px; background-image: url(images/edit_icon01.png); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .plugin-app-list .app-content .list-table-item .item-edit{margin-left: 5px; margin-right: auto; background-position: center right;}.plugin-app-list .app-content .list-table-item .item-edit:hover{background-image: url(images/edit_icon02.png); color: #518dca !important;}.jimu-rtl .plugin-app-list .app-content .list-table-item .item-edit-image{}.plugin-app-list .app-content .list-table-item .item-edit-text{line-height: 40px; padding-left: 17px; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.jimu-rtl .plugin-app-list .app-content .list-table-item .item-edit-text{padding-right: 17px; padding-left: 0;}.plugin-app-list .app-content .list-table-item .item-preview{border: 0px solid; margin-right: 0px; cursor: pointer; width: 80px; height: 40px; line-height: 40px; background-image: url(images/launch2.png); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .plugin-app-list .app-content .list-table-item .item-preview{margin-left: 0px; margin-right: auto; background-position: center right;}.plugin-app-list .app-content .list-table-item .item-preview:hover{background-image: url(images/launch3.png); color: #518dca !important;}.plugin-app-list .app-content .list-table-item .item-preview a{text-decoration: none; color: inherit; display: inline-block; padding-left: 19px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 100%;}.jimu-rtl .plugin-app-list .app-content .list-table-item .item-preview a{padding-right: 24px; padding-left: 0px;}.plugin-app-list .app-content .list-table-item .item-preview img{margin-top: 13px; margin-right: 5px;}.jimu-rtl .plugin-app-list .app-content .list-table-item .item-preview img{margin-left: 13px; margin-right: auto;}.plugin-app-list .app-content .list-table-item .item-more{height: 40px; width: 38px; text-align: center; cursor: pointer; background-image: url(images/moreaction_icon.png); background-repeat: no-repeat; background-position: center center; overflow: hidden;}.plugin-app-list .app-content .list-table-item .item-more-selected{background-image: url(images/moreaction_icon1.png) !important;}.plugin-app-list .app-content .list-table-item .item-more:hover{background-image: url(images/moreaction_icon1.png);}.plugin-app-list .app-content .list-table-item .item-more-image{margin-top: 18px;}.plugin-app-list .app-menu {position: absolute; background-color:#354052; width:160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.plugin-app-list .app-menu .item{width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .plugin-app-list .app-menu .item{padding-right: 20px; padding-left: 0px;}.plugin-app-list .app-menu .item a{text-decoration: none; color: inherit;}.plugin-app-list .app-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url(images/up_triangle.png);}.jimu-rtl .plugin-app-list .app-menu .up-triangle{left: 20px; right: auto;}.plugin-app-list .app-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url(images/down_triangle.png); display: none; background-repeat: no-repeat;}.jimu-rtl .plugin-app-list .app-menu .down-triangle{left: 20px; right: auto;}.plugin-app-list .app-menu .item-mouseover{background-color: #6f7e95; color: #ffffff;}.plugin-app-list .app-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.edit-app-info-content {color: #4d4d4d; font-size: 14px; font-family: monospace;}.edit-app-info-content .app-name {margin-left: 30px;}.edit-app-info-content .app-description {margin-left: 30px; margin-top: 20px;}.edit-app-info-content .dijitTextBox {}.edit-app-info-content .dijitTextBoxFocused {border-color: #406b9b !important; box-shadow: 0 0 0 #ffffff !important;}.edit-app-info-content .dijitTextBoxHover{background-color: #ffffff; background-image: none;}.edit-app-info-content .dijitInputField {line-height: 15px !important; padding: 0 0 0 !important;}.edit-app-info-content .dijitTextBox .dijitInputInner{height: 23px;}.edit-app-info-content .app-name .name-text-box{width: 95%; padding: 2px;}.edit-app-info-content .app-description .desc-text-area{width: 95%; max-width: 95%; min-width: 95%; height: 200px; max-height: 200px; min-height: 200px; padding: 2px; resize: none;}',
"url:builder/plugins/attribute-config/Plugin.html":'\x3cdiv class\x3d"attribute-config"\x3e\r\n  \x3cdiv class\x3d"section jimu-float-leading header-section" data-dojo-attach-point\x3d"headerSection"\x3e\r\n    \x3cp class\x3d"header-title"\x3e${nls.headerTitle}\x3c/p\x3e\r\n    \x3cdiv class\x3d"header-desc"\x3e${nls.headerDesc}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading jimu-trailing-margin1" data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser" data-dojo-props\x3d"showSelfImg:false,goldenWidth:30,goldenHeight:30"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"no-logo jimu-float-leading jimu-trailing-margin1"  data-dojo-attach-point\x3d"noLogoNode"\x3e\r\n        \x3cdiv class\x3d"image"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"text"\x3e ${nls.addLogo}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cimg class\x3d"logo jimu-float-leading jimu-trailing-margin1" data-dojo-attach-point\x3d"logoNode" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"titles jimu-float-leading"\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"title"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.title}" data-dojo-attach-point\x3d"titleNode" maxLength\x3d"100"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"subtitle"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.subtitle}" data-dojo-attach-point\x3d"subtitleNode" maxLength\x3d"100"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section jimu-float-leading links-section" data-dojo-attach-point\x3d"linksSection"\x3e\r\n    \x3cp class\x3d"title"\x3e${nls.linksTitle}\x3c/p\x3e\r\n    \x3cdiv class\x3d"attribute-content"\x3e\r\n      \x3cdiv class\x3d"list-header"\x3e\r\n        \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddLinkClick"\x3e${nls.addLink}\x3c/span\x3e\r\n        \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditLinkClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n        \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteLinkClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"links-list" data-dojo-attach-point\x3d"linksListNode"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section jimu-float-leading appId-section" data-dojo-attach-point\x3d"appIdSection" style\x3d"display:none"\x3e\r\n    \x3cp class\x3d"title"\x3e${nls.appIdTitle}\x3c/p\x3e\r\n    \x3ca target\x3d"_blank" href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.appIdAbout}\x3c/a\x3e\r\n    \x3cdiv class\x3d"attribute-content"\x3e\r\n      \x3cinput type\x3d"text" placeholder\x3d"AppId" data-dojo-attach-point\x3d"appIdNode" /\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section jimu-float-leading" data-dojo-attach-point\x3d"useProxySection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"useProxySetting"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"proxy-section" data-dojo-attach-point\x3d"proxySection"\x3e\r\n      \x3clabel class\x3d"rules-label"\x3e${nls.proxyRulesLabel}\x3c/label\x3e\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cdiv class\x3d"list-header"\x3e\r\n          \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddProxyRuleClick"\x3e${nls.addProxyRule}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditProxyRuleClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteProxyRuleClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"proxy-rule-header"\x3e\r\n          \x3cdiv class\x3d"prefix"\x3e${nls.prefixHeader}\x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-url"\x3e${nls.proxyUrlHeader}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"proxy-rule-list" data-dojo-attach-point\x3d"proxyRulesListNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"always-use-proxy" data-dojo-attach-point\x3d"alwaysUseProxy"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"attribute-content" data-dojo-attach-point\x3d"proxyUrlSection" \x3e\r\n        \x3cinput type\x3d"text" placeholder\x3d"${nls.proxyUrl}" data-dojo-attach-point\x3d"proxyUrlNode" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"mask"\x3e\x3c/div\x3e\r\n  \x3cinput type\x3d"file" accept\x3d"image/png, image/jpeg, image/bmp, image/gif" data-dojo-attach-point\x3d"fileInput"\x3e\r\n\x3c/div\x3e',"url:builder/plugins/attribute-config/css/style.css":".attribute-config{overflow-x: hidden; overflow-y: auto; font-size: 14px; padding: 0 30px;}.attribute-config .section{margin: 40px 0 0;}.header-section input,.links-section input,.appId-section input,.proxy-section input{height: 30px; border: 1px solid #d2dae2; padding: 5px; margin: 0; font-size: 14px; color: #7889a0; width: 100%; background-color: #fafafc;}.header-section input:focus,.links-section input:focus,.appId-section input:focus,.proxy-section input:focus{border: 1px solid #15a4fa; background-color: white; color: black;} .attribute-config .header-section{border: 0 solid; margin-top: 20px;}.attribute-config .header-section .header-title, .attribute-config .title{color: #596679; font-weight: bold; line-height: 1.0; display: inline-block;}.attribute-config .header-section .header-desc{margin-top: 15px; font-size: 12px; color: #798393; width: 352px;}.attribute-config .header-section .logo{font-size: 10px; width: 74px; height: 74px; margin-top: 20px; border: 1px solid #d2dae2; border-radius: 4px; cursor: pointer;}.attribute-config .header-section .no-logo{font-size: 10px; width: 74px; height: 74px; margin-top: 20px; border: 1px dashed #d2dae2; border-radius: 4px; background-color: #fafafc; text-align: center; margin-bottom: 0; cursor: pointer;}.attribute-config .header-section .no-logo .image{margin: auto; margin-top: 10px; background: url(images/add_header.png) no-repeat center; width: 20px; height: 20px;}.attribute-config .header-section .no-logo .text{font-size: 12px; color: #aaaaaa; text-align: center;}.attribute-config .header-section .titles{font-size: 10px; margin-top: 20px; width: 250px;}.attribute-config .header-section .title{width: 100%; height: 32px;}.attribute-config .header-section .subtitle{width: 100%; height: 32px; margin-top: 10px;}.appId-section .attribute-content{margin-top: 10px;}.appId-section a{color: #7EC6F8; float: right; cursor: pointer;}.proxy-section{display: none;}.attribute-config .sub-title{padding: 15px 0 10px 0;}.links-section .attribute-content{width: 340px; padding-top: 15px;}.links-section, .proxy-section{color: #a0acbf;}.attribute-config .attribute-content .links-list,.attribute-config .attribute-content .proxy-rule-list{padding-top: 10px;}.attribute-config .attribute-content .list-item.selected-item,.attribute-config .attribute-content .list-item:hover{background-color: #e3ecf2;}.attribute-config .attribute-content .list-item.selected-item .mask,.attribute-config .attribute-content .list-item:hover .mask{background-color: #e3ecf2;}.attribute-config .attribute-content .list-item{overflow: hidden; border-top-style: none; border: 1px solid #d2dae2; border-bottom-color: #eef2f5;}.attribute-config .attribute-content .list-item+.list-item{border-top-style: none;}.attribute-config .attribute-content .list-item:last-child{border-bottom-color: #dad2de;}.attribute-config .attribute-content .list-item:first-child{border-top-color: #dad2de;}.attribute-config .attribute-content .list-item .mask{width: 100%; height: 30px; color: #a0acbf; font-size: 12px; line-height: 30px; padding-left: 10px; border-width: 1px; background-color: #fafafc;}.attribute-config .attribute-content .list-item .mask:first-child{font-size: 14px;}.attribute-config .attribute-content .list-item .first,.attribute-config .attribute-content .list-item .second{height: 30px;}.proxy-rule-header{width: 100%; height: 30px; line-height: 30px; background-color: #518dca; color: white; margin: 10px 0 -10px;}.proxy-rule-header div{float: left; border-style: none; padding-left: 10px;}.attribute-content .list-item .first,.proxy-rule-header .prefix{width: 110px;}.proxy-rule-header .proxy-url{width: 228px;}.attribute-content .list-item .second{width: 228px; border-left: 1px solid #eef2f5;}.attribute-config .attribute-content .list-item .first input{border-right-style: none;}.attribute-config .attribute-content .list-header{}.attribute-config .list-header .header-button{display: inline-block; padding: 0 15px 0px 19px; color: #a0acbf; cursor: default;}.attribute-config .list-header .header-button.add{color: #518dca; cursor: pointer; background: url(images/add_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.add:hover{background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .header-button.edit{background: url(images/edit_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.delete{background: url(images/delete_icon01.png) no-repeat left;}.attribute-config .list-header .highlight-button{color: #518dca; cursor: pointer;}.attribute-config .list-header .highlight-button.add{color: #518dca; background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.edit{background: url(images/edit_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.delete{background: url(images/delete_icon02.png) no-repeat left;}.attribute-config .section .always-use-proxy{color: #596679; cursor: pointer; display: inline-block; margin-top: 15px; margin-bottom: 6px;}.attribute-config .section .always-use-proxy .label{display: inline; float: none;}.proxy-section .rules-label{color: #596679; font-size: 12px; margin: 10px 0 12px 0; display: block; line-height: 12px;}.proxy-section .error-status{border: 1px solid #e84b4b; background-color: #fff;}",
"url:builder/plugins/creation-entry/Plugin.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"configureApp"\x3e${nls.savePublish}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderMsg}\x3c/p\x3e\r\n\r\n  \x3cdiv class\x3d"app-2d-and-3d" data-dojo-attach-point\x3d"divAppTypes" style\x3d"overflow:hidden;margin-left:75px;margin-bottom:10px;padding:2px 2px 15px 2px;"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/ItemInfo.html":'\x3cdiv\x3e\r\n        \x3cdiv\x3e\r\n          \x3ctable style\x3d"width:100%" cellspacing\x3d"6"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" width\x3d"10%"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-name"\x3e\r\n                    ${nls.nameLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"90%"\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;padding:2px;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"tagsTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n                    ${nls.tagsLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-props\x3d"minWidth:\'435px\',maxWidth:\'435px\'" data-dojo-attach-point\x3d"tags"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" valign\x3d"top"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n                    ${nls.summaryLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;max-width:95%;min-width:95%;height:200px;max-height:200px;min-height:200px;padding:2px;resize:none;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"folderTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-folder"\x3e\r\n                    ${nls.saveFolderLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-folder" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:96%;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"sharingTr"\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit/form/CheckBox" checked\x3e\x3c/div\x3e\r\n                  \x3clabel for\x3d"publish-webmap-sharing"\x3e${nls.shareSameLevel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:builder/plugins/creation-entry/css/style.css":".plugin-creation-app .back-div {margin: 0; position: absolute; width: 100%; height: 100%; top: 0; left: 0;}.plugin-creation-app .front-div {width: 648px; height: 484px; margin: 10px auto; background-color: #ffffff; box-shadow: 0px 0px 5px #cccccc;}.plugin-creation-app .app-2d-and-3d {overflow: hidden; margin-left: 75px; margin-bottom: 10px; padding:2px 2px 15px 2px;}.jimu-rtl .plugin-creation-app .app-2d-and-3d {margin-right: 75px; margin-left: auto;}.plugin-creation-app .app-image-div {width: 160px; height: 120px; border: 0px solid; text-align: center; background-color: #f2f2f2; cursor: pointer; position: relative; margin-left: 10px; margin-right: 10px;}.plugin-creation-app .app-image-div img{height: 100%; width: 100%;}.plugin-creation-app .app-image-div .surface-div{position: absolute; top: 46px; left: 0px; color: #777777; font-size: 24px; padding-left: 10px; right: 0; bottom: 0;}.plugin-creation-app .app-image-div-back:hover{background-color: #e2f6ff; border: 2px solid #15a4fa; border-radius: 6px;}.plugin-creation-app .app-image-div-down{box-shadow: 0px 0px 0px 2px #15a4fa; border-radius: 4px;}.plugin-creation-app .app-name input, .plugin-creation-app .app-description textarea{padding-left: 10px; width: 100%; background-color: #fafafc; border: 1px solid #d2dae2;}.plugin-creation-app .app-input {color: #777777; font-size: 14px;}.plugin-creation-app .app-name input{height: 30px; margin-top: 30px;}.plugin-creation-app .app-description textarea{height: 180px; resize: none; margin-top: 10px; padding: 10px;}.plugin-creation-app .app-input ::-webkit-input-placeholder {font-style: italic;}.plugin-creation-app .app-input :-moz-placeholder {font-style: italic;}.plugin-creation-app .app-input ::-moz-placeholder {font-style: italic;}.plugin-creation-app .app-input :-ms-input-placeholder {font-style: italic;}.plugin-creation-app .cancel-button{float: left; margin-top: 20px; margin-left: 36px;}.plugin-creation-app .next-button{float: left; margin-top: 20px; margin-left: 214px;}.plugin-creation-app .app-button{width: 180px; height: 40px; text-align: center; border: 0px solid; padding-top: 13px; color: #333333; font-size: 14px; cursor: pointer;}.plugin-creation-app .app-button:hover{color: #ffffff; background-color: #0db2ef; border-radius: 2px;}.plugin-creation-app .appBuilder {margin: 4px 0;}.plugin-creation-app {color: #4d4d4d; font-size: 14px;}",
"url:builder/plugins/header/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"home-section jimu-float-leading" data-dojo-attach-point\x3d"homeSection"\x3e\r\n    \x3cdiv class\x3d"home-label" data-dojo-attach-point\x3d"homeLabel"\x3e${nls.home}\x3c/div\x3e\r\n    \x3cdiv class\x3d"home-menu header-menu" data-dojo-attach-point\x3d"homeMenu"\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"homeItem"\x3e${nls.home}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"galleryItem"\x3e${nls.gallery}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"mapItem"\x3e${nls.map}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"groupsItem"\x3e${nls.groups}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"contentItem"\x3e${nls.content}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"organizationItem"\x3e${nls.organization}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"logo-title jimu-float-leading" data-dojo-attach-point\x3d"logoTitle"\x3e\r\n    \x3cdiv class\x3d"logo jimu-float-leading"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"title jimu-float-leading"\x3eWeb AppBuilder for ArcGIS\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-name" data-dojo-attach-point\x3d"appName"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"user-section jimu-float-trailing" data-dojo-attach-point\x3d"userSection" data-dojo-attach-event\x3d"onclick:_onUserSectionClicked"\x3e\r\n    \x3cdiv class\x3d"user-info" data-dojo-attach-point\x3d"userInfoDom"\x3e      \r\n      \x3cdiv class\x3d"user-name jimu-float-trailing" data-dojo-attach-point\x3d"userNameNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"user-icon jimu-float-trailing"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"user-menu header-menu" data-dojo-attach-point\x3d"userMenu"\x3e\r\n      \x3ca nowrap target\x3d"_self" data-dojo-attach-point\x3d"profileItem"\x3e${nls.profile}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_blank" data-dojo-attach-point\x3d"helpItem"\x3e${nls.help}\x3c/a\x3e\r\n      \x3cdiv nowrap class\x3d"sign-out" data-dojo-attach-point\x3d"signOutItem"\x3e${nls.signOut}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/header/css/style.css":".plugin-header{position:relative; background: #ffffff; width:100%; min-width: 1000px; height:40px; line-height:40px; color:#4d4d4d; z-index: 10; font-size: 12px}.plugin-header .header-menu{display: none; position: absolute; top: 40px; box-shadow: 0 0 4px #646464;}.plugin-header .header-menu a, .plugin-header .header-menu div{display: block; height: 30px; line-height: 30px; padding-left: 25px; padding-right: 25px; cursor: pointer; white-space: nowrap; font-size: 14px; background-color: #fafafc; text-decoration: none; color: #7989a0;}.plugin-header .header-menu a:hover, .plugin-header .header-menu div:hover{background-color: #edf2f5; color: #15a4fa;}.plugin-header .home-section{position: relative; display: inline-block; height: 100%; margin-left: 10px; cursor: pointer;}.jimu-rtl .plugin-header .home-section{margin-left: 0; margin-right: 10px;}.plugin-header .home-section .home-label{height: 100%; line-height: 40px; overflow: hidden; cursor: pointer; padding-right: 12px;}.jimu-rtl .plugin-header .home-section .home-label{padding-right: 0; padding-left: 12px;}.plugin-header .home-section .home-label.dropdown{background-repeat: no-repeat; background-position: right center; background-image: url(images/v.png);}.jimu-rtl .plugin-header .home-section .home-label.dropdown{background-position: left center;}.plugin-header .home-section .home-menu{left: 0;}.jimu-rtl .plugin-header .home-section .home-menu{left: auto; right: 0;}.plugin-header .user-section{position: relative; display: inline-block; height: 100%; margin-right: 20px; cursor: pointer;}.jimu-rtl .plugin-header .user-section{margin-right: 0; margin-left: 20px;}.plugin-header .user-section .user-info{height: 100%; line-height: 40px; overflow: hidden; cursor: pointer; display: inline-block;}.plugin-header .user-section .user-icon{display: inline-block; width: 14px; height: 100%; background: no-repeat center center url(images/sign_in.png);}.plugin-header .user-section .user-name{display: inline-block; height: 100%; line-height: 40px; overflow: hidden; cursor: pointer; margin-left: 10px; padding-right: 12px; background-repeat: no-repeat; background-position: right center; background-image: url(images/v.png);}.jimu-rtl .plugin-header .user-section .user-name{margin-left: 0; margin-right: 10px; padding-right: 0; padding-left: 12px; background-position: left center;}.plugin-header .user-section .header-menu{right: 0;}.jimu-rtl .plugin-header .user-section .header-menu{right: auto; left: 0;}.plugin-header .user-section .sign-out{border-top: 1px solid #eeeeee;}.plugin-header .logo-title{height: 100%;}.plugin-header .logo{width: 26px; height: 40px; background: url(images/logo.png) no-repeat center; margin-left: 20px;}.jimu-rtl .plugin-header .logo{margin-left: 0; margin-right: 20px;}.plugin-header .title{margin-left: 10px; color: #4d4d4d;}.jimu-rtl .plugin-header .title{margin-left: 0; margin-right: 10px;}.plugin-header .app-name{position: absolute; left: 50%; top: 0; bottom: 0; color: #7f7f7f;}",
"url:builder/plugins/map-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"map-info-section"\x3e\r\n    \x3cdiv class\x3d"map-selected-meta-data"\x3e\r\n      \x3cdiv class\x3d"thumbnail-container" data-dojo-attach-point\x3d"thumbnailContainer" data-dojo-attach-event\x3d"click:_showMapSelector" title\x3d"${nls.clickChooseWebMap}"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"detail-info"\x3e\r\n        \x3cdiv style\x3d"overflow:hidden;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webItemIcon" class\x3d"web-item-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"owner-div jimu-float-leading" style\x3d"width:140px;"\x3e\r\n            \x3cspan class\x3d"item-type" data-dojo-attach-point\x3d"webItemType"\x3e\x3c/span\x3e\r\n            \x3cdiv class\x3d"owner-link-div"\x3e\r\n              \x3cspan class\x3d"owner-tip"\x3e${nls.owner}\x3c/span\x3e\r\n              \x3ca class\x3d"owner-name" href\x3d"#" target\x3d"_blank" data-dojo-attach-point\x3d"ownerName"\x3e\x3c/a\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-top:5px;color:#596679;"\x3e\r\n          \x3cspan\x3e${nls.lastModified}:\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"lastModified" class\x3d"last-modified"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-top:5px;"\x3e\r\n          \x3ca data-dojo-attach-point\x3d"webMapDetails" href\x3d"#" target\x3d"_blank" class\x3d"webmap-details"\x3e${nls.moreDetails}...\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv nowrap class\x3d"jimu-btn choose-map-btn" title\x3d"${nls.changeMap}" data-dojo-attach-event\x3d"click:_showMapSelector"\x3e${nls.changeMap}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"map-info-content"\x3e\r\n      \x3cdiv class\x3d"map-info-title" data-dojo-attach-point\x3d"mapTitle"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"snippet" data-dojo-attach-point\x3d"snippet"\x3e\x3c/p\x3e\r\n      \x3cdiv class\x3d"map-option extent-option"\x3e\r\n        \x3cdiv class\x3d"option-title"\x3e${nls.setInitialExtent}\x3c/div\x3e\r\n        \x3cp class\x3d"option-statement"\x3e${nls.statement}\x3c/p\x3e\r\n        \x3cspan class\x3d"jimu-btn init-ext-btn" data-dojo-attach-event\x3d"onclick:_useCurrentMapExtent"\x3e${nls.useCurrentExtent}\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"jimu-btn restore-ext-btn" data-dojo-attach-event\x3d"onclick:_useDefaultMapExtent"\x3e${nls.restoreInitialExtent}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"map-option scale-option"\x3e\r\n        \x3cdiv class\x3d"option-title"\x3e${nls.scaleTitle}\x3c/div\x3e\r\n        \x3cp class\x3d"option-statement"\x3e${nls.scaleStatement}\x3c/p\x3e\r\n        \x3cspan class\x3d"jimu-btn scale-btn" data-dojo-attach-point\x3d"btnScale" data-dojo-attach-event\x3d"onclick:_onBtnScaleClicked"\x3e${nls.customize}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapSelector.html":'\x3cdiv style\x3d"position:relative;width:100%;height:100%;"\x3e\r\n\t\x3cdiv class\x3d"map-setting-tab-container" style\x3d"width:100%;height:100%;"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"  style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:70px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:113px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel  data-dojo-attach-point\x3d"portalNameLabel" class\x3d"jimu-float-leading portal-name"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlineNameLabel" class\x3d"jimu-float-leading online-name"\x3eArcGIS.com\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicMapSection" class\x3d"public-map-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"filteredMapsSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/CustomizeScale.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"scale-input-div"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading" data-dojo-attach-point\x3d"scaleNumberBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'placeholder:"${nls.scale}",intermediateChanges:true,trim:true,constraints:{min:1,pattern: "###############0.################"}\' style\x3d"width:550px;height:100%;"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"add-btn jimu-float-leading" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onBtnAddClicked"\x3e+\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"operations-div"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn delete-btn" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onBtnDeleteClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.deleteTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn reset-btn" data-dojo-attach-event\x3d"onclick:_onBtnResetClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.resetTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"list" data-dojo-attach-point\x3d"listNode" data-dojo-attach-event\x3d"onclick:_onLodListClicked"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/css/style.css":".map-config{margin: 0; padding: 0; overflow-y: hidden;}.map-config .map-info-section{position:absolute; left: 20px; right: 20px; top: 20px; bottom: 0;}.map-config .big-img{position:relative; width:100%; height:240px; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background:#e5e5e5;}.map-config .add-map-tip{margin-top:13px; padding-left:6px; padding-right:6px; color:#999999; font-size:12px;}.map-config .map-selected-meta-data{position: relative; width: 100%; height: 133px;}.map-config .thumbnail-container{position:absolute; left: 0; right: auto; top: 0; width:190px; height:133px; cursor: pointer;}.jimu-rtl .map-config .thumbnail-container{left: auto; right: 0;}.map-config .thumbnail-container .thumbnail{width: 100%; height: 100%; -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; background-color:#e5e5e5; border:1px solid #d2dae2; background-repeat:no-repeat; background-position:center center; background-size:cover;}.map-config .thumbnail-container .thumbnail.default-webmap{background-image: url(images/WebMapThumbnail.png);}.map-config .thumbnail-container .thumbnail.default-webscene{background-image: url(images/WebSceneThumbnail.png);}.map-config .detail-info{position: absolute; left: 200px; top: 0; right: 0; height: 100%; color: #333333; font-size: 13px;}.jimu-rtl .map-config .detail-info{left: 0; right: 200px;}.map-config .web-item-icon{display: inline-block; width: 16px; height: 16px; background-position: center center; background-repeat: no-repeat;}.map-config .web-item-icon.webmap{background-image: url(images/WebMapIcon.png);}.map-config .web-item-icon.webscene{background-image: url(images/WebSceneIcon.png);}.map-config .owner-div{padding-left: 5px; color: #596679;}.jimu-rtl .map-config .owner-div{padding-left: 0; padding-right: 5px;}.map-config .owner-link-div{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .owner-link-div .owner-name{color: #518dca; text-decoration: none;}.map-config .last-modified{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details{text-decoration: none; color: #518dca;}.map-config .map-info-content{position: absolute; width: 100%; left: 0; right: 0; top: 133px; bottom: 0; overflow: auto;}.map-config .snippet{max-height:115px; overflow: hidden; text-overflow: ellipsis; margin-top: 10px; font-size:12px; color: #596679;}.map-config .extent-option{margin-top: 33px;}.map-config .option-title{font-size: 14px; font-weight: bold; color: #596679;}.map-config .option-statement{font-size: 12px; color: #596679; margin-top: 9px;}.map-config .init-ext-btn{margin-top:10px;}.map-config .restore-ext-btn{margin-top:10px;}.map-config .scale-option{margin-top: 38px;}.map-config .scale-btn{margin-top: 10px;}.map-config .choose-map-btn{position:absolute; left:0; bottom:0; white-space:nowrap; width:100%; overflow:hidden; padding: 0; text-align: center; text-overflow: ellipsis;}.map-config .jimu-btn{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; color: #ffffff;}.map-config .jimu-btn.jimu-state-disabled{color: #d9dde0;}.map-config .map-info-title{margin-top:10px; color:#596679; font-size:12px;}.map-config .set-extent-tip{color:#999999; font-size:12px;}.map-config .description{position:absolute; top:420px; bottom:0; width:100%; overflow:auto; color:#999999; font-size:12px;}.map-table{position:absolute; width: 100%; top:0; bottom: 0; height: auto;}.map-table .maps-section{position: absolute; width: 100%; top: 0; bottom: 0;}.map-table .maps-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.map-table .maps-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.map-table .maps-table td{vertical-align:top;}.map-table .map-item-div{width:176px; padding:3px;}.map-table .map-item-div .map-item-bg{position:relative; width:100%; height:118px; text-align:center; color:#999999; font-size:13px;}.map-table .map-item-div .map-item-bg .map-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center; border:1px solid #d2dae2; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-thumbnail{left: auto; right: 0;}.map-table .map-item-div .map-item-bg.selected .map-item-thumbnail{border:3px solid #15a4fa; -webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.map-table .map-item-div .map-item-bg .map-item-detail-icon{display: none; position:absolute; right:7px; bottom:7px; width:15px; height:15px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/info.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-detail-icon{right: auto; left: 7px;}.map-table .map-item-div .map-item-bg:hover .map-item-detail-icon{display: block;}.map-table .map-item-div .map-item-title{display:inline-block; width:100%; max-height: 31px; text-align:center; color:#596679; font-size:13px; margin-top: 10px; overflow: hidden; word-wrap: break-word;}.map-table .search-none-tip-section .search-none-icon{display:inline-block; width:12px; height:12px; background:url(images/error.png) no-repeat center center; margin-left:5px;}.jimu-rtl .map-table .search-none-tip-section .search-none-icon{margin-left: 0; margin-right: 5px;}.map-table .search-none-tip-section .search-none-tip{font-size:13px; color:#ff0000; margin-left:10px;}.jimu-rtl .map-table .search-none-tip-section .search-none-tip{margin-left: 0; margin-right: 10px;}.map-selector .jimu-tab3{height: 100%;}.map-selector .jimu-tab3\x3e.container-node{position:absolute; width:100%; left:0; right:0; top:60px; bottom:0;}.map-selector .jimu-tab3 .tab-item-div{height: 48px; line-height: 48px;}.map-selector .tab-content{position: relative;}.map-selector .tab-content .tab-content-main{position: absolute; width: 100%; top:0; bottom:0;}.map-selector .public-search-radios{position:absolute; width:100%; top:75px; height: 20px; line-height:1em; color:rgb(140, 140, 140);}.map-selector .public-search-radios span{display: inline-block;}.map-selector .public-search-radios .portal-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .portal-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-search-radios .portal-name{margin-right: 28px;}.jimu-rtl .map-selector .public-search-radios .portal-name{margin-right: 0; margin-left: 28px;}.map-selector .public-search-radios .online-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .online-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-map-section{position:absolute; width:100%; top:100px; bottom:0;}.map-selector .signin-section{position: absolute; top:75px; width:100%;}.map-selector .signin-section .signin-tip{width:100%; color:#d6d6d6; font-size:13px;}.mapconfig-customize-scale{width: 100%; height: 100%;}.mapconfig-customize-scale .scale-input-div{position:relative; height:30px;}.mapconfig-customize-scale .add-btn{width: 30px; height: 100%; line-height: 30px; color: #ffffff; font-size: 28px; text-align: center; vertical-align: center; cursor: default; background-color: #d2dae2;}.mapconfig-customize-scale .scale-input-div:hover .add-btn{background-color: #15a4fa;}.mapconfig-customize-scale .operations-div{height: 24px; margin-top: 13px; margin-bottom: 2px;}.mapconfig-customize-scale .operation-btn{display: inline-block; overflow: hidden; height: 24px; cursor: default; font-size: 13px;}.mapconfig-customize-scale .operation-btn .icon{width: 14px; height: 100%; background-repeat: no-repeat; background-position: center center;}.mapconfig-customize-scale .delete-btn{color: #a0acbf; cursor: default;}.mapconfig-customize-scale .delete-btn.enabled-operation{color: #518dca; cursor: pointer;}.mapconfig-customize-scale .delete-btn .icon{background-image: url(images/delete1.png);}.mapconfig-customize-scale .delete-btn.enabled-operation .icon{background-image: url(images/delete2.png);}.mapconfig-customize-scale .reset-btn .icon{background-image: url(images/reset2.png);}.mapconfig-customize-scale .reset-btn{margin-left: 15px; color: #518dca; cursor: pointer;}.jimu-rtl .mapconfig-customize-scale .reset-btn{margin-left: 0; margin-right: 15px;}.mapconfig-customize-scale .operation-btn .label{height: 100%; line-height: 24px; vertical-align: middle; margin-left: 7px;}.jimu-rtl .mapconfig-customize-scale .operation-btn .label{margin-left: 0; margin-right: 7px;}.mapconfig-customize-scale .list{width: 100%; height: 395px; border: 1px solid #dfe4ea; background-color: #fafafc; color: #7989a0; font-size: 14px; overflow: auto;}.mapconfig-customize-scale .list .lod-item{height: 30px; line-height: 30px; padding-left: 10px; cursor: default; border-bottom: 1px solid #f2f4f7;}.mapconfig-customize-scale .list .lod-item.selected{background-color: #e3ecf2; color: #596670;}",
"url:builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/templates/AGOLTemplate.html":'\x3cdiv\x3e\r\n  \x3c!--div class\x3d"front-div" data-dojo-attach-point\x3d"frontDiv"--\x3e\r\n    \x3c!--div class\x3d"header-div" data-dojo-attach-point\x3d"headerDiv"\x3e\r\n      \x3cspan\x3e${nls.title}\x3c/span\x3e\r\n      \x3cimg src\x3d"builder/css/images/cancel.png" alt\x3d"img" data-dojo-attach-event\x3d"onclick:_onCancelClick"\x3e\x3c/img\x3e\r\n    \x3c/div--\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part jimu-float-leading" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title"\x3e${nls.appNameTitle}${app.name}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part jimu-float-leading" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-head" \x3e\r\n          \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n          \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick" style\x3d"display:none"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n          \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"right-part-subhead"\x3e\r\n          ${nls.rightPartSubhead}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n          \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e     \r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!--div class\x3d"operation-div" data-dojo-attach-point\x3d"operationDiv"\x3e\r\n      \x3cdiv class\x3d"operation-item-div  export-div jimu-btn" style\x3d"" data-dojo-attach-point\x3d"exportNode" data-dojo-attach-event\x3d"onclick:_onExportClick"\x3e${nls.download}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div  download-div jimu-btn jimu-state-disabled" style\x3d"padding: 0px; display: none" data-dojo-attach-point\x3d"downloadNode"\x3e\r\n        \x3ca class\x3d"download-a" href\x3d"#" target\x3d"downloadTargetFrame" data-dojo-attach-point\x3d"downloadLinkNode"\x3e${nls.download}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div save-div jimu-btn" data-dojo-attach-event\x3d"onclick:_onSaveClick"\x3e\r\n        ${nls.save}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div cancel-div jimu-btn" data-dojo-attach-event\x3d"onclick:_onCancelClick"\x3e\r\n        ${nls.cancel}\r\n      \x3c/div\x3e\r\n    \x3c/div--\x3e\r\n  \x3c!--/div--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/templates/Export.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:block;" class\x3d"message-div" data-dojo-attach-point\x3d"templateTitle"\x3e${nls.templateTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"message-div" data-dojo-attach-point\x3d"message1"\x3e\x3c/p\x3e\r\n  \x3cdiv style\x3d"display:none;" class\x3d"explain-div" data-dojo-attach-point\x3d"explain1"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/popup-actions/popup-agoltemplate/AGOLTemplate/templates/ExportMessage.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"element resMessage" data-dojo-attach-point\x3d"resMessage"\x3e\x3c/div\x3e\r\n    \x3c!--div class\x3d"element" data-dojo-attach-point\x3d"message1"\x3e\x3c/div--\x3e\r\n    \x3cdiv class\x3d"element itemLink"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word1" \x3e\x3c/span\x3e\r\n      \x3ca class\x3d"download-a" target\x3d"_blank" data-dojo-attach-point\x3d"itemLink"\x3e\x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word2" \x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/popup-actions/popup-agoltemplate/css/style.css":".agol-template {}.agol-template .front-div {border: 0px solid; width: 1024px; height: 650px; background-color: #ffffff; margin: 79px auto; border-radius: 4px;}.agol-template .header-div {height: 50px; padding-left: 20px; line-height: 50px; color: #ffffff; font-size: 20px; background-color: #6f7e95; border-top-left-radius: 4px; border-top-right-radius: 4px;}.agol-template .header-div span{}.agol-template .header-div img{float: right; margin-top: 20px; margin-right: 30px; cursor: pointer;}.agol-template .content-part {width: 100%; height: 500px; overflow: hidden; border: 0px solid;}.agol-template .tree-part {border: 0px solid; width: 280px; height: 100%; overflow: auto; margin-right: 10px; border-radius: 4px; background-color: #f5f5f5; color: #333333; font-size: 13px;}.jimu-rtl .agol-template .tree-part {margin-left: 10px; margin-right: auto;}.agol-template .tree-part .left-part-title {height: 30px; padding: 8px; color: #596679; font-size: 15px;}.agol-template .tree-node-div{height: 40px; line-height:40px; border-radius: 4px; border: 0px solid; overflow: hidden;}.agol-template .tree-node-heighlight-div{background-color: #b0cdf6;}.agol-template .tree-node-div:hover{background-color: #e3ecf2;}.agol-template .tree-node-div-unable-selected{border: 0px solid; height: 30px; overflow: hidden;}.agol-template .tree-node-subdiv{border: 0px solid;}.agol-template .show-subnode-div{margin-left: 7px; margin-right: 7px;}.agol-template .line-label-span{}.agol-template .to-right-div{cursor: pointer; margin-right: 15px;}.jimu-rtl .agol-template .to-right-div{margin-left: 15px; margin-right: auto;}.agol-template .to-right-img{} .agol-template .right-part {border: 0px solid; width: 690px; height: 100%; background-color: #f5f5f5; border-radius: 4px; position: relative;}.agol-template .right-part-head{color: #596679; font-size: 18px; overflow: hidden; line-height: 50px; padding-left: 20px;}.jimu-rtl .right-part-head {padding-right: 20px; padding-left: 0;}.agol-template .right-part-subhead{color: #596679; font-size: 15px; overflow: hidden; line-height: 30px; padding-left: 20px; display: none;}.jimu-rtl .agol-template .right-part-subhead{padding-right: 20px; padding-left: 0;}.agol-template .review-json-div {min-width: 140px; border: 0px solid; height: 50px; text-align: center; cursor: pointer; float: right; border-radius: 4px; color: #518dca; font-size: 15px;}.agol-template .review-json-back-div {min-width: 140px; border: 0px solid; height: 50px; text-align: center; cursor: pointer; float: right; border-radius: 4px; color: #518dca; font-size: 15px;}.agol-template .show-json-div {position: absolute; margin: 0px auto; top: 51px; width: 690px; height: 428px; background-color: #ffffff; border: 0px solid; display: none; border-radius: 4px;}.agol-template .show-json-content-div {height: 100%; border: 0px solid; overflow: auto;}.agol-template .show-json-cancel-div {width: 160px; height: 40px; background-color: #cccccc; border: 0px solid; text-align: center; cursor: pointer; border-radius: 4px; margin-top: 4px; margin-left: 848px; line-height: 40px; color: #606060; font-size: 13px;} .agol-template .category-part {border: 0px solid; height: 430px; overflow: auto; padding-left: 12px; padding-right: 12px;}.agol-template .category-div{border: 0px solid; margin-bottom: 2px; border-radius: 4px; background-color: #ffffff;}.agol-template .category-head-div{overflow: hidden; height: 40px; border-radius: 4px; background-color: #fbfbfb; border: 0px solid; line-height: 40px; padding-left: 14px; color: #596679; font-size: 15px; cursor: pointer;}.jimu-rtl .agol-template .category-head-div{padding-right: 14px; padding-left: 0;}.agol-template .category-head-div-selected{background-color: #6f7e95; color: #ffffff;}.agol-template .category-fold-div{margin-top: -1px; width: 22px; padding-left: 7px;}.jimu-rtl .agol-template .category-fold-div{padding-right: 7px; padding-left: 0}.agol-template .category-title-div{margin-right: 50px;}.jimu-rtl .agol-template .category-title-div{margin-left: 50px; margin-right: auto;}.agol-template .category-oper-div{text-align: center; border: 0px solid;} .agol-template .category-oper-item-div{cursor: pointer; width: 30px;}.agol-template .category-moveup-div{}.agol-template .category-movedown-div{}.agol-template .category-remove-div{} .agol-template .fields-div{margin-top: 10px; margin-left: 20px; color: #000000; font-size: 12px; padding-bottom: 30px;}.jimu-rtl .agol-template .fields-div{margin-right: 20px; margin-left: auto;}.agol-template .fields-div input{font-size: 12px;}.agol-template .field-div{background-color: #ffffff; overflow: hidden; margin-bottom: 2px; padding-top: 2px; padding-bottom: 2px; border-radius: 4px;}.agol-template .field-head-div{overflow: hidden; cursor: pointer;}.agol-template .field-head-title-div{line-height: 25px; color: #596679; font-size: 14px;}.agol-template .field-heighlight-div{background-color: #eeeeee;}.agol-template .field-fold-div{width: 30px; cursor: pointer; text-align: right; border: 0px solid; height: 30px; line-height: 30px; margin-top: -2px;}.jimu-rtl .agol-template .field-fold-div{text-align: left;}.agol-template .field-fold-img{margin-right: 5px;}.jimu-rtl .agol-template .field-fold-img{margin-left: 5px; margin-right: auto;}.agol-template .field-label-span{line-height: 30px; margin-left: 30px; display: inline-block; width: 80px;}.jimu-rtl .agol-template .field-label-span{margin-right: 30px; margin-left: auto;}.agol-template .field-label-input{width: 150px; margin-left: 10px; margin-right: 40px; display: inline-block;}.jimu-rtl .agol-template .field-label-input{margin-left: 40px; margin-right: 10px;}.agol-template .field-type-span{line-height: 30px; display: inline-block; width: 80px;}.agol-template .field-type-select{height: 30px; width: 170px; margin-left: 10px;}.jimu-rtl .agol-template .field-type-select{margin-right: 10px; margin-left: auto;}.agol-template .field-oper-div{margin-right: 15px; text-align: center; cursor: pointer; line-height: 30px;}.jimu-rtl .agol-template .field-oper-div{margin-left: 15px; margin-right: auto;}.agol-template .field-oper-img{width: 10px;} .agol-template .field-content-div{padding-top: 20px; padding-bottom: 40px; margin-left: 30px; border-radius: 4px;}.jimu-rtl .agol-template .field-content-div{margin-right: 30px; margin-left: auto;}.agol-template .field-content-div input{margin-bottom: 3px;}.agol-template .field-tooltip-input{margin-left: 10px;}.jimu-rtl .agol-template .field-tooltip-input{margin-right: 10px; margin-left: auto;}.agol-template .field-tooltip-span{display: inline-block; width: 80px;} .agol-template .field-string-ph-span{display: inline-block; width: 80px;}.agol-template .field-string-ph-input{margin-left: 10px;}.jimu-rtl .agol-template .field-string-ph-input{margin-right: 10px; margin-left: auto;}.agol-template .field-text-type-span{line-height: 30px; width: 80px;}.agol-template .field-string-options {margin-left: 10px; width: 156px; height: 30px;}.jimu-rtl .agol-template .field-string-options {margin-right: 10px; margin-left: auto;} .agol-template .field-num-min-span{display: inline-block; width: 80px;}.agol-template .field-num-min-input{margin-left: 10px;}.jimu-rtl .agol-template .field-num-min-input{margin-right: 10px; margin-left: auto;}.agol-template .field-num-max-span{display: inline-block; width: 80px;}.agol-template .field-num-max-input{margin-left: 10px;}.jimu-rtl .agol-template .field-num-max-input{margin-right: 10px; margin-left: auto;}.agol-template .field-num-places-span{display: inline-block; width: 80px;}.agol-template .field-num-places-input{margin-left: 10px;}.jimu-rtl .agol-template .field-num-places-input{margin-right: 10px; margin-left: auto;} .agol-template .field-options-add-div{border: 0px solid; border-radius: 4px; height: 30px; text-align: center; line-height: 30px; width: 425px; margin-bottom: 3px; background-color: #e5e5e5;}.agol-template .field-options-add-content{overflow: hidden; width: 150px; margin: 0px auto; border: 0px solid; height: 30px;}.agol-template .field-options-add-img-div{margin-top: 2px;}.agol-template .field-options-add-text-div{margin-left: 10px;}.jimu-rtl .agol-template .field-options-add-text-div{margin-right: 10px; margin-left: auto;}.agol-template .field-options-div{overflow: hidden; line-height: 30px;}.agol-template .field-options-div input{margin-left: 10px; margin-right: 20px;}.jimu-rtl .agol-template .field-options-div input{margin-left: 20px; margin-right: 10px;}.agol-template .field-options-label-div{}.agol-template .field-options-label-input{}.agol-template .field-options-value-div{}.agol-template .field-options-value-input{}.agol-template .field-options-remove-div{cursor: pointer; height: 30px; padding-top: 3px;}.agol-template .operation-div{border: 0px solid; cursor: pointer; overflow: hidden; margin-top: 30px; margin-right: 14px; float: right; text-align: center; color: #606060; font-size: 13px;}.agol-template .operation-item-div{border: 0px solid; float: left; border-radius: 4px; margin-right: 10px;}.agol-template .operation-div .download-div{}.agol-template .operation-div .save-div{}.agol-template .download-a{text-decoration: none; display: block; width: 70px; height: 41px; line-height: 41px; color: #aaaaaa;}.agol-template .download-div-enable{color: #ffffff;}.export-agoltemplate {color: #4d4d4d; font-size: 14px;}.export-agoltemplate .message-div {margin: 4px 0;}.export-agoltemplate .explain-div {font-size: 11px; color: red; margin-bottom: 2px;}.agol-template-export-message .element{width: 100%; border: 0px solid; margin-bottom: 10px; font-size: 15px;}",
"url:builder/plugins/popup-actions/popup-saveas/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"footMenu"\x3e\r\n      \x3cdiv nowrap data-dojo-attach-event\x3d"click:_onSave"\x3e${nls.save}\x3c/div\x3e\r\n      \x3cdiv nowrap data-dojo-attach-event\x3d"click:_onSaveAs"\x3e${nls.saveAs}\x3c/div\x3e\r\n      \x3cdiv nowrap data-dojo-attach-event\x3d"click:_onExportAsTemplate" data-dojo-attach-point\x3d"exportMenu"\x3e${nls.exportTitle}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/startup/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"viewStackNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/startup/css/style.css":".plugin-startup .header{height: 40px; width: 100%;}.plugin-startup\x3e.jimu-viewstack{position: absolute; top: 40px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #E3ECF2;}","url:builder/plugins/theme-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"theme-list" data-dojo-attach-point\x3d"themeList"\x3e\r\n    \x3cdiv class\x3d"theme-title"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separate-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"style-list" data-dojo-attach-point\x3d"styleList"\x3e\r\n    \x3c!--div class\x3d"style-text"\x3e${nls.styleTitle}\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layout-list" data-dojo-attach-point\x3d"layoutList"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"theme-loading-cover" style\x3d"display:none" data-dojo-attach-point\x3d"themeCoverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/theme-config/css/style.css":".plugin-theme-config{overflow: auto; position: relative;}.plugin-theme-config .section {}.plugin-theme-config .theme-section{}.plugin-theme-config .theme-list{overflow: auto; display: none; padding-left: 30px; padding-right: 14px; border: 0px solid;}.jimu-rtl .plugin-theme-config .theme-list{padding-left: 14px; padding-right: 30px;}.plugin-theme-config .theme-title{margin-top: 20px; margin-left: 18px; font-size: 14px; color: #015574;}.plugin-theme-config .theme-catalog{border: 0px solid; display: none; overflow: hidden;}.plugin-theme-config .catalog-theme-content-div{border: 0px solid; width: 25%; height: 135px; overflow: hidden;}.plugin-theme-config .catalog-theme-div{position: relative; border: 3px solid #fff; width: 78px; height: 78px; border-radius: 6px; cursor: pointer; background-color: #e3ecf2;}.plugin-theme-config .catalog-theme-div:hover{border-radius: 6px; border-color: #15a4fa;}.plugin-theme-config .catalog-theme-selected {border-radius: 6px; border-color: #15a4fa;}.plugin-theme-config .catalog-theme-img-div{width: 100%; height: 100%; border: 0px solid;}.plugin-theme-config .catalog-theme-img{text-align: center; width: 100%; height: 100%;}.plugin-theme-config .catalog-theme-name-div{border: 0px solid; width: 72px; overflow: hidden; text-align: center; padding-top: 5px; font-size: 12px; color: #566979; cursor: default; text-overflow: ellipsis; line-height: 13px;}.plugin-theme-config .theme-cl-selected-div{position: absolute; left: 21px; top: 21px; width: 40px; height: 34px; border: 0px solid; text-align: center; border-radius: 4px; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .theme-cl-selected-img{margin-top: 10px;}.plugin-theme-config .separate-line{margin-left: 10px; margin-right: 10px; border-top: 1px solid #e3ecf2;}.plugin-theme-config .style-list{border: 0px solid; padding-right: 30px; padding-left: 30px;}.plugin-theme-config .style-section{border: 0px solid; overflow: auto;}.plugin-theme-config .style-text{margin-top: 20px; margin-bottom: 15px; font-size: 14px; font-weight: bold; color: #596679;}.plugin-theme-config .style-color-content{}.plugin-theme-config .style-div{position: relative; width: 25%; height: 30px; margin-bottom: 12px; border: 0px solid; cursor: pointer;}.plugin-theme-config .style-div:hover{border: 3px solid #15a4fa;}.plugin-theme-config .style-image{}.plugin-theme-config .style-selected{border: 3px solid #15a4fa;}.plugin-theme-config .style-selected-div{position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; border-radius: 2px; background-color: rgba(0, 0, 0, 0.65); text-align: center; display: none;}.plugin-theme-config .layout-list{border: 0px solid;}.plugin-theme-config .layout-section{border: 0px solid; overflow: hidden; margin-top: 28px; padding-left: 30px;}.jimu-rtl .plugin-theme-config .layout-section{padding-right: 30px; padding-left: auto;}.plugin-theme-config .layout-text{margin-bottom: 16px; font-size: 14px; font-weight: bold; color: #596679;}.plugin-theme-config .layout-out-div{position: relative; margin-bottom: 15px; width: 33%;}.plugin-theme-config .layout-box-div{width: 106px; height: 80px; border: 3px solid #ffffff;}.plugin-theme-config .layout-box-div:hover{border-radius: 4px; border: 3px solid #15a4fa;}.plugin-theme-config .layout-box-selected{border-radius: 4px; border: 3px solid #15a4fa;}.plugin-theme-config .layout-div{width: 100px; height: 74px; border-radius: 4px; border: 1px solid #d2dae2; background-color: #fafafc; text-align: center; cursor: pointer;}.plugin-theme-config .app-layout{background-color: #6f7e95;}.plugin-theme-config .layout-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .layout-selected{border: 1px solid #ffffff;}.plugin-theme-config .layout-image{width: 80%; height: 80%; margin-top: 8px;}.plugin-theme-config .layout-selected-div{position: absolute; left: 28px; top: 24px; width: 40px; height: 34px; border: 0px solid; text-align: center; border-radius: 4px; padding-top: 6px; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .layout-selected-img{}.plugin-theme-config .theme-loading-cover{position: absolute; z-index: 999; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.3);}",
"url:builder/plugins/widget-config/WidgetSettingPage.html":'\x3cdiv class\x3d"widget-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.widgetLabel}" required\x3d"true" class\x3d"widget-setting-input"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooser"\x3e\x3c/div\x3e\r\n            \x3cspan nowrap class\x3d"change-icon" data-dojo-attach-point\x3d"changeNode"\x3e${nls.changeIcon}\x3c/span\x3e\r\n            \x3ca class\x3d"help-link jimu-float-trailing" target\x3d"_blank" data-dojo-attach-point\x3d"helpNode"\x3e${nls.more}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layout"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"section widget-setting" data-dojo-attach-point\x3d"widgetSettingNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/GroupSettingPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"label-div"\x3e\r\n    \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n    \x3cinput class\x3d"jimu-input" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/input\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/widget-config/WidgetChoosePage.html":'\x3cdiv class\x3d"widget-choose-page"\x3e\r\n  \r\n  \x3cdiv class\x3d"section search" data-dojo-attach-point\x3d"searchSectionNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"searchInputNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"list widget-list" data-dojo-attach-point\x3d"widgetListNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preload-widgets-list" data-dojo-attach-point\x3d"preloadWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"controller-widgets-list" data-dojo-attach-point\x3d"controllerWidgetsNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"noncontroller-preload-widgets-list" data-dojo-attach-point\x3d"noncontrollerPreloadWidgetsNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"pool-widgets-list" data-dojo-attach-point\x3d"poolWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"widgets-link" data-dojo-attach-point\x3d"backWidgetsNode" data-dojo-attach-event\x3d"onclick: _onBackWidgetsClick"\x3e \x3cspan\x3e\x3c/span\x3e \x26nbsp;\r\n      ${nls.widgets}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-title" data-dojo-attach-point\x3d"poolTitleNode"\x3e${nls.setControlledWidgetsBy}\x3cspan data-dojo-attach-point\x3d"controllerLabelNode"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-list" data-dojo-attach-point\x3d"poolWidgetsListNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/css/style.css":".json-editor{width: 100%; height: 100%; position: relative;}.app-widgets{width: 100%; height: 100%;}.app-widgets\x3e.jimu-viewstack{width: 100%; height: 100%;}.app-widgets .preload-widgets-list, .app-widgets .pool-widgets-list{overflow: hidden; position: relative; width: 100%; height: 100%; padding: 15px 0px;}.app-widgets .controller-widget{position: relative; height: 118px;}.app-widgets .controller-widget .action-node{position: absolute; left: 96px; top: 0; height: 74px; right: 0; line-height: 74px; cursor: pointer; font-size: 14px; color: #518dca;}.app-widgets .controller-widget .action-node:hover{background-color: #EEF2F5; color: #15a4fa;}.app-widgets .controller-widget .action-node .action-text{white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 230px;}.app-widgets .controller-widget .action-node .action-arrow{width: 7px; height: 100%; background-image: url(images/right_arrow1.png); background-repeat: no-repeat; background-position: center;}.app-widgets .controller-widget .action-node:hover .action-arrow{background-image: url(images/right_arrow2.png);}.app-widgets .noncontroller-preload-widgets-list{position: absolute; left: 15px; right: 0; bottom: 0; overflow-x: hidden; overflow-y: auto;}.app-widgets .widget-pool-list{position: absolute; top: 75px; left: 15px; right: 0; bottom: 0; overflow-x: hidden; overflow-y: auto;}.app-widgets .widgets-link{font-size: 14px; margin-left: 30px; color: #518dca; cursor: pointer; font-weight: bold;}.app-widgets .widgets-link span{width: 7px; height: 12px; display: inline-block; background-image: url(images/left_arrow1.png)}.app-widgets .widgets-link:hover{color: #14a4fa;}.app-widgets .widgets-link:hover span{background-image: url(images/left_arrow2.png)}.app-widgets .widget-pool-title{margin-top: 15px; font-size: 12px; color: #596679; margin-left: 30px;}.app-widgets .moveable{position: absolute; font-size: 12px; float: left; z-index: 3;}.app-widgets .moveable.dojoMoveItem{z-index: 4;}.app-widgets .moveable .box{position: relative; border: 1px solid #8ccdec; background-color: #8ccdec; border-radius: 4px; width: 112px; height: 112px; overflow: hidden; cursor: pointer;}.app-widgets .moveable.node-active .box{border: 3px solid #15a4fa;}.app-widgets .moveable .box.jimu-state-active{border: 2px solid red;}.app-widgets .moveable .label{text-align: center; width: 100%; height: 30px; margin-top: 10px; overflow: hidden; text-overflow: ellipsis;}.app-widgets .moveable .edit-btn{position: absolute; border-radius: 4px; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/edit_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .drop-btn{position: absolute; border-radius: 2px; background: url(images/delete_widget.png) no-repeat center center;}.app-widgets .moveable .switch-btn{position: absolute; border-radius: 2px; background: url(images/eye_open.png) no-repeat center center;}.app-widgets .moveable.hide .switch-btn{background-image: url(images/eye_close.png);}.app-widgets .moveable.hide{opacity: 0.5;}.app-widgets .moveable .edit-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .drop-btn:hover{background-image:url(images/delete_widget_hover.png);}.app-widgets .moveable .switch-btn:hover{background-image: url(images/eye_open_hover.png);}.app-widgets .moveable.hide .switch-btn:hover{background-image: url(images/eye_close_hover.png);}.app-widgets .moveable .switch-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .node-shadow{position: absolute; border: 1px dashed;}.app-widgets .node-margin{position: absolute; z-index: 2; border-radius: 4px;}.app-widgets .node-margin-active{background: red;}.app-widgets .add-widget-node{position: absolute; font-size: 12px; float: left;}.app-widgets .add-widget-node .box{background-color: #fafafc; border: 1px dashed #d2dae2; color: #596679;}.app-widgets .add-widget-node img{width: 20px; height: 20px; display: block; margin: auto; margin-top: 10px;}.app-widgets .add-widget-node .label{margin-top: 6px; white-space: pre-line;}.app-widgets .empty-node .box{opacity: 0; cursor: normal;}.app-widgets .empty-node-active .box{opacity: 0.4;}.app-widgets .widget-node .placehoder{border-radius: 4px; border: 1px dashed #a0acbf; background-color: #596679; overflow: hidden;}.app-widgets .widget-node .placehoder-inner{text-align: center; color: black; background-color: white; font-size: 14px;}.app-widgets .group-node .small{float: left;}.app-widgets .widget-group-panel{position: absolute; background-color: #E3ECF2; border-radius: 4px;}.app-widgets .group-triangle{position: absolute; width: 0px; height: 0px; top: -8px; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 8px solid #E3ECF2;}.widget-setting-popup .content{overflow-y: hidden;}.widget-setting-page{width: 100%; height: 100%;}.widget-setting-page .common-setting{height: 74px; margin-bottom: 20px;}.widget-setting-page .common-setting .basic{overflow: hidden;}.widget-setting-page .common-setting .label input{width: 224px; height: 32px;}.widget-setting-page .opts-section{padding: 5px;}.widget-setting-page .common-setting .icon{background-color: #8ccdec; border: 1px solid #8ccdec; width: 74px; height: 74px; border-radius: 4px; display: inline-block;}.widget-setting-page .common-setting .icon img{width: 40px; height: 40px; margin: 17px;}.widget-setting-page .common-setting .right{font-size: 10px; width: 875px; display: inline-block;}.widget-setting-page .common-setting .right .widget-setting-input{width: 100%; color: black; display: block; background-color: #fafafc;}.widget-setting-page .image-container{overflow:hidden; min-width: 100px; width: 100%; display: inline-block; position: relative; height: 30px; margin-top: 14px;}.widget-setting-page .image-container .help-link{color: #518dca; display:none;}.widget-setting-page .jimu-image-chooser{height: 30px; padding: 0;}.widget-setting-page .common-setting .right .change-icon{white-space:nowrap; color: white; cursor: pointer; display: inline-block; background-color: #518dca; text-align: center; vertical-align: middle; height: 30px; line-height: 30px; border-radius: 5px; padding-left: 6px; padding-right: 6px; box-shadow: 0 0 2px gray; position: relative;}.widget-setting-page .common-setting .right .disable-change-icon{background-color: #a0acbf; cursor: default;}.widget-setting-page .common-setting .right .more{float: right; color: #15a4fa; display: inline-block; margin-top: 20px;}.widget-setting-page .common-setting .right-foot{position: relative; font-size: 16px;}.widget-setting-page .common-setting .right .state{font-size: 14px; margin-top: 10px;}.widget-setting-page .widget-setting{overflow-x: hidden; overflow-y: auto; position: relative;}.widget-setting-page .widget-default-setting{width: 100%; height: 100%;}.widget-setting-page .opts-section{height: 50px;}.widget-setting-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-setting-page .noconfig-info{font-size: 16px; position: absolute; left: 50%; top: 50%; margin-left: -100px;}.widget-choose-page{width: 100%; height: 100%;}.widget-choose-page .jimu-search{margin: 10px 0;}.widget-choose-page .widget-node{width: 78px; height: 118px; margin: 10px 10px 0 0px; float: left; font-size: 12px; cursor: pointer; position: relative;}.widget-choose-page .widget-node .box{position: relative; border: 1px solid #8ccdec; background-color: #8ccdec; border-radius: 4px; width: 78px; height: 78px; overflow: hidden;}.widget-choose-page .widget-node .box-border{position: absolute; border: 3px solid #15a4fa; border-radius: 6px; width: 82px; height: 82px; left: -2px; top: -2px; display: none;}.widget-choose-page .widget-node.jimu-state-selected .box-border{display: block;}.widget-choose-page .widget-node .icon{width: 40px; height: 40px; display: block; margin: auto; margin-top: 16px;}.widget-choose-page .widget-node .label{text-align: center; width: 100%; height: 30px; margin-top: 10px; overflow: hidden; text-overflow: ellipsis;}.widget-choose-page .search{width: 100%; overflow-x: hidden; overflow-y: auto;}.widget-choose-page .list{height: 100%; margin-right: -10px; padding-left: 2px;}.widget-choose-page .opts-section{overflow: hidden; margin-top: 10px;}.widget-choose-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;} .group-setting-page {margin: 20px 10px; font-size: 16px;}.group-setting-page .label-div input{margin-left: 10px; color: #000000;}.jimu-rtl .app-widgets .controller-widget .action-node{right: 96px; left: 0;}.jimu-rtl .widget-choose-page .widget-node{margin: 10px 0 0 10px; float: right;}.jimu-rtl .widget-choose-page .list{margin-right: auto; padding-left: auto; margin-left: -10px; padding-right: 2px;}.jimu-rtl .app-widgets .controller-widget .action-node .action-arrow{background-image: url(images/left_arrow1.png);}.jimu-rtl .app-widgets .controller-widget .action-node:hover .action-arrow{background-image: url(images/left_arrow2.png);}.jimu-rtl .app-widgets .widgets-link{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .widgets-link span{background-image: url(images/right_arrow1.png)}.jimu-rtl .app-widgets .widgets-link:hover span{background-image: url(images/right_arrow2.png)}.jimu-rtl .app-widgets .widget-pool-title{margin-left: auto; margin-right: 30px;}",
"*now":function(q){q(['dojo/i18n!*preload*builder/nls/main*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("dojo/_base/config dojo/_base/html dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/cookie dojo/topic dojo/json jimu/utils jimu/portalUrlUtils jimu/portalUtils ./tokenUtils ./utils ./PluginManager require esri/IdentityManager dojo/text!./plugins/plugins.json dojo/i18n!./nls/builder".split(" "),function(q,e,a,f,k,n,r,t,b,g,d,h,u,m,s,p,c,l,w){function v(a){e.setStyle("pre-main-page","display","none");e.setStyle("main-page","display","block");window.portalUrl=a.portalUrl;u.setPortalUrl(window.portalUrl);
var b=d.getSharingUrl(window.portalUrl);c.checkSignInStatus(b).then(function(){x(a)},function(){if(window.isXT)u.xtGetCredentialFromCookie(window.portalUrl)&&x(a);else{var b=d.getPortalSignInUrlFromLocation(),c=encodeURI(window.location.href);window.location.href=b+"?returnUrl\x3d"+c}})}function x(b){var c=h.getPortal(window.portalUrl),f;c.loadSelfInfo().then(function(a){f=a;window.portalSelf=a;window.isXT?a=m.checkProtocolAndUpdateSigninInfo(f,b):(a=new n,a.resolve({success:!0}));return a}).then(function(h){if(h.success){var k=
f.user&&f.user.culture||f.culture||q.locale;k&&(k=k.toLowerCase());h=null;g.isLocaleChanged(q.locale,k)&&(r("wab_locale",k),h=window.location.href);window.isXT&&/[\?|\&](action=)(.+)/gi.test(window.location.href)&&(h||(h=window.location.href),h=m.removeActionFromUrl(h));k="https:"===window.location.protocol;if(f.allSSL||k)window.portalUrl=b.portalUrl=d.setHttpsProtocol(b.portalUrl);c.portalUrl=window.portalUrl;var l=0===window.portalUrl.toLowerCase().indexOf("https:");!k&&l&&(h||(h=window.location.href),
h=h.replace(/^http:/i,"https:"));h?window.location.href=h:(h=z.startup,h.options={signinInfo:b},s.getInstance(z).loadPlugin(h).then(a.hitch(this,function(a){a.placeAt(e.byId("main-page"));a.startup()})))}else console.log("Update signin info error.")})}function y(a,b){f.forEach(b,function(b){var c=z[b.pluginName],d;for(d in b.parameters)if(d===a.name){var e=b.parameters[d];g.url.isAbsolute(e)||(b.parameters[d]=c.folderUrl+e)}})}function B(a){var c=new n;if(!a.parameters||null===b.stringify(a.parameters).match(/\$\{(\w)+\}/g))return c.resolve(!0),
c;var d=z[a.pluginName];s.getInstance().loadPluginI18n(d).then(function(b){a.parameters=g.replacePlaceHolder(a.parameters,b);c.resolve(!0)});return c}var z=b.parse(l);window.builderNls=w;window.pluginsMeta=z;"function"!==typeof r.getAll&&(r.getAll=function(a){var b=[];(a=r(a))&&b.push(a);return b});jimuConfig.layoutId=jimuConfig.mainPageId;t.subscribe("switchToMainPage",function(a){var b=m.removeActionFromUrl(window.location.href);g.changeLocation(b);v(a)});(function(){for(var a in z){var b=z[a];
b.amdFolder="builder/plugins/"+a.replace(/\./g,"/")+"/";b.folderUrl=p.toUrl(b.amdFolder);b.uri=b.amdFolder+"Plugin"}a=[];for(var c in z){var b=z[c],d;for(d in b.extensionPoints){var e=b.extensionPoints[d],f;for(f in e.parameters){var g=e.parameters[f];"url"===g.type&&y(g,e.extensions)}if(e.extensions)for(g=0;g<e.extensions.length;g++)a.push(B(e.extensions[g]))}}return k(a)})().then(function(){e.setStyle("main-loading","display","none");window.isXT?p(["./xtMain"]):t.publish("switchToMainPage",{portalUrl:d.getPortalUrlFromLocation()})})});